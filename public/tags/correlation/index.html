<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=4321&amp;path=livereload" data-no-instant defer></script>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131792052-1"></script>
  
  <script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-131792052-1');
  </script>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Fixing the bridge between biologists and statisticians  | Correlation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css" />
    <link rel="stylesheet" href="http://localhost:4321/css/blog.css" />
       
</head>
<body>

    
    <nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
            <a class="navbar-item" href="http://localhost:4321/">Home</a>
            <a class="navbar-item" href="http://localhost:4321/aboutthis" >About this site</a>
            <a class="navbar-item" href="http://localhost:4321/tutorials" >Tutorials</a>
            <a class="navbar-item" href="http://localhost:4321/_Statbook" >Book (Italian)</a>
            <a class="navbar-item" href="http://localhost:4321/_StatbookEng" >Book (English)</a>
            <a class="navbar-item" href="http://localhost:4321/rpackages" >R packages</a>
            <a class="navbar-item" href="http://localhost:4321/recentcourses" >Stat Courses</a>
            <a class="navbar-item" href="http://localhost:4321/links" >Links</a>
            <a class="navbar-item" href="http://localhost:4321/about" >About me</a>
        </div>
    </nav>
    

    
    <section class="hero is-info is-medium">
        <div class="hero-body" style="background-image: url(http://localhost:4321/img/bg-blog.jpg);">
            <div class="container has-text-centered">
                <br>
                <h1 class="title is-size-1">
                    
                        #Correlation
                    
                </h1>
                
            </div>
        </div>
    </section>



<div class="container">
    <div class="section">
    



<div class="columns">
    <div class="column is-9">
        <div class="tile is-child box">
            <div class="content">

                <article class="media">
                    <div class="media-content">
                        <div class="content">
                            <p class="title is-4"><a href="http://localhost:4321/2025/stat_general_correlationcovariance/">A trip from variance-covariance to correlation and back</a></p>
                            <p class="subtitle is-size-6 has-text-grey-light">
                                Published at January 24, 2025 &middot;
                                <i class="far fa-clock"></i>&nbsp;6 min read
                            </p>
                            <p><p>The variance-covariance and the correlation matrices are two entities that describe the association between the columns of a two-way data matrix. They are very much used, e.g., in agriculture, biology and ecology and they can be easily calculated with base R, as shown in the box below.</p>
<pre class="r"><code>data(mtcars)
matr &lt;- mtcars[,1:4]

# Covariances
Sigma &lt;- cov(matr)

# Correlations
R &lt;- cor(matr)

Sigma
##              mpg        cyl       disp        hp
## mpg    36.324103  -9.172379  -633.0972 -320.7321
## cyl    -9.172379   3.189516   199.6603  101.9315
## disp -633.097208 199.660282 15360.7998 6721.1587
## hp   -320.732056 101.931452  6721.1587 4700.8669
R
##             mpg        cyl       disp         hp
## mpg   1.0000000 -0.8521620 -0.8475514 -0.7761684
## cyl  -0.8521620  1.0000000  0.9020329  0.8324475
## disp -0.8475514  0.9020329  1.0000000  0.7909486
## hp   -0.7761684  0.8324475  0.7909486  1.0000000</code></pre>
<p>It is useful to be able to go back and forth from variance-covariance to correlation, without going back to the original data matrix. Let’s consider that the variance-covariance of the two variables X and Y is:</p>...</p>
                        </div>
                    </div>
                </article>
                <br>

                <article class="media">
                    <div class="media-content">
                        <div class="content">
                            <p class="title is-4"><a href="http://localhost:4321/2022/stat_general_r2/">The coefficient of determination: is it the R-squared or r-squared?</a></p>
                            <p class="subtitle is-size-6 has-text-grey-light">
                                Published at November 26, 2022 &middot;
                                <i class="far fa-clock"></i>&nbsp;9 min read
                            </p>
                            <p><p>We often use the <strong>coefficient of determination</strong> as a swift ‘measure’ of goodness of fit for our regression models. Unfortunately, there is no unique symbol for such a coefficient and both <span class="math inline">\(R^2\)</span> and <span class="math inline">\(r^2\)</span> are used in literature, almost interchangeably. Such an interchangeability is also endorsed by the Wikipedia (see at: <a href="https://en.wikipedia.org/wiki/Coefficient_of_determination">https://en.wikipedia.org/wiki/Coefficient_of_determination</a> ), where both symbols are reported as the abbreviations for this statistical index.</p>
<p>As an editor of several International Journals, I should not agree with such an approach; indeed, the two symbols <span class="math inline">\(R^2\)</span> and <span class="math inline">\(r^2\)</span> mean two different things, and they are not necessarily interchangeable, because, depending on the setting, either of the two may be wrong or ambiguous. Let’s pay a little attention to such an issue.</p>...</p>
                        </div>
                    </div>
                </article>
                <br>

                <article class="media">
                    <div class="media-content">
                        <div class="content">
                            <p class="title is-4"><a href="http://localhost:4321/2019/stat_general_correlationindependence2/">Dealing with correlation in designed field experiments: part II</a></p>
                            <p class="subtitle is-size-6 has-text-grey-light">
                                Published at May 10, 2019 &middot;
                                <i class="far fa-clock"></i>&nbsp;12 min read
                            </p>
                            <p><p>With field experiments, studying the correlation between the observed traits may not be an easy task. Indeed, in these experiments, subjects are not independent, but they are grouped by treatment factors (e.g., genotypes or weed control methods) or by blocking factors (e.g., blocks, plots, main-plots). I have dealt with this problem <a href="https://www.statforbiology.com/2019/stat_general_correlationindependence1/">in a previous post</a> and I gave a solution based on traditional methods of data analyses.</p>
<p>In a recent paper, Piepho (2018) proposed a more advanced solution based on mixed models. He presented four examplary datasets and gave SAS code to analyse them, based on PROC MIXED. I was very interested in those examples, but I do not use SAS. Therefore, I tried to ‘transport’ the models in R, which turned out to be a difficult task. After struggling for awhile with several mixed model packages, I came to an acceptable solution, which I would like to share.</p>...</p>
                        </div>
                    </div>
                </article>
                <br>

                <article class="media">
                    <div class="media-content">
                        <div class="content">
                            <p class="title is-4"><a href="http://localhost:4321/2019/stat_general_correlationindependence1/">Dealing with correlation in designed field experiments: part I</a></p>
                            <p class="subtitle is-size-6 has-text-grey-light">
                                Published at April 30, 2019 &middot;
                                <i class="far fa-clock"></i>&nbsp;7 min read
                            </p>
                            <p><p>When we have recorded two traits in different subjects, we can be interested in describing their joint variability, by using the Pearson’s correlation coefficient. That’s ok, altough we have to respect some basic assumptions (e.g. linearity) that have been detailed elsewhere (<a href="https://www.statforbiology.com/2019/stat_general_correlation_alookat/">see here</a>). Problems may arise when we need to test the hypothesis that the correlation coefficient is equal to 0. In this case, we need to make sure that all the couples of observations are taken on independent subjects.</p>...</p>
                        </div>
                    </div>
                </article>
                <br>

                <article class="media">
                    <div class="media-content">
                        <div class="content">
                            <p class="title is-4"><a href="http://localhost:4321/2019/stat_general_correlation_alookat/">Going back to the basics: the correlation coefficient</a></p>
                            <p class="subtitle is-size-6 has-text-grey-light">
                                Published at February 7, 2019 &middot;
                                <i class="far fa-clock"></i>&nbsp;7 min read
                            </p>
                            <p><div id="a-measure-of-joint-variability" class="section level1">
<h1>A measure of joint variability</h1>
<p>In statistics, dependence or association is any statistical relationship, whether causal or not, between two random variables or bivariate data. It is often measured by the Pearson correlation coefficient:</p>
<p><span class="math display">\[\rho _{X,Y} =\textrm{corr} (X,Y) = \frac {\textrm{cov}(X,Y) }{ \sigma_X \sigma_Y } = \frac{ \sum_{1 = 1}^n [(X - \mu_X)(Y - \mu_Y)] }{ \sigma_X \sigma_Y }\]</span></p>
<p>Other measures of correlation can be thought of, such as the Spearman <span class="math inline">\(\rho\)</span> rank correlation coefficient or Kendall <span class="math inline">\(\tau\)</span> rank correlation coefficient.</p>...</p>
                        </div>
                    </div>
                </article>
                <br>

            </div>
        </div>
    </div>
    <div class="column is-3">
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Tags</h1>
        <div class="tags">
        
            <span class="tag"><a href="http://localhost:4321/tags/agricensdata">agricensdata</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/ammi_analysis">ammi_analysis</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/aomisc">aomisc</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/asreml">asreml</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/bayesian_stat">bayesian_stat</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/biplot">biplot</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/blogdown">blogdown</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/boxplot">boxplot</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/case_study">case_study</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/climate_data">climate_data</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/correlation">correlation</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/cva">cva</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/data_management">data_management</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/delta_method">delta_method</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/descriptive_statistics">descriptive_statistics</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/diallel_models">diallel_models</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/dplyr">dplyr</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/drcseedgerm">drcseedgerm</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/drcte">drcte</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/drm">drm</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/error_propagation">error_propagation</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/gge_analysis">gge_analysis</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/ggh4x">ggh4x</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/ggplot">ggplot</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/gls">gls</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/gnlht">gnlht</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/jags">jags</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/linear_models">linear_models</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/lm">lm</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/lmdiallel">lmdiallel</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/lme">lme</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/long_term_experiments">long_term_experiments</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/meta_analysis">meta_analysis</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/metafor">metafor</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/mixed_models">mixed_models</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/multi_environment_studies">multi_environment_studies</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/multivariate_stat">multivariate_stat</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/nlme">nlme</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/nls">nls</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/nonlinear_regression">nonlinear_regression</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/p-values">p-values</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/pca">pca</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/percentiles">percentiles</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/plot">plot</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/qq_plot">qq_plot</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/r">r</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/regression">regression</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/repeated_measures">repeated_measures</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/seed_germination">seed_germination</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/split_plot">split_plot</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/statforbiology">statforbiology</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/statistical_inference">statistical_inference</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/subsampling">subsampling</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/tidyverse">tidyverse</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/time_to_event_models">time_to_event_models</a></span>
        
            <span class="tag"><a href="http://localhost:4321/tags/variance">variance</a></span>
        
        </div>          
    </div>
</div><br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Recent posts</h1>
        
            <h1><a href="http://localhost:4321/2025/stat_general_correlationcovariance/">A trip from variance-covariance to correlation and back</a></h1>
            <time class="has-text-grey-light is-size-7">24 January 2025</time>
        
            <h1><a href="http://localhost:4321/2024/stat_general_errorpropagation/">How do we combine errors? The linear case</a></h1>
            <time class="has-text-grey-light is-size-7">22 November 2024</time>
        
            <h1><a href="http://localhost:4321/2024/stat_general_thedeltamethod_edit/">How do we combine errors, in biology? The delta method</a></h1>
            <time class="has-text-grey-light is-size-7">22 November 2024</time>
        
            <h1><a href="http://localhost:4321/2024/r_ggplot_dualscaledaxes/">Plotting weather data with ggplot()</a></h1>
            <time class="has-text-grey-light is-size-7">6 June 2024</time>
        
            <h1><a href="http://localhost:4321/2024/stat_lm_checkassumptions/">Here is why I don&#39;t care about the Levene&#39;s test</a></h1>
            <time class="has-text-grey-light is-size-7">15 March 2024</time>
        
    </div>
</div>
    <br>
        <div class="card">
    <div class="card-content">
        <h1 class="title is-5">Archives</h1>
        
            <a href="http://localhost:4321/archives/2025">2025</a> (1)<br>
        
            <a href="http://localhost:4321/archives/2024">2024</a> (5)<br>
        
            <a href="http://localhost:4321/archives/2023">2023</a> (12)<br>
        
            <a href="http://localhost:4321/archives/2022">2022</a> (8)<br>
        
            <a href="http://localhost:4321/archives/2021">2021</a> (16)<br>
        
            <a href="http://localhost:4321/archives/2020">2020</a> (13)<br>
        
            <a href="http://localhost:4321/archives/2019">2019</a> (12)<br>
        
            <a href="http://localhost:4321/archives/2018">2018</a> (2)<br>
        
            <a href="http://localhost:4321/archives/2014">2014</a> (1)<br>
        
    </div>
</div>

    </div>
</div>


    </div>
</div>
<footer class="footer has-background-grey-darker has-text-white">
    <div class="content has-text-centered">
        <p>
             <span class="icon is-large"><a href="mailto:andrea.onofri@unipg.it" class="mysocial"><i class="far fa-envelope-open fa-3x"></i></a></span>&nbsp;&nbsp;
            <span class="icon is-large"><a href="https://github.com/OnofriAndreaPG/" class="mysocial"><i class="fab fa-github fa-3x"></i></a></span>&nbsp;&nbsp;
           <span class="icon is-large"><a href="https://twitter.com/onofriandreapg" class="mysocial"><i class="fab fa-twitter fa-3x"></i></a></span>&nbsp;&nbsp;
            <span class="icon is-large"><a href="https://www.r-project.org/" class="mysocial"><i class="fab fa-r-project fa-3x"></i></a></span>&nbsp;&nbsp;
 
<br>
<p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/">Copyright &copy; <a property="dct:title" rel="cc:attributionURL" href="https://www.statforbiology.com/aboutthis/">Fixing the bridge between biologists and statisticians</a> by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://www.statforbiology.com/about/">Andrea Onofri</a> is licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a> - Theme by <a href="https://jeffprod.com" class="mysocial">JeffProd.com</a></p>
            
</div>
</footer>

<script defer src="https://use.fontawesome.com/releases/v5.1.0/js/all.js"></script>
</body>
</html>
