<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Contrasts and multiple comparison testing | Experimental methods in agriculture</title>
  <meta name="description" content="Chapter 9 Contrasts and multiple comparison testing | Experimental methods in agriculture: a tutorial book with R" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Contrasts and multiple comparison testing | Experimental methods in agriculture" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="http://www.casaonofri.it/images/coversmall.png" />
  <meta property="og:description" content="Chapter 9 Contrasts and multiple comparison testing | Experimental methods in agriculture: a tutorial book with R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Contrasts and multiple comparison testing | Experimental methods in agriculture" />
  <meta name="twitter:site" content="@onofriandreapg" />
  <meta name="twitter:description" content="Chapter 9 Contrasts and multiple comparison testing | Experimental methods in agriculture: a tutorial book with R" />
  <meta name="twitter:image" content="http://www.casaonofri.it/images/coversmall.png" />

<meta name="author" content="Andrea Onofri and Dario Sacco" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="checking-for-the-basic-assumptions.html"/>
<link rel="next" href="multi-way-anova-models.html"/>
<script src="book_assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="book_assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="book_assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="book_assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131792052-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-131792052-1');
  </script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Experimental Methods</a></strong></li> 

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#aims"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-this-book-is-organised"><i class="fa fa-check"></i>How this book is organised</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#statistical-software"><i class="fa fa-check"></i>Statistical software</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-authors"><i class="fa fa-check"></i>The authors</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html"><i class="fa fa-check"></i><b>1</b> Science and pseudoscience</a>
<ul>
<li class="chapter" data-level="1.1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#science-needs-data"><i class="fa fa-check"></i><b>1.1</b> Science needs data</a></li>
<li class="chapter" data-level="1.2" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#not-all-data-support-science"><i class="fa fa-check"></i><b>1.2</b> Not all data support science</a></li>
<li class="chapter" data-level="1.3" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#good-data-is-based-on-good-methods"><i class="fa fa-check"></i><b>1.3</b> Good data is based on good ‘methods’</a></li>
<li class="chapter" data-level="1.4" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#the-falsification-principle"><i class="fa fa-check"></i><b>1.4</b> The ‘falsification’ principle</a></li>
<li class="chapter" data-level="1.5" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#trying-to-falsify-a-result"><i class="fa fa-check"></i><b>1.5</b> Trying to falsify a result</a></li>
<li class="chapter" data-level="1.6" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#the-basic-principles-of-experimental-design"><i class="fa fa-check"></i><b>1.6</b> The basic principles of experimental design</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#control"><i class="fa fa-check"></i><b>1.6.1</b> Control</a></li>
<li class="chapter" data-level="1.6.2" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#replication"><i class="fa fa-check"></i><b>1.6.2</b> Replication</a></li>
<li class="chapter" data-level="1.6.3" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#randomisation"><i class="fa fa-check"></i><b>1.6.3</b> Randomisation</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#invalid-experiments"><i class="fa fa-check"></i><b>1.7</b> Invalid experiments</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#lack-of-good-control"><i class="fa fa-check"></i><b>1.7.1</b> Lack of good control</a></li>
<li class="chapter" data-level="1.7.2" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#confounding-and-spurious-correlation"><i class="fa fa-check"></i><b>1.7.2</b> ‘Confounding’ and spurious correlation</a></li>
<li class="chapter" data-level="1.7.3" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#lack-of-true-replicates-or-careless-randomisation"><i class="fa fa-check"></i><b>1.7.3</b> Lack of true-replicates or careless randomisation</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#how-can-we-assess-whether-the-data-is-valid"><i class="fa fa-check"></i><b>1.8</b> How can we assess whether the data is valid?</a></li>
<li class="chapter" data-level="1.9" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#conclusions"><i class="fa fa-check"></i><b>1.9</b> Conclusions</a></li>
<li class="chapter" data-level="1.10" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#further-readings"><i class="fa fa-check"></i><b>1.10</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="designing-experiments.html"><a href="designing-experiments.html"><i class="fa fa-check"></i><b>2</b> Designing experiments</a>
<ul>
<li class="chapter" data-level="2.1" data-path="designing-experiments.html"><a href="designing-experiments.html#the-elements-of-research"><i class="fa fa-check"></i><b>2.1</b> The elements of research</a></li>
<li class="chapter" data-level="2.2" data-path="designing-experiments.html"><a href="designing-experiments.html#hypothesis-and-objectives"><i class="fa fa-check"></i><b>2.2</b> Hypothesis and objectives</a></li>
<li class="chapter" data-level="2.3" data-path="designing-experiments.html"><a href="designing-experiments.html#the-experimental-treatments"><i class="fa fa-check"></i><b>2.3</b> The experimental treatments</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="designing-experiments.html"><a href="designing-experiments.html#factorial-experiments"><i class="fa fa-check"></i><b>2.3.1</b> Factorial experiments</a></li>
<li class="chapter" data-level="2.3.2" data-path="designing-experiments.html"><a href="designing-experiments.html#the-control"><i class="fa fa-check"></i><b>2.3.2</b> The control</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="designing-experiments.html"><a href="designing-experiments.html#the-experimental-units"><i class="fa fa-check"></i><b>2.4</b> The experimental units</a></li>
<li class="chapter" data-level="2.5" data-path="designing-experiments.html"><a href="designing-experiments.html#the-allocation-of-treatments"><i class="fa fa-check"></i><b>2.5</b> The allocation of treatments</a></li>
<li class="chapter" data-level="2.6" data-path="designing-experiments.html"><a href="designing-experiments.html#the-variables"><i class="fa fa-check"></i><b>2.6</b> The variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="designing-experiments.html"><a href="designing-experiments.html#nominal-variables"><i class="fa fa-check"></i><b>2.6.1</b> Nominal variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="designing-experiments.html"><a href="designing-experiments.html#ordinal-variables"><i class="fa fa-check"></i><b>2.6.2</b> Ordinal variables</a></li>
<li class="chapter" data-level="2.6.3" data-path="designing-experiments.html"><a href="designing-experiments.html#count-and-ratio-variables"><i class="fa fa-check"></i><b>2.6.3</b> Count and ratio variables</a></li>
<li class="chapter" data-level="2.6.4" data-path="designing-experiments.html"><a href="designing-experiments.html#continuous-variables"><i class="fa fa-check"></i><b>2.6.4</b> Continuous variables</a></li>
<li class="chapter" data-level="2.6.5" data-path="designing-experiments.html"><a href="designing-experiments.html#sensory-and-visual-assessments"><i class="fa fa-check"></i><b>2.6.5</b> Sensory and visual assessments</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="designing-experiments.html"><a href="designing-experiments.html#setting-up-a-field-experiment"><i class="fa fa-check"></i><b>2.7</b> Setting up a field experiment</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="designing-experiments.html"><a href="designing-experiments.html#selecting-the-field"><i class="fa fa-check"></i><b>2.7.1</b> Selecting the field</a></li>
<li class="chapter" data-level="2.7.2" data-path="designing-experiments.html"><a href="designing-experiments.html#selecting-the-units-within-the-field"><i class="fa fa-check"></i><b>2.7.2</b> Selecting the units within the field</a></li>
<li class="chapter" data-level="2.7.3" data-path="designing-experiments.html"><a href="designing-experiments.html#number-of-replicates"><i class="fa fa-check"></i><b>2.7.3</b> Number of replicates</a></li>
<li class="chapter" data-level="2.7.4" data-path="designing-experiments.html"><a href="designing-experiments.html#the-field-map"><i class="fa fa-check"></i><b>2.7.4</b> The field map</a></li>
<li class="chapter" data-level="2.7.5" data-path="designing-experiments.html"><a href="designing-experiments.html#the-experimental-lay-out"><i class="fa fa-check"></i><b>2.7.5</b> The experimental lay-out</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="designing-experiments.html"><a href="designing-experiments.html#conclusions-1"><i class="fa fa-check"></i><b>2.8</b> Conclusions</a></li>
<li class="chapter" data-level="2.9" data-path="designing-experiments.html"><a href="designing-experiments.html#further-readings-1"><i class="fa fa-check"></i><b>2.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="describing-the-observations.html"><a href="describing-the-observations.html"><i class="fa fa-check"></i><b>3</b> Describing the observations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="describing-the-observations.html"><a href="describing-the-observations.html#quantitative-data"><i class="fa fa-check"></i><b>3.1</b> Quantitative data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="describing-the-observations.html"><a href="describing-the-observations.html#statistics-of-location"><i class="fa fa-check"></i><b>3.1.1</b> Statistics of location</a></li>
<li class="chapter" data-level="3.1.2" data-path="describing-the-observations.html"><a href="describing-the-observations.html#statistics-of-spread"><i class="fa fa-check"></i><b>3.1.2</b> Statistics of spread</a></li>
<li class="chapter" data-level="3.1.3" data-path="describing-the-observations.html"><a href="describing-the-observations.html#summing-the-uncertainty"><i class="fa fa-check"></i><b>3.1.3</b> Summing the uncertainty</a></li>
<li class="chapter" data-level="3.1.4" data-path="describing-the-observations.html"><a href="describing-the-observations.html#relationship-between-quantitative-variables"><i class="fa fa-check"></i><b>3.1.4</b> Relationship between quantitative variables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="describing-the-observations.html"><a href="describing-the-observations.html#nominal-data"><i class="fa fa-check"></i><b>3.2</b> Nominal data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="describing-the-observations.html"><a href="describing-the-observations.html#distributions-of-frequencies"><i class="fa fa-check"></i><b>3.2.1</b> Distributions of frequencies</a></li>
<li class="chapter" data-level="3.2.2" data-path="describing-the-observations.html"><a href="describing-the-observations.html#descriptive-stats-for-distributions-of-frequencies"><i class="fa fa-check"></i><b>3.2.2</b> Descriptive stats for distributions of frequencies</a></li>
<li class="chapter" data-level="3.2.3" data-path="describing-the-observations.html"><a href="describing-the-observations.html#contingency-tables"><i class="fa fa-check"></i><b>3.2.3</b> Contingency tables</a></li>
<li class="chapter" data-level="3.2.4" data-path="describing-the-observations.html"><a href="describing-the-observations.html#independence"><i class="fa fa-check"></i><b>3.2.4</b> Independence</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="describing-the-observations.html"><a href="describing-the-observations.html#descriptive-stats-with-r"><i class="fa fa-check"></i><b>3.3</b> Descriptive stats with R</a></li>
<li class="chapter" data-level="3.4" data-path="describing-the-observations.html"><a href="describing-the-observations.html#graphical-representations"><i class="fa fa-check"></i><b>3.4</b> Graphical representations</a></li>
<li class="chapter" data-level="3.5" data-path="describing-the-observations.html"><a href="describing-the-observations.html#further-reading"><i class="fa fa-check"></i><b>3.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html"><i class="fa fa-check"></i><b>4</b> Modeling the experimental data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#deterministic-models"><i class="fa fa-check"></i><b>4.1</b> Deterministic models</a></li>
<li class="chapter" data-level="4.2" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#stochastic-models"><i class="fa fa-check"></i><b>4.2</b> Stochastic models</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#probability-functions"><i class="fa fa-check"></i><b>4.2.1</b> Probability functions</a></li>
<li class="chapter" data-level="4.2.2" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#density-functions"><i class="fa fa-check"></i><b>4.2.2</b> Density functions</a></li>
<li class="chapter" data-level="4.2.3" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#the-gaussian-pdf-and-cdf"><i class="fa fa-check"></i><b>4.2.3</b> The Gaussian PDF and CDF</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#a-model-with-two-components"><i class="fa fa-check"></i><b>4.3</b> A model with two components</a></li>
<li class="chapter" data-level="4.4" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#and-so-what"><i class="fa fa-check"></i><b>4.4</b> And so what?</a></li>
<li class="chapter" data-level="4.5" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#monte-carlo-methods-to-simulate-an-experiment"><i class="fa fa-check"></i><b>4.5</b> Monte Carlo methods to simulate an experiment</a></li>
<li class="chapter" data-level="4.6" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#data-analysis-and-model-fitting"><i class="fa fa-check"></i><b>4.6</b> Data analysis and model fitting</a></li>
<li class="chapter" data-level="4.7" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#some-words-of-warning"><i class="fa fa-check"></i><b>4.7</b> Some words of warning</a></li>
<li class="chapter" data-level="4.8" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#further-readings-2"><i class="fa fa-check"></i><b>4.8</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html"><i class="fa fa-check"></i><b>5</b> Estimation of model parameters</a>
<ul>
<li class="chapter" data-level="5.1" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#example-1-a-concentration-value"><i class="fa fa-check"></i><b>5.1</b> Example 1: a concentration value</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#the-empirical-sampling-distribution"><i class="fa fa-check"></i><b>5.1.1</b> The empirical sampling distribution</a></li>
<li class="chapter" data-level="5.1.2" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#a-theoretical-sampling-distribution"><i class="fa fa-check"></i><b>5.1.2</b> A theoretical sampling distribution</a></li>
<li class="chapter" data-level="5.1.3" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#the-frequentist-confidence-interval"><i class="fa fa-check"></i><b>5.1.3</b> The frequentist confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#example-2-a-proportion"><i class="fa fa-check"></i><b>5.2</b> Example 2: a proportion</a></li>
<li class="chapter" data-level="5.3" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#conclusions-2"><i class="fa fa-check"></i><b>5.3</b> Conclusions</a></li>
<li class="chapter" data-level="5.4" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#further-readings-3"><i class="fa fa-check"></i><b>5.4</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html"><i class="fa fa-check"></i><b>6</b> Making Decisions under uncertainty</a>
<ul>
<li class="chapter" data-level="6.1" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#comparing-sample-means-the-students-t-test"><i class="fa fa-check"></i><b>6.1</b> Comparing sample means: the Student’s t-test</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#the-dataset"><i class="fa fa-check"></i><b>6.1.1</b> The dataset</a></li>
<li class="chapter" data-level="6.1.2" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#monte-carlo-simulation"><i class="fa fa-check"></i><b>6.1.2</b> Monte Carlo simulation</a></li>
<li class="chapter" data-level="6.1.3" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#a-formal-solution"><i class="fa fa-check"></i><b>6.1.3</b> A formal solution</a></li>
<li class="chapter" data-level="6.1.4" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#the-t-test-with-r"><i class="fa fa-check"></i><b>6.1.4</b> The t test with R</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#comparing-proportions-the-chi2-test"><i class="fa fa-check"></i><b>6.2</b> Comparing proportions: the <span class="math inline">\(\chi^2\)</span> test</a></li>
<li class="chapter" data-level="6.3" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#correct-interpretation-of-the-p-value"><i class="fa fa-check"></i><b>6.3</b> Correct interpretation of the P-value</a></li>
<li class="chapter" data-level="6.4" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#conclusions-3"><i class="fa fa-check"></i><b>6.4</b> Conclusions</a></li>
<li class="chapter" data-level="6.5" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#further-readings-4"><i class="fa fa-check"></i><b>6.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html"><i class="fa fa-check"></i><b>7</b> One-way ANOVA models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#comparing-herbicides-in-a-pot-experiment"><i class="fa fa-check"></i><b>7.1</b> Comparing herbicides in a pot-experiment</a></li>
<li class="chapter" data-level="7.2" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#data-description"><i class="fa fa-check"></i><b>7.2</b> Data description</a></li>
<li class="chapter" data-level="7.3" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#model-definition"><i class="fa fa-check"></i><b>7.3</b> Model definition</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#parameterisation"><i class="fa fa-check"></i><b>7.3.1</b> Parameterisation</a></li>
<li class="chapter" data-level="7.3.2" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#treatment-constraint"><i class="fa fa-check"></i><b>7.3.2</b> Treatment constraint</a></li>
<li class="chapter" data-level="7.3.3" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#sum-to-zero-constraint"><i class="fa fa-check"></i><b>7.3.3</b> Sum-to-zero constraint</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#basic-assumptions"><i class="fa fa-check"></i><b>7.4</b> Basic assumptions</a></li>
<li class="chapter" data-level="7.5" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#fitting-anova-models-by-hand"><i class="fa fa-check"></i><b>7.5</b> Fitting ANOVA models by hand</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#parameter-estimation"><i class="fa fa-check"></i><b>7.5.1</b> Parameter estimation</a></li>
<li class="chapter" data-level="7.5.2" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#residuals"><i class="fa fa-check"></i><b>7.5.2</b> Residuals</a></li>
<li class="chapter" data-level="7.5.3" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#standard-deviation-sigma"><i class="fa fa-check"></i><b>7.5.3</b> Standard deviation <span class="math inline">\(\sigma\)</span></a></li>
<li class="chapter" data-level="7.5.4" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#sem-and-sed"><i class="fa fa-check"></i><b>7.5.4</b> SEM and SED</a></li>
<li class="chapter" data-level="7.5.5" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#variance-partitioning"><i class="fa fa-check"></i><b>7.5.5</b> Variance partitioning</a></li>
<li class="chapter" data-level="7.5.6" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#hypothesis-testing"><i class="fa fa-check"></i><b>7.5.6</b> Hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#fitting-anova-models-with-r"><i class="fa fa-check"></i><b>7.6</b> Fitting ANOVA models with R</a></li>
<li class="chapter" data-level="7.7" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#expected-marginal-means"><i class="fa fa-check"></i><b>7.7</b> Expected marginal means</a></li>
<li class="chapter" data-level="7.8" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#conclusions-4"><i class="fa fa-check"></i><b>7.8</b> Conclusions</a></li>
<li class="chapter" data-level="7.9" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#further-readings-5"><i class="fa fa-check"></i><b>7.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html"><i class="fa fa-check"></i><b>8</b> Checking for the basic assumptions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#outlying-observations"><i class="fa fa-check"></i><b>8.1</b> Outlying observations</a></li>
<li class="chapter" data-level="8.2" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#the-inspection-of-residuals"><i class="fa fa-check"></i><b>8.2</b> The inspection of residuals</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#plot-of-residuals-against-expected-values"><i class="fa fa-check"></i><b>8.2.1</b> Plot of residuals against expected values</a></li>
<li class="chapter" data-level="8.2.2" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#qq-plot"><i class="fa fa-check"></i><b>8.2.2</b> QQ-plot</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#formal-hypotesis-testing"><i class="fa fa-check"></i><b>8.3</b> Formal hypotesis testing</a></li>
<li class="chapter" data-level="8.4" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#what-do-we-do-in-practice"><i class="fa fa-check"></i><b>8.4</b> What do we do, in practice?</a></li>
<li class="chapter" data-level="8.5" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#correcting-measures"><i class="fa fa-check"></i><b>8.5</b> Correcting measures</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#removing-outliers"><i class="fa fa-check"></i><b>8.5.1</b> Removing outliers</a></li>
<li class="chapter" data-level="8.5.2" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#stabilising-transformations"><i class="fa fa-check"></i><b>8.5.2</b> Stabilising transformations</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#examples-with-r"><i class="fa fa-check"></i><b>8.6</b> Examples with R</a></li>
<li class="chapter" data-level="8.7" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#example-1"><i class="fa fa-check"></i><b>8.7</b> Example 1</a></li>
<li class="chapter" data-level="8.8" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#example-2"><i class="fa fa-check"></i><b>8.8</b> Example 2</a></li>
<li class="chapter" data-level="8.9" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#other-possible-approaches"><i class="fa fa-check"></i><b>8.9</b> Other possible approaches</a></li>
<li class="chapter" data-level="8.10" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#further-readings-6"><i class="fa fa-check"></i><b>8.10</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html"><i class="fa fa-check"></i><b>9</b> Contrasts and multiple comparison testing</a>
<ul>
<li class="chapter" data-level="9.1" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#back-to-the-mixture-example"><i class="fa fa-check"></i><b>9.1</b> Back to the ‘mixture’ example</a></li>
<li class="chapter" data-level="9.2" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#linear-contrasts"><i class="fa fa-check"></i><b>9.2</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#the-variance-of-contrasts"><i class="fa fa-check"></i><b>9.2.1</b> The variance of contrasts</a></li>
<li class="chapter" data-level="9.2.2" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#testing-linear-contrasts-with-r"><i class="fa fa-check"></i><b>9.2.2</b> Testing linear contrasts with R</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#pairwise-comparisons"><i class="fa fa-check"></i><b>9.3</b> Pairwise comparisons</a></li>
<li class="chapter" data-level="9.4" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#letter-display"><i class="fa fa-check"></i><b>9.4</b> Letter display</a></li>
<li class="chapter" data-level="9.5" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#multiplicity-correction"><i class="fa fa-check"></i><b>9.5</b> Multiplicity correction</a></li>
<li class="chapter" data-level="9.6" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#multiple-comparisons-with-transformed-data"><i class="fa fa-check"></i><b>9.6</b> Multiple comparisons with transformed data</a></li>
<li class="chapter" data-level="9.7" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#what-about-the-traditional-mcps"><i class="fa fa-check"></i><b>9.7</b> What about the traditional MCPs?</a></li>
<li class="chapter" data-level="9.8" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#some-practical-suggestions"><i class="fa fa-check"></i><b>9.8</b> Some practical suggestions</a></li>
<li class="chapter" data-level="9.9" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#further-readings-7"><i class="fa fa-check"></i><b>9.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html"><i class="fa fa-check"></i><b>10</b> Multi-way ANOVA models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#motivating-example-a-genotype-experiment-in-blocks"><i class="fa fa-check"></i><b>10.1</b> Motivating example: a genotype experiment in blocks</a></li>
<li class="chapter" data-level="10.2" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-definition-1"><i class="fa fa-check"></i><b>10.2</b> Model definition</a></li>
<li class="chapter" data-level="10.3" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-fitting-by-hand"><i class="fa fa-check"></i><b>10.3</b> Model fitting by hand</a></li>
<li class="chapter" data-level="10.4" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-fitting-with-r"><i class="fa fa-check"></i><b>10.4</b> Model fitting with R</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-checking"><i class="fa fa-check"></i><b>10.4.1</b> Model checking</a></li>
<li class="chapter" data-level="10.4.2" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#variance-partitioning-1"><i class="fa fa-check"></i><b>10.4.2</b> Variance partitioning</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#another-example-comparing-working-protocols"><i class="fa fa-check"></i><b>10.5</b> Another example: comparing working protocols</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html"><i class="fa fa-check"></i><b>11</b> Multi-way ANOVA models with interactions</a>
<ul>
<li class="chapter" data-level="11.1" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#the-interaction-concept"><i class="fa fa-check"></i><b>11.1</b> The ‘interaction’ concept</a></li>
<li class="chapter" data-level="11.2" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#genotype-by-n-interactions"><i class="fa fa-check"></i><b>11.2</b> Genotype by N interactions</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-definition-2"><i class="fa fa-check"></i><b>11.2.1</b> Model definition</a></li>
<li class="chapter" data-level="11.2.2" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-fitting-by-hand-1"><i class="fa fa-check"></i><b>11.2.2</b> Model fitting by hand</a></li>
<li class="chapter" data-level="11.2.3" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-fitting-with-r-1"><i class="fa fa-check"></i><b>11.2.3</b> Model fitting with R</a></li>
<li class="chapter" data-level="11.2.4" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#inferences-and-standard-errors"><i class="fa fa-check"></i><b>11.2.4</b> Inferences and standard errors</a></li>
<li class="chapter" data-level="11.2.5" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#expected-marginal-means-1"><i class="fa fa-check"></i><b>11.2.5</b> Expected marginal means</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#nested-effects-maize-crosses"><i class="fa fa-check"></i><b>11.3</b> Nested effects: maize crosses</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-definition-3"><i class="fa fa-check"></i><b>11.3.1</b> Model definition</a></li>
<li class="chapter" data-level="11.3.2" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#parameter-estimation-1"><i class="fa fa-check"></i><b>11.3.2</b> Parameter estimation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#further-readings-8"><i class="fa fa-check"></i><b>11.4</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>12</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#case-study-n-fertilisation-in-wheat"><i class="fa fa-check"></i><b>12.1</b> Case-study: N fertilisation in wheat</a></li>
<li class="chapter" data-level="12.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#preliminary-analysis"><i class="fa fa-check"></i><b>12.2</b> Preliminary analysis</a></li>
<li class="chapter" data-level="12.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#definition-of-a-linear-model"><i class="fa fa-check"></i><b>12.3</b> Definition of a linear model</a></li>
<li class="chapter" data-level="12.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#parameter-estimation-2"><i class="fa fa-check"></i><b>12.4</b> Parameter estimation</a></li>
<li class="chapter" data-level="12.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#goodness-of-fit"><i class="fa fa-check"></i><b>12.5</b> Goodness of fit</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#graphical-evaluation"><i class="fa fa-check"></i><b>12.5.1</b> Graphical evaluation</a></li>
<li class="chapter" data-level="12.5.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#standard-errors-for-parameter-estimates"><i class="fa fa-check"></i><b>12.5.2</b> Standard errors for parameter estimates</a></li>
<li class="chapter" data-level="12.5.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#f-test-for-lack-of-fit"><i class="fa fa-check"></i><b>12.5.3</b> F test for lack of fit</a></li>
<li class="chapter" data-level="12.5.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#f-test-for-goodness-of-fit-and-coefficient-of-determination"><i class="fa fa-check"></i><b>12.5.4</b> F test for goodness of fit and coefficient of determination</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#making-predictions"><i class="fa fa-check"></i><b>12.6</b> Making predictions</a></li>
<li class="chapter" data-level="12.7" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#further-readings-9"><i class="fa fa-check"></i><b>12.7</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html"><i class="fa fa-check"></i><b>13</b> A brief intro to mixed models</a>
<ul>
<li class="chapter" data-level="13.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#split-plot-or-strip-plot-experiments"><i class="fa fa-check"></i><b>13.1</b> Split-plot or strip-plot experiments</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-1-a-split-plot-experiment"><i class="fa fa-check"></i><b>13.1.1</b> Example 1: a split-plot experiment</a></li>
<li class="chapter" data-level="13.1.2" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-2-a-strip-plot-design"><i class="fa fa-check"></i><b>13.1.2</b> Example 2: a strip-plot design</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#sub-sampling-designs"><i class="fa fa-check"></i><b>13.2</b> Sub-sampling designs</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-3-a-rcbd-with-sub-sampling"><i class="fa fa-check"></i><b>13.2.1</b> Example 3: A RCBD with sub-sampling</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#repeated-experiments"><i class="fa fa-check"></i><b>13.3</b> Repeated experiments</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#a-model-for-pooling-the-results"><i class="fa fa-check"></i><b>13.3.1</b> A model for pooling the results</a></li>
<li class="chapter" data-level="13.3.2" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#preliminary-analyses"><i class="fa fa-check"></i><b>13.3.2</b> Preliminary analyses</a></li>
<li class="chapter" data-level="13.3.3" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#fixed-or-random-runs"><i class="fa fa-check"></i><b>13.3.3</b> Fixed or random runs?</a></li>
<li class="chapter" data-level="13.3.4" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-4-a-seed-germination-experiment-in-two-runs"><i class="fa fa-check"></i><b>13.3.4</b> Example 4: a seed germination experiment in two runs</a></li>
<li class="chapter" data-level="13.3.5" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-5-a-multi-year-winter-wheat-experiment"><i class="fa fa-check"></i><b>13.3.5</b> Example 5: a multi-year winter wheat experiment</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#repeated-measures-in-perennial-crops"><i class="fa fa-check"></i><b>13.4</b> Repeated measures in perennial crops</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-5-genotype-experiment-with-lucerne"><i class="fa fa-check"></i><b>13.4.1</b> Example 5: genotype experiment with lucerne</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#further-readings-10"><i class="fa fa-check"></i><b>13.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>14</b> Nonlinear regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#case-study-a-degradation-curve"><i class="fa fa-check"></i><b>14.1</b> Case-study: a degradation curve</a></li>
<li class="chapter" data-level="14.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#model-selection"><i class="fa fa-check"></i><b>14.2</b> Model selection</a></li>
<li class="chapter" data-level="14.3" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#parameter-estimation-3"><i class="fa fa-check"></i><b>14.3</b> Parameter estimation</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#linearisation"><i class="fa fa-check"></i><b>14.3.1</b> Linearisation</a></li>
<li class="chapter" data-level="14.3.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#approximation-with-a-polynomial-function"><i class="fa fa-check"></i><b>14.3.2</b> Approximation with a polynomial function</a></li>
<li class="chapter" data-level="14.3.3" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#nonlinear-least-squares"><i class="fa fa-check"></i><b>14.3.3</b> Nonlinear least squares</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#nonlinear-regression-with-r"><i class="fa fa-check"></i><b>14.4</b> Nonlinear regression with R</a></li>
<li class="chapter" data-level="14.5" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#checking-the-model"><i class="fa fa-check"></i><b>14.5</b> Checking the model</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#graphical-analyses-of-residuals"><i class="fa fa-check"></i><b>14.5.1</b> Graphical analyses of residuals</a></li>
<li class="chapter" data-level="14.5.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#approximate-f-test-for-lack-of-fit"><i class="fa fa-check"></i><b>14.5.2</b> Approximate F test for lack of fit</a></li>
<li class="chapter" data-level="14.5.3" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#the-coefficient-of-determination-r2"><i class="fa fa-check"></i><b>14.5.3</b> The coefficient of determination (R<sup>2</sup>)</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#stabilising-transformations-1"><i class="fa fa-check"></i><b>14.6</b> Stabilising transformations</a></li>
<li class="chapter" data-level="14.7" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#making-predictions-1"><i class="fa fa-check"></i><b>14.7</b> Making predictions</a></li>
<li class="chapter" data-level="14.8" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#further-readings-11"><i class="fa fa-check"></i><b>14.8</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>15</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.1" data-path="exercises.html"><a href="exercises.html#designing-experiments-ch.-1-to-2"><i class="fa fa-check"></i><b>15.1</b> Designing experiments (ch. 1 to 2)</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="exercises.html"><a href="exercises.html#exercise-1"><i class="fa fa-check"></i><b>15.1.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.1.2" data-path="exercises.html"><a href="exercises.html#exercise-2"><i class="fa fa-check"></i><b>15.1.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.1.3" data-path="exercises.html"><a href="exercises.html#exercise-3"><i class="fa fa-check"></i><b>15.1.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="exercises.html"><a href="exercises.html#describing-the-observations-ch.-3"><i class="fa fa-check"></i><b>15.2</b> Describing the observations (ch. 3)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="exercises.html"><a href="exercises.html#exercise-1-1"><i class="fa fa-check"></i><b>15.2.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.2.2" data-path="exercises.html"><a href="exercises.html#exercise-2-1"><i class="fa fa-check"></i><b>15.2.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.2.3" data-path="exercises.html"><a href="exercises.html#exercise-3-1"><i class="fa fa-check"></i><b>15.2.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="exercises.html"><a href="exercises.html#modeling-the-experimental-data-ch.-4"><i class="fa fa-check"></i><b>15.3</b> Modeling the experimental data (ch. 4)</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="exercises.html"><a href="exercises.html#exercise-1-2"><i class="fa fa-check"></i><b>15.3.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.3.2" data-path="exercises.html"><a href="exercises.html#exercise-2-2"><i class="fa fa-check"></i><b>15.3.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.3.3" data-path="exercises.html"><a href="exercises.html#exercise-3-2"><i class="fa fa-check"></i><b>15.3.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.3.4" data-path="exercises.html"><a href="exercises.html#exercise-4"><i class="fa fa-check"></i><b>15.3.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.3.5" data-path="exercises.html"><a href="exercises.html#exercise-5"><i class="fa fa-check"></i><b>15.3.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.3.6" data-path="exercises.html"><a href="exercises.html#exercise-6"><i class="fa fa-check"></i><b>15.3.6</b> Exercise 6</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="exercises.html"><a href="exercises.html#interval-estimation-of-model-parameters-ch.-5"><i class="fa fa-check"></i><b>15.4</b> Interval estimation of model parameters (ch. 5)</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="exercises.html"><a href="exercises.html#exercise-1-3"><i class="fa fa-check"></i><b>15.4.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.4.2" data-path="exercises.html"><a href="exercises.html#exercise-2-3"><i class="fa fa-check"></i><b>15.4.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.4.3" data-path="exercises.html"><a href="exercises.html#exercise-3-3"><i class="fa fa-check"></i><b>15.4.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.4.4" data-path="exercises.html"><a href="exercises.html#exercise-4-1"><i class="fa fa-check"></i><b>15.4.4</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="exercises.html"><a href="exercises.html#making-decisions-under-uncertainty-ch.-6"><i class="fa fa-check"></i><b>15.5</b> Making decisions under uncertainty (ch. 6)</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="exercises.html"><a href="exercises.html#exercise-1-4"><i class="fa fa-check"></i><b>15.5.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.5.2" data-path="exercises.html"><a href="exercises.html#exercise-2-4"><i class="fa fa-check"></i><b>15.5.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.5.3" data-path="exercises.html"><a href="exercises.html#exercise-3-4"><i class="fa fa-check"></i><b>15.5.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.5.4" data-path="exercises.html"><a href="exercises.html#exercise-4-2"><i class="fa fa-check"></i><b>15.5.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.5.5" data-path="exercises.html"><a href="exercises.html#exercise-5-1"><i class="fa fa-check"></i><b>15.5.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.5.6" data-path="exercises.html"><a href="exercises.html#exercise-6-1"><i class="fa fa-check"></i><b>15.5.6</b> Exercise 6</a></li>
<li class="chapter" data-level="15.5.7" data-path="exercises.html"><a href="exercises.html#exercise-7"><i class="fa fa-check"></i><b>15.5.7</b> Exercise 7</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="exercises.html"><a href="exercises.html#fitting-models-to-data-from-agriculture-experiments"><i class="fa fa-check"></i><b>15.6</b> Fitting models to data from agriculture experiments</a></li>
<li class="chapter" data-level="15.7" data-path="exercises.html"><a href="exercises.html#one-way-anova-models-ch.-7-to-9"><i class="fa fa-check"></i><b>15.7</b> One-way ANOVA models (ch. 7 to 9)</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="exercises.html"><a href="exercises.html#exercise-1-5"><i class="fa fa-check"></i><b>15.7.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.7.2" data-path="exercises.html"><a href="exercises.html#exercise-2-5"><i class="fa fa-check"></i><b>15.7.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.7.3" data-path="exercises.html"><a href="exercises.html#exercise-3-5"><i class="fa fa-check"></i><b>15.7.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.7.4" data-path="exercises.html"><a href="exercises.html#exercise-4-3"><i class="fa fa-check"></i><b>15.7.4</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="exercises.html"><a href="exercises.html#multi-way-anova-models-ch.-10"><i class="fa fa-check"></i><b>15.8</b> Multi-way ANOVA models (ch. 10)</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="exercises.html"><a href="exercises.html#exercise-1-6"><i class="fa fa-check"></i><b>15.8.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.8.2" data-path="exercises.html"><a href="exercises.html#exercise-2-6"><i class="fa fa-check"></i><b>15.8.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.8.3" data-path="exercises.html"><a href="exercises.html#exercise-3-6"><i class="fa fa-check"></i><b>15.8.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="15.9" data-path="exercises.html"><a href="exercises.html#multi-way-anova-models-with-interactions-ch.-11-and-13"><i class="fa fa-check"></i><b>15.9</b> Multi-way ANOVA models with interactions (ch. 11 and 13)</a>
<ul>
<li class="chapter" data-level="15.9.1" data-path="exercises.html"><a href="exercises.html#exercise-1-7"><i class="fa fa-check"></i><b>15.9.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.9.2" data-path="exercises.html"><a href="exercises.html#exercise-2-7"><i class="fa fa-check"></i><b>15.9.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.9.3" data-path="exercises.html"><a href="exercises.html#exercise-3-7"><i class="fa fa-check"></i><b>15.9.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.9.4" data-path="exercises.html"><a href="exercises.html#exercise-4-4"><i class="fa fa-check"></i><b>15.9.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.9.5" data-path="exercises.html"><a href="exercises.html#exercise-5-2"><i class="fa fa-check"></i><b>15.9.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.9.6" data-path="exercises.html"><a href="exercises.html#exercise-6-2"><i class="fa fa-check"></i><b>15.9.6</b> Exercise 6</a></li>
</ul></li>
<li class="chapter" data-level="15.10" data-path="exercises.html"><a href="exercises.html#simple-linear-regression-ch.-12"><i class="fa fa-check"></i><b>15.10</b> Simple linear regression (ch. 12)</a>
<ul>
<li class="chapter" data-level="15.10.1" data-path="exercises.html"><a href="exercises.html#exercise-1-8"><i class="fa fa-check"></i><b>15.10.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.10.2" data-path="exercises.html"><a href="exercises.html#exercise-2-8"><i class="fa fa-check"></i><b>15.10.2</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="15.11" data-path="exercises.html"><a href="exercises.html#nonlinear-regression-ch.-14"><i class="fa fa-check"></i><b>15.11</b> Nonlinear regression (ch. 14)</a>
<ul>
<li class="chapter" data-level="15.11.1" data-path="exercises.html"><a href="exercises.html#exercise-1-9"><i class="fa fa-check"></i><b>15.11.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.11.2" data-path="exercises.html"><a href="exercises.html#exercise-2-9"><i class="fa fa-check"></i><b>15.11.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.11.3" data-path="exercises.html"><a href="exercises.html#exercise-3-8"><i class="fa fa-check"></i><b>15.11.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.11.4" data-path="exercises.html"><a href="exercises.html#exercise-4-5"><i class="fa fa-check"></i><b>15.11.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.11.5" data-path="exercises.html"><a href="exercises.html#exercise-5-3"><i class="fa fa-check"></i><b>15.11.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.11.6" data-path="exercises.html"><a href="exercises.html#exercise-6-3"><i class="fa fa-check"></i><b>15.11.6</b> Exercise 6</a></li>
<li class="chapter" data-level="15.11.7" data-path="exercises.html"><a href="exercises.html#exercise-7-1"><i class="fa fa-check"></i><b>15.11.7</b> Exercise 7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html"><i class="fa fa-check"></i><b>16</b> APPENDIX: A very gentle introduction to R</a>
<ul>
<li class="chapter" data-level="16.1" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#what-is-r"><i class="fa fa-check"></i><b>16.1</b> What is R?</a></li>
<li class="chapter" data-level="16.2" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#installing-r-and-moving-the-first-steps"><i class="fa fa-check"></i><b>16.2</b> Installing R and moving the first steps</a></li>
<li class="chapter" data-level="16.3" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#assignments"><i class="fa fa-check"></i><b>16.3</b> Assignments</a></li>
<li class="chapter" data-level="16.4" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#data-types-and-data-objects"><i class="fa fa-check"></i><b>16.4</b> Data types and data objects</a></li>
<li class="chapter" data-level="16.5" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#matrices"><i class="fa fa-check"></i><b>16.5</b> Matrices</a></li>
<li class="chapter" data-level="16.6" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#dataframes"><i class="fa fa-check"></i><b>16.6</b> Dataframes</a></li>
<li class="chapter" data-level="16.7" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#working-with-objects"><i class="fa fa-check"></i><b>16.7</b> Working with objects</a></li>
<li class="chapter" data-level="16.8" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#expressions-functions-and-arguments"><i class="fa fa-check"></i><b>16.8</b> Expressions, functions and arguments</a></li>
<li class="chapter" data-level="16.9" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#a-few-useful-functions"><i class="fa fa-check"></i><b>16.9</b> A few useful functions</a></li>
<li class="chapter" data-level="16.10" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#extractors"><i class="fa fa-check"></i><b>16.10</b> Extractors</a></li>
<li class="chapter" data-level="16.11" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#reading-external-data"><i class="fa fa-check"></i><b>16.11</b> Reading external data</a></li>
<li class="chapter" data-level="16.12" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#simple-r-graphics"><i class="fa fa-check"></i><b>16.12</b> Simple R graphics</a></li>
<li class="chapter" data-level="16.13" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#further-readings-12"><i class="fa fa-check"></i><b>16.13</b> Further readings</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Experimental methods in agriculture</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="contrasts-and-multiple-comparison-testing" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Contrasts and multiple comparison testing<a href="contrasts-and-multiple-comparison-testing.html#contrasts-and-multiple-comparison-testing" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>All we know about the world teaches us that the effects of A and B are always different in some decimal place for any A and B. Thus asking “are the effects different?” is foolish (John Tukey)</em></p>
<p>In Chapter 7 we have shown how to fit an ANOVA model to the observed data, which is very often the first step of data analysis, with two fundamental aims:</p>
<ol style="list-style-type: decimal">
<li>determining the variance of the residual (unexplained) effects, that is the basis of statistical inference;</li>
<li>test the hypothesis of no treatment effects (test of homogeneity), by using the F-ratio.</li>
</ol>
<p>In Chapter 8, we sow that, before trusting the results of every linear model fit, we need to make sure that the basic assumptions for linear models are valid, by a thorough inspection of residuals. This is a fundamental step and should never, ever be neglected.</p>
<p>After the inspection of model residuals and after the adoption of possible correcting measures, wherever necessary, the process of data analysis must go ahead. Indeed, rejecting the null hypothesis of no treatment effects implies accepting the alternative, i.e. that there is, at least, one treatment level that produced a significant effect on the experimental units. Such conclusion is important, but it very rarely answers all our research questions; indeed, taking whatever pair of treatments A and B, we might ask:</p>
<ol style="list-style-type: decimal">
<li>is the effect of A different from the effect of B?</li>
<li>is A better/worse than B?</li>
<li>what is the difference between A and B?</li>
</ol>
<p>In other words, for any pairs of treatments, we might be willing to assess the existence of significant differences (question 1), their sign (positive/negative; question 2) and their size (<strong>effect size</strong>; question 3). According to the English scientist John Tukey, the first question is ‘foolish’ as there are no two treatments whose effects can be regarded as totally equal (see the beginning of this Chapter), while the other two questions, particularly the third one, are much more relevant.</p>
<p>In order to ask the above questions, we can apply <strong>linear contrasts</strong> or <strong>Multiple Comparison Procedures</strong> (MCP). We will explore these methods by using the ‘mixture.csv’ dataset, which we have started analysing in Chapters 7 and 8.</p>
<div id="back-to-the-mixture-example" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Back to the ‘mixture’ example<a href="contrasts-and-multiple-comparison-testing.html#back-to-the-mixture-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let me remind once more that we are dealing with a pot experiment, where we compared four herbicide treatments in terms of their activity against an important weed species (<em>Solanum nigrum</em>). The experiment is completely randomised, with four replicates and the observed response is the weight of treated plants in each pot, four weeks after the treatment. One of the four treatments is the untreated control, while the other three treatments consist of two herbicides used either alone or in mixture.</p>
<p>Let’s load the data, fit an ANOVA model and get the least squares means, as we did in Chapter 7. In Chapter 8, we have demonstrated that this model is valid and there are no evident deviations from the basic assumptions for linear models.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="contrasts-and-multiple-comparison-testing.html#cb95-1" aria-hidden="true" tabindex="-1"></a>repo <span class="ot">&lt;-</span> <span class="st">&quot;https://www.casaonofri.it/_datasets/&quot;</span></span>
<span id="cb95-2"><a href="contrasts-and-multiple-comparison-testing.html#cb95-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">&quot;mixture.csv&quot;</span></span>
<span id="cb95-3"><a href="contrasts-and-multiple-comparison-testing.html#cb95-3" aria-hidden="true" tabindex="-1"></a>pathData <span class="ot">&lt;-</span> <span class="fu">paste</span>(repo, file, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb95-4"><a href="contrasts-and-multiple-comparison-testing.html#cb95-4" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(pathData, <span class="at">header =</span> T)</span>
<span id="cb95-5"><a href="contrasts-and-multiple-comparison-testing.html#cb95-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Weight <span class="sc">~</span> Treat, <span class="at">data=</span>dataset)</span>
<span id="cb95-6"><a href="contrasts-and-multiple-comparison-testing.html#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="contrasts-and-multiple-comparison-testing.html#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb95-8"><a href="contrasts-and-multiple-comparison-testing.html#cb95-8" aria-hidden="true" tabindex="-1"></a>treat.means <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span>Treat)</span>
<span id="cb95-9"><a href="contrasts-and-multiple-comparison-testing.html#cb95-9" aria-hidden="true" tabindex="-1"></a>treat.means</span>
<span id="cb95-10"><a href="contrasts-and-multiple-comparison-testing.html#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  Treat           emmean   SE df lower.CL upper.CL</span></span>
<span id="cb95-11"><a href="contrasts-and-multiple-comparison-testing.html#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348   9.18 1.96 12     4.91     13.4</span></span>
<span id="cb95-12"><a href="contrasts-and-multiple-comparison-testing.html#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378       5.13 1.96 12     0.86      9.4</span></span>
<span id="cb95-13"><a href="contrasts-and-multiple-comparison-testing.html#cb95-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30   16.86 1.96 12    12.59     21.1</span></span>
<span id="cb95-14"><a href="contrasts-and-multiple-comparison-testing.html#cb95-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  Unweeded         26.77 1.96 12    22.50     31.0</span></span>
<span id="cb95-15"><a href="contrasts-and-multiple-comparison-testing.html#cb95-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb95-16"><a href="contrasts-and-multiple-comparison-testing.html#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95</span></span></code></pre></div>
</div>
<div id="linear-contrasts" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Linear contrasts<a href="contrasts-and-multiple-comparison-testing.html#linear-contrasts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In statistics, a <strong>contrast</strong> is a linear combination of means or, more generally, model parameters, where the coefficients add up to zero. In the following example, I have built a linear contrast with the means of our example:</p>
<p><span class="math display">\[k = \frac{1}{3} \cdot 9.18 + \frac{1}{3} \cdot 5.13 + \frac{1}{3} \cdot 16.86 - 1 \cdot 26.77  = -16.385\]</span></p>
<p>As we see, the sum of coefficients is 0:</p>
<p><span class="math display">\[\frac{1}{3} + \frac{1}{3} + \frac{1}{3} - 1 = 0\]</span></p>
<p>This contrast has a very clear biological meaning, as it provides an estimate for the difference between the mean weight for treated pots and the mean weight for untreated pots. The result is -16.39; it provides the answers for all the three questions above. Indeed:</p>
<ol style="list-style-type: decimal">
<li>there is a difference between herbicide treatments (on average) and the untreated control;</li>
<li>the difference is negative, meaning that the weight of the weed in treated pots is lower than the weight in untreated pots;</li>
<li>the effect size is -16.39 grams per pot.</li>
</ol>
<p>However, we should never forget that the uncertainty about population means propagates to contrasts. The observed value of -16.39 is a point estimator of the population difference, but we need to quantify the uncertainty by using interval estimation.</p>
<div id="the-variance-of-contrasts" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> The variance of contrasts<a href="contrasts-and-multiple-comparison-testing.html#the-variance-of-contrasts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have already mentioned how the errors propagate when we ‘combine’ random variables; the basic principle is that the variance of a linear combination of independent estimates is equal to a linear combination of their variances, according to:</p>
<p><span class="math display">\[\textrm{var}(A \mu_1 + B \mu_2) = A ^2 \cdot \textrm{var}(\mu_1)  + B ^2 \cdot \textrm{var}(\mu_2)\]</span></p>
<p>where A and B are contrast coefficients, <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span> are the estimates (means, in this case). The standard errors of the four means are equal to 1.9588 and, therefore, the variances are <span class="math inline">\(1.9588^2 = 3.83703\)</span>, which are combined as shown below:</p>
<p><span class="math display">\[\textrm{var}(k) = \left( \frac{1}{3} \right)^2 \cdot 3.83703  +  \left( \frac{1}{3}\right)^2 \cdot 3.83703 + \left( \frac{1}{3}  \right)^2 \cdot 3.83703 + \left( - 1 \right)^2 \cdot 3.83703  = 5.11604\]</span></p>
<p>The standard deviation for the contrast (i.e. the standard error) is:</p>
<p><span class="math display">\[SE(k) = \sqrt{5.11604} = 2.261866\]</span></p>
<p>Here we go. We have a point estimate for the contrast (-16.4) and a standard error (2.26), which we can use to build a confidence interval, as shown in Chapter 5. However, we might also like to answer the following question: is it possible that the population contrast is 0 (no difference between treated and untreated pots) and the observed value was just due to random sampling fluctuations?</p>
<p>Of course, this is possible: we have already seen that sample-to-sample variation can be rather high. We can translate our question into a null hypothesis:</p>
<p><span class="math display">\[H_0: \kappa = 0\]</span></p>
<p>we use the greek letter <span class="math inline">\(\kappa\)</span> to refer to the real population value for the contrast, which we estimate by using the observed value <span class="math inline">\(k\)</span>. In order to decide whether the null is true, in spite of the observed <span class="math inline">\(k \neq 0\)</span>, we should contemporarily consider the estimate and its uncertainty. As we did in a previous chapter, we use the T statistics, i.e. the ratio between the estimate and its standard error:</p>
<p><span class="math display">\[T = \frac{k}{ES(k)} = \frac{-16.385}{2.261866} = -7.244\]</span>
Let’s assume that the null is true; the observed T values should ‘fluctuate’ around 0, by following a Student’s t distribution with a number of degrees of freedom equal to that of the residual error in ANOVA. We could empirically see this by using Monte Carlo simulation, but we will not do so, for the sake of brevity.</p>
<p>Therefore, we can use the <code>pt()</code> function to find the probability that <span class="math inline">\(t &lt; -7.244\)</span> and <span class="math inline">\(t &gt; 7.244\)</span>. We have:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="contrasts-and-multiple-comparison-testing.html#cb96-1" aria-hidden="true" tabindex="-1"></a>Tval <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">16.385</span> <span class="sc">/</span> <span class="fl">2.261866</span></span>
<span id="cb96-2"><a href="contrasts-and-multiple-comparison-testing.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(Tval, <span class="dv">12</span>, <span class="at">lower.tail =</span> T)</span>
<span id="cb96-3"><a href="contrasts-and-multiple-comparison-testing.html#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.023001e-05</span></span></code></pre></div>
<p>We see that, if the null is true and we repeat the experiment for a high number of times, we have only one possibility out of 100,000 to obtain such a high T, in absolute value. Thus we reject the null and conclude that:</p>
<ol style="list-style-type: decimal">
<li>on average, herbicide treatments produce a significant effect;</li>
<li>such an effects results in the suppression of weed growth (the sign is negative);</li>
<li>the difference in weight is -16.385 (SE = 2.26) and the evidence is strong enough to support the conclusion that such a difference, at the population level, is not 0.</li>
</ol>
</div>
<div id="testing-linear-contrasts-with-r" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Testing linear contrasts with R<a href="contrasts-and-multiple-comparison-testing.html#testing-linear-contrasts-with-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The main challenge for a scientist is to translate research questions into a set of appropriate contrasts. For our example, we might consider the following contrasts:</p>
<ol style="list-style-type: decimal">
<li>untreated vs. treated (on average)</li>
<li>mixture vs. single herbicides (on average)</li>
<li>mixture vs. rimsulfuron</li>
<li>mixture vs. metribuzin</li>
</ol>
<p>Writing the above contrasts by hand is very tedious and, thus, we use R. First of all, we need to prepare one vector of coefficients for each contrast. For the first contrast, the vector is as above:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="contrasts-and-multiple-comparison-testing.html#cb97-1" aria-hidden="true" tabindex="-1"></a>k1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<p>For the other three contrasts, the vectors are:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="contrasts-and-multiple-comparison-testing.html#cb98-1" aria-hidden="true" tabindex="-1"></a>k2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb98-2"><a href="contrasts-and-multiple-comparison-testing.html#cb98-2" aria-hidden="true" tabindex="-1"></a>k3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb98-3"><a href="contrasts-and-multiple-comparison-testing.html#cb98-3" aria-hidden="true" tabindex="-1"></a>k4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p>With these coefficients, we prepare a list:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="contrasts-and-multiple-comparison-testing.html#cb99-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">list</span>(k1, k2, k3, k4)</span></code></pre></div>
<p>In the end, we use the <code>contrast()</code> function in the ‘emmeans’ package and pass the following arguments:</p>
<ol style="list-style-type: decimal">
<li>the means, obtained by using the ‘emmeans()’ function (see above)</li>
<li>the list of contrasts, as the ‘method’ argument</li>
<li>the type of adjustment (we will talk about this later, so far, please, simply use the command as shown in the box below)</li>
</ol>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="contrasts-and-multiple-comparison-testing.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(treat.means, <span class="at">method =</span> K, <span class="at">adjust=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb100-2"><a href="contrasts-and-multiple-comparison-testing.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast                                                     </span></span>
<span id="cb100-3"><a href="contrasts-and-multiple-comparison-testing.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  c(0.333333333333333, 0.333333333333333, 0.333333333333333, -1</span></span>
<span id="cb100-4"><a href="contrasts-and-multiple-comparison-testing.html#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  c(0.5, -1, 0.5, 0)                                           </span></span>
<span id="cb100-5"><a href="contrasts-and-multiple-comparison-testing.html#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  c(0, -1, 1, 0)                                               </span></span>
<span id="cb100-6"><a href="contrasts-and-multiple-comparison-testing.html#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  c(1, -1, 0, 0)                                               </span></span>
<span id="cb100-7"><a href="contrasts-and-multiple-comparison-testing.html#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  estimate   SE df t.ratio p.value</span></span>
<span id="cb100-8"><a href="contrasts-and-multiple-comparison-testing.html#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="do">##    -16.39 2.26 12  -7.244  &lt;.0001</span></span>
<span id="cb100-9"><a href="contrasts-and-multiple-comparison-testing.html#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="do">##      7.89 2.40 12   3.289  0.0065</span></span>
<span id="cb100-10"><a href="contrasts-and-multiple-comparison-testing.html#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="do">##     11.73 2.77 12   4.235  0.0012</span></span>
<span id="cb100-11"><a href="contrasts-and-multiple-comparison-testing.html#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="do">##      4.05 2.77 12   1.461  0.1697</span></span></code></pre></div>
<p>We see that all contrasts are significantly different from zero, except the fourth one.</p>
</div>
</div>
<div id="pairwise-comparisons" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Pairwise comparisons<a href="contrasts-and-multiple-comparison-testing.html#pairwise-comparisons" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Translating research questions into contrasts may be sort of an art and, very often, it marks the difference between ordinary and excellent papers. However, there are some sets of contrasts that are repeatedly used (and often abused) in several circumstances, such as the so-called <em>pairwise comparisons</em>. These contrasts consist of testing the differences between pairs of means, according to two possible situations:</p>
<ol style="list-style-type: decimal">
<li>all pairwise-comparisons (Tukey’s method)</li>
<li>comparisons with a control (Dunnett’s method)</li>
</ol>
<p>The first situation implies a very high number of contrasts that is equal to <span class="math inline">\(k = n \times (n - 1) /2\)</span>, where <span class="math inline">\(n\)</span> is the number of means. Accordingly, with four means we have six contrasts and, luckily, R provides the predefined list of coefficients, by assigning the value “pairwise” to the argument ‘method’, as shown below:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="contrasts-and-multiple-comparison-testing.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairwise contrasts</span></span>
<span id="cb101-2"><a href="contrasts-and-multiple-comparison-testing.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(treat.means, <span class="at">adjust=</span><span class="st">&quot;none&quot;</span>, <span class="at">method=</span><span class="st">&quot;pairwise&quot;</span>)</span>
<span id="cb101-3"><a href="contrasts-and-multiple-comparison-testing.html#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast                         estimate   SE df t.ratio p.value</span></span>
<span id="cb101-4"><a href="contrasts-and-multiple-comparison-testing.html#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Mixture_378        4.05 2.77 12   1.461  0.1697</span></span>
<span id="cb101-5"><a href="contrasts-and-multiple-comparison-testing.html#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Rimsulfuron_30    -7.68 2.77 12  -2.774  0.0168</span></span>
<span id="cb101-6"><a href="contrasts-and-multiple-comparison-testing.html#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Unweeded         -17.60 2.77 12  -6.352  &lt;.0001</span></span>
<span id="cb101-7"><a href="contrasts-and-multiple-comparison-testing.html#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Rimsulfuron_30       -11.73 2.77 12  -4.235  0.0012</span></span>
<span id="cb101-8"><a href="contrasts-and-multiple-comparison-testing.html#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Unweeded             -21.64 2.77 12  -7.813  &lt;.0001</span></span>
<span id="cb101-9"><a href="contrasts-and-multiple-comparison-testing.html#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30 - Unweeded           -9.91 2.77 12  -3.578  0.0038</span></span></code></pre></div>
<p>The second situation implies a lower number of contrasts and we can set the ‘method’ argument to “dunnett”. However, we need to be careful, because R compares all means against the first in alphabetical order, which may not be what we are looking for. For example, in our case, we might like to compare all treatments with the herbicide mixture, which is the second in alphabetical order. Therefore, we set the argument ‘ref’ to 2.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="contrasts-and-multiple-comparison-testing.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dunnett contrasts</span></span>
<span id="cb102-2"><a href="contrasts-and-multiple-comparison-testing.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(treat.means, <span class="at">adjust=</span><span class="st">&quot;none&quot;</span>, <span class="at">method=</span><span class="st">&quot;dunnett&quot;</span>, <span class="at">ref =</span> <span class="dv">2</span>)</span>
<span id="cb102-3"><a href="contrasts-and-multiple-comparison-testing.html#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast                      estimate   SE df t.ratio p.value</span></span>
<span id="cb102-4"><a href="contrasts-and-multiple-comparison-testing.html#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Mixture_378     4.05 2.77 12   1.461  0.1697</span></span>
<span id="cb102-5"><a href="contrasts-and-multiple-comparison-testing.html#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30 - Mixture_378     11.73 2.77 12   4.235  0.0012</span></span>
<span id="cb102-6"><a href="contrasts-and-multiple-comparison-testing.html#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Unweeded - Mixture_378           21.64 2.77 12   7.813  &lt;.0001</span></span></code></pre></div>
<p>We may have noted that the above contrasts do not fully answer our questions about the effect sizes; indeed, we have a point estimate with standard error, but we do not have explicit confidence intervals. To get them, we can assign the result of the <code>contrast()</code> function to a variable and explore it by using the ‘confint’ method.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="contrasts-and-multiple-comparison-testing.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confidence intervals</span></span>
<span id="cb103-2"><a href="contrasts-and-multiple-comparison-testing.html#cb103-2" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">contrast</span>(treat.means, <span class="at">adjust=</span><span class="st">&quot;none&quot;</span>, </span>
<span id="cb103-3"><a href="contrasts-and-multiple-comparison-testing.html#cb103-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">method=</span><span class="st">&quot;dunnett&quot;</span>, <span class="at">ref =</span> <span class="dv">2</span>)</span>
<span id="cb103-4"><a href="contrasts-and-multiple-comparison-testing.html#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(con)</span>
<span id="cb103-5"><a href="contrasts-and-multiple-comparison-testing.html#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast                      estimate   SE df lower.CL upper.CL</span></span>
<span id="cb103-6"><a href="contrasts-and-multiple-comparison-testing.html#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Mixture_378     4.05 2.77 12    -1.99     10.1</span></span>
<span id="cb103-7"><a href="contrasts-and-multiple-comparison-testing.html#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30 - Mixture_378     11.73 2.77 12     5.70     17.8</span></span>
<span id="cb103-8"><a href="contrasts-and-multiple-comparison-testing.html#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  Unweeded - Mixture_378           21.64 2.77 12    15.61     27.7</span></span>
<span id="cb103-9"><a href="contrasts-and-multiple-comparison-testing.html#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb103-10"><a href="contrasts-and-multiple-comparison-testing.html#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95</span></span></code></pre></div>
</div>
<div id="letter-display" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Letter display<a href="contrasts-and-multiple-comparison-testing.html#letter-display" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We mentioned that effect sizes provide full information about the results of contrasts, by which we can answer all questions above. However, reporting effects sizes for pairwise comparisons with a high number of means may be impractical. Therefore, we can use the so-called <strong>letter display</strong>, that consists of augmenting the table of means with significance letters, so that means followed by different letters are significantly different from each other, for a certain predefined protection level <span class="math inline">\(\alpha\)</span>, usually equal to 0.05.</p>
<p>A letter display can be easily added by hand, according to the following procedure:</p>
<ol style="list-style-type: decimal">
<li>sort the means in increasing/decreasing order</li>
<li>start from the uppermost mean and add the A letter to this mean and to all the following means, when the difference with the first one is not significant</li>
<li>go on to the second mean and add the B letter to this mean and to all the following means, when the difference with the second one is not significant</li>
<li>go on like this, until all means have got their letters</li>
</ol>
<p>The above procedure works well with balanced experiments, although we might prefer using the more general procedure in R, as implemented in the ‘multcomp’ package, which we need to install, together with the ‘multcompView’ package. The function is named <code>cld()</code> and requires the means and the method of adjustment (see next section). We also provide a third argument, that is ‘Letters = LETTERS’ (be careful with the syntax, relating to small and capital letters) to use capital letters display instead of the default number display</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="contrasts-and-multiple-comparison-testing.html#cb104-1" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(treat.means, <span class="at">adjust=</span><span class="st">&quot;none&quot;</span>, <span class="at">Letters=</span>LETTERS)</span>
<span id="cb104-2"><a href="contrasts-and-multiple-comparison-testing.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  Treat           emmean   SE df lower.CL upper.CL .group</span></span>
<span id="cb104-3"><a href="contrasts-and-multiple-comparison-testing.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378       5.13 1.96 12     0.86      9.4  A    </span></span>
<span id="cb104-4"><a href="contrasts-and-multiple-comparison-testing.html#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348   9.18 1.96 12     4.91     13.4  A    </span></span>
<span id="cb104-5"><a href="contrasts-and-multiple-comparison-testing.html#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30   16.86 1.96 12    12.59     21.1   B   </span></span>
<span id="cb104-6"><a href="contrasts-and-multiple-comparison-testing.html#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Unweeded         26.77 1.96 12    22.50     31.0    C  </span></span>
<span id="cb104-7"><a href="contrasts-and-multiple-comparison-testing.html#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb104-8"><a href="contrasts-and-multiple-comparison-testing.html#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb104-9"><a href="contrasts-and-multiple-comparison-testing.html#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="do">## significance level used: alpha = 0.05 </span></span>
<span id="cb104-10"><a href="contrasts-and-multiple-comparison-testing.html#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: If two or more means share the same grouping symbol,</span></span>
<span id="cb104-11"><a href="contrasts-and-multiple-comparison-testing.html#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="do">##       then we cannot show them to be different.</span></span>
<span id="cb104-12"><a href="contrasts-and-multiple-comparison-testing.html#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="do">##       But we also did not show them to be the same.</span></span></code></pre></div>
<p>The letter display is handy, but it can only answer questions about the significance of differences, while it gives no hints about the direction and size of differences. For this reason, using the letter display is often regarded as a poor practice in the presentation of experimental results.</p>
</div>
<div id="multiplicity-correction" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Multiplicity correction<a href="contrasts-and-multiple-comparison-testing.html#multiplicity-correction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Experiments may involve a very high number of contrasts and, therefore, a high number of hypotheses is simultaneously tested. Let’s consider one of those hypotheses and imagine that the null is rejected with <span class="math inline">\(P = 0.04\)</span>, which would be the <strong>comparisonwise error rate</strong> (<span class="math inline">\(P_c\)</span>), i.e. the probability of wrong rejection. If we have a family of <em>n</em> such simultaneous contrasts where the null is always rejected at <span class="math inline">\(P = 0.04\)</span>, we could define the probability of wrong rejection for at least one of those hypotheses, the so-called <strong>familywise error rate</strong> (<span class="math inline">\(P_f\)</span>). We can get a sense that the familywise error rate is higher than the comparisonwise error rate, especially when <span class="math inline">\(n\)</span> is high.</p>
<p>It is important to know the relationship between <span class="math inline">\(P_c\)</span> and <span class="math inline">\(P_f\)</span>. We should consider that the probability of correct rejection for each hypothesis is <span class="math inline">\(1 - P_c\)</span> and, for <span class="math inline">\(n\)</span> hypotheses, the probability of no wrong rejections is <span class="math inline">\((1 - P_c)^n\)</span> (joint probability of independent events). The probability of having, at least, one wrong rejection (complementary event) is calculated as:</p>
<p><span class="math display">\[P_f = 1 - (1 - P_c)^n\]</span>
What does this mean? In practice, if we have <span class="math inline">\(n = 10\)</span> contrasts, and each one in rejected at <span class="math inline">\(P_c = 0.04\)</span>, the probability that we make at least one wrong decision is:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="contrasts-and-multiple-comparison-testing.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.04</span>)<span class="sc">^</span><span class="dv">10</span></span>
<span id="cb105-2"><a href="contrasts-and-multiple-comparison-testing.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.3351674</span></span></code></pre></div>
<p>This is generally known as the <strong>multiplicity problem</strong>: whenever we make a high number of simultaneous inferences, the probability that we make at least one mistake (wrong rejection) is much higher than the error rate for each single test. In some cases, the multiplicity problem can be particularly concerning, for example, when:</p>
<ol style="list-style-type: decimal">
<li>we want to avoid that one treatment is wrongly excluded from the group of the best ones. In this case, we take the highest ranking treatment and compare it to all the others (Dunnett type contrast); when the number of treatments is high, the probability that at least one treatment is wrongly excluded from the lot of the best ones may be very high;</li>
<li>we want to avoid false positives. Wrong rejections are false positives and their number may be high if we do not consider the multiplicity problem;</li>
<li>we want to draw conclusions for all the simultaneous set of contrasts. For example, we have used a letter display and want to state that ‘treatments followed by different letters are significantly different (P &lt; 0.05)’. In this case, the conclusion relates to the whole set of comparisons and the comparisonwise error rate is clearly invalid.</li>
</ol>
<p>There is rather a wide consensus in literature that we should always account for the multiplicity problem in our pairwise comparisons, which means that we should take decisions based on the familywise error rate, instead of the comparisonwise error rate. That means that we should reject the null when <span class="math inline">\(P_f &lt; 0.05\)</span> and not when <span class="math inline">\(P_c &lt; 0.05\)</span>, which implies that we correct the observed P-value, based on the number of simultaneous inferences.</p>
<p>And, how do we correct? The most natural method is to use the above mentioned relationship between <span class="math inline">\(P_c\)</span> and <span class="math inline">\(P_f\)</span>, which is know as the Sidak’s correction. In the box below, we perfom this correction either by hand, or by using the appropriate argument to the <code>contrast()</code> function in R. Please, remember that, four our example, the number of simultaneous contrasts is six.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="contrasts-and-multiple-comparison-testing.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correction by hand (six simultaneous contrasts)</span></span>
<span id="cb106-2"><a href="contrasts-and-multiple-comparison-testing.html#cb106-2" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">contrast</span>(treat.means, <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>, <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb106-3"><a href="contrasts-and-multiple-comparison-testing.html#cb106-3" aria-hidden="true" tabindex="-1"></a>Pc <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(con)[,<span class="dv">6</span>]</span>
<span id="cb106-4"><a href="contrasts-and-multiple-comparison-testing.html#cb106-4" aria-hidden="true" tabindex="-1"></a>Pf <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> Pc)<span class="sc">^</span><span class="dv">6</span></span>
<span id="cb106-5"><a href="contrasts-and-multiple-comparison-testing.html#cb106-5" aria-hidden="true" tabindex="-1"></a>Pf</span>
<span id="cb106-6"><a href="contrasts-and-multiple-comparison-testing.html#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 6.722991e-01 9.683462e-02 2.190543e-04 6.923077e-03 2.869757e-05</span></span>
<span id="cb106-7"><a href="contrasts-and-multiple-comparison-testing.html#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [6] 2.255183e-02</span></span>
<span id="cb106-8"><a href="contrasts-and-multiple-comparison-testing.html#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="co"># With R</span></span>
<span id="cb106-9"><a href="contrasts-and-multiple-comparison-testing.html#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(treat.means, <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>, <span class="at">adjust =</span> <span class="st">&quot;sidak&quot;</span>)</span>
<span id="cb106-10"><a href="contrasts-and-multiple-comparison-testing.html#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast                         estimate   SE df t.ratio p.value</span></span>
<span id="cb106-11"><a href="contrasts-and-multiple-comparison-testing.html#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Mixture_378        4.05 2.77 12   1.461  0.6723</span></span>
<span id="cb106-12"><a href="contrasts-and-multiple-comparison-testing.html#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Rimsulfuron_30    -7.68 2.77 12  -2.774  0.0968</span></span>
<span id="cb106-13"><a href="contrasts-and-multiple-comparison-testing.html#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Unweeded         -17.60 2.77 12  -6.352  0.0002</span></span>
<span id="cb106-14"><a href="contrasts-and-multiple-comparison-testing.html#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Rimsulfuron_30       -11.73 2.77 12  -4.235  0.0069</span></span>
<span id="cb106-15"><a href="contrasts-and-multiple-comparison-testing.html#cb106-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Unweeded             -21.64 2.77 12  -7.813  &lt;.0001</span></span>
<span id="cb106-16"><a href="contrasts-and-multiple-comparison-testing.html#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30 - Unweeded           -9.91 2.77 12  -3.578  0.0226</span></span>
<span id="cb106-17"><a href="contrasts-and-multiple-comparison-testing.html#cb106-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb106-18"><a href="contrasts-and-multiple-comparison-testing.html#cb106-18" aria-hidden="true" tabindex="-1"></a><span class="do">## P value adjustment: sidak method for 6 tests</span></span></code></pre></div>
<p>We see that, applying this type of multiplicity correction, the second contrast is no longer significant. An alternative, simpler and much more widespread correction procedure is the so-called Bonferroni’s correction, that is based on the following heuristic:</p>
<p><span class="math display">\[\alpha_E = \alpha_C \cdot k\]</span></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="contrasts-and-multiple-comparison-testing.html#cb107-1" aria-hidden="true" tabindex="-1"></a>Pc <span class="sc">*</span> <span class="dv">6</span></span>
<span id="cb107-2"><a href="contrasts-and-multiple-comparison-testing.html#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.018071e+00 1.009900e-01 2.190743e-04 6.943132e-03 2.869792e-05</span></span>
<span id="cb107-3"><a href="contrasts-and-multiple-comparison-testing.html#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [6] 2.276671e-02</span></span>
<span id="cb107-4"><a href="contrasts-and-multiple-comparison-testing.html#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(treat.means, <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>, <span class="at">adjust =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb107-5"><a href="contrasts-and-multiple-comparison-testing.html#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast                         estimate   SE df t.ratio p.value</span></span>
<span id="cb107-6"><a href="contrasts-and-multiple-comparison-testing.html#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Mixture_378        4.05 2.77 12   1.461  1.0000</span></span>
<span id="cb107-7"><a href="contrasts-and-multiple-comparison-testing.html#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Rimsulfuron_30    -7.68 2.77 12  -2.774  0.1010</span></span>
<span id="cb107-8"><a href="contrasts-and-multiple-comparison-testing.html#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Unweeded         -17.60 2.77 12  -6.352  0.0002</span></span>
<span id="cb107-9"><a href="contrasts-and-multiple-comparison-testing.html#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Rimsulfuron_30       -11.73 2.77 12  -4.235  0.0069</span></span>
<span id="cb107-10"><a href="contrasts-and-multiple-comparison-testing.html#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Unweeded             -21.64 2.77 12  -7.813  &lt;.0001</span></span>
<span id="cb107-11"><a href="contrasts-and-multiple-comparison-testing.html#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30 - Unweeded           -9.91 2.77 12  -3.578  0.0228</span></span>
<span id="cb107-12"><a href="contrasts-and-multiple-comparison-testing.html#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb107-13"><a href="contrasts-and-multiple-comparison-testing.html#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="do">## P value adjustment: bonferroni method for 6 tests</span></span></code></pre></div>
<p>Both the procedures, particularly the second one, are rather conservative, in the sense that they do not account for the fact that contrasts are always correlated and, therefore, overestimated <span class="math inline">\(P_f\)</span> values are furnished. Other correcting procedures exist (e.g., Holm, Hochberg, Hommel), but they are all more or less conservative.</p>
<p>In recent times, a group of American scientists has found the way of accounting for the correlation between contrasts, based on the multivariate Student’s t distribution (Bretz et al., 2011). Their method is the default one in R and it is incorporated in the <code>contrast()</code> function; we simply need to remove the ‘correct’ argument:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="contrasts-and-multiple-comparison-testing.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(treat.means, <span class="at">method=</span><span class="st">&quot;pairwise&quot;</span>)</span>
<span id="cb108-2"><a href="contrasts-and-multiple-comparison-testing.html#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast                         estimate   SE df t.ratio p.value</span></span>
<span id="cb108-3"><a href="contrasts-and-multiple-comparison-testing.html#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Mixture_378        4.05 2.77 12   1.461  0.4885</span></span>
<span id="cb108-4"><a href="contrasts-and-multiple-comparison-testing.html#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Rimsulfuron_30    -7.68 2.77 12  -2.774  0.0698</span></span>
<span id="cb108-5"><a href="contrasts-and-multiple-comparison-testing.html#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Unweeded         -17.60 2.77 12  -6.352  0.0002</span></span>
<span id="cb108-6"><a href="contrasts-and-multiple-comparison-testing.html#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Rimsulfuron_30       -11.73 2.77 12  -4.235  0.0055</span></span>
<span id="cb108-7"><a href="contrasts-and-multiple-comparison-testing.html#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Unweeded             -21.64 2.77 12  -7.813  &lt;.0001</span></span>
<span id="cb108-8"><a href="contrasts-and-multiple-comparison-testing.html#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30 - Unweeded           -9.91 2.77 12  -3.578  0.0173</span></span>
<span id="cb108-9"><a href="contrasts-and-multiple-comparison-testing.html#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb108-10"><a href="contrasts-and-multiple-comparison-testing.html#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="do">## P value adjustment: tukey method for comparing a family of 4 estimates</span></span>
<span id="cb108-11"><a href="contrasts-and-multiple-comparison-testing.html#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(treat.means, <span class="at">method=</span><span class="st">&quot;dunnett&quot;</span>)</span>
<span id="cb108-12"><a href="contrasts-and-multiple-comparison-testing.html#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast                         estimate   SE df t.ratio p.value</span></span>
<span id="cb108-13"><a href="contrasts-and-multiple-comparison-testing.html#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Metribuzin__348       -4.05 2.77 12  -1.461  0.3711</span></span>
<span id="cb108-14"><a href="contrasts-and-multiple-comparison-testing.html#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30 - Metribuzin__348     7.68 2.77 12   2.774  0.0442</span></span>
<span id="cb108-15"><a href="contrasts-and-multiple-comparison-testing.html#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  Unweeded - Metribuzin__348          17.60 2.77 12   6.352  0.0001</span></span>
<span id="cb108-16"><a href="contrasts-and-multiple-comparison-testing.html#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb108-17"><a href="contrasts-and-multiple-comparison-testing.html#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="do">## P value adjustment: dunnettx method for 3 tests</span></span></code></pre></div>
<p>Before concluding this part, I would like to put forward the idea that also confidence intervals may be appropriately enlarged to respect familywise error rates. However, we will not explore such an issue in this book.</p>
</div>
<div id="multiple-comparisons-with-transformed-data" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Multiple comparisons with transformed data<a href="contrasts-and-multiple-comparison-testing.html#multiple-comparisons-with-transformed-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the previous chapter, we have seen that, sometimes, we need to transform the data to respect the basic assumptions for linear models. For example, with the ‘insects.csv’ dataset in the previous chapter we have performed a logarithmic transformation, which we show again here.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="contrasts-and-multiple-comparison-testing.html#cb109-1" aria-hidden="true" tabindex="-1"></a>repo <span class="ot">&lt;-</span> <span class="st">&quot;https://www.casaonofri.it/_datasets/&quot;</span></span>
<span id="cb109-2"><a href="contrasts-and-multiple-comparison-testing.html#cb109-2" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">&quot;insects.csv&quot;</span></span>
<span id="cb109-3"><a href="contrasts-and-multiple-comparison-testing.html#cb109-3" aria-hidden="true" tabindex="-1"></a>pathData <span class="ot">&lt;-</span> <span class="fu">paste</span>(repo, file, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb109-4"><a href="contrasts-and-multiple-comparison-testing.html#cb109-4" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(pathData, <span class="at">header =</span> T)</span>
<span id="cb109-5"><a href="contrasts-and-multiple-comparison-testing.html#cb109-5" aria-hidden="true" tabindex="-1"></a>modt <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Count) <span class="sc">~</span> Insecticide, <span class="at">data =</span> dataset)</span></code></pre></div>
<p>When we use the <code>emmeans()</code> function in the ‘emmeans’ package, we get the means in the logarithmic scale.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="contrasts-and-multiple-comparison-testing.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb110-2"><a href="contrasts-and-multiple-comparison-testing.html#cb110-2" aria-hidden="true" tabindex="-1"></a>treatMeans <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modt, <span class="sc">~</span>Insecticide)</span>
<span id="cb110-3"><a href="contrasts-and-multiple-comparison-testing.html#cb110-3" aria-hidden="true" tabindex="-1"></a>treatMeans</span>
<span id="cb110-4"><a href="contrasts-and-multiple-comparison-testing.html#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Insecticide emmean    SE df lower.CL upper.CL</span></span>
<span id="cb110-5"><a href="contrasts-and-multiple-comparison-testing.html#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  T1            6.34 0.178 12     5.96     6.73</span></span>
<span id="cb110-6"><a href="contrasts-and-multiple-comparison-testing.html#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  T2            5.81 0.178 12     5.43     6.20</span></span>
<span id="cb110-7"><a href="contrasts-and-multiple-comparison-testing.html#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  T3            3.95 0.178 12     3.56     4.34</span></span>
<span id="cb110-8"><a href="contrasts-and-multiple-comparison-testing.html#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb110-9"><a href="contrasts-and-multiple-comparison-testing.html#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Results are given on the log (not the response) scale. </span></span>
<span id="cb110-10"><a href="contrasts-and-multiple-comparison-testing.html#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95</span></span></code></pre></div>
<p>In some instances, this may not be a problem, although there might be cases where we seek for the exact number of insect eggs in each leaf. Clearly, such an information is missing in the above analysis.</p>
<p>The best suggestion is to back-transform the above means by using the inverse transformation, e.g.:</p>
<p><span class="math display">\[e^{6.34} = 566.7963\]</span></p>
<p>Getting the back-trasfomed means for all treatments is easy, by using the <code>emmeans()</code> function and setting the ‘type’ argument to “response”, as shown below.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="contrasts-and-multiple-comparison-testing.html#cb111-1" aria-hidden="true" tabindex="-1"></a>retroMedie <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modt, <span class="sc">~</span>Insecticide, </span>
<span id="cb111-2"><a href="contrasts-and-multiple-comparison-testing.html#cb111-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb111-3"><a href="contrasts-and-multiple-comparison-testing.html#cb111-3" aria-hidden="true" tabindex="-1"></a>retroMedie</span>
<span id="cb111-4"><a href="contrasts-and-multiple-comparison-testing.html#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Insecticide response     SE df lower.CL upper.CL</span></span>
<span id="cb111-5"><a href="contrasts-and-multiple-comparison-testing.html#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  T1             568.6 101.01 12    386.1    837.3</span></span>
<span id="cb111-6"><a href="contrasts-and-multiple-comparison-testing.html#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  T2             335.1  59.54 12    227.6    493.5</span></span>
<span id="cb111-7"><a href="contrasts-and-multiple-comparison-testing.html#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  T3              51.9   9.22 12     35.2     76.4</span></span>
<span id="cb111-8"><a href="contrasts-and-multiple-comparison-testing.html#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb111-9"><a href="contrasts-and-multiple-comparison-testing.html#cb111-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb111-10"><a href="contrasts-and-multiple-comparison-testing.html#cb111-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Intervals are back-transformed from the log scale</span></span></code></pre></div>
<p>What are these back-transformed means? Expectedly, we can see that they are different from the arithmetic means on the original (untrasformed) scale:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="contrasts-and-multiple-comparison-testing.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(<span class="fu">lm</span>(Count <span class="sc">~</span> Insecticide, <span class="at">data =</span> dataset), <span class="sc">~</span>Insecticide)</span>
<span id="cb112-2"><a href="contrasts-and-multiple-comparison-testing.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  Insecticide emmean   SE df lower.CL upper.CL</span></span>
<span id="cb112-3"><a href="contrasts-and-multiple-comparison-testing.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  T1           589.8 62.7 12    453.1      726</span></span>
<span id="cb112-4"><a href="contrasts-and-multiple-comparison-testing.html#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  T2           357.4 62.7 12    220.7      494</span></span>
<span id="cb112-5"><a href="contrasts-and-multiple-comparison-testing.html#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  T3            56.6 62.7 12    -80.1      193</span></span>
<span id="cb112-6"><a href="contrasts-and-multiple-comparison-testing.html#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb112-7"><a href="contrasts-and-multiple-comparison-testing.html#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95</span></span></code></pre></div>
<p>Indeed, back-transformed means are lower than arithmetic means and they are regarded as estimators of the medians in the original scale, which are not influenced by the transformation. Indeed, we should think that monotonic transformations do not alter the ordering of observations and, thus, the central value remains the same. Consequently, when we report back-transformed means we are indeed reporting an estimate of the medians of the populations that generated our samples. However, estimating the medians instead of the means may not be a bad idea, considering that the populations are non-normal and might be asymmetric.</p>
<p>Finally, I have to point out that, in practice, things may become more complex if the transformation is not auto-detected, as we have shown before for the logarithmic transformation. For example, a reciprocal transformation is not detected and the back-transformation is not executed.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="contrasts-and-multiple-comparison-testing.html#cb113-1" aria-hidden="true" tabindex="-1"></a>modt2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="dv">1</span><span class="sc">/</span>Count <span class="sc">~</span> Insecticide, <span class="at">data =</span> dataset)</span>
<span id="cb113-2"><a href="contrasts-and-multiple-comparison-testing.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(modt2, <span class="sc">~</span>Insecticide, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb113-3"><a href="contrasts-and-multiple-comparison-testing.html#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Insecticide  emmean      SE df lower.CL upper.CL</span></span>
<span id="cb113-4"><a href="contrasts-and-multiple-comparison-testing.html#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  T1          0.00182 0.00279 12 -0.00426  0.00789</span></span>
<span id="cb113-5"><a href="contrasts-and-multiple-comparison-testing.html#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  T2          0.00317 0.00279 12 -0.00291  0.00924</span></span>
<span id="cb113-6"><a href="contrasts-and-multiple-comparison-testing.html#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  T3          0.02120 0.00279 12  0.01513  0.02727</span></span>
<span id="cb113-7"><a href="contrasts-and-multiple-comparison-testing.html#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb113-8"><a href="contrasts-and-multiple-comparison-testing.html#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95</span></span></code></pre></div>
<p>In this case, the transformation can be made prior to fitting the model; next, we need to update the ‘reference grid’ for the model, specifying what type of transformation we have made (<code>tran = "inverse"</code>). Finally, we can pass the updated grid into the <code>emmeans()</code> function.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="contrasts-and-multiple-comparison-testing.html#cb114-1" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>invCount <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>dataset<span class="sc">$</span>Count</span>
<span id="cb114-2"><a href="contrasts-and-multiple-comparison-testing.html#cb114-2" aria-hidden="true" tabindex="-1"></a>modt3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(invCount <span class="sc">~</span> Insecticide, <span class="at">data =</span> dataset)</span>
<span id="cb114-3"><a href="contrasts-and-multiple-comparison-testing.html#cb114-3" aria-hidden="true" tabindex="-1"></a>updGrid <span class="ot">&lt;-</span> <span class="fu">update</span>(<span class="fu">ref_grid</span>(modt3), <span class="at">tran =</span> <span class="st">&quot;inverse&quot;</span>)</span>
<span id="cb114-4"><a href="contrasts-and-multiple-comparison-testing.html#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(updGrid, <span class="sc">~</span>Insecticide, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb114-5"><a href="contrasts-and-multiple-comparison-testing.html#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Insecticide response    SE df lower.CL upper.CL</span></span>
<span id="cb114-6"><a href="contrasts-and-multiple-comparison-testing.html#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  T1             550.9 845.9 12    126.8      Inf</span></span>
<span id="cb114-7"><a href="contrasts-and-multiple-comparison-testing.html#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  T2             315.8 278.0 12    108.2      Inf</span></span>
<span id="cb114-8"><a href="contrasts-and-multiple-comparison-testing.html#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  T3              47.2   6.2 12     36.7       66</span></span>
<span id="cb114-9"><a href="contrasts-and-multiple-comparison-testing.html#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb114-10"><a href="contrasts-and-multiple-comparison-testing.html#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb114-11"><a href="contrasts-and-multiple-comparison-testing.html#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Intervals are back-transformed from the inverse scale</span></span></code></pre></div>
<p>We can use this method with several functions, such as: “identity”, “1/mu^2”, “inverse”, “reciprocal”, “log10”, “log2”, “asin.sqrt”, and “asinh.sqrt”.</p>
</div>
<div id="what-about-the-traditional-mcps" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> What about the traditional MCPs?<a href="contrasts-and-multiple-comparison-testing.html#what-about-the-traditional-mcps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have seen that the best practice to compare means is:</p>
<ol style="list-style-type: decimal">
<li>express the relevant differences by using contrasts</li>
<li>estimate those differences and their standard errors</li>
<li>test the null hypothesis that differences are zero and express the result by using familywise error rates.</li>
</ol>
<p>This process is conceptually different from the traditional multiple comparison procedures, which were very much in fashion before the 90s of the 20th century. MCPs were based on the determination of critical differences: whenever the observed difference was higher than the critical difference it was deemed significant. We can list the following MCPs:</p>
<ol style="list-style-type: decimal">
<li>Fisher’s Least Significant Difference (LSD)</li>
<li>Tukey’s Honest Significant Difference (HSD)</li>
<li>Dunnett’s test</li>
<li>Duncan’s test</li>
<li>Newman-Keuls’ test</li>
<li>Tukey’s MCP</li>
</ol>
<p>For balanced experiments, the Fisher’s LSD corresponds to pairwise contrasts with no multiplicity correction, while the Tukey’s HSD and Dunnett’s test involve the multiplicity correction respectively for all pairwise comparisons and for the comparisons against a control. Therefore, while the Fisher’s LSD adopts a comparisonwise error rate, the HSD and Dunnett’s test adopt a familywise protection rate.</p>
<p>All the other tests adopt some mechanism by which the critical difference is increased to account for a certain degree of multiplicity, but they do not adopt either a comparisonwise or a familywise error rate. They stay in the middle and, for this reason, their usage should be discouraged, although they are very much used in practice.</p>
</div>
<div id="some-practical-suggestions" class="section level2 hasAnchor" number="9.8">
<h2><span class="header-section-number">9.8</span> Some practical suggestions<a href="contrasts-and-multiple-comparison-testing.html#some-practical-suggestions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Pairwise contrasts and MCPs have been often abused in previous years and, still today, debates with editors and reviewers are very common. We would like to put forward a few suggestions, which might be useful in the way to scientific publication.</p>
<ol style="list-style-type: decimal">
<li>It is strongly advised that pairwise contrasts are never used when the experimental treatment is represented by a quantitative series of rates, doses, times or whatever. In this case, asking whether there is a significant difference between the response at different doses may be illogical: indeed, even though we selected a few doses to include in the experiment, we are usually interested in the responses across the whole range of possible doses. In this setting, fitting a response curve is much more respectful of our aims and data (see later, in this book).</li>
<li>Consider if you want to control the comparisonwise or the familywise error rate. The former might be preferred when only a few comparisons or contrasts are to be tested, each having a strong biological relevance (single-contrast problems), while the latter should be preferred in the case of a relatively high number of simultaneous tests, especially when an overall conclusion tends to be wrong when at least one single test is wrong.</li>
<li>If you just want to control comparisonwise protection rate, do not apply any multiplicity correction. For balanced data, such an approach corresponds to using the Fisher’s LSD in the traditional MCP setting.</li>
<li>If you want to control the familywise error rate, apply the appropriate multiplicity correcting measure and adjust the P-values accordingly. For balanced data, such an approach corresponds to using the Tukey HSD for all paairwise comparisons and to the Dunnett’s test for the comparisons against a control.</li>
<li>Do not use Student–Newman–Keuls or Duncans’ MRT, because they do not control either the familywise error rate, or the familywise error rate and do not yield a single critical difference for balanced data.</li>
</ol>
<hr />
</div>
<div id="further-readings-7" class="section level2 hasAnchor" number="9.9">
<h2><span class="header-section-number">9.9</span> Further readings<a href="contrasts-and-multiple-comparison-testing.html#further-readings-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Hsu, J., 1996. Multiple comparisons. Theory and methods. Chapman and Hall.</li>
<li>Bretz, F., T. Hothorn, and P. Westfall. 2002, On Multiple Comparison Procedures in R. R News 2: 14-17.</li>
<li>Chew, V. 1976, Comparing treatment means: a compendium. Hortscience, 11(4), 348-357.</li>
<li>Cousens, R. 1988, Misinterpretetion of results in weed research through inappropriate use of statistics. Weed Research, 28, 281-289.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="checking-for-the-basic-assumptions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multi-way-anova-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
