<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Nonlinear regression | Experimental methods in agriculture</title>
  <meta name="description" content="Chapter 14 Nonlinear regression | Experimental methods in agriculture: a tutorial book with R" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Nonlinear regression | Experimental methods in agriculture" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="http://www.casaonofri.it/images/coversmall.png" />
  <meta property="og:description" content="Chapter 14 Nonlinear regression | Experimental methods in agriculture: a tutorial book with R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Nonlinear regression | Experimental methods in agriculture" />
  <meta name="twitter:site" content="@onofriandreapg" />
  <meta name="twitter:description" content="Chapter 14 Nonlinear regression | Experimental methods in agriculture: a tutorial book with R" />
  <meta name="twitter:image" content="http://www.casaonofri.it/images/coversmall.png" />

<meta name="author" content="Andrea Onofri and Dario Sacco" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a-brief-intro-to-mixed-models.html"/>
<link rel="next" href="exercises.html"/>
<script src="book_assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="book_assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="book_assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="book_assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131792052-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-131792052-1');
  </script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Experimental Methods</a></strong></li> 

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#aims"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-this-book-is-organised"><i class="fa fa-check"></i>How this book is organised</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#statistical-software"><i class="fa fa-check"></i>Statistical software</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-authors"><i class="fa fa-check"></i>The authors</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html"><i class="fa fa-check"></i><b>1</b> Science and pseudoscience</a>
<ul>
<li class="chapter" data-level="1.1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#science-needs-data"><i class="fa fa-check"></i><b>1.1</b> Science needs data</a></li>
<li class="chapter" data-level="1.2" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#not-all-data-support-science"><i class="fa fa-check"></i><b>1.2</b> Not all data support science</a></li>
<li class="chapter" data-level="1.3" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#good-data-is-based-on-good-methods"><i class="fa fa-check"></i><b>1.3</b> Good data is based on good ‘methods’</a></li>
<li class="chapter" data-level="1.4" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#the-falsification-principle"><i class="fa fa-check"></i><b>1.4</b> The ‘falsification’ principle</a></li>
<li class="chapter" data-level="1.5" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#trying-to-falsify-a-result"><i class="fa fa-check"></i><b>1.5</b> Trying to falsify a result</a></li>
<li class="chapter" data-level="1.6" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#the-basic-principles-of-experimental-design"><i class="fa fa-check"></i><b>1.6</b> The basic principles of experimental design</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#control"><i class="fa fa-check"></i><b>1.6.1</b> Control</a></li>
<li class="chapter" data-level="1.6.2" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#replication"><i class="fa fa-check"></i><b>1.6.2</b> Replication</a></li>
<li class="chapter" data-level="1.6.3" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#randomisation"><i class="fa fa-check"></i><b>1.6.3</b> Randomisation</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#invalid-experiments"><i class="fa fa-check"></i><b>1.7</b> Invalid experiments</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#lack-of-good-control"><i class="fa fa-check"></i><b>1.7.1</b> Lack of good control</a></li>
<li class="chapter" data-level="1.7.2" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#confounding-and-spurious-correlation"><i class="fa fa-check"></i><b>1.7.2</b> ‘Confounding’ and spurious correlation</a></li>
<li class="chapter" data-level="1.7.3" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#lack-of-true-replicates-or-careless-randomisation"><i class="fa fa-check"></i><b>1.7.3</b> Lack of true-replicates or careless randomisation</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#how-can-we-assess-whether-the-data-is-valid"><i class="fa fa-check"></i><b>1.8</b> How can we assess whether the data is valid?</a></li>
<li class="chapter" data-level="1.9" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#conclusions"><i class="fa fa-check"></i><b>1.9</b> Conclusions</a></li>
<li class="chapter" data-level="1.10" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#further-readings"><i class="fa fa-check"></i><b>1.10</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="designing-experiments.html"><a href="designing-experiments.html"><i class="fa fa-check"></i><b>2</b> Designing experiments</a>
<ul>
<li class="chapter" data-level="2.1" data-path="designing-experiments.html"><a href="designing-experiments.html#the-elements-of-research"><i class="fa fa-check"></i><b>2.1</b> The elements of research</a></li>
<li class="chapter" data-level="2.2" data-path="designing-experiments.html"><a href="designing-experiments.html#hypothesis-and-objectives"><i class="fa fa-check"></i><b>2.2</b> Hypothesis and objectives</a></li>
<li class="chapter" data-level="2.3" data-path="designing-experiments.html"><a href="designing-experiments.html#the-experimental-treatments"><i class="fa fa-check"></i><b>2.3</b> The experimental treatments</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="designing-experiments.html"><a href="designing-experiments.html#factorial-experiments"><i class="fa fa-check"></i><b>2.3.1</b> Factorial experiments</a></li>
<li class="chapter" data-level="2.3.2" data-path="designing-experiments.html"><a href="designing-experiments.html#the-control"><i class="fa fa-check"></i><b>2.3.2</b> The control</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="designing-experiments.html"><a href="designing-experiments.html#the-experimental-units"><i class="fa fa-check"></i><b>2.4</b> The experimental units</a></li>
<li class="chapter" data-level="2.5" data-path="designing-experiments.html"><a href="designing-experiments.html#the-allocation-of-treatments"><i class="fa fa-check"></i><b>2.5</b> The allocation of treatments</a></li>
<li class="chapter" data-level="2.6" data-path="designing-experiments.html"><a href="designing-experiments.html#the-variables"><i class="fa fa-check"></i><b>2.6</b> The variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="designing-experiments.html"><a href="designing-experiments.html#nominal-variables"><i class="fa fa-check"></i><b>2.6.1</b> Nominal variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="designing-experiments.html"><a href="designing-experiments.html#ordinal-variables"><i class="fa fa-check"></i><b>2.6.2</b> Ordinal variables</a></li>
<li class="chapter" data-level="2.6.3" data-path="designing-experiments.html"><a href="designing-experiments.html#count-and-ratio-variables"><i class="fa fa-check"></i><b>2.6.3</b> Count and ratio variables</a></li>
<li class="chapter" data-level="2.6.4" data-path="designing-experiments.html"><a href="designing-experiments.html#continuous-variables"><i class="fa fa-check"></i><b>2.6.4</b> Continuous variables</a></li>
<li class="chapter" data-level="2.6.5" data-path="designing-experiments.html"><a href="designing-experiments.html#sensory-and-visual-assessments"><i class="fa fa-check"></i><b>2.6.5</b> Sensory and visual assessments</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="designing-experiments.html"><a href="designing-experiments.html#setting-up-a-field-experiment"><i class="fa fa-check"></i><b>2.7</b> Setting up a field experiment</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="designing-experiments.html"><a href="designing-experiments.html#selecting-the-field"><i class="fa fa-check"></i><b>2.7.1</b> Selecting the field</a></li>
<li class="chapter" data-level="2.7.2" data-path="designing-experiments.html"><a href="designing-experiments.html#selecting-the-units-within-the-field"><i class="fa fa-check"></i><b>2.7.2</b> Selecting the units within the field</a></li>
<li class="chapter" data-level="2.7.3" data-path="designing-experiments.html"><a href="designing-experiments.html#number-of-replicates"><i class="fa fa-check"></i><b>2.7.3</b> Number of replicates</a></li>
<li class="chapter" data-level="2.7.4" data-path="designing-experiments.html"><a href="designing-experiments.html#the-field-map"><i class="fa fa-check"></i><b>2.7.4</b> The field map</a></li>
<li class="chapter" data-level="2.7.5" data-path="designing-experiments.html"><a href="designing-experiments.html#the-experimental-lay-out"><i class="fa fa-check"></i><b>2.7.5</b> The experimental lay-out</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="designing-experiments.html"><a href="designing-experiments.html#conclusions-1"><i class="fa fa-check"></i><b>2.8</b> Conclusions</a></li>
<li class="chapter" data-level="2.9" data-path="designing-experiments.html"><a href="designing-experiments.html#further-readings-1"><i class="fa fa-check"></i><b>2.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="describing-the-observations.html"><a href="describing-the-observations.html"><i class="fa fa-check"></i><b>3</b> Describing the observations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="describing-the-observations.html"><a href="describing-the-observations.html#quantitative-data"><i class="fa fa-check"></i><b>3.1</b> Quantitative data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="describing-the-observations.html"><a href="describing-the-observations.html#statistics-of-location"><i class="fa fa-check"></i><b>3.1.1</b> Statistics of location</a></li>
<li class="chapter" data-level="3.1.2" data-path="describing-the-observations.html"><a href="describing-the-observations.html#statistics-of-spread"><i class="fa fa-check"></i><b>3.1.2</b> Statistics of spread</a></li>
<li class="chapter" data-level="3.1.3" data-path="describing-the-observations.html"><a href="describing-the-observations.html#summing-the-uncertainty"><i class="fa fa-check"></i><b>3.1.3</b> Summing the uncertainty</a></li>
<li class="chapter" data-level="3.1.4" data-path="describing-the-observations.html"><a href="describing-the-observations.html#relationship-between-quantitative-variables"><i class="fa fa-check"></i><b>3.1.4</b> Relationship between quantitative variables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="describing-the-observations.html"><a href="describing-the-observations.html#nominal-data"><i class="fa fa-check"></i><b>3.2</b> Nominal data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="describing-the-observations.html"><a href="describing-the-observations.html#distributions-of-frequencies"><i class="fa fa-check"></i><b>3.2.1</b> Distributions of frequencies</a></li>
<li class="chapter" data-level="3.2.2" data-path="describing-the-observations.html"><a href="describing-the-observations.html#descriptive-stats-for-distributions-of-frequencies"><i class="fa fa-check"></i><b>3.2.2</b> Descriptive stats for distributions of frequencies</a></li>
<li class="chapter" data-level="3.2.3" data-path="describing-the-observations.html"><a href="describing-the-observations.html#contingency-tables"><i class="fa fa-check"></i><b>3.2.3</b> Contingency tables</a></li>
<li class="chapter" data-level="3.2.4" data-path="describing-the-observations.html"><a href="describing-the-observations.html#independence"><i class="fa fa-check"></i><b>3.2.4</b> Independence</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="describing-the-observations.html"><a href="describing-the-observations.html#descriptive-stats-with-r"><i class="fa fa-check"></i><b>3.3</b> Descriptive stats with R</a></li>
<li class="chapter" data-level="3.4" data-path="describing-the-observations.html"><a href="describing-the-observations.html#graphical-representations"><i class="fa fa-check"></i><b>3.4</b> Graphical representations</a></li>
<li class="chapter" data-level="3.5" data-path="describing-the-observations.html"><a href="describing-the-observations.html#further-reading"><i class="fa fa-check"></i><b>3.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html"><i class="fa fa-check"></i><b>4</b> Modeling the experimental data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#deterministic-models"><i class="fa fa-check"></i><b>4.1</b> Deterministic models</a></li>
<li class="chapter" data-level="4.2" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#stochastic-models"><i class="fa fa-check"></i><b>4.2</b> Stochastic models</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#probability-functions"><i class="fa fa-check"></i><b>4.2.1</b> Probability functions</a></li>
<li class="chapter" data-level="4.2.2" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#density-functions"><i class="fa fa-check"></i><b>4.2.2</b> Density functions</a></li>
<li class="chapter" data-level="4.2.3" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#the-gaussian-pdf-and-cdf"><i class="fa fa-check"></i><b>4.2.3</b> The Gaussian PDF and CDF</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#a-model-with-two-components"><i class="fa fa-check"></i><b>4.3</b> A model with two components</a></li>
<li class="chapter" data-level="4.4" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#and-so-what"><i class="fa fa-check"></i><b>4.4</b> And so what?</a></li>
<li class="chapter" data-level="4.5" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#monte-carlo-methods-to-simulate-an-experiment"><i class="fa fa-check"></i><b>4.5</b> Monte Carlo methods to simulate an experiment</a></li>
<li class="chapter" data-level="4.6" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#data-analysis-and-model-fitting"><i class="fa fa-check"></i><b>4.6</b> Data analysis and model fitting</a></li>
<li class="chapter" data-level="4.7" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#some-words-of-warning"><i class="fa fa-check"></i><b>4.7</b> Some words of warning</a></li>
<li class="chapter" data-level="4.8" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#further-readings-2"><i class="fa fa-check"></i><b>4.8</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html"><i class="fa fa-check"></i><b>5</b> Estimation of model parameters</a>
<ul>
<li class="chapter" data-level="5.1" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#example-1-a-concentration-value"><i class="fa fa-check"></i><b>5.1</b> Example 1: a concentration value</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#the-empirical-sampling-distribution"><i class="fa fa-check"></i><b>5.1.1</b> The empirical sampling distribution</a></li>
<li class="chapter" data-level="5.1.2" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#a-theoretical-sampling-distribution"><i class="fa fa-check"></i><b>5.1.2</b> A theoretical sampling distribution</a></li>
<li class="chapter" data-level="5.1.3" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#the-frequentist-confidence-interval"><i class="fa fa-check"></i><b>5.1.3</b> The frequentist confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#example-2-a-proportion"><i class="fa fa-check"></i><b>5.2</b> Example 2: a proportion</a></li>
<li class="chapter" data-level="5.3" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#conclusions-2"><i class="fa fa-check"></i><b>5.3</b> Conclusions</a></li>
<li class="chapter" data-level="5.4" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#further-readings-3"><i class="fa fa-check"></i><b>5.4</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html"><i class="fa fa-check"></i><b>6</b> Making Decisions under uncertainty</a>
<ul>
<li class="chapter" data-level="6.1" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#comparing-sample-means-the-students-t-test"><i class="fa fa-check"></i><b>6.1</b> Comparing sample means: the Student’s t-test</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#the-dataset"><i class="fa fa-check"></i><b>6.1.1</b> The dataset</a></li>
<li class="chapter" data-level="6.1.2" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#monte-carlo-simulation"><i class="fa fa-check"></i><b>6.1.2</b> Monte Carlo simulation</a></li>
<li class="chapter" data-level="6.1.3" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#a-formal-solution"><i class="fa fa-check"></i><b>6.1.3</b> A formal solution</a></li>
<li class="chapter" data-level="6.1.4" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#the-t-test-with-r"><i class="fa fa-check"></i><b>6.1.4</b> The t test with R</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#comparing-proportions-the-chi2-test"><i class="fa fa-check"></i><b>6.2</b> Comparing proportions: the <span class="math inline">\(\chi^2\)</span> test</a></li>
<li class="chapter" data-level="6.3" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#correct-interpretation-of-the-p-value"><i class="fa fa-check"></i><b>6.3</b> Correct interpretation of the P-value</a></li>
<li class="chapter" data-level="6.4" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#conclusions-3"><i class="fa fa-check"></i><b>6.4</b> Conclusions</a></li>
<li class="chapter" data-level="6.5" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#further-readings-4"><i class="fa fa-check"></i><b>6.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html"><i class="fa fa-check"></i><b>7</b> One-way ANOVA models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#comparing-herbicides-in-a-pot-experiment"><i class="fa fa-check"></i><b>7.1</b> Comparing herbicides in a pot-experiment</a></li>
<li class="chapter" data-level="7.2" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#data-description"><i class="fa fa-check"></i><b>7.2</b> Data description</a></li>
<li class="chapter" data-level="7.3" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#model-definition"><i class="fa fa-check"></i><b>7.3</b> Model definition</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#parameterisation"><i class="fa fa-check"></i><b>7.3.1</b> Parameterisation</a></li>
<li class="chapter" data-level="7.3.2" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#treatment-constraint"><i class="fa fa-check"></i><b>7.3.2</b> Treatment constraint</a></li>
<li class="chapter" data-level="7.3.3" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#sum-to-zero-constraint"><i class="fa fa-check"></i><b>7.3.3</b> Sum-to-zero constraint</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#basic-assumptions"><i class="fa fa-check"></i><b>7.4</b> Basic assumptions</a></li>
<li class="chapter" data-level="7.5" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#fitting-anova-models-by-hand"><i class="fa fa-check"></i><b>7.5</b> Fitting ANOVA models by hand</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#parameter-estimation"><i class="fa fa-check"></i><b>7.5.1</b> Parameter estimation</a></li>
<li class="chapter" data-level="7.5.2" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#residuals"><i class="fa fa-check"></i><b>7.5.2</b> Residuals</a></li>
<li class="chapter" data-level="7.5.3" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#standard-deviation-sigma"><i class="fa fa-check"></i><b>7.5.3</b> Standard deviation <span class="math inline">\(\sigma\)</span></a></li>
<li class="chapter" data-level="7.5.4" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#sem-and-sed"><i class="fa fa-check"></i><b>7.5.4</b> SEM and SED</a></li>
<li class="chapter" data-level="7.5.5" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#variance-partitioning"><i class="fa fa-check"></i><b>7.5.5</b> Variance partitioning</a></li>
<li class="chapter" data-level="7.5.6" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#hypothesis-testing"><i class="fa fa-check"></i><b>7.5.6</b> Hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#fitting-anova-models-with-r"><i class="fa fa-check"></i><b>7.6</b> Fitting ANOVA models with R</a></li>
<li class="chapter" data-level="7.7" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#expected-marginal-means"><i class="fa fa-check"></i><b>7.7</b> Expected marginal means</a></li>
<li class="chapter" data-level="7.8" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#conclusions-4"><i class="fa fa-check"></i><b>7.8</b> Conclusions</a></li>
<li class="chapter" data-level="7.9" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#further-readings-5"><i class="fa fa-check"></i><b>7.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html"><i class="fa fa-check"></i><b>8</b> Checking for the basic assumptions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#outlying-observations"><i class="fa fa-check"></i><b>8.1</b> Outlying observations</a></li>
<li class="chapter" data-level="8.2" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#the-inspection-of-residuals"><i class="fa fa-check"></i><b>8.2</b> The inspection of residuals</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#plot-of-residuals-against-expected-values"><i class="fa fa-check"></i><b>8.2.1</b> Plot of residuals against expected values</a></li>
<li class="chapter" data-level="8.2.2" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#qq-plot"><i class="fa fa-check"></i><b>8.2.2</b> QQ-plot</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#formal-hypotesis-testing"><i class="fa fa-check"></i><b>8.3</b> Formal hypotesis testing</a></li>
<li class="chapter" data-level="8.4" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#what-do-we-do-in-practice"><i class="fa fa-check"></i><b>8.4</b> What do we do, in practice?</a></li>
<li class="chapter" data-level="8.5" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#correcting-measures"><i class="fa fa-check"></i><b>8.5</b> Correcting measures</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#removing-outliers"><i class="fa fa-check"></i><b>8.5.1</b> Removing outliers</a></li>
<li class="chapter" data-level="8.5.2" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#stabilising-transformations"><i class="fa fa-check"></i><b>8.5.2</b> Stabilising transformations</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#examples-with-r"><i class="fa fa-check"></i><b>8.6</b> Examples with R</a></li>
<li class="chapter" data-level="8.7" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#example-1"><i class="fa fa-check"></i><b>8.7</b> Example 1</a></li>
<li class="chapter" data-level="8.8" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#example-2"><i class="fa fa-check"></i><b>8.8</b> Example 2</a></li>
<li class="chapter" data-level="8.9" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#other-possible-approaches"><i class="fa fa-check"></i><b>8.9</b> Other possible approaches</a></li>
<li class="chapter" data-level="8.10" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#further-readings-6"><i class="fa fa-check"></i><b>8.10</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html"><i class="fa fa-check"></i><b>9</b> Contrasts and multiple comparison testing</a>
<ul>
<li class="chapter" data-level="9.1" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#back-to-the-mixture-example"><i class="fa fa-check"></i><b>9.1</b> Back to the ‘mixture’ example</a></li>
<li class="chapter" data-level="9.2" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#linear-contrasts"><i class="fa fa-check"></i><b>9.2</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#the-variance-of-contrasts"><i class="fa fa-check"></i><b>9.2.1</b> The variance of contrasts</a></li>
<li class="chapter" data-level="9.2.2" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#testing-linear-contrasts-with-r"><i class="fa fa-check"></i><b>9.2.2</b> Testing linear contrasts with R</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#pairwise-comparisons"><i class="fa fa-check"></i><b>9.3</b> Pairwise comparisons</a></li>
<li class="chapter" data-level="9.4" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#letter-display"><i class="fa fa-check"></i><b>9.4</b> Letter display</a></li>
<li class="chapter" data-level="9.5" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#multiplicity-correction"><i class="fa fa-check"></i><b>9.5</b> Multiplicity correction</a></li>
<li class="chapter" data-level="9.6" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#multiple-comparisons-with-transformed-data"><i class="fa fa-check"></i><b>9.6</b> Multiple comparisons with transformed data</a></li>
<li class="chapter" data-level="9.7" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#what-about-the-traditional-mcps"><i class="fa fa-check"></i><b>9.7</b> What about the traditional MCPs?</a></li>
<li class="chapter" data-level="9.8" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#some-practical-suggestions"><i class="fa fa-check"></i><b>9.8</b> Some practical suggestions</a></li>
<li class="chapter" data-level="9.9" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#further-readings-7"><i class="fa fa-check"></i><b>9.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html"><i class="fa fa-check"></i><b>10</b> Multi-way ANOVA models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#motivating-example-a-genotype-experiment-in-blocks"><i class="fa fa-check"></i><b>10.1</b> Motivating example: a genotype experiment in blocks</a></li>
<li class="chapter" data-level="10.2" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-definition-1"><i class="fa fa-check"></i><b>10.2</b> Model definition</a></li>
<li class="chapter" data-level="10.3" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-fitting-by-hand"><i class="fa fa-check"></i><b>10.3</b> Model fitting by hand</a></li>
<li class="chapter" data-level="10.4" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-fitting-with-r"><i class="fa fa-check"></i><b>10.4</b> Model fitting with R</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-checking"><i class="fa fa-check"></i><b>10.4.1</b> Model checking</a></li>
<li class="chapter" data-level="10.4.2" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#variance-partitioning-1"><i class="fa fa-check"></i><b>10.4.2</b> Variance partitioning</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#another-example-comparing-working-protocols"><i class="fa fa-check"></i><b>10.5</b> Another example: comparing working protocols</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html"><i class="fa fa-check"></i><b>11</b> Multi-way ANOVA models with interactions</a>
<ul>
<li class="chapter" data-level="11.1" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#the-interaction-concept"><i class="fa fa-check"></i><b>11.1</b> The ‘interaction’ concept</a></li>
<li class="chapter" data-level="11.2" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#genotype-by-n-interactions"><i class="fa fa-check"></i><b>11.2</b> Genotype by N interactions</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-definition-2"><i class="fa fa-check"></i><b>11.2.1</b> Model definition</a></li>
<li class="chapter" data-level="11.2.2" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-fitting-by-hand-1"><i class="fa fa-check"></i><b>11.2.2</b> Model fitting by hand</a></li>
<li class="chapter" data-level="11.2.3" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-fitting-with-r-1"><i class="fa fa-check"></i><b>11.2.3</b> Model fitting with R</a></li>
<li class="chapter" data-level="11.2.4" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#inferences-and-standard-errors"><i class="fa fa-check"></i><b>11.2.4</b> Inferences and standard errors</a></li>
<li class="chapter" data-level="11.2.5" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#expected-marginal-means-1"><i class="fa fa-check"></i><b>11.2.5</b> Expected marginal means</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#nested-effects-maize-crosses"><i class="fa fa-check"></i><b>11.3</b> Nested effects: maize crosses</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-definition-3"><i class="fa fa-check"></i><b>11.3.1</b> Model definition</a></li>
<li class="chapter" data-level="11.3.2" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#parameter-estimation-1"><i class="fa fa-check"></i><b>11.3.2</b> Parameter estimation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#further-readings-8"><i class="fa fa-check"></i><b>11.4</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>12</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#case-study-n-fertilisation-in-wheat"><i class="fa fa-check"></i><b>12.1</b> Case-study: N fertilisation in wheat</a></li>
<li class="chapter" data-level="12.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#preliminary-analysis"><i class="fa fa-check"></i><b>12.2</b> Preliminary analysis</a></li>
<li class="chapter" data-level="12.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#definition-of-a-linear-model"><i class="fa fa-check"></i><b>12.3</b> Definition of a linear model</a></li>
<li class="chapter" data-level="12.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#parameter-estimation-2"><i class="fa fa-check"></i><b>12.4</b> Parameter estimation</a></li>
<li class="chapter" data-level="12.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#goodness-of-fit"><i class="fa fa-check"></i><b>12.5</b> Goodness of fit</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#graphical-evaluation"><i class="fa fa-check"></i><b>12.5.1</b> Graphical evaluation</a></li>
<li class="chapter" data-level="12.5.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#standard-errors-for-parameter-estimates"><i class="fa fa-check"></i><b>12.5.2</b> Standard errors for parameter estimates</a></li>
<li class="chapter" data-level="12.5.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#f-test-for-lack-of-fit"><i class="fa fa-check"></i><b>12.5.3</b> F test for lack of fit</a></li>
<li class="chapter" data-level="12.5.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#f-test-for-goodness-of-fit-and-coefficient-of-determination"><i class="fa fa-check"></i><b>12.5.4</b> F test for goodness of fit and coefficient of determination</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#making-predictions"><i class="fa fa-check"></i><b>12.6</b> Making predictions</a></li>
<li class="chapter" data-level="12.7" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#further-readings-9"><i class="fa fa-check"></i><b>12.7</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html"><i class="fa fa-check"></i><b>13</b> A brief intro to mixed models</a>
<ul>
<li class="chapter" data-level="13.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#split-plot-or-strip-plot-experiments"><i class="fa fa-check"></i><b>13.1</b> Split-plot or strip-plot experiments</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-1-a-split-plot-experiment"><i class="fa fa-check"></i><b>13.1.1</b> Example 1: a split-plot experiment</a></li>
<li class="chapter" data-level="13.1.2" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-2-a-strip-plot-design"><i class="fa fa-check"></i><b>13.1.2</b> Example 2: a strip-plot design</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#sub-sampling-designs"><i class="fa fa-check"></i><b>13.2</b> Sub-sampling designs</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-3-a-rcbd-with-sub-sampling"><i class="fa fa-check"></i><b>13.2.1</b> Example 3: A RCBD with sub-sampling</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#repeated-experiments"><i class="fa fa-check"></i><b>13.3</b> Repeated experiments</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#a-model-for-pooling-the-results"><i class="fa fa-check"></i><b>13.3.1</b> A model for pooling the results</a></li>
<li class="chapter" data-level="13.3.2" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#preliminary-analyses"><i class="fa fa-check"></i><b>13.3.2</b> Preliminary analyses</a></li>
<li class="chapter" data-level="13.3.3" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#fixed-or-random-runs"><i class="fa fa-check"></i><b>13.3.3</b> Fixed or random runs?</a></li>
<li class="chapter" data-level="13.3.4" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-4-a-seed-germination-experiment-in-two-runs"><i class="fa fa-check"></i><b>13.3.4</b> Example 4: a seed germination experiment in two runs</a></li>
<li class="chapter" data-level="13.3.5" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-5-a-multi-year-winter-wheat-experiment"><i class="fa fa-check"></i><b>13.3.5</b> Example 5: a multi-year winter wheat experiment</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#repeated-measures-in-perennial-crops"><i class="fa fa-check"></i><b>13.4</b> Repeated measures in perennial crops</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-5-genotype-experiment-with-lucerne"><i class="fa fa-check"></i><b>13.4.1</b> Example 5: genotype experiment with lucerne</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#further-readings-10"><i class="fa fa-check"></i><b>13.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>14</b> Nonlinear regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#case-study-a-degradation-curve"><i class="fa fa-check"></i><b>14.1</b> Case-study: a degradation curve</a></li>
<li class="chapter" data-level="14.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#model-selection"><i class="fa fa-check"></i><b>14.2</b> Model selection</a></li>
<li class="chapter" data-level="14.3" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#parameter-estimation-3"><i class="fa fa-check"></i><b>14.3</b> Parameter estimation</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#linearisation"><i class="fa fa-check"></i><b>14.3.1</b> Linearisation</a></li>
<li class="chapter" data-level="14.3.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#approximation-with-a-polynomial-function"><i class="fa fa-check"></i><b>14.3.2</b> Approximation with a polynomial function</a></li>
<li class="chapter" data-level="14.3.3" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#nonlinear-least-squares"><i class="fa fa-check"></i><b>14.3.3</b> Nonlinear least squares</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#nonlinear-regression-with-r"><i class="fa fa-check"></i><b>14.4</b> Nonlinear regression with R</a></li>
<li class="chapter" data-level="14.5" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#checking-the-model"><i class="fa fa-check"></i><b>14.5</b> Checking the model</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#graphical-analyses-of-residuals"><i class="fa fa-check"></i><b>14.5.1</b> Graphical analyses of residuals</a></li>
<li class="chapter" data-level="14.5.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#approximate-f-test-for-lack-of-fit"><i class="fa fa-check"></i><b>14.5.2</b> Approximate F test for lack of fit</a></li>
<li class="chapter" data-level="14.5.3" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#the-coefficient-of-determination-r2"><i class="fa fa-check"></i><b>14.5.3</b> The coefficient of determination (R<sup>2</sup>)</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#stabilising-transformations-1"><i class="fa fa-check"></i><b>14.6</b> Stabilising transformations</a></li>
<li class="chapter" data-level="14.7" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#making-predictions-1"><i class="fa fa-check"></i><b>14.7</b> Making predictions</a></li>
<li class="chapter" data-level="14.8" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#further-readings-11"><i class="fa fa-check"></i><b>14.8</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>15</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.1" data-path="exercises.html"><a href="exercises.html#designing-experiments-ch.-1-to-2"><i class="fa fa-check"></i><b>15.1</b> Designing experiments (ch. 1 to 2)</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="exercises.html"><a href="exercises.html#exercise-1"><i class="fa fa-check"></i><b>15.1.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.1.2" data-path="exercises.html"><a href="exercises.html#exercise-2"><i class="fa fa-check"></i><b>15.1.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.1.3" data-path="exercises.html"><a href="exercises.html#exercise-3"><i class="fa fa-check"></i><b>15.1.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="exercises.html"><a href="exercises.html#describing-the-observations-ch.-3"><i class="fa fa-check"></i><b>15.2</b> Describing the observations (ch. 3)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="exercises.html"><a href="exercises.html#exercise-1-1"><i class="fa fa-check"></i><b>15.2.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.2.2" data-path="exercises.html"><a href="exercises.html#exercise-2-1"><i class="fa fa-check"></i><b>15.2.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.2.3" data-path="exercises.html"><a href="exercises.html#exercise-3-1"><i class="fa fa-check"></i><b>15.2.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="exercises.html"><a href="exercises.html#modeling-the-experimental-data-ch.-4"><i class="fa fa-check"></i><b>15.3</b> Modeling the experimental data (ch. 4)</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="exercises.html"><a href="exercises.html#exercise-1-2"><i class="fa fa-check"></i><b>15.3.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.3.2" data-path="exercises.html"><a href="exercises.html#exercise-2-2"><i class="fa fa-check"></i><b>15.3.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.3.3" data-path="exercises.html"><a href="exercises.html#exercise-3-2"><i class="fa fa-check"></i><b>15.3.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.3.4" data-path="exercises.html"><a href="exercises.html#exercise-4"><i class="fa fa-check"></i><b>15.3.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.3.5" data-path="exercises.html"><a href="exercises.html#exercise-5"><i class="fa fa-check"></i><b>15.3.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.3.6" data-path="exercises.html"><a href="exercises.html#exercise-6"><i class="fa fa-check"></i><b>15.3.6</b> Exercise 6</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="exercises.html"><a href="exercises.html#interval-estimation-of-model-parameters-ch.-5"><i class="fa fa-check"></i><b>15.4</b> Interval estimation of model parameters (ch. 5)</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="exercises.html"><a href="exercises.html#exercise-1-3"><i class="fa fa-check"></i><b>15.4.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.4.2" data-path="exercises.html"><a href="exercises.html#exercise-2-3"><i class="fa fa-check"></i><b>15.4.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.4.3" data-path="exercises.html"><a href="exercises.html#exercise-3-3"><i class="fa fa-check"></i><b>15.4.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.4.4" data-path="exercises.html"><a href="exercises.html#exercise-4-1"><i class="fa fa-check"></i><b>15.4.4</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="exercises.html"><a href="exercises.html#making-decisions-under-uncertainty-ch.-6"><i class="fa fa-check"></i><b>15.5</b> Making decisions under uncertainty (ch. 6)</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="exercises.html"><a href="exercises.html#exercise-1-4"><i class="fa fa-check"></i><b>15.5.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.5.2" data-path="exercises.html"><a href="exercises.html#exercise-2-4"><i class="fa fa-check"></i><b>15.5.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.5.3" data-path="exercises.html"><a href="exercises.html#exercise-3-4"><i class="fa fa-check"></i><b>15.5.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.5.4" data-path="exercises.html"><a href="exercises.html#exercise-4-2"><i class="fa fa-check"></i><b>15.5.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.5.5" data-path="exercises.html"><a href="exercises.html#exercise-5-1"><i class="fa fa-check"></i><b>15.5.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.5.6" data-path="exercises.html"><a href="exercises.html#exercise-6-1"><i class="fa fa-check"></i><b>15.5.6</b> Exercise 6</a></li>
<li class="chapter" data-level="15.5.7" data-path="exercises.html"><a href="exercises.html#exercise-7"><i class="fa fa-check"></i><b>15.5.7</b> Exercise 7</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="exercises.html"><a href="exercises.html#fitting-models-to-data-from-agriculture-experiments"><i class="fa fa-check"></i><b>15.6</b> Fitting models to data from agriculture experiments</a></li>
<li class="chapter" data-level="15.7" data-path="exercises.html"><a href="exercises.html#one-way-anova-models-ch.-7-to-9"><i class="fa fa-check"></i><b>15.7</b> One-way ANOVA models (ch. 7 to 9)</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="exercises.html"><a href="exercises.html#exercise-1-5"><i class="fa fa-check"></i><b>15.7.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.7.2" data-path="exercises.html"><a href="exercises.html#exercise-2-5"><i class="fa fa-check"></i><b>15.7.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.7.3" data-path="exercises.html"><a href="exercises.html#exercise-3-5"><i class="fa fa-check"></i><b>15.7.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.7.4" data-path="exercises.html"><a href="exercises.html#exercise-4-3"><i class="fa fa-check"></i><b>15.7.4</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="exercises.html"><a href="exercises.html#multi-way-anova-models-ch.-10"><i class="fa fa-check"></i><b>15.8</b> Multi-way ANOVA models (ch. 10)</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="exercises.html"><a href="exercises.html#exercise-1-6"><i class="fa fa-check"></i><b>15.8.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.8.2" data-path="exercises.html"><a href="exercises.html#exercise-2-6"><i class="fa fa-check"></i><b>15.8.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.8.3" data-path="exercises.html"><a href="exercises.html#exercise-3-6"><i class="fa fa-check"></i><b>15.8.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="15.9" data-path="exercises.html"><a href="exercises.html#multi-way-anova-models-with-interactions-ch.-11-and-13"><i class="fa fa-check"></i><b>15.9</b> Multi-way ANOVA models with interactions (ch. 11 and 13)</a>
<ul>
<li class="chapter" data-level="15.9.1" data-path="exercises.html"><a href="exercises.html#exercise-1-7"><i class="fa fa-check"></i><b>15.9.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.9.2" data-path="exercises.html"><a href="exercises.html#exercise-2-7"><i class="fa fa-check"></i><b>15.9.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.9.3" data-path="exercises.html"><a href="exercises.html#exercise-3-7"><i class="fa fa-check"></i><b>15.9.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.9.4" data-path="exercises.html"><a href="exercises.html#exercise-4-4"><i class="fa fa-check"></i><b>15.9.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.9.5" data-path="exercises.html"><a href="exercises.html#exercise-5-2"><i class="fa fa-check"></i><b>15.9.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.9.6" data-path="exercises.html"><a href="exercises.html#exercise-6-2"><i class="fa fa-check"></i><b>15.9.6</b> Exercise 6</a></li>
</ul></li>
<li class="chapter" data-level="15.10" data-path="exercises.html"><a href="exercises.html#simple-linear-regression-ch.-12"><i class="fa fa-check"></i><b>15.10</b> Simple linear regression (ch. 12)</a>
<ul>
<li class="chapter" data-level="15.10.1" data-path="exercises.html"><a href="exercises.html#exercise-1-8"><i class="fa fa-check"></i><b>15.10.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.10.2" data-path="exercises.html"><a href="exercises.html#exercise-2-8"><i class="fa fa-check"></i><b>15.10.2</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="15.11" data-path="exercises.html"><a href="exercises.html#nonlinear-regression-ch.-14"><i class="fa fa-check"></i><b>15.11</b> Nonlinear regression (ch. 14)</a>
<ul>
<li class="chapter" data-level="15.11.1" data-path="exercises.html"><a href="exercises.html#exercise-1-9"><i class="fa fa-check"></i><b>15.11.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.11.2" data-path="exercises.html"><a href="exercises.html#exercise-2-9"><i class="fa fa-check"></i><b>15.11.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.11.3" data-path="exercises.html"><a href="exercises.html#exercise-3-8"><i class="fa fa-check"></i><b>15.11.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.11.4" data-path="exercises.html"><a href="exercises.html#exercise-4-5"><i class="fa fa-check"></i><b>15.11.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.11.5" data-path="exercises.html"><a href="exercises.html#exercise-5-3"><i class="fa fa-check"></i><b>15.11.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.11.6" data-path="exercises.html"><a href="exercises.html#exercise-6-3"><i class="fa fa-check"></i><b>15.11.6</b> Exercise 6</a></li>
<li class="chapter" data-level="15.11.7" data-path="exercises.html"><a href="exercises.html#exercise-7-1"><i class="fa fa-check"></i><b>15.11.7</b> Exercise 7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html"><i class="fa fa-check"></i><b>16</b> APPENDIX: A very gentle introduction to R</a>
<ul>
<li class="chapter" data-level="16.1" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#what-is-r"><i class="fa fa-check"></i><b>16.1</b> What is R?</a></li>
<li class="chapter" data-level="16.2" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#installing-r-and-moving-the-first-steps"><i class="fa fa-check"></i><b>16.2</b> Installing R and moving the first steps</a></li>
<li class="chapter" data-level="16.3" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#assignments"><i class="fa fa-check"></i><b>16.3</b> Assignments</a></li>
<li class="chapter" data-level="16.4" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#data-types-and-data-objects"><i class="fa fa-check"></i><b>16.4</b> Data types and data objects</a></li>
<li class="chapter" data-level="16.5" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#matrices"><i class="fa fa-check"></i><b>16.5</b> Matrices</a></li>
<li class="chapter" data-level="16.6" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#dataframes"><i class="fa fa-check"></i><b>16.6</b> Dataframes</a></li>
<li class="chapter" data-level="16.7" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#working-with-objects"><i class="fa fa-check"></i><b>16.7</b> Working with objects</a></li>
<li class="chapter" data-level="16.8" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#expressions-functions-and-arguments"><i class="fa fa-check"></i><b>16.8</b> Expressions, functions and arguments</a></li>
<li class="chapter" data-level="16.9" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#a-few-useful-functions"><i class="fa fa-check"></i><b>16.9</b> A few useful functions</a></li>
<li class="chapter" data-level="16.10" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#extractors"><i class="fa fa-check"></i><b>16.10</b> Extractors</a></li>
<li class="chapter" data-level="16.11" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#reading-external-data"><i class="fa fa-check"></i><b>16.11</b> Reading external data</a></li>
<li class="chapter" data-level="16.12" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#simple-r-graphics"><i class="fa fa-check"></i><b>16.12</b> Simple R graphics</a></li>
<li class="chapter" data-level="16.13" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#further-readings-12"><i class="fa fa-check"></i><b>16.13</b> Further readings</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Experimental methods in agriculture</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="nonlinear-regression" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Chapter 14</span> Nonlinear regression<a href="nonlinear-regression.html#nonlinear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>The aim of science is to seek the simplest explanation of complex facts. Seek simplicity and distrust it (A.N. Whitehead)</em></p>
<p>Biological processes, very rarely follow linear trends. Just think about how a crop grows, or responds to increasing doses of fertilisers/xenobiotics. Or, think about how an herbicide degrades in the soil, or about the germination pattern of a seed population. It is very easy to realise that curvilinear trends, asymptotes and/or inflection points are far more common, in nature. In practice, linear equations in biology are nothing more than a quick way to approximate a response over a very narrow range of the independent variable.</p>
<p>Therefore, we need to be able to fit simple nonlinear models to our experimental data. In this Chapter, we will see how to do this, starting from a simple, but realistic example.</p>
<div id="case-study-a-degradation-curve" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Case-study: a degradation curve<a href="nonlinear-regression.html#case-study-a-degradation-curve" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A soil was enriched with the herbicide metamitron, up to a concentration of 100 ng g<sup>1</sup>. It was put in 24 aluminium containers, inside a climatic chamber at 20°C. Three containers were randomly selected in eight different times and the residual concentration of metamitron was measured. The observed data are available in the ‘degradation.csv’ file, in an external repository. First of all we load and inspect the data.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="nonlinear-regression.html#cb192-1" tabindex="-1"></a>fileName <span class="ot">&lt;-</span> <span class="st">&quot;https://www.casaonofri.it/_datasets/degradation.csv&quot;</span></span>
<span id="cb192-2"><a href="nonlinear-regression.html#cb192-2" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(fileName, <span class="at">header=</span>T)</span>
<span id="cb192-3"><a href="nonlinear-regression.html#cb192-3" tabindex="-1"></a><span class="fu">head</span>(dataset, <span class="dv">10</span>)</span>
<span id="cb192-4"><a href="nonlinear-regression.html#cb192-4" tabindex="-1"></a><span class="do">##    Time   Conc</span></span>
<span id="cb192-5"><a href="nonlinear-regression.html#cb192-5" tabindex="-1"></a><span class="do">## 1     0  96.40</span></span>
<span id="cb192-6"><a href="nonlinear-regression.html#cb192-6" tabindex="-1"></a><span class="do">## 2    10  46.30</span></span>
<span id="cb192-7"><a href="nonlinear-regression.html#cb192-7" tabindex="-1"></a><span class="do">## 3    20  21.20</span></span>
<span id="cb192-8"><a href="nonlinear-regression.html#cb192-8" tabindex="-1"></a><span class="do">## 4    30  17.89</span></span>
<span id="cb192-9"><a href="nonlinear-regression.html#cb192-9" tabindex="-1"></a><span class="do">## 5    40  10.10</span></span>
<span id="cb192-10"><a href="nonlinear-regression.html#cb192-10" tabindex="-1"></a><span class="do">## 6    50   6.90</span></span>
<span id="cb192-11"><a href="nonlinear-regression.html#cb192-11" tabindex="-1"></a><span class="do">## 7    60   3.50</span></span>
<span id="cb192-12"><a href="nonlinear-regression.html#cb192-12" tabindex="-1"></a><span class="do">## 8    70   1.90</span></span>
<span id="cb192-13"><a href="nonlinear-regression.html#cb192-13" tabindex="-1"></a><span class="do">## 9     0 102.30</span></span>
<span id="cb192-14"><a href="nonlinear-regression.html#cb192-14" tabindex="-1"></a><span class="do">## 10   10  49.20</span></span></code></pre></div>
<p>It is always very useful to take a look at the observed data, by plotting the response against the predictor (Figure <a href="nonlinear-regression.html#fig:figName150">14.1</a>); we see that the trend is curvilinear, which rules out the use of simple linear regression.</p>
<p>In order to build a nonlinear regression model, we can use the general form introduced in Chapter 4, that is:</p>
<p><span class="math display">\[Y_i = f(X_i, \theta) + \varepsilon_i\]</span></p>
<p>where <span class="math inline">\(X\)</span> is the time, <span class="math inline">\(Y\)</span> is the concentration, <span class="math inline">\(f\)</span> is a nonlinear function, <span class="math inline">\(\theta\)</span> is the set of model parameters and <span class="math inline">\(\varepsilon\)</span> are the residuals, assumed as independent, gaussian and homoscedastic.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figName150"></span>
<img src="_main_files/figure-html/figName150-1.png" alt="Degradation of metamitron in soil" width="90%" />
<p class="caption">
Figure 14.1: Degradation of metamitron in soil
</p>
</div>
</div>
<div id="model-selection" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> Model selection<a href="nonlinear-regression.html#model-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first task is to select a function <span class="math inline">\(f\)</span> that matches the observed response shape. You can find full detail elsewhere (go to <a href="https://www.statforbiology.com/2020/stat_nls_usefulfunctions/">this link</a>). For now, we can look at Figure <a href="nonlinear-regression.html#fig:figName151">14.2</a>, where we have displayed the shapes of some useful functions for nonlinear regression analysis in agricultural studies. We distinguish:</p>
<ol style="list-style-type: decimal">
<li>Convex/concave shapes (e.g., quadratic polynomial, exponential growth/decay, asymptotic growth, power curve and rectangular hyperbola)</li>
<li>Sigmoidal shapes (e.g., logistic growth, Gompertz growth and log-logistic dose-response)</li>
<li>Curves with maxima/minima (e.g., Bragg’s function)</li>
</ol>
<p>In the above list, the quadratic polynomial is a curvilinear model, but it is linear in the parameters and, therefore, it should have been better included in the previous Chapter about linear regression. However, we decided to include it here, considering its concave shape.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figName151"></span>
<img src="_images/nonLinearCurves.png" alt="The shapes of the most important functions" width="95%" />
<p class="caption">
Figure 14.2: The shapes of the most important functions
</p>
</div>
<p>Behind each of the above shapes, there is a mathematical function, which is shown in Figure <a href="nonlinear-regression.html#fig:figName151bis">14.3</a> ).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figName151bis"></span>
<img src="_images/nonLinearEquations.png" alt="Some useful functions for nonlinear regression analysis (equation and R function)." width="95%" />
<p class="caption">
Figure 14.3: Some useful functions for nonlinear regression analysis (equation and R function).
</p>
</div>
<p>For the dataset under study, considering the shapes in Figure <a href="nonlinear-regression.html#fig:figName151">14.2</a> and, above all, considering the available literature information, we select an exponential decay equation, with the following form (see also Fig. <a href="nonlinear-regression.html#fig:figName151bis">14.3</a> ):</p>
<p><span class="math display">\[Y_i = a \, e^{-k \,X_i} + \varepsilon_i\]</span></p>
<p>where <span class="math inline">\(Y\)</span> is the concentration at time <span class="math inline">\(X\)</span>, <span class="math inline">\(a\)</span> is the initial metamitron concentration and <span class="math inline">\(k\)</span> is the constant degradation rate.</p>
</div>
<div id="parameter-estimation-3" class="section level2 hasAnchor" number="14.3">
<h2><span class="header-section-number">14.3</span> Parameter estimation<a href="nonlinear-regression.html#parameter-estimation-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, we have to obtain the least squares estimates of the parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(k\)</span>. Unfortunately, with nonlinear regression, the least squares problem has no closed form solution and, therefore, we need to tackle the estimation problem in a different way. In general, there are three possibilities</p>
<ol style="list-style-type: decimal">
<li>linearise the nonlinear function;</li>
<li>approximate the nonlinear function by using a polynomial;</li>
<li>use numerical methods for the minimisation.</li>
</ol>
<p>Let’s see advantages and disadvantages of all methods.</p>
<div id="linearisation" class="section level3 hasAnchor" number="14.3.1">
<h3><span class="header-section-number">14.3.1</span> Linearisation<a href="nonlinear-regression.html#linearisation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In some cases, we can modify the function to make it linear. In this case, we can take the logarithm of both sides and define the following equation:</p>
<p><span class="math display">\[ \log(Y) = \log(A) - k \, X \]</span></p>
<p>which is, indeed, linear. Therefore, we can take the logarithms of the concentrations and fit a linear model, by using the <code>lm()</code> function:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="nonlinear-regression.html#cb193-1" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Conc) <span class="sc">~</span> Time, <span class="at">data=</span>dataset)</span>
<span id="cb193-2"><a href="nonlinear-regression.html#cb193-2" tabindex="-1"></a><span class="fu">summary</span>(mod)</span>
<span id="cb193-3"><a href="nonlinear-regression.html#cb193-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb193-4"><a href="nonlinear-regression.html#cb193-4" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb193-5"><a href="nonlinear-regression.html#cb193-5" tabindex="-1"></a><span class="do">## lm(formula = log(Conc) ~ Time, data = dataset)</span></span>
<span id="cb193-6"><a href="nonlinear-regression.html#cb193-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb193-7"><a href="nonlinear-regression.html#cb193-7" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb193-8"><a href="nonlinear-regression.html#cb193-8" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb193-9"><a href="nonlinear-regression.html#cb193-9" tabindex="-1"></a><span class="do">## -2.11738 -0.09583  0.05336  0.31166  1.01243 </span></span>
<span id="cb193-10"><a href="nonlinear-regression.html#cb193-10" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb193-11"><a href="nonlinear-regression.html#cb193-11" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb193-12"><a href="nonlinear-regression.html#cb193-12" tabindex="-1"></a><span class="do">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb193-13"><a href="nonlinear-regression.html#cb193-13" tabindex="-1"></a><span class="do">## (Intercept)  4.662874   0.257325   18.12 1.04e-14 ***</span></span>
<span id="cb193-14"><a href="nonlinear-regression.html#cb193-14" tabindex="-1"></a><span class="do">## Time        -0.071906   0.006151  -11.69 6.56e-11 ***</span></span>
<span id="cb193-15"><a href="nonlinear-regression.html#cb193-15" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb193-16"><a href="nonlinear-regression.html#cb193-16" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb193-17"><a href="nonlinear-regression.html#cb193-17" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb193-18"><a href="nonlinear-regression.html#cb193-18" tabindex="-1"></a><span class="do">## Residual standard error: 0.6905 on 22 degrees of freedom</span></span>
<span id="cb193-19"><a href="nonlinear-regression.html#cb193-19" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.8613, Adjusted R-squared:  0.855 </span></span>
<span id="cb193-20"><a href="nonlinear-regression.html#cb193-20" tabindex="-1"></a><span class="do">## F-statistic: 136.6 on 1 and 22 DF,  p-value: 6.564e-11</span></span></code></pre></div>
<p>We see that the slope has a negative sign (the line is decreasing) and the intercept is not the initial concentration value, but its logarithm.</p>
<p>The advantage of this process is that the calculations are very easily performed with every spreadsheet or simple calculator. However, we need to check that the basic assumptions of normal and homoscedastic residuals hold in the logarithmic scale. We do this in the following box.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="nonlinear-regression.html#cb194-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb194-2"><a href="nonlinear-regression.html#cb194-2" tabindex="-1"></a><span class="fu">plot</span>(mod, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb194-3"><a href="nonlinear-regression.html#cb194-3" tabindex="-1"></a><span class="fu">plot</span>(mod, <span class="at">which =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figName152"></span>
<img src="_main_files/figure-html/figName152-1.png" alt="Graphical analyses of residuals for nonlinear regression with linearisation of the mean function" width="90%" />
<p class="caption">
Figure 14.4: Graphical analyses of residuals for nonlinear regression with linearisation of the mean function
</p>
</div>
<p>The plots show dramatic deviations from homoscedasticity (Figure <a href="nonlinear-regression.html#fig:figName152">14.4</a> ), which rule out the use of the linearisation method. Please, consider that this conclusion is specific to our dataset, while, in general, the linearisation method can be successfully used, whenever the basic assumptions for linear models appear to hold for the transformed response.</p>
</div>
<div id="approximation-with-a-polynomial-function" class="section level3 hasAnchor" number="14.3.2">
<h3><span class="header-section-number">14.3.2</span> Approximation with a polynomial function<a href="nonlinear-regression.html#approximation-with-a-polynomial-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In some other cases, a curvilinear shape can be approximated by using a polynomial equation, that is, indeed, linear in the parameters. In our example, we could think of the descending part of a second order polynomial (see Figure <a href="nonlinear-regression.html#fig:figName152">14.4</a>) and, thus, we fit this model by the usual <code>lm()</code> function:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="nonlinear-regression.html#cb195-1" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Conc <span class="sc">~</span> Time <span class="sc">+</span> <span class="fu">I</span>(Time<span class="sc">^</span><span class="dv">2</span>), <span class="at">data=</span>dataset)</span>
<span id="cb195-2"><a href="nonlinear-regression.html#cb195-2" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod2, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Time =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">70</span>, <span class="at">by =</span> <span class="fl">0.1</span>)))</span>
<span id="cb195-3"><a href="nonlinear-regression.html#cb195-3" tabindex="-1"></a><span class="fu">plot</span>(Conc <span class="sc">~</span> Time, <span class="at">data=</span>dataset)</span>
<span id="cb195-4"><a href="nonlinear-regression.html#cb195-4" tabindex="-1"></a><span class="fu">lines</span>(pred <span class="sc">~</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">70</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figName153"></span>
<img src="_main_files/figure-html/figName153-1.png" alt="Approximating a degradation kinetic by using a second order polynomial" width="90%" />
<p class="caption">
Figure 14.5: Approximating a degradation kinetic by using a second order polynomial
</p>
</div>
<p>We see that the approximation is good up to 40 days after the beginning of the experiment. Later on, the fitted function appears to deviate from the observed pattern, depicting an unrealistic concentration increase from 55 days onwards (Figure <a href="nonlinear-regression.html#fig:figName153">14.5</a>). Clearly, the use of polynomials may be useful in some other instances, but it not a suitable solution for this case.</p>
</div>
<div id="nonlinear-least-squares" class="section level3 hasAnchor" number="14.3.3">
<h3><span class="header-section-number">14.3.3</span> Nonlinear least squares<a href="nonlinear-regression.html#nonlinear-least-squares" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The third possibility consists of using nonlinear least squares, based on the Gauss-Newton iterative algorithm. We need to provide reasonable initial estimates of model parameters and the algorithm updates them, iteratively, until it converges on the approximate least squares solution. Nowadays, thanks to the advent of modern computers, nonlinear least squares have become the most widespread nonlinear regression method, providing very good approximations for most practical needs.</p>
</div>
</div>
<div id="nonlinear-regression-with-r" class="section level2 hasAnchor" number="14.4">
<h2><span class="header-section-number">14.4</span> Nonlinear regression with R<a href="nonlinear-regression.html#nonlinear-regression-with-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Considering the base R installation, nonlinear least squares regression is implemented in the <code>nls()</code> function. The syntax is very similar to that of the <code>lm()</code> function, although we need to provide reasonable initial values for model parameters. In this case, obtaining such values is relatively easy: <span class="math inline">\(a\)</span> is the initial concentration and, by looking at the data, we can set this value to 100. The parameter <span class="math inline">\(k\)</span> is the constant degradation rate, i.e. the percentage daily reduction in concentration; we see that the concentration drops by 50% in ten days, thus we could assume that there is a daily 5% drop (k = 0.05). With such an information, we fit the model, as shown in the box below.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="nonlinear-regression.html#cb196-1" tabindex="-1"></a>modNlin <span class="ot">&lt;-</span> <span class="fu">nls</span>(Conc <span class="sc">~</span> A<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>k<span class="sc">*</span>Time), </span>
<span id="cb196-2"><a href="nonlinear-regression.html#cb196-2" tabindex="-1"></a>               <span class="at">start=</span><span class="fu">list</span>(<span class="at">A=</span><span class="dv">100</span>, <span class="at">k=</span><span class="fl">0.05</span>), </span>
<span id="cb196-3"><a href="nonlinear-regression.html#cb196-3" tabindex="-1"></a>               <span class="at">data =</span> dataset)</span>
<span id="cb196-4"><a href="nonlinear-regression.html#cb196-4" tabindex="-1"></a><span class="fu">summary</span>(modNlin)</span>
<span id="cb196-5"><a href="nonlinear-regression.html#cb196-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb196-6"><a href="nonlinear-regression.html#cb196-6" tabindex="-1"></a><span class="do">## Formula: Conc ~ A * exp(-k * Time)</span></span>
<span id="cb196-7"><a href="nonlinear-regression.html#cb196-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb196-8"><a href="nonlinear-regression.html#cb196-8" tabindex="-1"></a><span class="do">## Parameters:</span></span>
<span id="cb196-9"><a href="nonlinear-regression.html#cb196-9" tabindex="-1"></a><span class="do">##    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb196-10"><a href="nonlinear-regression.html#cb196-10" tabindex="-1"></a><span class="do">## A 99.634902   1.461047   68.19   &lt;2e-16 ***</span></span>
<span id="cb196-11"><a href="nonlinear-regression.html#cb196-11" tabindex="-1"></a><span class="do">## k  0.067039   0.001887   35.53   &lt;2e-16 ***</span></span>
<span id="cb196-12"><a href="nonlinear-regression.html#cb196-12" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb196-13"><a href="nonlinear-regression.html#cb196-13" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb196-14"><a href="nonlinear-regression.html#cb196-14" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb196-15"><a href="nonlinear-regression.html#cb196-15" tabindex="-1"></a><span class="do">## Residual standard error: 2.621 on 22 degrees of freedom</span></span>
<span id="cb196-16"><a href="nonlinear-regression.html#cb196-16" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb196-17"><a href="nonlinear-regression.html#cb196-17" tabindex="-1"></a><span class="do">## Number of iterations to convergence: 5 </span></span>
<span id="cb196-18"><a href="nonlinear-regression.html#cb196-18" tabindex="-1"></a><span class="do">## Achieved convergence tolerance: 4.33e-07</span></span></code></pre></div>
<p>Instead of coding the mean model from the scratch, we can use one of the available self-starting functions (Fig. <a href="nonlinear-regression.html#fig:figName151bis">14.3</a> ), which are associated to self-starting routines. This is very useful, as the self-starting functions do not need initial estimates and, thus, we are free from the task of providing them, which is rather difficult for beginners. Indeed, if our initial guesses are not close enough to least squares estimates, the algorithm may freeze during the estimation process and may not reach convergence. Self-starting functions are available within the ‘aomisc’ which needs to be installed from github prior to fitting the model.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="nonlinear-regression.html#cb197-1" tabindex="-1"></a><span class="co"># Installation is required only once</span></span>
<span id="cb197-2"><a href="nonlinear-regression.html#cb197-2" tabindex="-1"></a><span class="co"># library(devtools)</span></span>
<span id="cb197-3"><a href="nonlinear-regression.html#cb197-3" tabindex="-1"></a><span class="co"># install_github(&quot;onofriandreapg/aomisc&quot;)</span></span>
<span id="cb197-4"><a href="nonlinear-regression.html#cb197-4" tabindex="-1"></a><span class="fu">library</span>(aomisc)</span>
<span id="cb197-5"><a href="nonlinear-regression.html#cb197-5" tabindex="-1"></a>modNlin2 <span class="ot">&lt;-</span> <span class="fu">nls</span>(Conc <span class="sc">~</span> <span class="fu">NLS.expoDecay</span>(Time, a, k),</span>
<span id="cb197-6"><a href="nonlinear-regression.html#cb197-6" tabindex="-1"></a>               <span class="at">data =</span> dataset)</span></code></pre></div>
</div>
<div id="checking-the-model" class="section level2 hasAnchor" number="14.5">
<h2><span class="header-section-number">14.5</span> Checking the model<a href="nonlinear-regression.html#checking-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While the estimation of model parameters is performed by using numerical methods, checking a fitted model is done by using the very same methods as shown for simple linear regression, with slight differences. In the following section we will show some of the R methods for nonlinear models, which can be used on ‘nls’ objects.</p>
<div id="graphical-analyses-of-residuals" class="section level3 hasAnchor" number="14.5.1">
<h3><span class="header-section-number">14.5.1</span> Graphical analyses of residuals<a href="nonlinear-regression.html#graphical-analyses-of-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First of all, we check the basic assumptions of normality and homoscedasticity of model residuals, by the usual diagnostic plots. We can us the <code>plotnls()</code> function, as available in the ‘aomisc’ package.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="nonlinear-regression.html#cb198-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb198-2"><a href="nonlinear-regression.html#cb198-2" tabindex="-1"></a><span class="fu">plot</span>(modNlin, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb198-3"><a href="nonlinear-regression.html#cb198-3" tabindex="-1"></a><span class="fu">plot</span>(modNlin, <span class="at">which =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figName154"></span>
<img src="_main_files/figure-html/figName154-1.png" alt="Graphical analyses of residuals relating to the degradation of metamitron in soil." width="90%" />
<p class="caption">
Figure 14.6: Graphical analyses of residuals relating to the degradation of metamitron in soil.
</p>
</div>
<p>Figure <a href="nonlinear-regression.html#fig:figName154">14.6</a> does not show any visible deviations and, thus, we proceed to plotting the observed data along with model predictions (Figure <a href="nonlinear-regression.html#fig:figName155">14.7</a>), e.g., by using the <code>plotnls()</code> function, in the ‘aomisc’ package.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="nonlinear-regression.html#cb199-1" tabindex="-1"></a><span class="fu">plot</span>(modNlin, <span class="at">type =</span> <span class="st">&quot;means&quot;</span>,</span>
<span id="cb199-2"><a href="nonlinear-regression.html#cb199-2" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Time (d)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Concentration (ng/g)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figName155"></span>
<img src="_main_files/figure-html/figName155-1.png" alt="Degradation kinetic for metamitron in soil: symbols show the observed data, the red line shows the fitted equation" width="90%" />
<p class="caption">
Figure 14.7: Degradation kinetic for metamitron in soil: symbols show the observed data, the red line shows the fitted equation
</p>
</div>
</div>
<div id="approximate-f-test-for-lack-of-fit" class="section level3 hasAnchor" number="14.5.2">
<h3><span class="header-section-number">14.5.2</span> Approximate F test for lack of fit<a href="nonlinear-regression.html#approximate-f-test-for-lack-of-fit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If we have replicates, we can fit an ANOVA model and compare this latter model to the nonlinear regression model, as we have already shown in Chapter 13, for linear regression models (F test for lack of fit). With R, this test can be performed by using the <code>anova()</code> method and passing the two model objects as arguments. The box below shows that the null hypothesis of no lack of fit can be accepted.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="nonlinear-regression.html#cb200-1" tabindex="-1"></a>modAov <span class="ot">&lt;-</span> <span class="fu">lm</span>(Conc <span class="sc">~</span> <span class="fu">factor</span>(Time), <span class="at">data=</span>dataset)</span>
<span id="cb200-2"><a href="nonlinear-regression.html#cb200-2" tabindex="-1"></a><span class="fu">anova</span>(modNlin, modAov)</span>
<span id="cb200-3"><a href="nonlinear-regression.html#cb200-3" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb200-4"><a href="nonlinear-regression.html#cb200-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb200-5"><a href="nonlinear-regression.html#cb200-5" tabindex="-1"></a><span class="do">## Model 1: Conc ~ A * exp(-k * Time)</span></span>
<span id="cb200-6"><a href="nonlinear-regression.html#cb200-6" tabindex="-1"></a><span class="do">## Model 2: Conc ~ factor(Time)</span></span>
<span id="cb200-7"><a href="nonlinear-regression.html#cb200-7" tabindex="-1"></a><span class="do">##   Res.Df Res.Sum Sq Df Sum Sq F value Pr(&gt;F)</span></span>
<span id="cb200-8"><a href="nonlinear-regression.html#cb200-8" tabindex="-1"></a><span class="do">## 1     22     151.18                         </span></span>
<span id="cb200-9"><a href="nonlinear-regression.html#cb200-9" tabindex="-1"></a><span class="do">## 2     16     135.94  6 15.238  0.2989 0.9284</span></span></code></pre></div>
</div>
<div id="the-coefficient-of-determination-r2" class="section level3 hasAnchor" number="14.5.3">
<h3><span class="header-section-number">14.5.3</span> The coefficient of determination (R<sup>2</sup>)<a href="nonlinear-regression.html#the-coefficient-of-determination-r2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The R<sup>2</sup> coefficient in nonlinear regression should not be used as a measure of goodness of fit, because it represents the ratio between the residual deviances for the model under comparison and for a model with the only intercept (see previous chapter). Some non-linear models do not have an intercept and, therefore, the R<sup>2</sup> value is not meaningful and can also assume values outside the range from 0 to 1.</p>
<p>Such an argument can be, at least partly, overcame by using the <strong>Pseudo R<sup>2</sup></strong> (Schabenberger and Pierce, 2002), that is the proportion of variance explained by the regression effect:</p>
<p><span class="math display">\[R_a^2  = 1 - \frac{MSE}{MST}\]</span></p>
<p>where MSE is the residual mean square and MST is total mean square. For our example:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="nonlinear-regression.html#cb201-1" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> <span class="fu">summary</span>(modNlin)<span class="sc">$</span>sigma <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb201-2"><a href="nonlinear-regression.html#cb201-2" tabindex="-1"></a>MST <span class="ot">&lt;-</span> <span class="fu">var</span>(dataset<span class="sc">$</span>Conc)</span>
<span id="cb201-3"><a href="nonlinear-regression.html#cb201-3" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> MSE<span class="sc">/</span>MST</span>
<span id="cb201-4"><a href="nonlinear-regression.html#cb201-4" tabindex="-1"></a><span class="do">## [1] 0.9936359</span></span></code></pre></div>
<p>Whenever necessary, The Pseudo-R<sup>2</sup> value can be obtained by using the <code>R2nls()</code> function, in the ‘aomisc’ package, as shown in the box below.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="nonlinear-regression.html#cb202-1" tabindex="-1"></a><span class="fu">R2nls</span>(modNlin)<span class="sc">$</span>PseudoR2</span>
<span id="cb202-2"><a href="nonlinear-regression.html#cb202-2" tabindex="-1"></a><span class="do">## [1] 0.9939126</span></span></code></pre></div>
</div>
</div>
<div id="stabilising-transformations-1" class="section level2 hasAnchor" number="14.6">
<h2><span class="header-section-number">14.6</span> Stabilising transformations<a href="nonlinear-regression.html#stabilising-transformations-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In some cases, it may happen that the model does not fit the data (<strong>lack of fit</strong>) or that the residuals are not gaussian and homoscedastic. In the first case, we have to discard the model and select a new one, that fits better to the observed data.</p>
<p>In the other cases (heteroscedastic or non-normal residuals), similarly to linear regression, we should adopt some sort of stabilising transformations, possibly selected by using the Box-Cox method. However, nonlinear regression poses an additional issue, that we should keep into account. Indeed, in most cases, the parameters of nonlinear models are characterised by a clear biological meaning, such as, for example, the parameter <span class="math inline">\(a\)</span> in the exponential equation above, that is the initial concentration value. If we transform the response into, e.g., its logarithm, the estimated <span class="math inline">\(a\)</span> represents the logarithm of the initial concentration and its biological meaning is lost.</p>
<p>In order to avoid such a problem and obtain parameter estimates in their original scale, the ‘transform-both-sides’ approach is feasible, where we use the Box-Cox family of transformations (see Chapter 8) to transform both the response and the model:</p>
<p><span class="math display">\[Y_i^\lambda  = f(X_i)^\lambda + \varepsilon_i\]</span></p>
<p>In order to use this technique in R, we can use the <code>boxcox.nls()</code> method in the ‘aomisc’ package, that is very similar to the ‘boxcox()’ method in the MASS package (see Chapter 8). The <code>boxcox.nls()</code> method returns the maximum likelihood value for <span class="math inline">\(\lambda\)</span> with confidence intervals and a likelihood graph as a function of <span class="math inline">\(\lambda\)</span> can also be obtained by using the argument ‘plotit = T’</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="nonlinear-regression.html#cb203-1" tabindex="-1"></a>bc <span class="ot">&lt;-</span> <span class="fu">boxcox</span>(modNlin)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-205-1.png" /><!-- --></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="nonlinear-regression.html#cb204-1" tabindex="-1"></a>bc<span class="sc">$</span>lambda</span>
<span id="cb204-2"><a href="nonlinear-regression.html#cb204-2" tabindex="-1"></a><span class="do">## $lambda</span></span>
<span id="cb204-3"><a href="nonlinear-regression.html#cb204-3" tabindex="-1"></a><span class="do">## [1] 0.8</span></span>
<span id="cb204-4"><a href="nonlinear-regression.html#cb204-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb204-5"><a href="nonlinear-regression.html#cb204-5" tabindex="-1"></a><span class="do">## $ci</span></span>
<span id="cb204-6"><a href="nonlinear-regression.html#cb204-6" tabindex="-1"></a><span class="do">## [1] 0.5619080 0.9637162</span></span>
<span id="cb204-7"><a href="nonlinear-regression.html#cb204-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb204-8"><a href="nonlinear-regression.html#cb204-8" tabindex="-1"></a><span class="do">## $loglik</span></span>
<span id="cb204-9"><a href="nonlinear-regression.html#cb204-9" tabindex="-1"></a><span class="do">## [1] -31.55224</span></span></code></pre></div>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="nonlinear-regression.html#cb205-1" tabindex="-1"></a><span class="fu">boxcox</span>(modNlin, <span class="at">plotit =</span> T)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figName156"></span>
<img src="_main_files/figure-html/figName156-1.png" alt="Selection of the 'lambda' value for the Box-Cox transformation of a nonlinear regression model" width="90%" />
<p class="caption">
Figure 14.8: Selection of the ‘lambda’ value for the Box-Cox transformation of a nonlinear regression model
</p>
</div>
<p>From Figure <a href="nonlinear-regression.html#fig:figName156">14.8</a>, we see that the transformation is not required, although a value <span class="math inline">\(\lambda\)</span> = 0.5 (square-root transformation; see previous chapter) might be used to maximise the likelihood of the data under the selected model. We can specify our favourite <span class="math inline">\(\lambda\)</span> value and get the corresponding fit by using the same <code>boxcox.nsl()</code> function and passing an extra-argument, as shown in the box below.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="nonlinear-regression.html#cb206-1" tabindex="-1"></a>modNlin3 <span class="ot">&lt;-</span> <span class="fu">boxcox</span>(modNlin, <span class="at">lambda =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-206-1.png" /><!-- --></p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="nonlinear-regression.html#cb207-1" tabindex="-1"></a><span class="fu">summary</span>(modNlin3)</span>
<span id="cb207-2"><a href="nonlinear-regression.html#cb207-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb207-3"><a href="nonlinear-regression.html#cb207-3" tabindex="-1"></a><span class="do">## Estimated lambda: 0.5 </span></span>
<span id="cb207-4"><a href="nonlinear-regression.html#cb207-4" tabindex="-1"></a><span class="do">## Confidence interval for lambda: [NA,NA]</span></span>
<span id="cb207-5"><a href="nonlinear-regression.html#cb207-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb207-6"><a href="nonlinear-regression.html#cb207-6" tabindex="-1"></a><span class="do">## Formula: newRes ~ eval(parse(text = newFormula), df)</span></span>
<span id="cb207-7"><a href="nonlinear-regression.html#cb207-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb207-8"><a href="nonlinear-regression.html#cb207-8" tabindex="-1"></a><span class="do">## Parameters:</span></span>
<span id="cb207-9"><a href="nonlinear-regression.html#cb207-9" tabindex="-1"></a><span class="do">##    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb207-10"><a href="nonlinear-regression.html#cb207-10" tabindex="-1"></a><span class="do">## A 99.532761   4.625343   21.52 2.87e-16 ***</span></span>
<span id="cb207-11"><a href="nonlinear-regression.html#cb207-11" tabindex="-1"></a><span class="do">## k  0.067068   0.002749   24.40  &lt; 2e-16 ***</span></span>
<span id="cb207-12"><a href="nonlinear-regression.html#cb207-12" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb207-13"><a href="nonlinear-regression.html#cb207-13" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb207-14"><a href="nonlinear-regression.html#cb207-14" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb207-15"><a href="nonlinear-regression.html#cb207-15" tabindex="-1"></a><span class="do">## Residual standard error: 0.9196 on 22 degrees of freedom</span></span>
<span id="cb207-16"><a href="nonlinear-regression.html#cb207-16" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb207-17"><a href="nonlinear-regression.html#cb207-17" tabindex="-1"></a><span class="do">## Number of iterations to convergence: 1 </span></span>
<span id="cb207-18"><a href="nonlinear-regression.html#cb207-18" tabindex="-1"></a><span class="do">## Achieved convergence tolerance: 7.541e-06</span></span></code></pre></div>
<p>We see that, in spite of the stabilising transformation, the estimated parameters have not lost their measurement unit.</p>
</div>
<div id="making-predictions-1" class="section level2 hasAnchor" number="14.7">
<h2><span class="header-section-number">14.7</span> Making predictions<a href="nonlinear-regression.html#making-predictions-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As shown for linear regression in Chapter 13, every fitted model can be used to make predictions, i.e. to calculate the response for a given X-value or to calculate the X-value corresponding to a given response.</p>
<p>Analogously to linear regression, we could make predictions by using the <code>predict()</code> method, although, for nonlinear regression objects, this method does not return standard errors. Therefore, we can use the <code>gnlht()</code> function in the ‘aomisc’ package, which requires the following arguments:</p>
<ol style="list-style-type: decimal">
<li>a list of functions containing model parameters (with the same names as the fitted model) and, possibly, some other parameters</li>
<li>if the previous function contain further parameters with respect to the fitted model, their values need to be given in a data frame as an extra-argument</li>
</ol>
<p>In the box below we make predictions for the response at 5, 10 and 15 days after the beginning of the experiment.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="nonlinear-regression.html#cb208-1" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="sc">~</span>A <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>k <span class="sc">*</span> time))</span>
<span id="cb208-2"><a href="nonlinear-regression.html#cb208-2" tabindex="-1"></a>const <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>)) </span>
<span id="cb208-3"><a href="nonlinear-regression.html#cb208-3" tabindex="-1"></a><span class="fu">gnlht</span>(modNlin, func,  const)</span>
<span id="cb208-4"><a href="nonlinear-regression.html#cb208-4" tabindex="-1"></a><span class="do">##                 Form time Estimate        SE  t-value      p-value</span></span>
<span id="cb208-5"><a href="nonlinear-regression.html#cb208-5" tabindex="-1"></a><span class="do">## 1 A * exp(-k * time)    5 71.25873 0.9505532 74.96553 5.340741e-28</span></span>
<span id="cb208-6"><a href="nonlinear-regression.html#cb208-6" tabindex="-1"></a><span class="do">## 2 A * exp(-k * time)   10 50.96413 0.9100611 56.00078 3.163518e-25</span></span>
<span id="cb208-7"><a href="nonlinear-regression.html#cb208-7" tabindex="-1"></a><span class="do">## 3 A * exp(-k * time)   15 36.44947 0.9205315 39.59611 6.029672e-22</span></span></code></pre></div>
<p>The same method can be used to make inverse predictions. In our case, the inverse function is:</p>
<p><span class="math display">\[X = - \frac{log \left( \frac{Y}{A} \right)}{k}\]</span></p>
<p>We can calculate the times required for the concentration to drop to, e.g., 10 and 20 mg/g by using the code in the following box.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="nonlinear-regression.html#cb209-1" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="sc">-</span>(<span class="fu">log</span>(Conc<span class="sc">/</span>A)<span class="sc">/</span>k))</span>
<span id="cb209-2"><a href="nonlinear-regression.html#cb209-2" tabindex="-1"></a>const <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Conc =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>)) </span>
<span id="cb209-3"><a href="nonlinear-regression.html#cb209-3" tabindex="-1"></a><span class="fu">gnlht</span>(modNlin, func,  const)</span>
<span id="cb209-4"><a href="nonlinear-regression.html#cb209-4" tabindex="-1"></a><span class="do">##               Form Conc Estimate        SE  t-value      p-value</span></span>
<span id="cb209-5"><a href="nonlinear-regression.html#cb209-5" tabindex="-1"></a><span class="do">## 1 -(log(Conc/A)/k)   10 34.29237 0.8871429 38.65484 1.016347e-21</span></span>
<span id="cb209-6"><a href="nonlinear-regression.html#cb209-6" tabindex="-1"></a><span class="do">## 2 -(log(Conc/A)/k)   20 23.95291 0.6065930 39.48761 6.399715e-22</span></span></code></pre></div>
<p>In the same fashion, we can calculate the half-life (i.e. the time required for the concentration to drop to half of the initial value), by considering that:</p>
<p><span class="math display">\[t_{1/2} = - \frac{ \log \left( {\frac{1}{2}} \right) }{k}\]</span></p>
<p>The code is::</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="nonlinear-regression.html#cb210-1" tabindex="-1"></a>func <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="sc">~</span> <span class="sc">-</span>(<span class="fu">log</span>(<span class="fl">0.5</span>)<span class="sc">/</span>k))</span>
<span id="cb210-2"><a href="nonlinear-regression.html#cb210-2" tabindex="-1"></a><span class="fu">gnlht</span>(modNlin, func)</span>
<span id="cb210-3"><a href="nonlinear-regression.html#cb210-3" tabindex="-1"></a><span class="do">##            Form Estimate       SE t-value      p-value</span></span>
<span id="cb210-4"><a href="nonlinear-regression.html#cb210-4" tabindex="-1"></a><span class="do">## 1 -(log(0.5)/k) 10.33945 0.291017 35.5287 6.318214e-21</span></span></code></pre></div>
<p>The ‘gnlht()’ function provides standard errors based on the delta method, which we have already introduced in a previous chapter.</p>
<hr />
</div>
<div id="further-readings-11" class="section level2 hasAnchor" number="14.8">
<h2><span class="header-section-number">14.8</span> Further readings<a href="nonlinear-regression.html#further-readings-11" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Bates, D.M., Watts, D.G., 1988. Nonlinear regression analysis &amp; its applications. John Wiley &amp; Sons, Inc., Books.</li>
<li>Bolker, B.M., 2008. Ecological models and data in R. Princeton University Press, Books.</li>
<li>Carroll, R.J., Ruppert, D., 1988. Transformation and weighting in regression. Chapman and Hall, Books.</li>
<li>Ratkowsky, D.A., 1990. Handbook of nonlinear regression models. Marcel Dekker Inc., Books.</li>
<li>Ritz, C., Streibig, J.C., 2008. Nonlinear regression with R. Springer-Verlag New York Inc., Books.</li>
<li>Schabenberger, O., Pierce, F.J., 2002. Contemporary statistical models for the plant and soil sciences. Taylor &amp; Francis, CRC Press</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-brief-intro-to-mixed-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exercises.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
