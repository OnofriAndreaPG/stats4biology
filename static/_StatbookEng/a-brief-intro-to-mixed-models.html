<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 A brief intro to mixed models | Experimental methods in agriculture</title>
  <meta name="description" content="Chapter 13 A brief intro to mixed models | Experimental methods in agriculture: a tutorial book with R" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 A brief intro to mixed models | Experimental methods in agriculture" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="http://www.casaonofri.it/images/coversmall.png" />
  <meta property="og:description" content="Chapter 13 A brief intro to mixed models | Experimental methods in agriculture: a tutorial book with R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 A brief intro to mixed models | Experimental methods in agriculture" />
  <meta name="twitter:site" content="@onofriandreapg" />
  <meta name="twitter:description" content="Chapter 13 A brief intro to mixed models | Experimental methods in agriculture: a tutorial book with R" />
  <meta name="twitter:image" content="http://www.casaonofri.it/images/coversmall.png" />

<meta name="author" content="Andrea Onofri and Dario Sacco" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simple-linear-regression.html"/>
<link rel="next" href="nonlinear-regression.html"/>
<script src="book_assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="book_assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="book_assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="book_assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131792052-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-131792052-1');
  </script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Experimental Methods</a></strong></li> 

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#aims"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-this-book-is-organised"><i class="fa fa-check"></i>How this book is organised</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#statistical-software"><i class="fa fa-check"></i>Statistical software</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-authors"><i class="fa fa-check"></i>The authors</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html"><i class="fa fa-check"></i><b>1</b> Science and pseudoscience</a>
<ul>
<li class="chapter" data-level="1.1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#science-needs-data"><i class="fa fa-check"></i><b>1.1</b> Science needs data</a></li>
<li class="chapter" data-level="1.2" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#not-all-data-support-science"><i class="fa fa-check"></i><b>1.2</b> Not all data support science</a></li>
<li class="chapter" data-level="1.3" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#good-data-is-based-on-good-methods"><i class="fa fa-check"></i><b>1.3</b> Good data is based on good ‘methods’</a></li>
<li class="chapter" data-level="1.4" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#the-falsification-principle"><i class="fa fa-check"></i><b>1.4</b> The ‘falsification’ principle</a></li>
<li class="chapter" data-level="1.5" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#trying-to-falsify-a-result"><i class="fa fa-check"></i><b>1.5</b> Trying to falsify a result</a></li>
<li class="chapter" data-level="1.6" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#the-basic-principles-of-experimental-design"><i class="fa fa-check"></i><b>1.6</b> The basic principles of experimental design</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#control"><i class="fa fa-check"></i><b>1.6.1</b> Control</a></li>
<li class="chapter" data-level="1.6.2" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#replication"><i class="fa fa-check"></i><b>1.6.2</b> Replication</a></li>
<li class="chapter" data-level="1.6.3" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#randomisation"><i class="fa fa-check"></i><b>1.6.3</b> Randomisation</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#invalid-experiments"><i class="fa fa-check"></i><b>1.7</b> Invalid experiments</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#lack-of-good-control"><i class="fa fa-check"></i><b>1.7.1</b> Lack of good control</a></li>
<li class="chapter" data-level="1.7.2" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#confounding-and-spurious-correlation"><i class="fa fa-check"></i><b>1.7.2</b> ‘Confounding’ and spurious correlation</a></li>
<li class="chapter" data-level="1.7.3" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#lack-of-true-replicates-or-careless-randomisation"><i class="fa fa-check"></i><b>1.7.3</b> Lack of true-replicates or careless randomisation</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#how-can-we-assess-whether-the-data-is-valid"><i class="fa fa-check"></i><b>1.8</b> How can we assess whether the data is valid?</a></li>
<li class="chapter" data-level="1.9" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#conclusions"><i class="fa fa-check"></i><b>1.9</b> Conclusions</a></li>
<li class="chapter" data-level="1.10" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#further-readings"><i class="fa fa-check"></i><b>1.10</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="designing-experiments.html"><a href="designing-experiments.html"><i class="fa fa-check"></i><b>2</b> Designing experiments</a>
<ul>
<li class="chapter" data-level="2.1" data-path="designing-experiments.html"><a href="designing-experiments.html#the-elements-of-research"><i class="fa fa-check"></i><b>2.1</b> The elements of research</a></li>
<li class="chapter" data-level="2.2" data-path="designing-experiments.html"><a href="designing-experiments.html#hypothesis-and-objectives"><i class="fa fa-check"></i><b>2.2</b> Hypothesis and objectives</a></li>
<li class="chapter" data-level="2.3" data-path="designing-experiments.html"><a href="designing-experiments.html#the-experimental-treatments"><i class="fa fa-check"></i><b>2.3</b> The experimental treatments</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="designing-experiments.html"><a href="designing-experiments.html#factorial-experiments"><i class="fa fa-check"></i><b>2.3.1</b> Factorial experiments</a></li>
<li class="chapter" data-level="2.3.2" data-path="designing-experiments.html"><a href="designing-experiments.html#the-control"><i class="fa fa-check"></i><b>2.3.2</b> The control</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="designing-experiments.html"><a href="designing-experiments.html#the-experimental-units"><i class="fa fa-check"></i><b>2.4</b> The experimental units</a></li>
<li class="chapter" data-level="2.5" data-path="designing-experiments.html"><a href="designing-experiments.html#the-allocation-of-treatments"><i class="fa fa-check"></i><b>2.5</b> The allocation of treatments</a></li>
<li class="chapter" data-level="2.6" data-path="designing-experiments.html"><a href="designing-experiments.html#the-variables"><i class="fa fa-check"></i><b>2.6</b> The variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="designing-experiments.html"><a href="designing-experiments.html#nominal-variables"><i class="fa fa-check"></i><b>2.6.1</b> Nominal variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="designing-experiments.html"><a href="designing-experiments.html#ordinal-variables"><i class="fa fa-check"></i><b>2.6.2</b> Ordinal variables</a></li>
<li class="chapter" data-level="2.6.3" data-path="designing-experiments.html"><a href="designing-experiments.html#count-and-ratio-variables"><i class="fa fa-check"></i><b>2.6.3</b> Count and ratio variables</a></li>
<li class="chapter" data-level="2.6.4" data-path="designing-experiments.html"><a href="designing-experiments.html#continuous-variables"><i class="fa fa-check"></i><b>2.6.4</b> Continuous variables</a></li>
<li class="chapter" data-level="2.6.5" data-path="designing-experiments.html"><a href="designing-experiments.html#sensory-and-visual-assessments"><i class="fa fa-check"></i><b>2.6.5</b> Sensory and visual assessments</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="designing-experiments.html"><a href="designing-experiments.html#setting-up-a-field-experiment"><i class="fa fa-check"></i><b>2.7</b> Setting up a field experiment</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="designing-experiments.html"><a href="designing-experiments.html#selecting-the-field"><i class="fa fa-check"></i><b>2.7.1</b> Selecting the field</a></li>
<li class="chapter" data-level="2.7.2" data-path="designing-experiments.html"><a href="designing-experiments.html#selecting-the-units-within-the-field"><i class="fa fa-check"></i><b>2.7.2</b> Selecting the units within the field</a></li>
<li class="chapter" data-level="2.7.3" data-path="designing-experiments.html"><a href="designing-experiments.html#number-of-replicates"><i class="fa fa-check"></i><b>2.7.3</b> Number of replicates</a></li>
<li class="chapter" data-level="2.7.4" data-path="designing-experiments.html"><a href="designing-experiments.html#the-field-map"><i class="fa fa-check"></i><b>2.7.4</b> The field map</a></li>
<li class="chapter" data-level="2.7.5" data-path="designing-experiments.html"><a href="designing-experiments.html#the-experimental-lay-out"><i class="fa fa-check"></i><b>2.7.5</b> The experimental lay-out</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="designing-experiments.html"><a href="designing-experiments.html#conclusions-1"><i class="fa fa-check"></i><b>2.8</b> Conclusions</a></li>
<li class="chapter" data-level="2.9" data-path="designing-experiments.html"><a href="designing-experiments.html#further-readings-1"><i class="fa fa-check"></i><b>2.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="describing-the-observations.html"><a href="describing-the-observations.html"><i class="fa fa-check"></i><b>3</b> Describing the observations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="describing-the-observations.html"><a href="describing-the-observations.html#quantitative-data"><i class="fa fa-check"></i><b>3.1</b> Quantitative data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="describing-the-observations.html"><a href="describing-the-observations.html#statistics-of-location"><i class="fa fa-check"></i><b>3.1.1</b> Statistics of location</a></li>
<li class="chapter" data-level="3.1.2" data-path="describing-the-observations.html"><a href="describing-the-observations.html#statistics-of-spread"><i class="fa fa-check"></i><b>3.1.2</b> Statistics of spread</a></li>
<li class="chapter" data-level="3.1.3" data-path="describing-the-observations.html"><a href="describing-the-observations.html#summing-the-uncertainty"><i class="fa fa-check"></i><b>3.1.3</b> Summing the uncertainty</a></li>
<li class="chapter" data-level="3.1.4" data-path="describing-the-observations.html"><a href="describing-the-observations.html#relationship-between-quantitative-variables"><i class="fa fa-check"></i><b>3.1.4</b> Relationship between quantitative variables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="describing-the-observations.html"><a href="describing-the-observations.html#nominal-data"><i class="fa fa-check"></i><b>3.2</b> Nominal data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="describing-the-observations.html"><a href="describing-the-observations.html#distributions-of-frequencies"><i class="fa fa-check"></i><b>3.2.1</b> Distributions of frequencies</a></li>
<li class="chapter" data-level="3.2.2" data-path="describing-the-observations.html"><a href="describing-the-observations.html#descriptive-stats-for-distributions-of-frequencies"><i class="fa fa-check"></i><b>3.2.2</b> Descriptive stats for distributions of frequencies</a></li>
<li class="chapter" data-level="3.2.3" data-path="describing-the-observations.html"><a href="describing-the-observations.html#contingency-tables"><i class="fa fa-check"></i><b>3.2.3</b> Contingency tables</a></li>
<li class="chapter" data-level="3.2.4" data-path="describing-the-observations.html"><a href="describing-the-observations.html#independence"><i class="fa fa-check"></i><b>3.2.4</b> Independence</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="describing-the-observations.html"><a href="describing-the-observations.html#descriptive-stats-with-r"><i class="fa fa-check"></i><b>3.3</b> Descriptive stats with R</a></li>
<li class="chapter" data-level="3.4" data-path="describing-the-observations.html"><a href="describing-the-observations.html#graphical-representations"><i class="fa fa-check"></i><b>3.4</b> Graphical representations</a></li>
<li class="chapter" data-level="3.5" data-path="describing-the-observations.html"><a href="describing-the-observations.html#further-reading"><i class="fa fa-check"></i><b>3.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html"><i class="fa fa-check"></i><b>4</b> Modeling the experimental data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#deterministic-models"><i class="fa fa-check"></i><b>4.1</b> Deterministic models</a></li>
<li class="chapter" data-level="4.2" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#stochastic-models"><i class="fa fa-check"></i><b>4.2</b> Stochastic models</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#probability-functions"><i class="fa fa-check"></i><b>4.2.1</b> Probability functions</a></li>
<li class="chapter" data-level="4.2.2" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#density-functions"><i class="fa fa-check"></i><b>4.2.2</b> Density functions</a></li>
<li class="chapter" data-level="4.2.3" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#the-gaussian-pdf-and-cdf"><i class="fa fa-check"></i><b>4.2.3</b> The Gaussian PDF and CDF</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#a-model-with-two-components"><i class="fa fa-check"></i><b>4.3</b> A model with two components</a></li>
<li class="chapter" data-level="4.4" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#and-so-what"><i class="fa fa-check"></i><b>4.4</b> And so what?</a></li>
<li class="chapter" data-level="4.5" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#monte-carlo-methods-to-simulate-an-experiment"><i class="fa fa-check"></i><b>4.5</b> Monte Carlo methods to simulate an experiment</a></li>
<li class="chapter" data-level="4.6" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#data-analysis-and-model-fitting"><i class="fa fa-check"></i><b>4.6</b> Data analysis and model fitting</a></li>
<li class="chapter" data-level="4.7" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#some-words-of-warning"><i class="fa fa-check"></i><b>4.7</b> Some words of warning</a></li>
<li class="chapter" data-level="4.8" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#further-readings-2"><i class="fa fa-check"></i><b>4.8</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html"><i class="fa fa-check"></i><b>5</b> Estimation of model parameters</a>
<ul>
<li class="chapter" data-level="5.1" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#example-1-a-concentration-value"><i class="fa fa-check"></i><b>5.1</b> Example 1: a concentration value</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#the-empirical-sampling-distribution"><i class="fa fa-check"></i><b>5.1.1</b> The empirical sampling distribution</a></li>
<li class="chapter" data-level="5.1.2" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#a-theoretical-sampling-distribution"><i class="fa fa-check"></i><b>5.1.2</b> A theoretical sampling distribution</a></li>
<li class="chapter" data-level="5.1.3" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#the-frequentist-confidence-interval"><i class="fa fa-check"></i><b>5.1.3</b> The frequentist confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#example-2-a-proportion"><i class="fa fa-check"></i><b>5.2</b> Example 2: a proportion</a></li>
<li class="chapter" data-level="5.3" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#conclusions-2"><i class="fa fa-check"></i><b>5.3</b> Conclusions</a></li>
<li class="chapter" data-level="5.4" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#further-readings-3"><i class="fa fa-check"></i><b>5.4</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html"><i class="fa fa-check"></i><b>6</b> Making Decisions under uncertainty</a>
<ul>
<li class="chapter" data-level="6.1" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#comparing-sample-means-the-students-t-test"><i class="fa fa-check"></i><b>6.1</b> Comparing sample means: the Student’s t-test</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#the-dataset"><i class="fa fa-check"></i><b>6.1.1</b> The dataset</a></li>
<li class="chapter" data-level="6.1.2" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#monte-carlo-simulation"><i class="fa fa-check"></i><b>6.1.2</b> Monte Carlo simulation</a></li>
<li class="chapter" data-level="6.1.3" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#a-formal-solution"><i class="fa fa-check"></i><b>6.1.3</b> A formal solution</a></li>
<li class="chapter" data-level="6.1.4" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#the-t-test-with-r"><i class="fa fa-check"></i><b>6.1.4</b> The t test with R</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#comparing-proportions-the-chi2-test"><i class="fa fa-check"></i><b>6.2</b> Comparing proportions: the <span class="math inline">\(\chi^2\)</span> test</a></li>
<li class="chapter" data-level="6.3" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#correct-interpretation-of-the-p-value"><i class="fa fa-check"></i><b>6.3</b> Correct interpretation of the P-value</a></li>
<li class="chapter" data-level="6.4" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#conclusions-3"><i class="fa fa-check"></i><b>6.4</b> Conclusions</a></li>
<li class="chapter" data-level="6.5" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#further-readings-4"><i class="fa fa-check"></i><b>6.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html"><i class="fa fa-check"></i><b>7</b> One-way ANOVA models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#comparing-herbicides-in-a-pot-experiment"><i class="fa fa-check"></i><b>7.1</b> Comparing herbicides in a pot-experiment</a></li>
<li class="chapter" data-level="7.2" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#data-description"><i class="fa fa-check"></i><b>7.2</b> Data description</a></li>
<li class="chapter" data-level="7.3" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#model-definition"><i class="fa fa-check"></i><b>7.3</b> Model definition</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#parameterisation"><i class="fa fa-check"></i><b>7.3.1</b> Parameterisation</a></li>
<li class="chapter" data-level="7.3.2" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#treatment-constraint"><i class="fa fa-check"></i><b>7.3.2</b> Treatment constraint</a></li>
<li class="chapter" data-level="7.3.3" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#sum-to-zero-constraint"><i class="fa fa-check"></i><b>7.3.3</b> Sum-to-zero constraint</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#basic-assumptions"><i class="fa fa-check"></i><b>7.4</b> Basic assumptions</a></li>
<li class="chapter" data-level="7.5" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#fitting-anova-models-by-hand"><i class="fa fa-check"></i><b>7.5</b> Fitting ANOVA models by hand</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#parameter-estimation"><i class="fa fa-check"></i><b>7.5.1</b> Parameter estimation</a></li>
<li class="chapter" data-level="7.5.2" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#residuals"><i class="fa fa-check"></i><b>7.5.2</b> Residuals</a></li>
<li class="chapter" data-level="7.5.3" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#standard-deviation-sigma"><i class="fa fa-check"></i><b>7.5.3</b> Standard deviation <span class="math inline">\(\sigma\)</span></a></li>
<li class="chapter" data-level="7.5.4" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#sem-and-sed"><i class="fa fa-check"></i><b>7.5.4</b> SEM and SED</a></li>
<li class="chapter" data-level="7.5.5" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#variance-partitioning"><i class="fa fa-check"></i><b>7.5.5</b> Variance partitioning</a></li>
<li class="chapter" data-level="7.5.6" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#hypothesis-testing"><i class="fa fa-check"></i><b>7.5.6</b> Hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#fitting-anova-models-with-r"><i class="fa fa-check"></i><b>7.6</b> Fitting ANOVA models with R</a></li>
<li class="chapter" data-level="7.7" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#expected-marginal-means"><i class="fa fa-check"></i><b>7.7</b> Expected marginal means</a></li>
<li class="chapter" data-level="7.8" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#conclusions-4"><i class="fa fa-check"></i><b>7.8</b> Conclusions</a></li>
<li class="chapter" data-level="7.9" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#further-readings-5"><i class="fa fa-check"></i><b>7.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html"><i class="fa fa-check"></i><b>8</b> Checking for the basic assumptions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#outlying-observations"><i class="fa fa-check"></i><b>8.1</b> Outlying observations</a></li>
<li class="chapter" data-level="8.2" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#the-inspection-of-residuals"><i class="fa fa-check"></i><b>8.2</b> The inspection of residuals</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#plot-of-residuals-against-expected-values"><i class="fa fa-check"></i><b>8.2.1</b> Plot of residuals against expected values</a></li>
<li class="chapter" data-level="8.2.2" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#qq-plot"><i class="fa fa-check"></i><b>8.2.2</b> QQ-plot</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#formal-hypotesis-testing"><i class="fa fa-check"></i><b>8.3</b> Formal hypotesis testing</a></li>
<li class="chapter" data-level="8.4" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#what-do-we-do-in-practice"><i class="fa fa-check"></i><b>8.4</b> What do we do, in practice?</a></li>
<li class="chapter" data-level="8.5" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#correcting-measures"><i class="fa fa-check"></i><b>8.5</b> Correcting measures</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#removing-outliers"><i class="fa fa-check"></i><b>8.5.1</b> Removing outliers</a></li>
<li class="chapter" data-level="8.5.2" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#stabilising-transformations"><i class="fa fa-check"></i><b>8.5.2</b> Stabilising transformations</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#examples-with-r"><i class="fa fa-check"></i><b>8.6</b> Examples with R</a></li>
<li class="chapter" data-level="8.7" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#example-1"><i class="fa fa-check"></i><b>8.7</b> Example 1</a></li>
<li class="chapter" data-level="8.8" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#example-2"><i class="fa fa-check"></i><b>8.8</b> Example 2</a></li>
<li class="chapter" data-level="8.9" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#other-possible-approaches"><i class="fa fa-check"></i><b>8.9</b> Other possible approaches</a></li>
<li class="chapter" data-level="8.10" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#further-readings-6"><i class="fa fa-check"></i><b>8.10</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html"><i class="fa fa-check"></i><b>9</b> Contrasts and multiple comparison testing</a>
<ul>
<li class="chapter" data-level="9.1" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#back-to-the-mixture-example"><i class="fa fa-check"></i><b>9.1</b> Back to the ‘mixture’ example</a></li>
<li class="chapter" data-level="9.2" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#linear-contrasts"><i class="fa fa-check"></i><b>9.2</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#the-variance-of-contrasts"><i class="fa fa-check"></i><b>9.2.1</b> The variance of contrasts</a></li>
<li class="chapter" data-level="9.2.2" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#testing-linear-contrasts-with-r"><i class="fa fa-check"></i><b>9.2.2</b> Testing linear contrasts with R</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#pairwise-comparisons"><i class="fa fa-check"></i><b>9.3</b> Pairwise comparisons</a></li>
<li class="chapter" data-level="9.4" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#letter-display"><i class="fa fa-check"></i><b>9.4</b> Letter display</a></li>
<li class="chapter" data-level="9.5" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#multiplicity-correction"><i class="fa fa-check"></i><b>9.5</b> Multiplicity correction</a></li>
<li class="chapter" data-level="9.6" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#multiple-comparisons-with-transformed-data"><i class="fa fa-check"></i><b>9.6</b> Multiple comparisons with transformed data</a></li>
<li class="chapter" data-level="9.7" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#what-about-the-traditional-mcps"><i class="fa fa-check"></i><b>9.7</b> What about the traditional MCPs?</a></li>
<li class="chapter" data-level="9.8" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#some-practical-suggestions"><i class="fa fa-check"></i><b>9.8</b> Some practical suggestions</a></li>
<li class="chapter" data-level="9.9" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#further-readings-7"><i class="fa fa-check"></i><b>9.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html"><i class="fa fa-check"></i><b>10</b> Multi-way ANOVA models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#motivating-example-a-genotype-experiment-in-blocks"><i class="fa fa-check"></i><b>10.1</b> Motivating example: a genotype experiment in blocks</a></li>
<li class="chapter" data-level="10.2" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-definition-1"><i class="fa fa-check"></i><b>10.2</b> Model definition</a></li>
<li class="chapter" data-level="10.3" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-fitting-by-hand"><i class="fa fa-check"></i><b>10.3</b> Model fitting by hand</a></li>
<li class="chapter" data-level="10.4" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-fitting-with-r"><i class="fa fa-check"></i><b>10.4</b> Model fitting with R</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-checking"><i class="fa fa-check"></i><b>10.4.1</b> Model checking</a></li>
<li class="chapter" data-level="10.4.2" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#variance-partitioning-1"><i class="fa fa-check"></i><b>10.4.2</b> Variance partitioning</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#another-example-comparing-working-protocols"><i class="fa fa-check"></i><b>10.5</b> Another example: comparing working protocols</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html"><i class="fa fa-check"></i><b>11</b> Multi-way ANOVA models with interactions</a>
<ul>
<li class="chapter" data-level="11.1" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#the-interaction-concept"><i class="fa fa-check"></i><b>11.1</b> The ‘interaction’ concept</a></li>
<li class="chapter" data-level="11.2" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#genotype-by-n-interactions"><i class="fa fa-check"></i><b>11.2</b> Genotype by N interactions</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-definition-2"><i class="fa fa-check"></i><b>11.2.1</b> Model definition</a></li>
<li class="chapter" data-level="11.2.2" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-fitting-by-hand-1"><i class="fa fa-check"></i><b>11.2.2</b> Model fitting by hand</a></li>
<li class="chapter" data-level="11.2.3" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-fitting-with-r-1"><i class="fa fa-check"></i><b>11.2.3</b> Model fitting with R</a></li>
<li class="chapter" data-level="11.2.4" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#inferences-and-standard-errors"><i class="fa fa-check"></i><b>11.2.4</b> Inferences and standard errors</a></li>
<li class="chapter" data-level="11.2.5" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#expected-marginal-means-1"><i class="fa fa-check"></i><b>11.2.5</b> Expected marginal means</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#nested-effects-maize-crosses"><i class="fa fa-check"></i><b>11.3</b> Nested effects: maize crosses</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-definition-3"><i class="fa fa-check"></i><b>11.3.1</b> Model definition</a></li>
<li class="chapter" data-level="11.3.2" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#parameter-estimation-1"><i class="fa fa-check"></i><b>11.3.2</b> Parameter estimation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#further-readings-8"><i class="fa fa-check"></i><b>11.4</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>12</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#case-study-n-fertilisation-in-wheat"><i class="fa fa-check"></i><b>12.1</b> Case-study: N fertilisation in wheat</a></li>
<li class="chapter" data-level="12.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#preliminary-analysis"><i class="fa fa-check"></i><b>12.2</b> Preliminary analysis</a></li>
<li class="chapter" data-level="12.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#definition-of-a-linear-model"><i class="fa fa-check"></i><b>12.3</b> Definition of a linear model</a></li>
<li class="chapter" data-level="12.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#parameter-estimation-2"><i class="fa fa-check"></i><b>12.4</b> Parameter estimation</a></li>
<li class="chapter" data-level="12.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#goodness-of-fit"><i class="fa fa-check"></i><b>12.5</b> Goodness of fit</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#graphical-evaluation"><i class="fa fa-check"></i><b>12.5.1</b> Graphical evaluation</a></li>
<li class="chapter" data-level="12.5.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#standard-errors-for-parameter-estimates"><i class="fa fa-check"></i><b>12.5.2</b> Standard errors for parameter estimates</a></li>
<li class="chapter" data-level="12.5.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#f-test-for-lack-of-fit"><i class="fa fa-check"></i><b>12.5.3</b> F test for lack of fit</a></li>
<li class="chapter" data-level="12.5.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#f-test-for-goodness-of-fit-and-coefficient-of-determination"><i class="fa fa-check"></i><b>12.5.4</b> F test for goodness of fit and coefficient of determination</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#making-predictions"><i class="fa fa-check"></i><b>12.6</b> Making predictions</a></li>
<li class="chapter" data-level="12.7" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#further-readings-9"><i class="fa fa-check"></i><b>12.7</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html"><i class="fa fa-check"></i><b>13</b> A brief intro to mixed models</a>
<ul>
<li class="chapter" data-level="13.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#split-plot-or-strip-plot-experiments"><i class="fa fa-check"></i><b>13.1</b> Split-plot or strip-plot experiments</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-1-a-split-plot-experiment"><i class="fa fa-check"></i><b>13.1.1</b> Example 1: a split-plot experiment</a></li>
<li class="chapter" data-level="13.1.2" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-2-a-strip-plot-design"><i class="fa fa-check"></i><b>13.1.2</b> Example 2: a strip-plot design</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#sub-sampling-designs"><i class="fa fa-check"></i><b>13.2</b> Sub-sampling designs</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-3-a-rcbd-with-sub-sampling"><i class="fa fa-check"></i><b>13.2.1</b> Example 3: A RCBD with sub-sampling</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#repeated-experiments"><i class="fa fa-check"></i><b>13.3</b> Repeated experiments</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#a-model-for-pooling-the-results"><i class="fa fa-check"></i><b>13.3.1</b> A model for pooling the results</a></li>
<li class="chapter" data-level="13.3.2" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#preliminary-analyses"><i class="fa fa-check"></i><b>13.3.2</b> Preliminary analyses</a></li>
<li class="chapter" data-level="13.3.3" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#fixed-or-random-runs"><i class="fa fa-check"></i><b>13.3.3</b> Fixed or random runs?</a></li>
<li class="chapter" data-level="13.3.4" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-4-a-seed-germination-experiment-in-two-runs"><i class="fa fa-check"></i><b>13.3.4</b> Example 4: a seed germination experiment in two runs</a></li>
<li class="chapter" data-level="13.3.5" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-5-a-multi-year-winter-wheat-experiment"><i class="fa fa-check"></i><b>13.3.5</b> Example 5: a multi-year winter wheat experiment</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#repeated-measures-in-perennial-crops"><i class="fa fa-check"></i><b>13.4</b> Repeated measures in perennial crops</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-5-genotype-experiment-with-lucerne"><i class="fa fa-check"></i><b>13.4.1</b> Example 5: genotype experiment with lucerne</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#further-readings-10"><i class="fa fa-check"></i><b>13.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>14</b> Nonlinear regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#case-study-a-degradation-curve"><i class="fa fa-check"></i><b>14.1</b> Case-study: a degradation curve</a></li>
<li class="chapter" data-level="14.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#model-selection"><i class="fa fa-check"></i><b>14.2</b> Model selection</a></li>
<li class="chapter" data-level="14.3" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#parameter-estimation-3"><i class="fa fa-check"></i><b>14.3</b> Parameter estimation</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#linearisation"><i class="fa fa-check"></i><b>14.3.1</b> Linearisation</a></li>
<li class="chapter" data-level="14.3.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#approximation-with-a-polynomial-function"><i class="fa fa-check"></i><b>14.3.2</b> Approximation with a polynomial function</a></li>
<li class="chapter" data-level="14.3.3" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#nonlinear-least-squares"><i class="fa fa-check"></i><b>14.3.3</b> Nonlinear least squares</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#nonlinear-regression-with-r"><i class="fa fa-check"></i><b>14.4</b> Nonlinear regression with R</a></li>
<li class="chapter" data-level="14.5" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#checking-the-model"><i class="fa fa-check"></i><b>14.5</b> Checking the model</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#graphical-analyses-of-residuals"><i class="fa fa-check"></i><b>14.5.1</b> Graphical analyses of residuals</a></li>
<li class="chapter" data-level="14.5.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#approximate-f-test-for-lack-of-fit"><i class="fa fa-check"></i><b>14.5.2</b> Approximate F test for lack of fit</a></li>
<li class="chapter" data-level="14.5.3" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#the-coefficient-of-determination-r2"><i class="fa fa-check"></i><b>14.5.3</b> The coefficient of determination (R<sup>2</sup>)</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#stabilising-transformations-1"><i class="fa fa-check"></i><b>14.6</b> Stabilising transformations</a></li>
<li class="chapter" data-level="14.7" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#making-predictions-1"><i class="fa fa-check"></i><b>14.7</b> Making predictions</a></li>
<li class="chapter" data-level="14.8" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#further-readings-11"><i class="fa fa-check"></i><b>14.8</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>15</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.1" data-path="exercises.html"><a href="exercises.html#designing-experiments-ch.-1-to-2"><i class="fa fa-check"></i><b>15.1</b> Designing experiments (ch. 1 to 2)</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="exercises.html"><a href="exercises.html#exercise-1"><i class="fa fa-check"></i><b>15.1.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.1.2" data-path="exercises.html"><a href="exercises.html#exercise-2"><i class="fa fa-check"></i><b>15.1.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.1.3" data-path="exercises.html"><a href="exercises.html#exercise-3"><i class="fa fa-check"></i><b>15.1.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="exercises.html"><a href="exercises.html#describing-the-observations-ch.-3"><i class="fa fa-check"></i><b>15.2</b> Describing the observations (ch. 3)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="exercises.html"><a href="exercises.html#exercise-1-1"><i class="fa fa-check"></i><b>15.2.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.2.2" data-path="exercises.html"><a href="exercises.html#exercise-2-1"><i class="fa fa-check"></i><b>15.2.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.2.3" data-path="exercises.html"><a href="exercises.html#exercise-3-1"><i class="fa fa-check"></i><b>15.2.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="exercises.html"><a href="exercises.html#modeling-the-experimental-data-ch.-4"><i class="fa fa-check"></i><b>15.3</b> Modeling the experimental data (ch. 4)</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="exercises.html"><a href="exercises.html#exercise-1-2"><i class="fa fa-check"></i><b>15.3.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.3.2" data-path="exercises.html"><a href="exercises.html#exercise-2-2"><i class="fa fa-check"></i><b>15.3.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.3.3" data-path="exercises.html"><a href="exercises.html#exercise-3-2"><i class="fa fa-check"></i><b>15.3.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.3.4" data-path="exercises.html"><a href="exercises.html#exercise-4"><i class="fa fa-check"></i><b>15.3.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.3.5" data-path="exercises.html"><a href="exercises.html#exercise-5"><i class="fa fa-check"></i><b>15.3.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.3.6" data-path="exercises.html"><a href="exercises.html#exercise-6"><i class="fa fa-check"></i><b>15.3.6</b> Exercise 6</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="exercises.html"><a href="exercises.html#interval-estimation-of-model-parameters-ch.-5"><i class="fa fa-check"></i><b>15.4</b> Interval estimation of model parameters (ch. 5)</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="exercises.html"><a href="exercises.html#exercise-1-3"><i class="fa fa-check"></i><b>15.4.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.4.2" data-path="exercises.html"><a href="exercises.html#exercise-2-3"><i class="fa fa-check"></i><b>15.4.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.4.3" data-path="exercises.html"><a href="exercises.html#exercise-3-3"><i class="fa fa-check"></i><b>15.4.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.4.4" data-path="exercises.html"><a href="exercises.html#exercise-4-1"><i class="fa fa-check"></i><b>15.4.4</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="exercises.html"><a href="exercises.html#making-decisions-under-uncertainty-ch.-6"><i class="fa fa-check"></i><b>15.5</b> Making decisions under uncertainty (ch. 6)</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="exercises.html"><a href="exercises.html#exercise-1-4"><i class="fa fa-check"></i><b>15.5.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.5.2" data-path="exercises.html"><a href="exercises.html#exercise-2-4"><i class="fa fa-check"></i><b>15.5.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.5.3" data-path="exercises.html"><a href="exercises.html#exercise-3-4"><i class="fa fa-check"></i><b>15.5.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.5.4" data-path="exercises.html"><a href="exercises.html#exercise-4-2"><i class="fa fa-check"></i><b>15.5.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.5.5" data-path="exercises.html"><a href="exercises.html#exercise-5-1"><i class="fa fa-check"></i><b>15.5.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.5.6" data-path="exercises.html"><a href="exercises.html#exercise-6-1"><i class="fa fa-check"></i><b>15.5.6</b> Exercise 6</a></li>
<li class="chapter" data-level="15.5.7" data-path="exercises.html"><a href="exercises.html#exercise-7"><i class="fa fa-check"></i><b>15.5.7</b> Exercise 7</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="exercises.html"><a href="exercises.html#fitting-models-to-data-from-agriculture-experiments"><i class="fa fa-check"></i><b>15.6</b> Fitting models to data from agriculture experiments</a></li>
<li class="chapter" data-level="15.7" data-path="exercises.html"><a href="exercises.html#one-way-anova-models-ch.-7-to-9"><i class="fa fa-check"></i><b>15.7</b> One-way ANOVA models (ch. 7 to 9)</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="exercises.html"><a href="exercises.html#exercise-1-5"><i class="fa fa-check"></i><b>15.7.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.7.2" data-path="exercises.html"><a href="exercises.html#exercise-2-5"><i class="fa fa-check"></i><b>15.7.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.7.3" data-path="exercises.html"><a href="exercises.html#exercise-3-5"><i class="fa fa-check"></i><b>15.7.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.7.4" data-path="exercises.html"><a href="exercises.html#exercise-4-3"><i class="fa fa-check"></i><b>15.7.4</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="exercises.html"><a href="exercises.html#multi-way-anova-models-ch.-10"><i class="fa fa-check"></i><b>15.8</b> Multi-way ANOVA models (ch. 10)</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="exercises.html"><a href="exercises.html#exercise-1-6"><i class="fa fa-check"></i><b>15.8.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.8.2" data-path="exercises.html"><a href="exercises.html#exercise-2-6"><i class="fa fa-check"></i><b>15.8.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.8.3" data-path="exercises.html"><a href="exercises.html#exercise-3-6"><i class="fa fa-check"></i><b>15.8.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="15.9" data-path="exercises.html"><a href="exercises.html#multi-way-anova-models-with-interactions-ch.-11-and-13"><i class="fa fa-check"></i><b>15.9</b> Multi-way ANOVA models with interactions (ch. 11 and 13)</a>
<ul>
<li class="chapter" data-level="15.9.1" data-path="exercises.html"><a href="exercises.html#exercise-1-7"><i class="fa fa-check"></i><b>15.9.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.9.2" data-path="exercises.html"><a href="exercises.html#exercise-2-7"><i class="fa fa-check"></i><b>15.9.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.9.3" data-path="exercises.html"><a href="exercises.html#exercise-3-7"><i class="fa fa-check"></i><b>15.9.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.9.4" data-path="exercises.html"><a href="exercises.html#exercise-4-4"><i class="fa fa-check"></i><b>15.9.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.9.5" data-path="exercises.html"><a href="exercises.html#exercise-5-2"><i class="fa fa-check"></i><b>15.9.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.9.6" data-path="exercises.html"><a href="exercises.html#exercise-6-2"><i class="fa fa-check"></i><b>15.9.6</b> Exercise 6</a></li>
</ul></li>
<li class="chapter" data-level="15.10" data-path="exercises.html"><a href="exercises.html#simple-linear-regression-ch.-12"><i class="fa fa-check"></i><b>15.10</b> Simple linear regression (ch. 12)</a>
<ul>
<li class="chapter" data-level="15.10.1" data-path="exercises.html"><a href="exercises.html#exercise-1-8"><i class="fa fa-check"></i><b>15.10.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.10.2" data-path="exercises.html"><a href="exercises.html#exercise-2-8"><i class="fa fa-check"></i><b>15.10.2</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="15.11" data-path="exercises.html"><a href="exercises.html#nonlinear-regression-ch.-14"><i class="fa fa-check"></i><b>15.11</b> Nonlinear regression (ch. 14)</a>
<ul>
<li class="chapter" data-level="15.11.1" data-path="exercises.html"><a href="exercises.html#exercise-1-9"><i class="fa fa-check"></i><b>15.11.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.11.2" data-path="exercises.html"><a href="exercises.html#exercise-2-9"><i class="fa fa-check"></i><b>15.11.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.11.3" data-path="exercises.html"><a href="exercises.html#exercise-3-8"><i class="fa fa-check"></i><b>15.11.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.11.4" data-path="exercises.html"><a href="exercises.html#exercise-4-5"><i class="fa fa-check"></i><b>15.11.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.11.5" data-path="exercises.html"><a href="exercises.html#exercise-5-3"><i class="fa fa-check"></i><b>15.11.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.11.6" data-path="exercises.html"><a href="exercises.html#exercise-6-3"><i class="fa fa-check"></i><b>15.11.6</b> Exercise 6</a></li>
<li class="chapter" data-level="15.11.7" data-path="exercises.html"><a href="exercises.html#exercise-7-1"><i class="fa fa-check"></i><b>15.11.7</b> Exercise 7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html"><i class="fa fa-check"></i><b>16</b> APPENDIX: A very gentle introduction to R</a>
<ul>
<li class="chapter" data-level="16.1" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#what-is-r"><i class="fa fa-check"></i><b>16.1</b> What is R?</a></li>
<li class="chapter" data-level="16.2" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#installing-r-and-moving-the-first-steps"><i class="fa fa-check"></i><b>16.2</b> Installing R and moving the first steps</a></li>
<li class="chapter" data-level="16.3" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#assignments"><i class="fa fa-check"></i><b>16.3</b> Assignments</a></li>
<li class="chapter" data-level="16.4" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#data-types-and-data-objects"><i class="fa fa-check"></i><b>16.4</b> Data types and data objects</a></li>
<li class="chapter" data-level="16.5" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#matrices"><i class="fa fa-check"></i><b>16.5</b> Matrices</a></li>
<li class="chapter" data-level="16.6" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#dataframes"><i class="fa fa-check"></i><b>16.6</b> Dataframes</a></li>
<li class="chapter" data-level="16.7" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#working-with-objects"><i class="fa fa-check"></i><b>16.7</b> Working with objects</a></li>
<li class="chapter" data-level="16.8" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#expressions-functions-and-arguments"><i class="fa fa-check"></i><b>16.8</b> Expressions, functions and arguments</a></li>
<li class="chapter" data-level="16.9" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#a-few-useful-functions"><i class="fa fa-check"></i><b>16.9</b> A few useful functions</a></li>
<li class="chapter" data-level="16.10" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#extractors"><i class="fa fa-check"></i><b>16.10</b> Extractors</a></li>
<li class="chapter" data-level="16.11" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#reading-external-data"><i class="fa fa-check"></i><b>16.11</b> Reading external data</a></li>
<li class="chapter" data-level="16.12" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#simple-r-graphics"><i class="fa fa-check"></i><b>16.12</b> Simple R graphics</a></li>
<li class="chapter" data-level="16.13" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#further-readings-12"><i class="fa fa-check"></i><b>16.13</b> Further readings</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Experimental methods in agriculture</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a-brief-intro-to-mixed-models" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> A brief intro to mixed models<a href="a-brief-intro-to-mixed-models.html#a-brief-intro-to-mixed-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>… the actual and physical conduct of an experiment must govern the statistical procedure of its interpretation (R. A. Fisher)</em></p>
<p>Although the previous chapters have covered the analysis of data from a wide array of agricultural experiments, there are still a few important situations, which require some more advanced knowledge. In particular, we have, so far, encountered only the so-called <em>fixed factors</em>. An experimental factor is ‘fixed’ when its levels are purposely selected (not sampled), repeatable (we could make a new experiment with the very same levels) and of unique and direct interest, in the sense that we are not interested in any other level apart from those we have decided to include in the experiment. As we have seen in the previous chapters, fixed factors produce fixed effects, which can be expressed as differences (increases/decreases) with respect to the overall mean. Models containing only fixed effects and the residual random error term are named <strong>fixed models</strong>.</p>
<p>Apart from fixed factors, experiments in agriculture and biology may require the inclusion of <em>random factors</em>, that produce effects of random nature. An experimental factor is ‘random’ when its levels are not interesting in themselves, but they are sampled from a wider population of possible levels. Even if the levels are selected on purpose, they are, anyway, not ‘repeatable’ in the sense that, if we repeat the experiment, we cannot select the very same factor levels.</p>
<p>As an example of a random factor, we can imagine that we are interested in studying the variability of yield in a certain environment and, to this aim, we sample twenty representative fields at random within that environment to measure the yield level. The field factor is random, in the sense that we are not specifically interested in those twenty fields, but we are interested in the overall variability that the field effect produces on yield. Provided that the levels of the yield factor are not interesting in themselves, estimating their fixed effects (increase/decrease with respect to the overall mean) is meaningless; on the contrary, we are more interested in estimating the amount of variability, as measured by the corresponding variance (<em>variance component</em>). Models containing random factors together with fixed factors and the residual error term are named <strong>mixed models</strong> and, since the advent of personal computers in the 70s of the previous century, they represent a very important class of models, which require specific algorithms and fitting methods.</p>
<p>Mixed models are far beyond the scope of this book; for those who are interested in this subject, we recommend the wonderful book ‘Linear mixed-effects models using R: a step-by-step approach’ (Gałecki and Burzykowski, 2013). In this chapter we will only give a few examples relating to several common types of field experiments, that require the inclusion of random effects and, thus, the adoption of mixed models.</p>
<div id="split-plot-or-strip-plot-experiments" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Split-plot or strip-plot experiments<a href="a-brief-intro-to-mixed-models.html#split-plot-or-strip-plot-experiments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have seen in Chapter 2 that factorial experiments can be designed as split-plots or strip-plots, where treatment levels are allocated to the experimental units in groups. We have seen that this is advantageous in some circumstances, e.g., when one of the factors is better allocated to bigger plots, compared to the other factor. When factor levels are allocated to groups of individuals, the independency of residuals is broken, as the individuals within the group are more alike than the individuals in different groups. For example, let’s consider a field experiment: if one group of plots is, e.g., more fertile than the other groups, all plots within that group will share such a positive effect and, therefore, their yields will be correlated. In this case, we talk about <em>intra-class correlation</em>, that is a similar concept to the Pearson correlation, which we have encountered in Chapter 3.</p>
<p>In order to respect the basic assumption of independent residuals, data from split-plot and strip-plot experiments cannot be analysed by using the methods proposed in Chapter 11 (multi-way ANOVA models), but they require a different approach.</p>
<div id="example-1-a-split-plot-experiment" class="section level3 hasAnchor" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Example 1: a split-plot experiment<a href="a-brief-intro-to-mixed-models.html#example-1-a-split-plot-experiment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In chapter 2, we presented an experiment to compare three types of tillage (minimum tillage = MIN; shallow ploughing = SP; deep ploughing = DP) and two types of chemical weed control methods (broadcast = TOT; in-furrow = PART). This experiment was designed in four complete blocks with three main-plots per block, split into two sub-plots per main-plot; the three types of tillage were randomly allocated to the main-plots, while the two weed control treatments were randomly allocated to sub-plots (see Figure <a href="designing-experiments.html#fig:figName38">2.9</a>).</p>
<p>The results of this experiment are reported in the ‘beet.csv’ file, that is available in the online repository. In the following box we load the file and transform the explanatory variables into factors.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="a-brief-intro-to-mixed-models.html#cb165-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://www.casaonofri.it/_datasets/beet.csv&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb165-2"><a href="a-brief-intro-to-mixed-models.html#cb165-2" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Tillage <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset<span class="sc">$</span>Tillage)</span>
<span id="cb165-3"><a href="a-brief-intro-to-mixed-models.html#cb165-3" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>WeedControl <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset<span class="sc">$</span>WeedControl)</span>
<span id="cb165-4"><a href="a-brief-intro-to-mixed-models.html#cb165-4" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Block <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset<span class="sc">$</span>Block)</span>
<span id="cb165-5"><a href="a-brief-intro-to-mixed-models.html#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataset)</span>
<span id="cb165-6"><a href="a-brief-intro-to-mixed-models.html#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   Tillage WeedControl Block  Yield</span></span>
<span id="cb165-7"><a href="a-brief-intro-to-mixed-models.html#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     MIN         TOT     1 11.614</span></span>
<span id="cb165-8"><a href="a-brief-intro-to-mixed-models.html#cb165-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     MIN         TOT     2  9.283</span></span>
<span id="cb165-9"><a href="a-brief-intro-to-mixed-models.html#cb165-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     MIN         TOT     3  7.019</span></span>
<span id="cb165-10"><a href="a-brief-intro-to-mixed-models.html#cb165-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 4     MIN         TOT     4  8.015</span></span>
<span id="cb165-11"><a href="a-brief-intro-to-mixed-models.html#cb165-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 5     MIN        PART     1  5.117</span></span>
<span id="cb165-12"><a href="a-brief-intro-to-mixed-models.html#cb165-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 6     MIN        PART     2  4.306</span></span></code></pre></div>
<p>By looking at the map in Figure <a href="designing-experiments.html#fig:figName38">2.9</a>, it is easy to see that there are two types of constraints to randomisation:</p>
<ol style="list-style-type: decimal">
<li>each replicate of the six combinations was allocated to each block</li>
<li>the two weed control methods were allocated to each main plot</li>
</ol>
<p>As the consequence, apart from treatment factors, we have two blocking factors, i.e. the blocks and the main-plots within each block; both this blocking factors should be included in the model, in order to ensure the independence of residuals.</p>
<div id="model-definition-4" class="section level4 hasAnchor" number="13.1.1.1">
<h4><span class="header-section-number">13.1.1.1</span> Model definition<a href="a-brief-intro-to-mixed-models.html#model-definition-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Considering the above comments, a linear model for a two-way split-plot experiment is:</p>
<p><span class="math display">\[Y_{ijk} = \mu + \gamma_k + \alpha_i + \theta_{ik} + \beta_j + \alpha\beta_{ij} + \varepsilon_{ijk}\]</span></p>
<p>where <span class="math inline">\(\gamma\)</span> is the effect of the <span class="math inline">\(k\)</span><sup>th</sup> block, <span class="math inline">\(\alpha\)</span> is the effect of the <span class="math inline">\(i\)</span><sup>th</sup> tillage, <span class="math inline">\(\beta\)</span> is the effect of <span class="math inline">\(j\)</span><sup>th</sup> weed control method, <span class="math inline">\(\alpha\beta\)</span> is the interaction between the <span class="math inline">\(i\)</span><sup>th</sup> tillage method and <span class="math inline">\(j\)</span><sup>th</sup> weed control method. Apart from these effects, which are totally the same as those used in Chapter 11, we also include the main-plot effect <span class="math inline">\(\theta\)</span>, where we use the <span class="math inline">\(i\)</span> and <span class="math inline">\(k\)</span> subscripts, as each main-plot is uniquely identified by the block to which it belongs and by the tillage method with which it was treated (see Figure <a href="designing-experiments.html#fig:figName38">2.9</a>). Obviously, the main plots can be labelled in any other way, as long as each one is uniquely identified.</p>
<p>Now, let’s concentrate on the main-plots and forget the sub-plots for awhile; we see that the split-plot design in Figure <a href="designing-experiments.html#fig:figName38">2.9</a>, without considering the sub-plots, is totally similar to a Randomised Complete Block Design. Consequently, we are not really interested in the main-plots we have included in the experiment, they are simply a random sample selected from a wider universe. Furthermore, the differences between main-plots treated alike (same tillage method), once the block effect has been removed, are only due to random factors, as there is no other known systematic source of variability. Last, but not least, the levels of the tillage factor were independently allocated to main-plots, which, therefore, represent true-replicates for this factor. If we consider all previous comments, we have to conclude that the main-plot factor has to be regarded as a random factor.</p>
<p>Likewise, the subplot effect is also random, as subplots were sampled from a wider universe and the differences between sub-plots treated alike (same ‘tillage by weed control method’ combination) are only due to random effects (unknown sources of variability). In the end, in split-plot designs we have two random factors and, consequently, two random effects: <span class="math inline">\(\theta\)</span> (main-plot effect) and <span class="math inline">\(\varepsilon\)</span> (sub-plot effect), which are assumed as gaussian, with means equal to 0 and standard deviations equal to, respectively, <span class="math inline">\(\sigma_{\theta}\)</span> and <span class="math inline">\(\sigma\)</span>. Therefore, we need to fit a mixed model.</p>
</div>
<div id="model-fitting-with-r-2" class="section level4 hasAnchor" number="13.1.1.2">
<h4><span class="header-section-number">13.1.1.2</span> Model fitting with R<a href="a-brief-intro-to-mixed-models.html#model-fitting-with-r-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First of all, we need to build a new variable to uniquely identify the main plots. We can do this by using numeric coding, or, more easily, by creating a new factor that combines the levels of block and tillage; we have already anticipated that each main plot is uniquely identified by the block and the tillage method.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="a-brief-intro-to-mixed-models.html#cb166-1" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>mainPlot <span class="ot">&lt;-</span> <span class="fu">with</span>(dataset, <span class="fu">factor</span>(Block<span class="sc">:</span>Tillage))</span></code></pre></div>
<p>Due to the presence of two random effects, we cannot use the <code>lm()</code> function for model fitting, which is only able to accomodate one residual random term. In R, there are several mixed model fitting function; in this book, we propose the use of the <code>lmer()</code> function, which requires two additional packages, i.e. ‘lme4’ and ‘lmerTest’. These two packages need to be installed, unless we have already done so and loaded in the environment before model fitting.</p>
<p>The syntax of the <code>lmer()</code> function is rather similar to that of the <code>lm()</code> function, although the random main-plot effect is entered by using the ‘1|’ operator and it is put in brackets, in order to better mark the difference with fixed effects. See the box below for the exact coding.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="a-brief-intro-to-mixed-models.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;lme4&quot;)  #only at first time</span></span>
<span id="cb167-2"><a href="a-brief-intro-to-mixed-models.html#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;lmerTest&quot;)  #only at first time</span></span>
<span id="cb167-3"><a href="a-brief-intro-to-mixed-models.html#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb167-4"><a href="a-brief-intro-to-mixed-models.html#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb167-5"><a href="a-brief-intro-to-mixed-models.html#cb167-5" aria-hidden="true" tabindex="-1"></a>mod.split <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Yield <span class="sc">~</span> Block <span class="sc">+</span> Tillage <span class="sc">*</span> WeedControl <span class="sc">+</span></span>
<span id="cb167-6"><a href="a-brief-intro-to-mixed-models.html#cb167-6" aria-hidden="true" tabindex="-1"></a>                  (<span class="dv">1</span><span class="sc">|</span>mainPlot), <span class="at">data=</span>dataset)</span></code></pre></div>
<p>As usual, the second step is based on the inspection of model residuals. The <code>plot()</code> method applied to the ‘lmer’ object only returns the graph of residuals against fitted values (Figure <a href="a-brief-intro-to-mixed-models.html#fig:figName141b">13.1</a>), while there is no quick way to obtain a QQ-plot. Therefore, we use the Shapiro-Wilks test for normality, as shown in Chapter 8.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="a-brief-intro-to-mixed-models.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.split))</span>
<span id="cb168-2"><a href="a-brief-intro-to-mixed-models.html#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb168-3"><a href="a-brief-intro-to-mixed-models.html#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Shapiro-Wilk normality test</span></span>
<span id="cb168-4"><a href="a-brief-intro-to-mixed-models.html#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb168-5"><a href="a-brief-intro-to-mixed-models.html#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  residuals(mod.split)</span></span>
<span id="cb168-6"><a href="a-brief-intro-to-mixed-models.html#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="do">## W = 0.93838, p-value = 0.1501</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figName141b"></span>
<img src="_main_files/figure-html/figName141b-1.png" alt="Graphical analyses of residuals for a split-plot ANOVA model" width="90%" />
<p class="caption">
Figure 13.1: Graphical analyses of residuals for a split-plot ANOVA model
</p>
</div>
<p>After having made sure that the basic assumptions for linear models hold, we can proceed to variance partitioning. In this case, we use the <code>anova()</code> method for a mixed model object, which gives a slightly different output than the <code>anova()</code> method for a linear model object. As the second argument, it is necessary to indicate the method we want to use to estimate the degrees of freedom, which, in mixed models, are not as easy to calculate as in linear models.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="a-brief-intro-to-mixed-models.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod.split, <span class="at">ddf=</span><span class="st">&quot;Kenward-Roger&quot;</span>)</span>
<span id="cb169-2"><a href="a-brief-intro-to-mixed-models.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Type III Analysis of Variance Table with Kenward-Roger&#39;s method</span></span>
<span id="cb169-3"><a href="a-brief-intro-to-mixed-models.html#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="do">##                      Sum Sq Mean Sq NumDF DenDF F value  Pr(&gt;F)  </span></span>
<span id="cb169-4"><a href="a-brief-intro-to-mixed-models.html#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Block                3.6596  1.2199     3     6  0.6521 0.61016  </span></span>
<span id="cb169-5"><a href="a-brief-intro-to-mixed-models.html#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Tillage             23.6565 11.8282     2     6  6.3228 0.03332 *</span></span>
<span id="cb169-6"><a href="a-brief-intro-to-mixed-models.html#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="do">## WeedControl          3.3205  3.3205     1     9  1.7750 0.21552  </span></span>
<span id="cb169-7"><a href="a-brief-intro-to-mixed-models.html#cb169-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Tillage:WeedControl 19.4641  9.7321     2     9  5.2023 0.03152 *</span></span>
<span id="cb169-8"><a href="a-brief-intro-to-mixed-models.html#cb169-8" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb169-9"><a href="a-brief-intro-to-mixed-models.html#cb169-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>From the above table we see that the ‘tillage by weed control method’ interaction is significant and, therefore, we show the means for the corresponding combinations of experimental factors. As in previous chapters, we use the <code>emmeans()</code> function.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="a-brief-intro-to-mixed-models.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb170-2"><a href="a-brief-intro-to-mixed-models.html#cb170-2" aria-hidden="true" tabindex="-1"></a>meansAB <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(mod.split, <span class="sc">~</span>Tillage<span class="sc">:</span>WeedControl)</span>
<span id="cb170-3"><a href="a-brief-intro-to-mixed-models.html#cb170-3" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(meansAB, <span class="at">Letters =</span> LETTERS)</span>
<span id="cb170-4"><a href="a-brief-intro-to-mixed-models.html#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Tillage WeedControl emmean    SE   df lower.CL upper.CL .group</span></span>
<span id="cb170-5"><a href="a-brief-intro-to-mixed-models.html#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  MIN     PART          6.00 0.684 14.4     4.53     7.46  A    </span></span>
<span id="cb170-6"><a href="a-brief-intro-to-mixed-models.html#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  SP      PART          8.48 0.684 14.4     7.01     9.94  AB   </span></span>
<span id="cb170-7"><a href="a-brief-intro-to-mixed-models.html#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  MIN     TOT           8.98 0.684 14.4     7.52    10.45  AB   </span></span>
<span id="cb170-8"><a href="a-brief-intro-to-mixed-models.html#cb170-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  SP      TOT           9.14 0.684 14.4     7.68    10.60  AB   </span></span>
<span id="cb170-9"><a href="a-brief-intro-to-mixed-models.html#cb170-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  DP      TOT           9.21 0.684 14.4     7.74    10.67   B   </span></span>
<span id="cb170-10"><a href="a-brief-intro-to-mixed-models.html#cb170-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  DP      PART         10.63 0.684 14.4     9.17    12.09   B   </span></span>
<span id="cb170-11"><a href="a-brief-intro-to-mixed-models.html#cb170-11" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb170-12"><a href="a-brief-intro-to-mixed-models.html#cb170-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Results are averaged over the levels of: Block </span></span>
<span id="cb170-13"><a href="a-brief-intro-to-mixed-models.html#cb170-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Degrees-of-freedom method: kenward-roger </span></span>
<span id="cb170-14"><a href="a-brief-intro-to-mixed-models.html#cb170-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb170-15"><a href="a-brief-intro-to-mixed-models.html#cb170-15" aria-hidden="true" tabindex="-1"></a><span class="do">## P value adjustment: tukey method for comparing a family of 6 estimates </span></span>
<span id="cb170-16"><a href="a-brief-intro-to-mixed-models.html#cb170-16" aria-hidden="true" tabindex="-1"></a><span class="do">## significance level used: alpha = 0.05 </span></span>
<span id="cb170-17"><a href="a-brief-intro-to-mixed-models.html#cb170-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: If two or more means share the same grouping symbol,</span></span>
<span id="cb170-18"><a href="a-brief-intro-to-mixed-models.html#cb170-18" aria-hidden="true" tabindex="-1"></a><span class="do">##       then we cannot show them to be different.</span></span>
<span id="cb170-19"><a href="a-brief-intro-to-mixed-models.html#cb170-19" aria-hidden="true" tabindex="-1"></a><span class="do">##       But we also did not show them to be the same.</span></span></code></pre></div>
<p>We see that we should avoid controlling the weeds only along the crop rows, if we have not plowed the soil, at least to a shallow depth.</p>
</div>
</div>
<div id="example-2-a-strip-plot-design" class="section level3 hasAnchor" number="13.1.2">
<h3><span class="header-section-number">13.1.2</span> Example 2: a strip-plot design<a href="a-brief-intro-to-mixed-models.html#example-2-a-strip-plot-design" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Chapter 2 we have also seen another possible arrangement of plots, relating to an experiment where three crops (sugarbeet, rape and soybean) were sown 40 days after an herbicide treatment. The aim was to assess possible phytotoxicity effects relating to an excessive persistence of herbicide residues in soil and the untreated control was added for the sake of comparison.</p>
<p>Figure <a href="designing-experiments.html#fig:figName39">2.10</a> shows that each block was organised with three rows and two columns: the three crops were sown along the rows and the two herbicide treatments (rimsulfuron and the untreated control) were allocated along the columns. In this design, the observations are clustered in three groups:</p>
<ol style="list-style-type: decimal">
<li>the blocks</li>
<li>the rows within each block (three rows per block)</li>
<li>the columns within each block (two columns per block)</li>
</ol>
<p>Analogously to the split-plot design, the rows represent the main plots for the crop factor, while the columns represent the main-plots for the herbicide factor. Both these grouping factors must be referenced as random effects in the model. The combinations between crops and herbicide treatments are allocated to the sub-plots, resulting from crossing the rows with the columns.</p>
<p>The dataset for this experiment, with four replicates, is available in the ‘recropS.csv’ file, that can be loaded from the usual repository. After loading, we transform all explanatory variables into factors. Furthermore, we create the definition of rows and columns, by considering that each row is uniquely defined by a specific block and crop and each column is uniquely defined by a specific herbicide and block.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="a-brief-intro-to-mixed-models.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb171-2"><a href="a-brief-intro-to-mixed-models.html#cb171-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://www.casaonofri.it/_datasets/recropS.csv&quot;</span>)</span>
<span id="cb171-3"><a href="a-brief-intro-to-mixed-models.html#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataset)</span>
<span id="cb171-4"><a href="a-brief-intro-to-mixed-models.html#cb171-4" aria-hidden="true" tabindex="-1"></a><span class="do">##     Herbicide     Crop Block CropBiomass</span></span>
<span id="cb171-5"><a href="a-brief-intro-to-mixed-models.html#cb171-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 1       Check soyabean     1    199.0831</span></span>
<span id="cb171-6"><a href="a-brief-intro-to-mixed-models.html#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 2       Check soyabean     2    257.3081</span></span>
<span id="cb171-7"><a href="a-brief-intro-to-mixed-models.html#cb171-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 3       Check soyabean     3    345.5538</span></span>
<span id="cb171-8"><a href="a-brief-intro-to-mixed-models.html#cb171-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 4       Check soyabean     4    210.8574</span></span>
<span id="cb171-9"><a href="a-brief-intro-to-mixed-models.html#cb171-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 rimsulfuron soyabean     1    225.5651</span></span>
<span id="cb171-10"><a href="a-brief-intro-to-mixed-models.html#cb171-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 6 rimsulfuron soyabean     2    195.3952</span></span>
<span id="cb171-11"><a href="a-brief-intro-to-mixed-models.html#cb171-11" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Herbicide <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset<span class="sc">$</span>Herbicide)</span>
<span id="cb171-12"><a href="a-brief-intro-to-mixed-models.html#cb171-12" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Crop <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset<span class="sc">$</span>Crop)</span>
<span id="cb171-13"><a href="a-brief-intro-to-mixed-models.html#cb171-13" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Block <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset<span class="sc">$</span>Block)</span>
<span id="cb171-14"><a href="a-brief-intro-to-mixed-models.html#cb171-14" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Rows <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset<span class="sc">$</span>Crop<span class="sc">:</span>dataset<span class="sc">$</span>Block)</span>
<span id="cb171-15"><a href="a-brief-intro-to-mixed-models.html#cb171-15" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Columns <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset<span class="sc">$</span>Herbicide<span class="sc">:</span>dataset<span class="sc">$</span>Block)</span></code></pre></div>
<div id="model-definition-5" class="section level4 hasAnchor" number="13.1.2.1">
<h4><span class="header-section-number">13.1.2.1</span> Model definition<a href="a-brief-intro-to-mixed-models.html#model-definition-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A good candidate model is:</p>
<p><span class="math display">\[Y_{ijk} = \mu + \gamma_k + \alpha_i + \theta_{ik} + \beta_j + \zeta_{jk} + \alpha\beta_{ij} + \varepsilon_{ijk}\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> is the intercept, <span class="math inline">\(\gamma_k\)</span> are the block effects, <span class="math inline">\(\alpha_i\)</span> are the crop effects <span class="math inline">\(\theta_ik\)</span> are the random row effects, <span class="math inline">\(\beta_j\)</span> are the herbicide effects, <span class="math inline">\(\zeta_{jk}\)</span> are the random column effects, <span class="math inline">\(\alpha\beta_{ij}\)</span> are the ‘crop by herbicide’ interaction effects and <span class="math inline">\(\varepsilon_ijk\)</span> is the residual random error term. The three random effects are assumed as gaussian, with mean equal to zero and variances respectively equal to <span class="math inline">\(\sigma_{\theta}\)</span>, <span class="math inline">\(\sigma_{\zeta}\)</span> and <span class="math inline">\(\sigma\)</span>.</p>
</div>
<div id="model-fitting-with-r-3" class="section level4 hasAnchor" number="13.1.2.2">
<h4><span class="header-section-number">13.1.2.2</span> Model fitting with R<a href="a-brief-intro-to-mixed-models.html#model-fitting-with-r-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>At this stage, the code for model fitting should be straightforward, as well as that for variance partitioning</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="a-brief-intro-to-mixed-models.html#cb172-1" aria-hidden="true" tabindex="-1"></a>model.strip <span class="ot">&lt;-</span> <span class="fu">lmer</span>(CropBiomass <span class="sc">~</span> Block <span class="sc">+</span> Herbicide<span class="sc">*</span>Crop <span class="sc">+</span> </span>
<span id="cb172-2"><a href="a-brief-intro-to-mixed-models.html#cb172-2" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span><span class="sc">|</span>Rows) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Columns), <span class="at">data =</span> dataset)</span>
<span id="cb172-3"><a href="a-brief-intro-to-mixed-models.html#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model.strip, <span class="at">ddf =</span> <span class="st">&quot;Kenward-Roger&quot;</span>)</span>
<span id="cb172-4"><a href="a-brief-intro-to-mixed-models.html#cb172-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Type III Analysis of Variance Table with Kenward-Roger&#39;s method</span></span>
<span id="cb172-5"><a href="a-brief-intro-to-mixed-models.html#cb172-5" aria-hidden="true" tabindex="-1"></a><span class="do">##                Sum Sq Mean Sq NumDF  DenDF F value  Pr(&gt;F)  </span></span>
<span id="cb172-6"><a href="a-brief-intro-to-mixed-models.html#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Block           21451  7150.3     3 4.1367  2.5076 0.19387  </span></span>
<span id="cb172-7"><a href="a-brief-intro-to-mixed-models.html#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Herbicide         148   147.9     1 3.0000  0.0519 0.83450  </span></span>
<span id="cb172-8"><a href="a-brief-intro-to-mixed-models.html#cb172-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Crop            43874 21936.9     2 6.0000  7.6932 0.02208 *</span></span>
<span id="cb172-9"><a href="a-brief-intro-to-mixed-models.html#cb172-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Herbicide:Crop  12549  6274.4     2 6.0000  2.2004 0.19198  </span></span>
<span id="cb172-10"><a href="a-brief-intro-to-mixed-models.html#cb172-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb172-11"><a href="a-brief-intro-to-mixed-models.html#cb172-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We see that only the crop effect is significant and, thus, we can be reasonably sure that the herbicide did not provoke unwanted carry-over effects to the crops sown in treated soil 40 days after the treatment.</p>
</div>
</div>
</div>
<div id="sub-sampling-designs" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Sub-sampling designs<a href="a-brief-intro-to-mixed-models.html#sub-sampling-designs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sub-sampling is another very common practice in field experiments. It happens when we collect several random samples from each plot and we submit them to some sort of measurement process. An example is shown in Figure @ref(fig:figName13.1): we have a latin square design with four treatment levels and four replicates and, for each plot, we collect four subsamples from the grain yield and submit them separately to the determination of, e.g., oil content.</p>
<div class="figure" style="text-align: center">
<img src="_images/subsampling2.png" alt="An example of subsampling: from the grain yield of each plot, four samples are randomly collected and separately submitted to chemical analyses" width="90%" />
<p class="caption">
(#fig:figName13.2)An example of subsampling: from the grain yield of each plot, four samples are randomly collected and separately submitted to chemical analyses
</p>
</div>
<p>The presence of sub-samples is a good thing, as long as true-replicates are also available. It must be clear, as we discussed in Chapter 2, that sub-samples are not to be regarded as true replicates, because the experimental treatments were not independently allocated to each of them. The four sub-samples must be regarded as sub-replicates (or pseudo-replicates) and, in absence of true-replicates, the design is to be considered as invalid.</p>
<div id="example-3-a-rcbd-with-sub-sampling" class="section level3 hasAnchor" number="13.2.1">
<h3><span class="header-section-number">13.2.1</span> Example 3: A RCBD with sub-sampling<a href="a-brief-intro-to-mixed-models.html#example-3-a-rcbd-with-sub-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s consider a dataset from an experiment where we had 30 genotypes in three blocks and recorded the Weight of Thousand Kernels (TKW) in three sub-samples per plot. This dataset contains the ‘Sample’ variable, that is used to label the three samples in each plot. In the box below, we load the ‘TKW’ dataset from the usual repository and transform all the explanatory variables into factors.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="a-brief-intro-to-mixed-models.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb173-2"><a href="a-brief-intro-to-mixed-models.html#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb173-3"><a href="a-brief-intro-to-mixed-models.html#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb173-4"><a href="a-brief-intro-to-mixed-models.html#cb173-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-5"><a href="a-brief-intro-to-mixed-models.html#cb173-5" aria-hidden="true" tabindex="-1"></a>filePath <span class="ot">&lt;-</span> <span class="st">&quot;https://www.casaonofri.it/_datasets/TKW.csv&quot;</span></span>
<span id="cb173-6"><a href="a-brief-intro-to-mixed-models.html#cb173-6" aria-hidden="true" tabindex="-1"></a>TKW <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(filePath)</span>
<span id="cb173-7"><a href="a-brief-intro-to-mixed-models.html#cb173-7" aria-hidden="true" tabindex="-1"></a>TKW<span class="sc">$</span>Block <span class="ot">&lt;-</span> <span class="fu">factor</span>(TKW<span class="sc">$</span>Block)</span>
<span id="cb173-8"><a href="a-brief-intro-to-mixed-models.html#cb173-8" aria-hidden="true" tabindex="-1"></a>TKW<span class="sc">$</span>Genotype <span class="ot">&lt;-</span> <span class="fu">factor</span>(TKW<span class="sc">$</span>Genotype)</span>
<span id="cb173-9"><a href="a-brief-intro-to-mixed-models.html#cb173-9" aria-hidden="true" tabindex="-1"></a>TKW<span class="sc">$</span>Sample <span class="ot">&lt;-</span> <span class="fu">factor</span>(TKW<span class="sc">$</span>Sample)</span>
<span id="cb173-10"><a href="a-brief-intro-to-mixed-models.html#cb173-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(TKW)</span>
<span id="cb173-11"><a href="a-brief-intro-to-mixed-models.html#cb173-11" aria-hidden="true" tabindex="-1"></a><span class="do">##   Plot Block  Genotype Sample  TKW</span></span>
<span id="cb173-12"><a href="a-brief-intro-to-mixed-models.html#cb173-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 1    1     1 Meridiano      1 28.6</span></span>
<span id="cb173-13"><a href="a-brief-intro-to-mixed-models.html#cb173-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 2    2     1     Solex      1 33.3</span></span>
<span id="cb173-14"><a href="a-brief-intro-to-mixed-models.html#cb173-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 3    3     1  Liberdur      1 22.3</span></span>
<span id="cb173-15"><a href="a-brief-intro-to-mixed-models.html#cb173-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 4    4     1  Virgilio      1 28.1</span></span>
<span id="cb173-16"><a href="a-brief-intro-to-mixed-models.html#cb173-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 5    5     1   PR22D40      1 26.7</span></span>
<span id="cb173-17"><a href="a-brief-intro-to-mixed-models.html#cb173-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 6    6     1    Ciccio      1 34.2</span></span></code></pre></div>
<p>It may be useful to look at the ‘naive’ analysis, that makes no distinction between true-replicates and sub-replicates and, consequently, regard the design as a RCB with 9 replicates.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="a-brief-intro-to-mixed-models.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Naive analysis</span></span>
<span id="cb174-2"><a href="a-brief-intro-to-mixed-models.html#cb174-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(TKW <span class="sc">~</span> Block <span class="sc">+</span> Genotype, <span class="at">data=</span>TKW)</span>
<span id="cb174-3"><a href="a-brief-intro-to-mixed-models.html#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod)</span>
<span id="cb174-4"><a href="a-brief-intro-to-mixed-models.html#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb174-5"><a href="a-brief-intro-to-mixed-models.html#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb174-6"><a href="a-brief-intro-to-mixed-models.html#cb174-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: TKW</span></span>
<span id="cb174-7"><a href="a-brief-intro-to-mixed-models.html#cb174-7" aria-hidden="true" tabindex="-1"></a><span class="do">##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb174-8"><a href="a-brief-intro-to-mixed-models.html#cb174-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Block       2  110.3  55.169   7.510 0.0006875 ***</span></span>
<span id="cb174-9"><a href="a-brief-intro-to-mixed-models.html#cb174-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype   29 7224.7 249.129  33.913 &lt; 2.2e-16 ***</span></span>
<span id="cb174-10"><a href="a-brief-intro-to-mixed-models.html#cb174-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 238 1748.4   7.346                      </span></span>
<span id="cb174-11"><a href="a-brief-intro-to-mixed-models.html#cb174-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb174-12"><a href="a-brief-intro-to-mixed-models.html#cb174-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb174-13"><a href="a-brief-intro-to-mixed-models.html#cb174-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)<span class="sc">$</span>sigma</span>
<span id="cb174-14"><a href="a-brief-intro-to-mixed-models.html#cb174-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2.710373</span></span>
<span id="cb174-15"><a href="a-brief-intro-to-mixed-models.html#cb174-15" aria-hidden="true" tabindex="-1"></a>pairwise <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">pairs</span>(<span class="fu">emmeans</span>(mod, <span class="sc">~</span>Genotype)))</span>
<span id="cb174-16"><a href="a-brief-intro-to-mixed-models.html#cb174-16" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pairwise<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb174-17"><a href="a-brief-intro-to-mixed-models.html#cb174-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 225</span></span></code></pre></div>
<p>We see that the Root Mean Square Error is 2.71, the F test for the genotypes is highly significant and there are 225 significant pairwise comparisons among the 30 genotypes.</p>
<div id="model-definition-6" class="section level4 hasAnchor" number="13.2.1.1">
<h4><span class="header-section-number">13.2.1.1</span> Model definition<a href="a-brief-intro-to-mixed-models.html#model-definition-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The above analysis is simple, but it is also <strong>terribly wrong</strong>. By putting true-replicates and pseudo-replicates on an equal footing, we have forgotten that the 270 observations are grouped by plot and that the observations in the same plot are more alike than the observations in different plots, because they share the same ‘origin’. In other words, the observations in each plot are correlated and, therefore, the basic assumption of independence of residuals is broken. Furthermore, we pretend a higher degree of precision then we actually have: the three sub-samples are correlated and they do not contribute three full pieces of information.</p>
<p>A fully correct model must make the distinction between replicates and sub-replicates, by including an extra-term for the plots, that are the ‘grouping’ units:</p>
<p><span class="math display">\[ Y_{ijks} = \mu + \alpha_i + \beta_j + \gamma_{k} + \varepsilon_{s}\]</span></p>
<p>In the above model, <span class="math inline">\(Y\)</span> is the thousand kernel weight for the i<sup>th</sup> genotype, j<sup>th</sup> block, k<sup>th</sup> plot and s<sup>th</sup> sub-sample, <span class="math inline">\(\alpha\)</span> is the effect of the i<sup>th</sup> genotype, <span class="math inline">\(\beta\)</span> is the effect of the j<sup>th</sup> block, <span class="math inline">\(\gamma\)</span> is the effect of the the k<sup>th</sup> plot and <span class="math inline">\(\varepsilon\)</span> is the effect of the s<sup>th</sup> subsample. The presence of the <span class="math inline">\(\gamma\)</span> element accounts for the the plot-to-plot differences, so that the independence of model residuals is restored.</p>
<p>Obviously, the difference between plots (for a given genotype and block) must be regarded as purely random, as well as the difference between subplots, within each plot. Consequently, this is a mixed model: the two variance components are <span class="math inline">\(\sigma^2_p\)</span> and <span class="math inline">\(\sigma^2_e\)</span> and we see that the second one is much smaller, as it does not contain some important sources of experimental error, such as the variability due to the soil, or to the cropping practices. Obviously the first component should be given the proper weight when building the correct error term to test for the genotypes.</p>
</div>
<div id="model-fitting-with-r-4" class="section level4 hasAnchor" number="13.2.1.2">
<h4><span class="header-section-number">13.2.1.2</span> Model fitting with R<a href="a-brief-intro-to-mixed-models.html#model-fitting-with-r-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can fit this mixed model by using the <code>lmer()</code> function in the <code>lme4</code> package.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="a-brief-intro-to-mixed-models.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mixed model fit</span></span>
<span id="cb175-2"><a href="a-brief-intro-to-mixed-models.html#cb175-2" aria-hidden="true" tabindex="-1"></a>mod.mix <span class="ot">&lt;-</span> <span class="fu">lmer</span>(TKW <span class="sc">~</span> Block <span class="sc">+</span> Genotype <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Plot), <span class="at">data=</span>TKW)</span>
<span id="cb175-3"><a href="a-brief-intro-to-mixed-models.html#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">VarCorr</span>(mod.mix), <span class="at">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb175-4"><a href="a-brief-intro-to-mixed-models.html#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Groups   Name        Variance</span></span>
<span id="cb175-5"><a href="a-brief-intro-to-mixed-models.html#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Plot     (Intercept) 8.89201 </span></span>
<span id="cb175-6"><a href="a-brief-intro-to-mixed-models.html#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Residual             0.84526</span></span>
<span id="cb175-7"><a href="a-brief-intro-to-mixed-models.html#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod.mix, <span class="at">ddf =</span> <span class="st">&quot;Kenward-Roger&quot;</span>)</span>
<span id="cb175-8"><a href="a-brief-intro-to-mixed-models.html#cb175-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Type III Analysis of Variance Table with Kenward-Roger&#39;s method</span></span>
<span id="cb175-9"><a href="a-brief-intro-to-mixed-models.html#cb175-9" aria-hidden="true" tabindex="-1"></a><span class="do">##           Sum Sq Mean Sq NumDF DenDF F value    Pr(&gt;F)    </span></span>
<span id="cb175-10"><a href="a-brief-intro-to-mixed-models.html#cb175-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Block      3.389  1.6944     2    58  2.0046    0.1439    </span></span>
<span id="cb175-11"><a href="a-brief-intro-to-mixed-models.html#cb175-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype 221.892  7.6515    29    58  9.0522 9.944e-13 ***</span></span>
<span id="cb175-12"><a href="a-brief-intro-to-mixed-models.html#cb175-12" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb175-13"><a href="a-brief-intro-to-mixed-models.html#cb175-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb175-14"><a href="a-brief-intro-to-mixed-models.html#cb175-14" aria-hidden="true" tabindex="-1"></a>pairwise <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">pairs</span>(<span class="fu">emmeans</span>(mod.mix, <span class="sc">~</span>Genotype)))</span>
<span id="cb175-15"><a href="a-brief-intro-to-mixed-models.html#cb175-15" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pairwise<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb175-16"><a href="a-brief-intro-to-mixed-models.html#cb175-16" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 91</span></span></code></pre></div>
<p>We do not show the results of pairwise comparisons for the sake of brevity; however, we point out that there are several differences with respect to the previous ‘naive’ fit:</p>
<ol style="list-style-type: decimal">
<li>in the ‘naive’ model, we have only one estimate for <span class="math inline">\(\sigma^2\)</span>, that is 7.346 with 238 DF. In this case the correct term to test for the genotype effect is <span class="math inline">\(\sigma^2_p\)</span>, that is equal to 8.892 with 58 DF. Clearly, the naive analysis strongly overestimates the number of DF: the observations taken in the same plot are correlated and they do not contribute full information.</li>
<li>The RMSE for the mixed model is equal to 2.98 and it is higher than that from the ‘naive’ fit. The variability within plots is much smaller.</li>
<li>The number of significant pairwise comparisons between genotypes has dropped to 91.</li>
</ol>
</div>
<div id="a-simpler-alternative" class="section level4 hasAnchor" number="13.2.1.3">
<h4><span class="header-section-number">13.2.1.3</span> A simpler alternative<a href="a-brief-intro-to-mixed-models.html#a-simpler-alternative" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We strongly recommend the previous method of data analysis, but, whenever the number of sub-samples is the same for all plots, we can also reach correct results by proceeding in two-steps. In the first step, we calculate the means of sub-samples for each plot and, in the second step, we submit the plot means to ANOVA, by considering the genotype and the block as fixed factors. In the box below we can see that the results are exactly the same as with the mixed model fit.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="a-brief-intro-to-mixed-models.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First step</span></span>
<span id="cb176-2"><a href="a-brief-intro-to-mixed-models.html#cb176-2" aria-hidden="true" tabindex="-1"></a>TKWm <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(TKW <span class="sc">~</span> Block <span class="sc">+</span> Genotype, <span class="at">data =</span> TKW, mean)</span>
<span id="cb176-3"><a href="a-brief-intro-to-mixed-models.html#cb176-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-4"><a href="a-brief-intro-to-mixed-models.html#cb176-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Second step</span></span>
<span id="cb176-5"><a href="a-brief-intro-to-mixed-models.html#cb176-5" aria-hidden="true" tabindex="-1"></a>mod2step <span class="ot">&lt;-</span> <span class="fu">lm</span>(TKW <span class="sc">~</span> Genotype <span class="sc">+</span> Block, <span class="at">data =</span> TKWm)</span>
<span id="cb176-6"><a href="a-brief-intro-to-mixed-models.html#cb176-6" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2step)</span>
<span id="cb176-7"><a href="a-brief-intro-to-mixed-models.html#cb176-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb176-8"><a href="a-brief-intro-to-mixed-models.html#cb176-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb176-9"><a href="a-brief-intro-to-mixed-models.html#cb176-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: TKW</span></span>
<span id="cb176-10"><a href="a-brief-intro-to-mixed-models.html#cb176-10" aria-hidden="true" tabindex="-1"></a><span class="do">##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb176-11"><a href="a-brief-intro-to-mixed-models.html#cb176-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype  29 2408.24  83.043  9.0522 9.943e-13 ***</span></span>
<span id="cb176-12"><a href="a-brief-intro-to-mixed-models.html#cb176-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Block      2   36.78  18.390  2.0046    0.1439    </span></span>
<span id="cb176-13"><a href="a-brief-intro-to-mixed-models.html#cb176-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 58  532.08   9.174                      </span></span>
<span id="cb176-14"><a href="a-brief-intro-to-mixed-models.html#cb176-14" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb176-15"><a href="a-brief-intro-to-mixed-models.html#cb176-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
</div>
</div>
<div id="repeated-experiments" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Repeated experiments<a href="a-brief-intro-to-mixed-models.html#repeated-experiments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Chapter 1 we mentioned that results need to be replicable and, hopefully, reproducible. The presence of true replicates ensures replicability, i.e. that the results can be reproduced in the same conditions. However, true replication does not ensure that the results are reproducible in different conditions.</p>
<p>For this reason, experiments should be usually repeated in different runs, sites, years or, more generally, in different environments. This is a fundamental key to scientific progress in agriculture and permits sound generalisation; otherwise, the results are specific to the conditions in which they were obtained and their scope is rather limited. Multi-year or multi-site experiments are very common, e.g., in plant breeding and they may involve wide groups of research units across countries or continents. These research units usually employ a commone core of genotypes and the same experimental design (e.g.: randomised complete blocks with 3-4 replicates), while innovative genotypes are progressively introduced in each year and the old ones tend to be abandoned.</p>
<p>Apart from genotype trials, all types of field experiments should be usually repeated at least in two-three different environments (sites or years) to have a minimum appraisal of the reproducibility of results. More generally, we should not underrate the importance of repeating all types of experiments, including those performed in the greenhouse or in controlled conditions, especially when we make use of sampled units from populations with a high degree of spatial or temporal variability (e.g.: seeds, plants, leaves and so on). Based on our experience, we suggest that the variability of results across different runs of the same experiment may be pretty high and, therefore, we argue that a single experiment in agriculture proves nothing.</p>
<div id="a-model-for-pooling-the-results" class="section level3 hasAnchor" number="13.3.1">
<h3><span class="header-section-number">13.3.1</span> A model for pooling the results<a href="a-brief-intro-to-mixed-models.html#a-model-for-pooling-the-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In general, each repeated experiment produces data that can be analysed on its own, by using one of the methods described in the previous chapters. However, a pooled analysis is in order, to consolidate the results over the runs and assess their reproducibility. When we pool a set of one-factor experiments, the pooled dataset becomes similar to a two-factor factorial experiment; analogously to what we have described in Chapter 11, a possible model is:</p>
<p><span class="math display">\[ y_{ijk} = \mu + \alpha_i + \beta_j + \alpha\beta_{ij} + \varepsilon_{ijk}\]</span></p>
<p>where <span class="math inline">\(y\)</span> is the response for the i<sup>th</sup> run, j<sup>th</sup> treatment level and k<sup>th</sup> replicate, <span class="math inline">\(\mu\)</span> is the intercept (the overall mean, when the sum-to-zero constraint is adopted), <span class="math inline">\(\alpha\)</span> is the effect of the i<sup>th</sup> run, <span class="math inline">\(\beta\)</span> is the effect of the j<sup>th</sup> treatment level, <span class="math inline">\(\alpha\beta\)</span> is the ‘treatment x run’ interaction effect and <span class="math inline">\(\varepsilon\)</span> is the residual random effect for each observation, which we assume as normally distributed (<span class="math inline">\(\epsilon_{ijk} \sim N(0, \sigma_{\varepsilon})\)</span>)</p>
<p>One difference with two-factor factorial experiments is that, when we repeat experiments laid down in complete blocks, we need to add to the model the term <span class="math inline">\(\gamma_{ik}\)</span>, that is the effect of the k<sup>th</sup> block in the i<sup>th</sup> run. Indeed, the block effect is nested within runs, as the block levels are usually different in different runs.</p>
<p>Obviously, if we need to pool a set of multi-factorial experiments, the model becomes more complex and we need to include all possible interactions between the treatment factors and their combinations with the run factor. For example, if we have a set of two-factor (A and B) factorial experiments, we need to consider the following effects (in R notation): ‘A + B + A:B + A:run + B:run + A:B:run’, that is equivalent to writing ‘A * B * run’.</p>
</div>
<div id="preliminary-analyses" class="section level3 hasAnchor" number="13.3.2">
<h3><span class="header-section-number">13.3.2</span> Preliminary analyses<a href="a-brief-intro-to-mixed-models.html#preliminary-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is always convenient to start with a preliminary evaluation of each single experiment and, afterwards, perform a pooled fit. We would suggest this process:</p>
<ol style="list-style-type: decimal">
<li>fit an ANOVA model to each experiment (as shown in previous Chapters);</li>
<li>inspect the data to assess whether we have good data for all runs. Search for possible outliers and for heteroscedasticity of within-run errors (as shown in Chapter 8);</li>
<li>if possible, fit a pooled model;</li>
<li>inspect the residuals from the pooled model, with particular reference to possible heteroscedasticy across runs.</li>
</ol>
</div>
<div id="fixed-or-random-runs" class="section level3 hasAnchor" number="13.3.3">
<h3><span class="header-section-number">13.3.3</span> Fixed or random runs?<a href="a-brief-intro-to-mixed-models.html#fixed-or-random-runs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What is peculiar about repeated experiments is that we always need to take a decision about the nature of the run effect, whether it is ‘fixed’ or ‘random’. Such decision is specific to each experiment and it is up to the researcher, who should give solid reasons to support it. It is not easy to give suggestions; as the rule of thumb, whenever the experiment is repeated in a small number of runs (e.g. 2 or 3), we could think of taking the run effect as fixed. Indeed, a reliable estimation of variance components requires that the number of levels for the random factor is sufficiently high (roughly 4, at least).</p>
<p>With field experiments repeated in a relatively high number of years/locations, the year effect seems to be reasonably random. Indeed, although the years are not sampled (we cannot sample years, we can only take them in the same order as they come), the effects they produce are not repeatable and they are clearly of random nature. On the other hand, the location effect is more dubious: sometimes, the locations are selected on purpose and they are interesting on themselves, so that the location effect is fixed. In other instances, locations are sampled to represent a macro-environment and, therefore, their effect is random.</p>
<p>Selecting the run factor as fixed or random has an impact on the results of data analyses, as we will see in the following two examples.</p>
</div>
<div id="example-4-a-seed-germination-experiment-in-two-runs" class="section level3 hasAnchor" number="13.3.4">
<h3><span class="header-section-number">13.3.4</span> Example 4: a seed germination experiment in two runs<a href="a-brief-intro-to-mixed-models.html#example-4-a-seed-germination-experiment-in-two-runs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The germination of three genotypes of oilseed rape was assessed by a greenhouse bioassay with six replicated Petri dishes per genotype (18 dishes in total). Fifty seeds were put in each dish and the number of germinated seeds was counted after 15 days and expressed as the Final Proportion of Germinated seeds (FGP). The assay was repeated twice in slightly different conditions, because the environmental parameters in the greenhouse were not under full control. The results are online available as the ‘FGP_rape.csv’ text file and they can be loaded by using the code below.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="a-brief-intro-to-mixed-models.html#cb177-1" aria-hidden="true" tabindex="-1"></a>fileName <span class="ot">&lt;-</span> <span class="st">&quot;https://www.casaonofri.it/_datasets/FGP_rape.csv&quot;</span></span>
<span id="cb177-2"><a href="a-brief-intro-to-mixed-models.html#cb177-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(fileName)</span>
<span id="cb177-3"><a href="a-brief-intro-to-mixed-models.html#cb177-3" aria-hidden="true" tabindex="-1"></a>dataset[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(dataset[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], factor)</span></code></pre></div>
<p>Preliminarily, in order to fit the ANOVA models to each single run, we can very much simplify the coding by using the ‘by()’ and ‘lapply()’ functions. The first one, operates on subsets of the selected dataset, according to a classification variable (the run, in this case) and produces a list with the resulting model objects. ‘Lapply()’ applies a function to all elements in a list and, in the following code, we used it to perform a Levene’s test for homoscedasticity and a Shapiro-Wilks test for normality.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="a-brief-intro-to-mixed-models.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb178-2"><a href="a-brief-intro-to-mixed-models.html#cb178-2" aria-hidden="true" tabindex="-1"></a>lmFits <span class="ot">&lt;-</span> <span class="fu">by</span>(dataset, dataset<span class="sc">$</span>Run,  </span>
<span id="cb178-3"><a href="a-brief-intro-to-mixed-models.html#cb178-3" aria-hidden="true" tabindex="-1"></a>      <span class="cf">function</span>(df) <span class="fu">lm</span>(FGP <span class="sc">~</span> Genotype, <span class="at">data =</span> df) )</span>
<span id="cb178-4"><a href="a-brief-intro-to-mixed-models.html#cb178-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-5"><a href="a-brief-intro-to-mixed-models.html#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for within-experiments homoscedasticity/normality</span></span>
<span id="cb178-6"><a href="a-brief-intro-to-mixed-models.html#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(lmFits, <span class="cf">function</span>(mods) car<span class="sc">::</span><span class="fu">leveneTest</span>(mods))</span>
<span id="cb178-7"><a href="a-brief-intro-to-mixed-models.html#cb178-7" aria-hidden="true" tabindex="-1"></a><span class="do">## $`1`</span></span>
<span id="cb178-8"><a href="a-brief-intro-to-mixed-models.html#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Levene&#39;s Test for Homogeneity of Variance (center = median)</span></span>
<span id="cb178-9"><a href="a-brief-intro-to-mixed-models.html#cb178-9" aria-hidden="true" tabindex="-1"></a><span class="do">##       Df F value Pr(&gt;F)</span></span>
<span id="cb178-10"><a href="a-brief-intro-to-mixed-models.html#cb178-10" aria-hidden="true" tabindex="-1"></a><span class="do">## group  2  2.6856 0.1007</span></span>
<span id="cb178-11"><a href="a-brief-intro-to-mixed-models.html#cb178-11" aria-hidden="true" tabindex="-1"></a><span class="do">##       15               </span></span>
<span id="cb178-12"><a href="a-brief-intro-to-mixed-models.html#cb178-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb178-13"><a href="a-brief-intro-to-mixed-models.html#cb178-13" aria-hidden="true" tabindex="-1"></a><span class="do">## $`2`</span></span>
<span id="cb178-14"><a href="a-brief-intro-to-mixed-models.html#cb178-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Levene&#39;s Test for Homogeneity of Variance (center = median)</span></span>
<span id="cb178-15"><a href="a-brief-intro-to-mixed-models.html#cb178-15" aria-hidden="true" tabindex="-1"></a><span class="do">##       Df F value Pr(&gt;F)</span></span>
<span id="cb178-16"><a href="a-brief-intro-to-mixed-models.html#cb178-16" aria-hidden="true" tabindex="-1"></a><span class="do">## group  2   1.222 0.3224</span></span>
<span id="cb178-17"><a href="a-brief-intro-to-mixed-models.html#cb178-17" aria-hidden="true" tabindex="-1"></a><span class="do">##       15</span></span>
<span id="cb178-18"><a href="a-brief-intro-to-mixed-models.html#cb178-18" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(lmFits, <span class="cf">function</span>(mods) <span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mods)))</span>
<span id="cb178-19"><a href="a-brief-intro-to-mixed-models.html#cb178-19" aria-hidden="true" tabindex="-1"></a><span class="do">## $`1`</span></span>
<span id="cb178-20"><a href="a-brief-intro-to-mixed-models.html#cb178-20" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb178-21"><a href="a-brief-intro-to-mixed-models.html#cb178-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  Shapiro-Wilk normality test</span></span>
<span id="cb178-22"><a href="a-brief-intro-to-mixed-models.html#cb178-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb178-23"><a href="a-brief-intro-to-mixed-models.html#cb178-23" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  residuals(mods)</span></span>
<span id="cb178-24"><a href="a-brief-intro-to-mixed-models.html#cb178-24" aria-hidden="true" tabindex="-1"></a><span class="do">## W = 0.94221, p-value = 0.316</span></span>
<span id="cb178-25"><a href="a-brief-intro-to-mixed-models.html#cb178-25" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb178-26"><a href="a-brief-intro-to-mixed-models.html#cb178-26" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb178-27"><a href="a-brief-intro-to-mixed-models.html#cb178-27" aria-hidden="true" tabindex="-1"></a><span class="do">## $`2`</span></span>
<span id="cb178-28"><a href="a-brief-intro-to-mixed-models.html#cb178-28" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb178-29"><a href="a-brief-intro-to-mixed-models.html#cb178-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  Shapiro-Wilk normality test</span></span>
<span id="cb178-30"><a href="a-brief-intro-to-mixed-models.html#cb178-30" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb178-31"><a href="a-brief-intro-to-mixed-models.html#cb178-31" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  residuals(mods)</span></span>
<span id="cb178-32"><a href="a-brief-intro-to-mixed-models.html#cb178-32" aria-hidden="true" tabindex="-1"></a><span class="do">## W = 0.93291, p-value = 0.2184</span></span>
<span id="cb178-33"><a href="a-brief-intro-to-mixed-models.html#cb178-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance partitioning</span></span>
<span id="cb178-34"><a href="a-brief-intro-to-mixed-models.html#cb178-34" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(lmFits, <span class="cf">function</span>(mods) <span class="fu">anova</span>(mods))</span>
<span id="cb178-35"><a href="a-brief-intro-to-mixed-models.html#cb178-35" aria-hidden="true" tabindex="-1"></a><span class="do">## $`1`</span></span>
<span id="cb178-36"><a href="a-brief-intro-to-mixed-models.html#cb178-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb178-37"><a href="a-brief-intro-to-mixed-models.html#cb178-37" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb178-38"><a href="a-brief-intro-to-mixed-models.html#cb178-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: FGP</span></span>
<span id="cb178-39"><a href="a-brief-intro-to-mixed-models.html#cb178-39" aria-hidden="true" tabindex="-1"></a><span class="do">##           Df   Sum Sq   Mean Sq F value   Pr(&gt;F)   </span></span>
<span id="cb178-40"><a href="a-brief-intro-to-mixed-models.html#cb178-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype   2 0.033011 0.0165056  8.1353 0.004047 **</span></span>
<span id="cb178-41"><a href="a-brief-intro-to-mixed-models.html#cb178-41" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 15 0.030433 0.0020289                    </span></span>
<span id="cb178-42"><a href="a-brief-intro-to-mixed-models.html#cb178-42" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb178-43"><a href="a-brief-intro-to-mixed-models.html#cb178-43" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb178-44"><a href="a-brief-intro-to-mixed-models.html#cb178-44" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb178-45"><a href="a-brief-intro-to-mixed-models.html#cb178-45" aria-hidden="true" tabindex="-1"></a><span class="do">## $`2`</span></span>
<span id="cb178-46"><a href="a-brief-intro-to-mixed-models.html#cb178-46" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb178-47"><a href="a-brief-intro-to-mixed-models.html#cb178-47" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb178-48"><a href="a-brief-intro-to-mixed-models.html#cb178-48" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: FGP</span></span>
<span id="cb178-49"><a href="a-brief-intro-to-mixed-models.html#cb178-49" aria-hidden="true" tabindex="-1"></a><span class="do">##           Df   Sum Sq   Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb178-50"><a href="a-brief-intro-to-mixed-models.html#cb178-50" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype   2 0.042544 0.0212722   22.34 3.177e-05 ***</span></span>
<span id="cb178-51"><a href="a-brief-intro-to-mixed-models.html#cb178-51" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 15 0.014283 0.0009522                      </span></span>
<span id="cb178-52"><a href="a-brief-intro-to-mixed-models.html#cb178-52" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb178-53"><a href="a-brief-intro-to-mixed-models.html#cb178-53" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The previous results demonstrate that the basic assumptions for linear models are reasonably met and that the two assays produced significant results, in relation to the genotype effect. Therefore, we move on to pooling the data from the two experiments.</p>
<div id="model-fitting-with-r-5" class="section level4 hasAnchor" number="13.3.4.1">
<h4><span class="header-section-number">13.3.4.1</span> Model fitting with R<a href="a-brief-intro-to-mixed-models.html#model-fitting-with-r-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As we have only two runs in similar (not totally equivalent) environmental conditions, it might be appropriate to regard the ‘run’ effect as fixed: are the results comparable across these two specific runs? Consequently, we have a fixed effects model, that can be fitted by using the <code>lm()</code> function, as shown in the box below:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="a-brief-intro-to-mixed-models.html#cb179-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(FGP <span class="sc">~</span> Genotype <span class="sc">*</span> Run, <span class="at">data =</span> dataset)</span></code></pre></div>
<p>Before looking at the results, we need to check the whole model and, in particular, we need to check that the residuals from the different runs have homogeneous variances. We do so by using a likelihood approach that is available in the ‘check.hom()’ function in the aomisc package.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="a-brief-intro-to-mixed-models.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb180-2"><a href="a-brief-intro-to-mixed-models.html#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aomisc)</span>
<span id="cb180-3"><a href="a-brief-intro-to-mixed-models.html#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: drc</span></span>
<span id="cb180-4"><a href="a-brief-intro-to-mixed-models.html#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: drcData</span></span>
<span id="cb180-5"><a href="a-brief-intro-to-mixed-models.html#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb180-6"><a href="a-brief-intro-to-mixed-models.html#cb180-6" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;drc&#39; has been loaded.</span></span>
<span id="cb180-7"><a href="a-brief-intro-to-mixed-models.html#cb180-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Please cite R and &#39;drc&#39; if used for a publication,</span></span>
<span id="cb180-8"><a href="a-brief-intro-to-mixed-models.html#cb180-8" aria-hidden="true" tabindex="-1"></a><span class="do">## for references type &#39;citation()&#39; and &#39;citation(&#39;drc&#39;)&#39;.</span></span>
<span id="cb180-9"><a href="a-brief-intro-to-mixed-models.html#cb180-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb180-10"><a href="a-brief-intro-to-mixed-models.html#cb180-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Attaching package: &#39;drc&#39;</span></span>
<span id="cb180-11"><a href="a-brief-intro-to-mixed-models.html#cb180-11" aria-hidden="true" tabindex="-1"></a><span class="do">## The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb180-12"><a href="a-brief-intro-to-mixed-models.html#cb180-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb180-13"><a href="a-brief-intro-to-mixed-models.html#cb180-13" aria-hidden="true" tabindex="-1"></a><span class="do">##     gaussian, getInitial</span></span>
<span id="cb180-14"><a href="a-brief-intro-to-mixed-models.html#cb180-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: plyr</span></span>
<span id="cb180-15"><a href="a-brief-intro-to-mixed-models.html#cb180-15" aria-hidden="true" tabindex="-1"></a><span class="do">## --------------------------------------------------------------------</span></span>
<span id="cb180-16"><a href="a-brief-intro-to-mixed-models.html#cb180-16" aria-hidden="true" tabindex="-1"></a><span class="do">## You have loaded plyr after dplyr - this is likely to cause problems.</span></span>
<span id="cb180-17"><a href="a-brief-intro-to-mixed-models.html#cb180-17" aria-hidden="true" tabindex="-1"></a><span class="do">## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:</span></span>
<span id="cb180-18"><a href="a-brief-intro-to-mixed-models.html#cb180-18" aria-hidden="true" tabindex="-1"></a><span class="do">## library(plyr); library(dplyr)</span></span>
<span id="cb180-19"><a href="a-brief-intro-to-mixed-models.html#cb180-19" aria-hidden="true" tabindex="-1"></a><span class="do">## --------------------------------------------------------------------</span></span>
<span id="cb180-20"><a href="a-brief-intro-to-mixed-models.html#cb180-20" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb180-21"><a href="a-brief-intro-to-mixed-models.html#cb180-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Attaching package: &#39;plyr&#39;</span></span>
<span id="cb180-22"><a href="a-brief-intro-to-mixed-models.html#cb180-22" aria-hidden="true" tabindex="-1"></a><span class="do">## The following objects are masked from &#39;package:reshape&#39;:</span></span>
<span id="cb180-23"><a href="a-brief-intro-to-mixed-models.html#cb180-23" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb180-24"><a href="a-brief-intro-to-mixed-models.html#cb180-24" aria-hidden="true" tabindex="-1"></a><span class="do">##     rename, round_any</span></span>
<span id="cb180-25"><a href="a-brief-intro-to-mixed-models.html#cb180-25" aria-hidden="true" tabindex="-1"></a><span class="do">## The following objects are masked from &#39;package:dplyr&#39;:</span></span>
<span id="cb180-26"><a href="a-brief-intro-to-mixed-models.html#cb180-26" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb180-27"><a href="a-brief-intro-to-mixed-models.html#cb180-27" aria-hidden="true" tabindex="-1"></a><span class="do">##     arrange, count, desc, failwith, id, mutate, rename,</span></span>
<span id="cb180-28"><a href="a-brief-intro-to-mixed-models.html#cb180-28" aria-hidden="true" tabindex="-1"></a><span class="do">##     summarise, summarize</span></span>
<span id="cb180-29"><a href="a-brief-intro-to-mixed-models.html#cb180-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: car</span></span>
<span id="cb180-30"><a href="a-brief-intro-to-mixed-models.html#cb180-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: carData</span></span>
<span id="cb180-31"><a href="a-brief-intro-to-mixed-models.html#cb180-31" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb180-32"><a href="a-brief-intro-to-mixed-models.html#cb180-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Attaching package: &#39;car&#39;</span></span>
<span id="cb180-33"><a href="a-brief-intro-to-mixed-models.html#cb180-33" aria-hidden="true" tabindex="-1"></a><span class="do">## The following object is masked from &#39;package:dplyr&#39;:</span></span>
<span id="cb180-34"><a href="a-brief-intro-to-mixed-models.html#cb180-34" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb180-35"><a href="a-brief-intro-to-mixed-models.html#cb180-35" aria-hidden="true" tabindex="-1"></a><span class="do">##     recode</span></span>
<span id="cb180-36"><a href="a-brief-intro-to-mixed-models.html#cb180-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: multcompView</span></span>
<span id="cb180-37"><a href="a-brief-intro-to-mixed-models.html#cb180-37" aria-hidden="true" tabindex="-1"></a><span class="do">## Registered S3 method overwritten by &#39;aomisc&#39;:</span></span>
<span id="cb180-38"><a href="a-brief-intro-to-mixed-models.html#cb180-38" aria-hidden="true" tabindex="-1"></a><span class="do">##   method   from</span></span>
<span id="cb180-39"><a href="a-brief-intro-to-mixed-models.html#cb180-39" aria-hidden="true" tabindex="-1"></a><span class="do">##   plot.nls nlme</span></span>
<span id="cb180-40"><a href="a-brief-intro-to-mixed-models.html#cb180-40" aria-hidden="true" tabindex="-1"></a>check <span class="ot">&lt;-</span> <span class="fu">check.hom</span>(mod, Run)</span>
<span id="cb180-41"><a href="a-brief-intro-to-mixed-models.html#cb180-41" aria-hidden="true" tabindex="-1"></a>check<span class="sc">$</span>aovtable</span>
<span id="cb180-42"><a href="a-brief-intro-to-mixed-models.html#cb180-42" aria-hidden="true" tabindex="-1"></a><span class="do">##      Model df       AIC       BIC   logLik   Test  L.Ratio p-value</span></span>
<span id="cb180-43"><a href="a-brief-intro-to-mixed-models.html#cb180-43" aria-hidden="true" tabindex="-1"></a><span class="do">## mod1     1  7 -85.37132 -75.56294 49.68566                        </span></span>
<span id="cb180-44"><a href="a-brief-intro-to-mixed-models.html#cb180-44" aria-hidden="true" tabindex="-1"></a><span class="do">## mod2     2  8 -85.46782 -74.25824 50.73391 1 vs 2 2.096495  0.1476</span></span></code></pre></div>
<p>We see that the null hypothesis of no heteroscedasticity of residuals across runs can be accepted and, therefore, we inspect the ANOVA table for the model fit.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="a-brief-intro-to-mixed-models.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod)</span>
<span id="cb181-2"><a href="a-brief-intro-to-mixed-models.html#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb181-3"><a href="a-brief-intro-to-mixed-models.html#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb181-4"><a href="a-brief-intro-to-mixed-models.html#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: FGP</span></span>
<span id="cb181-5"><a href="a-brief-intro-to-mixed-models.html#cb181-5" aria-hidden="true" tabindex="-1"></a><span class="do">##              Df   Sum Sq  Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb181-6"><a href="a-brief-intro-to-mixed-models.html#cb181-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype      2 0.074289 0.037144 24.9199 4.203e-07 ***</span></span>
<span id="cb181-7"><a href="a-brief-intro-to-mixed-models.html#cb181-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Run           1 0.003025 0.003025  2.0294    0.1646    </span></span>
<span id="cb181-8"><a href="a-brief-intro-to-mixed-models.html#cb181-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype:Run  2 0.001267 0.000633  0.4249    0.6577    </span></span>
<span id="cb181-9"><a href="a-brief-intro-to-mixed-models.html#cb181-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals    30 0.044717 0.001491                      </span></span>
<span id="cb181-10"><a href="a-brief-intro-to-mixed-models.html#cb181-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb181-11"><a href="a-brief-intro-to-mixed-models.html#cb181-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>In general, inspecting the ANOVA table gives us the possibility of veryifing to what extent the results of the first run were reproducible in the second run. When the run effect is fixed, the interpretation is very much like that for a two-factor factorial experiment; indeed, we can encounter the following situations:</p>
<ol style="list-style-type: decimal">
<li>the ‘run by treatment’ interaction is significant. In this case, we ought to conclude that the effects of treatment levels and, possibly, their ranking, changed in each run. Consequently, the results of our experiment were not reproducible and it makes no sense to try to pool them: <strong>we should only display and compare the means of treatment levels within each environment/run</strong>.</li>
<li>The interaction is not significant, but the run main effect is significant. We ought to conclude that the treatment effect and the run effect were independent and additive; consequently, the means for treatment levels changed across repetitions, but treatment effects were fully reproducible. It is up to the researcher to decide whether it is appropriate and meaningful to calculate and display the means for treatment levels.</li>
<li>Neither the interaction, nor the run main effects are significant. The results of the repeated experiments are fully reproducible and it is usually appropriate to report only the means for treatment levels.</li>
</ol>
<p>For our example, we see that the ‘run’ and ‘run by treatment’ effects are not significant, which means that the results are fully reproducible. Therefore, we are allowed to pool the two runs and compare the genotypes across runs, by using the usual ‘emmeans()’ function in the ‘emmeans()’ package.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="a-brief-intro-to-mixed-models.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb182-2"><a href="a-brief-intro-to-mixed-models.html#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb182-3"><a href="a-brief-intro-to-mixed-models.html#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: mvtnorm</span></span>
<span id="cb182-4"><a href="a-brief-intro-to-mixed-models.html#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: survival</span></span>
<span id="cb182-5"><a href="a-brief-intro-to-mixed-models.html#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: TH.data</span></span>
<span id="cb182-6"><a href="a-brief-intro-to-mixed-models.html#cb182-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb182-7"><a href="a-brief-intro-to-mixed-models.html#cb182-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Attaching package: &#39;TH.data&#39;</span></span>
<span id="cb182-8"><a href="a-brief-intro-to-mixed-models.html#cb182-8" aria-hidden="true" tabindex="-1"></a><span class="do">## The following object is masked from &#39;package:MASS&#39;:</span></span>
<span id="cb182-9"><a href="a-brief-intro-to-mixed-models.html#cb182-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb182-10"><a href="a-brief-intro-to-mixed-models.html#cb182-10" aria-hidden="true" tabindex="-1"></a><span class="do">##     geyser</span></span>
<span id="cb182-11"><a href="a-brief-intro-to-mixed-models.html#cb182-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(<span class="fu">emmeans</span>(mod, <span class="sc">~</span> Genotype), <span class="at">Letters =</span> LETTERS)</span>
<span id="cb182-12"><a href="a-brief-intro-to-mixed-models.html#cb182-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: Results may be misleading due to involvement in interactions</span></span>
<span id="cb182-13"><a href="a-brief-intro-to-mixed-models.html#cb182-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  Genotype emmean     SE df lower.CL upper.CL .group</span></span>
<span id="cb182-14"><a href="a-brief-intro-to-mixed-models.html#cb182-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  C         0.781 0.0111 30    0.758    0.804  A    </span></span>
<span id="cb182-15"><a href="a-brief-intro-to-mixed-models.html#cb182-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  A         0.871 0.0111 30    0.848    0.894   B   </span></span>
<span id="cb182-16"><a href="a-brief-intro-to-mixed-models.html#cb182-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  B         0.882 0.0111 30    0.860    0.905   B   </span></span>
<span id="cb182-17"><a href="a-brief-intro-to-mixed-models.html#cb182-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb182-18"><a href="a-brief-intro-to-mixed-models.html#cb182-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Results are averaged over the levels of: Run </span></span>
<span id="cb182-19"><a href="a-brief-intro-to-mixed-models.html#cb182-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb182-20"><a href="a-brief-intro-to-mixed-models.html#cb182-20" aria-hidden="true" tabindex="-1"></a><span class="do">## P value adjustment: tukey method for comparing a family of 3 estimates </span></span>
<span id="cb182-21"><a href="a-brief-intro-to-mixed-models.html#cb182-21" aria-hidden="true" tabindex="-1"></a><span class="do">## significance level used: alpha = 0.05 </span></span>
<span id="cb182-22"><a href="a-brief-intro-to-mixed-models.html#cb182-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: If two or more means share the same grouping symbol,</span></span>
<span id="cb182-23"><a href="a-brief-intro-to-mixed-models.html#cb182-23" aria-hidden="true" tabindex="-1"></a><span class="do">##       then we cannot show them to be different.</span></span>
<span id="cb182-24"><a href="a-brief-intro-to-mixed-models.html#cb182-24" aria-hidden="true" tabindex="-1"></a><span class="do">##       But we also did not show them to be the same.</span></span></code></pre></div>
</div>
</div>
<div id="example-5-a-multi-year-winter-wheat-experiment" class="section level3 hasAnchor" number="13.3.5">
<h3><span class="header-section-number">13.3.5</span> Example 5: a multi-year winter wheat experiment<a href="a-brief-intro-to-mixed-models.html#example-5-a-multi-year-winter-wheat-experiment" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s consider a field experiment to compare eight winter wheat genotypes, laid down in complete blocks, with three replicates. The experiment was repeated in seven years; please, note that part of this dataset has already been used for the example at Chapter 10. The response variable is the yield, in tons per hectare.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="a-brief-intro-to-mixed-models.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb183-2"><a href="a-brief-intro-to-mixed-models.html#cb183-2" aria-hidden="true" tabindex="-1"></a>fileName <span class="ot">&lt;-</span> <span class="st">&quot;https://www.casaonofri.it/_datasets/WinterWheat.csv&quot;</span></span>
<span id="cb183-3"><a href="a-brief-intro-to-mixed-models.html#cb183-3" aria-hidden="true" tabindex="-1"></a>WinterWheat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(fileName)</span>
<span id="cb183-4"><a href="a-brief-intro-to-mixed-models.html#cb183-4" aria-hidden="true" tabindex="-1"></a>WinterWheat<span class="sc">$</span>Block <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(WinterWheat<span class="sc">$</span>Block)</span>
<span id="cb183-5"><a href="a-brief-intro-to-mixed-models.html#cb183-5" aria-hidden="true" tabindex="-1"></a>WinterWheat<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(WinterWheat<span class="sc">$</span>Year)</span>
<span id="cb183-6"><a href="a-brief-intro-to-mixed-models.html#cb183-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(WinterWheat, <span class="dv">8</span>)</span>
<span id="cb183-7"><a href="a-brief-intro-to-mixed-models.html#cb183-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   Plot Block Genotype Yield Year</span></span>
<span id="cb183-8"><a href="a-brief-intro-to-mixed-models.html#cb183-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 1    2     1 COLOSSEO  6.73 1996</span></span>
<span id="cb183-9"><a href="a-brief-intro-to-mixed-models.html#cb183-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  110     2 COLOSSEO  6.96 1996</span></span>
<span id="cb183-10"><a href="a-brief-intro-to-mixed-models.html#cb183-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 3  181     3 COLOSSEO  5.35 1996</span></span>
<span id="cb183-11"><a href="a-brief-intro-to-mixed-models.html#cb183-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 4    2     1 COLOSSEO  6.26 1997</span></span>
<span id="cb183-12"><a href="a-brief-intro-to-mixed-models.html#cb183-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 5  110     2 COLOSSEO  7.01 1997</span></span>
<span id="cb183-13"><a href="a-brief-intro-to-mixed-models.html#cb183-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 6  181     3 COLOSSEO  6.11 1997</span></span>
<span id="cb183-14"><a href="a-brief-intro-to-mixed-models.html#cb183-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 7   17     1 COLOSSEO  6.75 1998</span></span>
<span id="cb183-15"><a href="a-brief-intro-to-mixed-models.html#cb183-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 8  110     2 COLOSSEO  6.82 1998</span></span></code></pre></div>
<p>For the sake of simplicity and brevity, we disregard the preliminary analyses of each single experiment, which could be performed by using the same code as given for the previous example.</p>
<div id="model-fitting-with-r-6" class="section level4 hasAnchor" number="13.3.5.1">
<h4><span class="header-section-number">13.3.5.1</span> Model fitting with R<a href="a-brief-intro-to-mixed-models.html#model-fitting-with-r-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We have a relatively high number of years and, as we explained, the year effect is intrinsically of random nature, because it is ‘not repeatable’. Therefore, we take the year effect as random and we assume that it is guassian, with mean equal 0 and standard deviation equal to <span class="math inline">\(\sigma_E\)</span>:</p>
<p><span class="math display">\[\alpha_i \sim N(0, \sigma_E)\]</span></p>
<p>The corresponding variance (<span class="math inline">\(\sigma^2_E\)</span>) is the so-called ‘variance component’ for the year effect. If the year is random, also the ‘genotype x year’ and the ‘block|year’ effects are random and they are defined as:</p>
<p><span class="math display">\[\alpha\beta_{i,j} \sim N(0, \sigma_{GE})\]</span></p>
<p><span class="math display">\[\gamma_{i,k} \sim N(0, \sigma_{EB})\]</span></p>
<p>Before fitting a mixed model, we decide to fit a fixed model, for a preliminary evaluation of model residuals and to compare with the results of a mixed model fit.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="a-brief-intro-to-mixed-models.html#cb184-1" aria-hidden="true" tabindex="-1"></a>modfix <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Year<span class="sc">/</span>Block <span class="sc">+</span> Genotype <span class="sc">*</span> Year,</span>
<span id="cb184-2"><a href="a-brief-intro-to-mixed-models.html#cb184-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> WinterWheat)</span>
<span id="cb184-3"><a href="a-brief-intro-to-mixed-models.html#cb184-3" aria-hidden="true" tabindex="-1"></a>check <span class="ot">&lt;-</span> <span class="fu">check.hom</span>(modfix, Year)</span>
<span id="cb184-4"><a href="a-brief-intro-to-mixed-models.html#cb184-4" aria-hidden="true" tabindex="-1"></a>check<span class="sc">$</span>aovtable</span>
<span id="cb184-5"><a href="a-brief-intro-to-mixed-models.html#cb184-5" aria-hidden="true" tabindex="-1"></a><span class="do">##      Model df      AIC      BIC    logLik   Test  L.Ratio p-value</span></span>
<span id="cb184-6"><a href="a-brief-intro-to-mixed-models.html#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="do">## mod1     1 71 316.3539 499.8865 -87.17693                        </span></span>
<span id="cb184-7"><a href="a-brief-intro-to-mixed-models.html#cb184-7" aria-hidden="true" tabindex="-1"></a><span class="do">## mod2     2 77 319.4480 518.4904 -82.72398 1 vs 2 8.905903  0.1789</span></span>
<span id="cb184-8"><a href="a-brief-intro-to-mixed-models.html#cb184-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modfix)</span>
<span id="cb184-9"><a href="a-brief-intro-to-mixed-models.html#cb184-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb184-10"><a href="a-brief-intro-to-mixed-models.html#cb184-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb184-11"><a href="a-brief-intro-to-mixed-models.html#cb184-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: Yield</span></span>
<span id="cb184-12"><a href="a-brief-intro-to-mixed-models.html#cb184-12" aria-hidden="true" tabindex="-1"></a><span class="do">##               Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span id="cb184-13"><a href="a-brief-intro-to-mixed-models.html#cb184-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Year           6 159.279 26.5466 178.3996 &lt; 2.2e-16 ***</span></span>
<span id="cb184-14"><a href="a-brief-intro-to-mixed-models.html#cb184-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype       7  11.544  1.6491  11.0824 2.978e-10 ***</span></span>
<span id="cb184-15"><a href="a-brief-intro-to-mixed-models.html#cb184-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Year:Block    14   3.922  0.2801   1.8826   0.03738 *  </span></span>
<span id="cb184-16"><a href="a-brief-intro-to-mixed-models.html#cb184-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Year:Genotype 42  27.713  0.6598   4.4342 6.779e-10 ***</span></span>
<span id="cb184-17"><a href="a-brief-intro-to-mixed-models.html#cb184-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals     98  14.583  0.1488                       </span></span>
<span id="cb184-18"><a href="a-brief-intro-to-mixed-models.html#cb184-18" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb184-19"><a href="a-brief-intro-to-mixed-models.html#cb184-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The previous box suggests that there is no problem with the heteroscedasticity of model residuals across years. The ‘genotype by year’ interaction is significant and, therefore, if the ‘year effect’ is taken as fixed, we could only compare genotypes within years, which is rather meaningless, due to the unreplicability of the year effect. Therefore, it is much more useful to switch to a mixed model fit.</p>
<p>This latter can be fitted by using the <code>lmer()</code> function, as shown below:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="a-brief-intro-to-mixed-models.html#cb185-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Yield <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>Year) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Year<span class="sc">:</span>Block) <span class="sc">+</span> Genotype <span class="sc">+</span></span>
<span id="cb185-2"><a href="a-brief-intro-to-mixed-models.html#cb185-2" aria-hidden="true" tabindex="-1"></a>               (<span class="dv">1</span><span class="sc">|</span>Year<span class="sc">:</span>Genotype),</span>
<span id="cb185-3"><a href="a-brief-intro-to-mixed-models.html#cb185-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> WinterWheat)</span></code></pre></div>
<p>First of all, we inspect the estimates of variance components, because they represent the sources of random variability. With balanced data (as in this case), these variance components could also be obtained by using the method of moments, starting from the ANOVA table from a fixed model fit:</p>
<p><span class="math display">\[\sigma^2_{\varepsilon} = MS_{\varepsilon}\]</span></p>
<p><span class="math display">\[ \sigma^2_{GE} = \frac{MS_{GE} - \sigma^2_{\varepsilon}}{n_B} = \frac{0.6598 - 0.1488}{3} = 0.1703\]</span></p>
<p><span class="math display">\[ \sigma^2_{EB} = \frac{MS_{EB} - \sigma^2_{\varepsilon}}{n_G} = \frac{0.2801 - 0.1488}{8} = 0.0164\]</span></p>
<p><span class="math display">\[ \sigma^2_{E} = \frac{MS_E - 8 \, \sigma^2_{EB} - 3 \, \sigma^2_{GE} -   \sigma^2_{\varepsilon}}{n_{GB}} = \]</span></p>
<p><span class="math display">\[ = \frac{26.55 - 8 \times 0.0164 - 3 \times 0.1703 - 0.1488}{24} = 1.073\]</span></p>
<p>where <span class="math inline">\(n_B\)</span>, <span class="math inline">\(n_G\)</span> and <span class="math inline">\(n_{GB}\)</span> are, respectively, the number of blocks, the number of genotypes and the number of ‘genotype by block’ combinations, while <span class="math inline">\(\textrm{MS}_{\varepsilon}\)</span>, <span class="math inline">\(\textrm{MS}_E\)</span>, <span class="math inline">\(\textrm{MS}_{EB}\)</span> and <span class="math inline">\(\textrm{MS}_{GE}\)</span> are the mean squares from a fixed effect fit, respectively, for the residual error, the years, the blocks within years and the genotype by year interaction. However, the REstricted Maximum Likelihood (REML) estimates provided by the ‘lmer()’ function are simpler to obtain, also with unbalance data.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="a-brief-intro-to-mixed-models.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance components</span></span>
<span id="cb186-2"><a href="a-brief-intro-to-mixed-models.html#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">VarCorr</span>(mod), <span class="at">comp=</span><span class="fu">c</span>(<span class="st">&quot;Variance&quot;</span>, <span class="st">&quot;Std.Dev.&quot;</span>) )</span>
<span id="cb186-3"><a href="a-brief-intro-to-mixed-models.html#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Groups        Name        Variance Std.Dev.</span></span>
<span id="cb186-4"><a href="a-brief-intro-to-mixed-models.html#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Year:Genotype (Intercept) 0.170341 0.41272 </span></span>
<span id="cb186-5"><a href="a-brief-intro-to-mixed-models.html#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Year:Block    (Intercept) 0.016418 0.12813 </span></span>
<span id="cb186-6"><a href="a-brief-intro-to-mixed-models.html#cb186-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Year          (Intercept) 1.073146 1.03593 </span></span>
<span id="cb186-7"><a href="a-brief-intro-to-mixed-models.html#cb186-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  Residual                  0.148804 0.38575</span></span></code></pre></div>
<p>The variance component estimates show that the overall yield variability is mainly due to the year effect (year-to-year variability: <span class="math inline">\(\sigma_E = 1.04\)</span>), which was the same for all genotypes. This source of variability impacts on genotype mean yields (which changes depending on the year), but it does not impact on genotype effects and differences. Another important source of variability is the genotype-by-year interaction (<span class="math inline">\(\sigma_{GE} = 0.41\)</span>), which is additional to the year-to-year variability and it is highly specific to each genotype. It impacts on genotype mean, but it also impact on genotype effects (and differences), that change depending on the years. The within year plot-to-plot variability is smaller (<span class="math inline">\(\sigma = 0.39\)</span>), although it is clear that it impacts on genotype means, effects and differences. Last, block-to-block variability (<span class="math inline">\(\sigma_{EB} = 0.13\)</span>) is the smallest component and, similarly to year-to-year variability, it is the same for all genotypes and it impacts only on their mean value across blocks.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="a-brief-intro-to-mixed-models.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA table</span></span>
<span id="cb187-2"><a href="a-brief-intro-to-mixed-models.html#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod)</span>
<span id="cb187-3"><a href="a-brief-intro-to-mixed-models.html#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Type III Analysis of Variance Table with Satterthwaite&#39;s method</span></span>
<span id="cb187-4"><a href="a-brief-intro-to-mixed-models.html#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="do">##          Sum Sq Mean Sq NumDF DenDF F value  Pr(&gt;F)  </span></span>
<span id="cb187-5"><a href="a-brief-intro-to-mixed-models.html#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype 2.6033  0.3719     7    42  2.4993 0.03058 *</span></span>
<span id="cb187-6"><a href="a-brief-intro-to-mixed-models.html#cb187-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb187-7"><a href="a-brief-intro-to-mixed-models.html#cb187-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The ANOVA table only includes the genotype effect, because all other effects are random and it makes no sense to test for the existence of a significant difference between the means for the different factor levels. We see that the F ratio for the genotype effect is smaller than that from a fixed model fit, because it needs to consider, at the denominator, all the main sources of variability that can impact on the genotype effects (i.e.: plot-to-plot variability and the genotype-by-year interaction). In particular, the F ratio is obtained as:</p>
<p><span class="math display">\[F = \frac{MS_G}{n_B \times \sigma^2_{GE} + \sigma^2_{\varepsilon}} = \frac{MS_G}{MS_{GE}} = \frac{1.6491}{0.6598} = 2.499\]</span></p>
<p>When the year effect is random, we can always consider and compare the means of genotypes across years and we are not restrained by a significant genotype-by-year interaction. However, SEMs and SEDs are usually higher than those from a fixed model fit, because they have to consider all possible sources of variability. In particular, with a fixed effects model, the standard errors for the genotype means is (<span class="math inline">\(r\)</span> is the number of replicates and <span class="math inline">\(n_e\)</span> is the number of environments):</p>
<p><span class="math display">\[SEM_f = \sqrt{ \frac{\sigma^2}{r\,n_e} } = \sqrt{ \frac{0.1488}{3 \cdot 7}} = 0.0842\]</span></p>
<p>With mixed models, the SEM is calculated by considering all sources of random variability:</p>
<p><span class="math display">\[SEM_m = \sqrt \frac{r \, \sigma^2_E  + \sigma^2_{EB} + r \sigma^2_{GE} + \sigma^2 }{re} = \sqrt \frac{3 \cdot 1.073  + 0.016 + 3 \cdot 0.170 + 0.1488 }{3 \cdot 7} = 0.431\]</span></p>
<p>Likewise, the Standard Error of a Difference (SED), for the mixed model, is calculated by considering the plot-to-plot variability and the genotype-by-environment variability, while the year-to-year variability and the block-to-block variability are not considered, because they impact on all the means in the same way and, therefore, they do not impact on the differences. The expressions are:</p>
<p><span class="math display">\[SED_f = \sqrt{2 \, \frac{\sigma^2}{r \, n_e} } \quad \quad SED_m = \sqrt {2 \, \frac{r \, \sigma^2_{ge}  + \sigma^2 }{r \, n_e} }\]</span></p>
<p>Marginal means and significance letters can be easily obtained as shown in previous examples and chapters:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="a-brief-intro-to-mixed-models.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(<span class="fu">emmeans</span>(mod, <span class="sc">~</span>Genotype), <span class="at">Letters =</span> letters,</span>
<span id="cb188-2"><a href="a-brief-intro-to-mixed-models.html#cb188-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb188-3"><a href="a-brief-intro-to-mixed-models.html#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Genotype emmean    SE   df lower.CL upper.CL .group</span></span>
<span id="cb188-4"><a href="a-brief-intro-to-mixed-models.html#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  SIMETO     5.93 0.431 8.23     4.94     6.91  a    </span></span>
<span id="cb188-5"><a href="a-brief-intro-to-mixed-models.html#cb188-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  CRESO      5.97 0.431 8.23     4.99     6.96  a    </span></span>
<span id="cb188-6"><a href="a-brief-intro-to-mixed-models.html#cb188-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  GRAZIA     6.08 0.431 8.23     5.09     7.07  a    </span></span>
<span id="cb188-7"><a href="a-brief-intro-to-mixed-models.html#cb188-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  SANCARLO   6.22 0.431 8.23     5.23     7.21  ab   </span></span>
<span id="cb188-8"><a href="a-brief-intro-to-mixed-models.html#cb188-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  SOLEX      6.23 0.431 8.23     5.24     7.22  ab   </span></span>
<span id="cb188-9"><a href="a-brief-intro-to-mixed-models.html#cb188-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  COLOSSEO   6.41 0.431 8.23     5.43     7.40  ab   </span></span>
<span id="cb188-10"><a href="a-brief-intro-to-mixed-models.html#cb188-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  DUILIO     6.59 0.431 8.23     5.60     7.58   b   </span></span>
<span id="cb188-11"><a href="a-brief-intro-to-mixed-models.html#cb188-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  IRIDE      6.70 0.431 8.23     5.71     7.68   b   </span></span>
<span id="cb188-12"><a href="a-brief-intro-to-mixed-models.html#cb188-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb188-13"><a href="a-brief-intro-to-mixed-models.html#cb188-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Degrees-of-freedom method: kenward-roger </span></span>
<span id="cb188-14"><a href="a-brief-intro-to-mixed-models.html#cb188-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb188-15"><a href="a-brief-intro-to-mixed-models.html#cb188-15" aria-hidden="true" tabindex="-1"></a><span class="do">## significance level used: alpha = 0.05 </span></span>
<span id="cb188-16"><a href="a-brief-intro-to-mixed-models.html#cb188-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: If two or more means share the same grouping symbol,</span></span>
<span id="cb188-17"><a href="a-brief-intro-to-mixed-models.html#cb188-17" aria-hidden="true" tabindex="-1"></a><span class="do">##       then we cannot show them to be different.</span></span>
<span id="cb188-18"><a href="a-brief-intro-to-mixed-models.html#cb188-18" aria-hidden="true" tabindex="-1"></a><span class="do">##       But we also did not show them to be the same.</span></span></code></pre></div>
<p>We see that the correction of multiplicity and the need to consider all sources of random yield variability, does not permit to prove the existence of any significant difference between genotypes.</p>
</div>
</div>
</div>
<div id="repeated-measures-in-perennial-crops" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Repeated measures in perennial crops<a href="a-brief-intro-to-mixed-models.html#repeated-measures-in-perennial-crops" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With perennial crops measures are taken repeatedly in the same plots across years. For this reason, even though the dataset looks very much like that for the winter wheat experiment repeated in several years, it must be analysed in a totally different manner.</p>
<p>In particular, we should not neglect that, in contrast to the winter wheat example, the observations are grouped within the same plots and, therefore, they are not independent, because the observations taken on the same plot are more alike than observations taken on different plots. We have seen a similar situation with the subsampling experiment given before, with an important difference: while subsamples were taken at random within each plot, repeated measures may not be sampled at random, they may be specifically taken to evaluate the yield in different moments of plant life.</p>
<div id="example-5-genotype-experiment-with-lucerne" class="section level3 hasAnchor" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> Example 5: genotype experiment with lucerne<a href="a-brief-intro-to-mixed-models.html#example-5-genotype-experiment-with-lucerne" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s consider the dataset below, that refers to the yield of lucerne genotypes in three consecutive years, taken from the same plots in a single experiment lasting for three years. In the box below we load the data and make the necessary transformations. We also build a new variable to uniquely identify each plot, which is easy, considering that yield values taken for the same genotype in the same block must have been taken in the same plot.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="a-brief-intro-to-mixed-models.html#cb189-1" aria-hidden="true" tabindex="-1"></a>filePath <span class="ot">&lt;-</span> <span class="st">&quot;https://www.casaonofri.it/_datasets/alfalfa3years.csv&quot;</span></span>
<span id="cb189-2"><a href="a-brief-intro-to-mixed-models.html#cb189-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(filePath)</span>
<span id="cb189-3"><a href="a-brief-intro-to-mixed-models.html#cb189-3" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Block <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset<span class="sc">$</span>Block)</span>
<span id="cb189-4"><a href="a-brief-intro-to-mixed-models.html#cb189-4" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Genotype <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset<span class="sc">$</span>Genotype)</span>
<span id="cb189-5"><a href="a-brief-intro-to-mixed-models.html#cb189-5" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset<span class="sc">$</span>Year)</span>
<span id="cb189-6"><a href="a-brief-intro-to-mixed-models.html#cb189-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataset)</span>
<span id="cb189-7"><a href="a-brief-intro-to-mixed-models.html#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   Block Genotype Year     Yield</span></span>
<span id="cb189-8"><a href="a-brief-intro-to-mixed-models.html#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1 4cascine 2006  6.631775</span></span>
<span id="cb189-9"><a href="a-brief-intro-to-mixed-models.html#cb189-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     2 4cascine 2006  6.705397</span></span>
<span id="cb189-10"><a href="a-brief-intro-to-mixed-models.html#cb189-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     3 4cascine 2006  6.499588</span></span>
<span id="cb189-11"><a href="a-brief-intro-to-mixed-models.html#cb189-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 4     4 4cascine 2006  7.087686</span></span>
<span id="cb189-12"><a href="a-brief-intro-to-mixed-models.html#cb189-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 5     1 4cascine 2007 14.964927</span></span>
<span id="cb189-13"><a href="a-brief-intro-to-mixed-models.html#cb189-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 6     2 4cascine 2007 13.584865</span></span>
<span id="cb189-14"><a href="a-brief-intro-to-mixed-models.html#cb189-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Reference the plots</span></span>
<span id="cb189-15"><a href="a-brief-intro-to-mixed-models.html#cb189-15" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Plot <span class="ot">&lt;-</span> dataset<span class="sc">$</span>Block<span class="sc">:</span>dataset<span class="sc">$</span>Genotype</span></code></pre></div>
<div id="model-definition-7" class="section level4 hasAnchor" number="13.4.1.1">
<h4><span class="header-section-number">13.4.1.1</span> Model definition<a href="a-brief-intro-to-mixed-models.html#model-definition-7" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For repeated measures designs, models can be built by using the rules in Piepho et al. (2004):</p>
<ol style="list-style-type: decimal">
<li>Consider one single year and build the treatment model</li>
<li>Consider one single year and build the block model</li>
<li>Include the year factor into the model and combine the year with all the effects in the treatment model, by crossing or nesting as appropriate.</li>
<li>Consider that the ‘plot’ factor in the block model references the randomisation units, i.e. those units which received the the genotypes by a randomisation process. Assign to this plot factor a random effect.</li>
<li>Excluding the terms for randomisation units, nest the year in all the other terms in the block model.</li>
<li>Combine random effects for randomisation units with the repeated factor, by using the colon operator, in order to derive the correct error terms to accommodate correlation structures.</li>
</ol>
<p>The models at the different steps are as follows (with R notation):</p>
<ol style="list-style-type: decimal">
<li>treatment model: YIELD ~ GENOTYPE</li>
<li>block model: YIELD ~ BLOCK + BLOCK:PLOT</li>
<li>treatment model: YIELD ~ GENOTYPE * YEAR</li>
<li>block model: YIELD ~ BLOCK + (1|BLOCK:PLOT)</li>
<li>block model: YIELD ~ BLOCK + BLOCK:YEAR + (1|BLOCK:PLOT)</li>
<li>block model: YIELD ~ BLOCK + BLOCK:YEAR + (1|BLOCK:PLOT) + (1|BLOCK:PLOT:YEAR)</li>
</ol>
<p>In this case, considering that lucerne lasts, on average, for three years and follows a specific pattern of yield across these three years, we decided to take the block, year and genotype effects as fixed; therefore, the final model, with R notation, is:</p>
<p>YIELD ~ BLOCK + BLOCK:YEAR + GENOTYPE * YEAR + (1|BLOCK:PLOT) + (1|BLOCK:PLOT:YEAR)</p>
<p>where the last term does not need to be fitted in R, as it is the residual term, that is fitted by default. The resulting analysis (with ‘lmer’) is:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="a-brief-intro-to-mixed-models.html#cb190-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Yield <span class="sc">~</span> Block <span class="sc">+</span> Block<span class="sc">:</span>Year <span class="sc">+</span> Genotype<span class="sc">*</span>Year <span class="sc">+</span></span>
<span id="cb190-2"><a href="a-brief-intro-to-mixed-models.html#cb190-2" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">1</span><span class="sc">|</span>Plot<span class="sc">:</span>Block),</span>
<span id="cb190-3"><a href="a-brief-intro-to-mixed-models.html#cb190-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> dataset)</span>
<span id="cb190-4"><a href="a-brief-intro-to-mixed-models.html#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod)</span>
<span id="cb190-5"><a href="a-brief-intro-to-mixed-models.html#cb190-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Type III Analysis of Variance Table with Satterthwaite&#39;s method</span></span>
<span id="cb190-6"><a href="a-brief-intro-to-mixed-models.html#cb190-6" aria-hidden="true" tabindex="-1"></a><span class="do">##                Sum Sq Mean Sq NumDF DenDF   F value    Pr(&gt;F)    </span></span>
<span id="cb190-7"><a href="a-brief-intro-to-mixed-models.html#cb190-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Block            3.96    1.32     3    57    2.1389  0.105316    </span></span>
<span id="cb190-8"><a href="a-brief-intro-to-mixed-models.html#cb190-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype        54.00    2.84    19    57    4.6024  3.75e-06 ***</span></span>
<span id="cb190-9"><a href="a-brief-intro-to-mixed-models.html#cb190-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Year          2602.53 1301.27     2   114 2107.3223 &lt; 2.2e-16 ***</span></span>
<span id="cb190-10"><a href="a-brief-intro-to-mixed-models.html#cb190-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Block:Year      14.14    2.36     6   114    3.8176  0.001667 ** </span></span>
<span id="cb190-11"><a href="a-brief-intro-to-mixed-models.html#cb190-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Year:Genotype   31.83    0.84    38   114    1.3563  0.111546    </span></span>
<span id="cb190-12"><a href="a-brief-intro-to-mixed-models.html#cb190-12" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb190-13"><a href="a-brief-intro-to-mixed-models.html#cb190-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb190-14"><a href="a-brief-intro-to-mixed-models.html#cb190-14" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(mod, <span class="sc">~</span>Genotype)</span>
<span id="cb190-15"><a href="a-brief-intro-to-mixed-models.html#cb190-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: Results may be misleading due to involvement in interactions</span></span>
<span id="cb190-16"><a href="a-brief-intro-to-mixed-models.html#cb190-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  Genotype          emmean    SE df lower.CL upper.CL</span></span>
<span id="cb190-17"><a href="a-brief-intro-to-mixed-models.html#cb190-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  4cascine           11.59 0.315 57    10.96     12.2</span></span>
<span id="cb190-18"><a href="a-brief-intro-to-mixed-models.html#cb190-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  casalina           12.46 0.315 57    11.83     13.1</span></span>
<span id="cb190-19"><a href="a-brief-intro-to-mixed-models.html#cb190-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  classe             11.59 0.315 57    10.96     12.2</span></span>
<span id="cb190-20"><a href="a-brief-intro-to-mixed-models.html#cb190-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  costanza            9.89 0.315 57     9.26     10.5</span></span>
<span id="cb190-21"><a href="a-brief-intro-to-mixed-models.html#cb190-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  dimitra            11.75 0.315 57    11.12     12.4</span></span>
<span id="cb190-22"><a href="a-brief-intro-to-mixed-models.html#cb190-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  FDL0101            12.22 0.315 57    11.59     12.9</span></span>
<span id="cb190-23"><a href="a-brief-intro-to-mixed-models.html#cb190-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  garisenda          11.76 0.315 57    11.13     12.4</span></span>
<span id="cb190-24"><a href="a-brief-intro-to-mixed-models.html#cb190-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  LaBellaCampagnola  12.17 0.315 57    11.54     12.8</span></span>
<span id="cb190-25"><a href="a-brief-intro-to-mixed-models.html#cb190-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  LaTorre            11.36 0.315 57    10.73     12.0</span></span>
<span id="cb190-26"><a href="a-brief-intro-to-mixed-models.html#cb190-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  linfa              11.23 0.315 57    10.60     11.9</span></span>
<span id="cb190-27"><a href="a-brief-intro-to-mixed-models.html#cb190-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  marina             11.76 0.315 57    11.13     12.4</span></span>
<span id="cb190-28"><a href="a-brief-intro-to-mixed-models.html#cb190-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  Palladiana         10.89 0.315 57    10.26     11.5</span></span>
<span id="cb190-29"><a href="a-brief-intro-to-mixed-models.html#cb190-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  PicenaGR           12.12 0.315 57    11.49     12.8</span></span>
<span id="cb190-30"><a href="a-brief-intro-to-mixed-models.html#cb190-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  PR56S82            11.56 0.315 57    10.93     12.2</span></span>
<span id="cb190-31"><a href="a-brief-intro-to-mixed-models.html#cb190-31" aria-hidden="true" tabindex="-1"></a><span class="do">##  PR57Q53            11.70 0.315 57    11.07     12.3</span></span>
<span id="cb190-32"><a href="a-brief-intro-to-mixed-models.html#cb190-32" aria-hidden="true" tabindex="-1"></a><span class="do">##  prosementi         11.79 0.315 57    11.15     12.4</span></span>
<span id="cb190-33"><a href="a-brief-intro-to-mixed-models.html#cb190-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  RivieraVicentina    9.98 0.315 57     9.35     10.6</span></span>
<span id="cb190-34"><a href="a-brief-intro-to-mixed-models.html#cb190-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  robot              12.11 0.315 57    11.48     12.7</span></span>
<span id="cb190-35"><a href="a-brief-intro-to-mixed-models.html#cb190-35" aria-hidden="true" tabindex="-1"></a><span class="do">##  Selene             12.11 0.315 57    11.48     12.7</span></span>
<span id="cb190-36"><a href="a-brief-intro-to-mixed-models.html#cb190-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  Zenith             11.94 0.315 57    11.31     12.6</span></span>
<span id="cb190-37"><a href="a-brief-intro-to-mixed-models.html#cb190-37" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb190-38"><a href="a-brief-intro-to-mixed-models.html#cb190-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Results are averaged over the levels of: Block, Year </span></span>
<span id="cb190-39"><a href="a-brief-intro-to-mixed-models.html#cb190-39" aria-hidden="true" tabindex="-1"></a><span class="do">## Degrees-of-freedom method: kenward-roger </span></span>
<span id="cb190-40"><a href="a-brief-intro-to-mixed-models.html#cb190-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95</span></span></code></pre></div>
<p>We see that the ‘genotype x year’ interaction is not significant, so that we can proceed to comparing the means of genotypes across years, which can be done with the ‘emmeans()’ function in the usual fashion.</p>
<p>It may be useful to compare this analysis with a ‘naive’ (and wrong) analysis that neglects the repeated measures (i.e., that neglects the ‘plot’ random effect). Wee see big differences and, especially, we see that the SEs for genotype means are much higher in the correct analysis.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="a-brief-intro-to-mixed-models.html#cb191-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Year<span class="sc">/</span>Block <span class="sc">+</span> Genotype<span class="sc">*</span>Year, </span>
<span id="cb191-2"><a href="a-brief-intro-to-mixed-models.html#cb191-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> dataset)</span>
<span id="cb191-3"><a href="a-brief-intro-to-mixed-models.html#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2)</span>
<span id="cb191-4"><a href="a-brief-intro-to-mixed-models.html#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb191-5"><a href="a-brief-intro-to-mixed-models.html#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb191-6"><a href="a-brief-intro-to-mixed-models.html#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: Yield</span></span>
<span id="cb191-7"><a href="a-brief-intro-to-mixed-models.html#cb191-7" aria-hidden="true" tabindex="-1"></a><span class="do">##                Df  Sum Sq Mean Sq   F value    Pr(&gt;F)    </span></span>
<span id="cb191-8"><a href="a-brief-intro-to-mixed-models.html#cb191-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Year            2 2602.53 1301.27 1608.2407 &lt; 2.2e-16 ***</span></span>
<span id="cb191-9"><a href="a-brief-intro-to-mixed-models.html#cb191-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype       19  104.27    5.49    6.7824 4.256e-13 ***</span></span>
<span id="cb191-10"><a href="a-brief-intro-to-mixed-models.html#cb191-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Year:Block      9   21.80    2.42    2.9930  0.002449 ** </span></span>
<span id="cb191-11"><a href="a-brief-intro-to-mixed-models.html#cb191-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Year:Genotype  38   31.83    0.84    1.0351  0.424687    </span></span>
<span id="cb191-12"><a href="a-brief-intro-to-mixed-models.html#cb191-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals     171  138.36    0.81                        </span></span>
<span id="cb191-13"><a href="a-brief-intro-to-mixed-models.html#cb191-13" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb191-14"><a href="a-brief-intro-to-mixed-models.html#cb191-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb191-15"><a href="a-brief-intro-to-mixed-models.html#cb191-15" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(mod2, <span class="sc">~</span>Genotype)</span>
<span id="cb191-16"><a href="a-brief-intro-to-mixed-models.html#cb191-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: A nesting structure was detected in the fitted model:</span></span>
<span id="cb191-17"><a href="a-brief-intro-to-mixed-models.html#cb191-17" aria-hidden="true" tabindex="-1"></a><span class="do">##     Block %in% Year</span></span>
<span id="cb191-18"><a href="a-brief-intro-to-mixed-models.html#cb191-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: Results may be misleading due to involvement in interactions</span></span>
<span id="cb191-19"><a href="a-brief-intro-to-mixed-models.html#cb191-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  Genotype          emmean   SE  df lower.CL upper.CL</span></span>
<span id="cb191-20"><a href="a-brief-intro-to-mixed-models.html#cb191-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  4cascine           11.59 0.26 171    11.07     12.1</span></span>
<span id="cb191-21"><a href="a-brief-intro-to-mixed-models.html#cb191-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  casalina           12.46 0.26 171    11.94     13.0</span></span>
<span id="cb191-22"><a href="a-brief-intro-to-mixed-models.html#cb191-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  classe             11.59 0.26 171    11.08     12.1</span></span>
<span id="cb191-23"><a href="a-brief-intro-to-mixed-models.html#cb191-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  costanza            9.89 0.26 171     9.38     10.4</span></span>
<span id="cb191-24"><a href="a-brief-intro-to-mixed-models.html#cb191-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  dimitra            11.75 0.26 171    11.24     12.3</span></span>
<span id="cb191-25"><a href="a-brief-intro-to-mixed-models.html#cb191-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  FDL0101            12.22 0.26 171    11.71     12.7</span></span>
<span id="cb191-26"><a href="a-brief-intro-to-mixed-models.html#cb191-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  garisenda          11.76 0.26 171    11.24     12.3</span></span>
<span id="cb191-27"><a href="a-brief-intro-to-mixed-models.html#cb191-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  LaBellaCampagnola  12.17 0.26 171    11.66     12.7</span></span>
<span id="cb191-28"><a href="a-brief-intro-to-mixed-models.html#cb191-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  LaTorre            11.36 0.26 171    10.84     11.9</span></span>
<span id="cb191-29"><a href="a-brief-intro-to-mixed-models.html#cb191-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  linfa              11.23 0.26 171    10.72     11.7</span></span>
<span id="cb191-30"><a href="a-brief-intro-to-mixed-models.html#cb191-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  marina             11.76 0.26 171    11.25     12.3</span></span>
<span id="cb191-31"><a href="a-brief-intro-to-mixed-models.html#cb191-31" aria-hidden="true" tabindex="-1"></a><span class="do">##  Palladiana         10.89 0.26 171    10.38     11.4</span></span>
<span id="cb191-32"><a href="a-brief-intro-to-mixed-models.html#cb191-32" aria-hidden="true" tabindex="-1"></a><span class="do">##  PicenaGR           12.12 0.26 171    11.61     12.6</span></span>
<span id="cb191-33"><a href="a-brief-intro-to-mixed-models.html#cb191-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  PR56S82            11.56 0.26 171    11.05     12.1</span></span>
<span id="cb191-34"><a href="a-brief-intro-to-mixed-models.html#cb191-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  PR57Q53            11.70 0.26 171    11.19     12.2</span></span>
<span id="cb191-35"><a href="a-brief-intro-to-mixed-models.html#cb191-35" aria-hidden="true" tabindex="-1"></a><span class="do">##  prosementi         11.79 0.26 171    11.27     12.3</span></span>
<span id="cb191-36"><a href="a-brief-intro-to-mixed-models.html#cb191-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  RivieraVicentina    9.98 0.26 171     9.47     10.5</span></span>
<span id="cb191-37"><a href="a-brief-intro-to-mixed-models.html#cb191-37" aria-hidden="true" tabindex="-1"></a><span class="do">##  robot              12.11 0.26 171    11.59     12.6</span></span>
<span id="cb191-38"><a href="a-brief-intro-to-mixed-models.html#cb191-38" aria-hidden="true" tabindex="-1"></a><span class="do">##  Selene             12.11 0.26 171    11.60     12.6</span></span>
<span id="cb191-39"><a href="a-brief-intro-to-mixed-models.html#cb191-39" aria-hidden="true" tabindex="-1"></a><span class="do">##  Zenith             11.94 0.26 171    11.42     12.5</span></span>
<span id="cb191-40"><a href="a-brief-intro-to-mixed-models.html#cb191-40" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb191-41"><a href="a-brief-intro-to-mixed-models.html#cb191-41" aria-hidden="true" tabindex="-1"></a><span class="do">## Results are averaged over the levels of: Block, Year </span></span>
<span id="cb191-42"><a href="a-brief-intro-to-mixed-models.html#cb191-42" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95</span></span></code></pre></div>
<p>We just want to conclude by saying that the above mixed model analyses regards the design as a sort of ‘split-plot in time’ and it is not necessarily correct, as it assumes that the within-plot correlation is the same for all pairs of observations, regardless of their distance in time. Further analyses might be necessary to assess whether serial correlation structures are necessary, although such an aspect is far beyond the scope of this book.</p>
</div>
</div>
</div>
<div id="further-readings-10" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Further readings<a href="a-brief-intro-to-mixed-models.html#further-readings-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Annichiarico, P., 2002. Genotype x Environment Interactions - Challenges and Opportunities for Plant Breeding and Cultivar Recommendations. FAO, 1, 1-115 (This is on-line available. Just make a google search!)</li>
<li>Bates, D., Mächler, M., Bolker, B., Walker, S., 2015. Fitting Linear Mixed-Effects Models Using lme4. Journal of Statistical Software 67. <a href="https://doi.org/10.18637/jss.v067.i01" class="uri">https://doi.org/10.18637/jss.v067.i01</a></li>
<li>Gałecki, A., Burzykowski, T., 2013. Linear mixed-effects models using R: a step-by-step approach. Springer, Berlin.</li>
<li>Kuznetsova, A., Brockhoff, P.B., Christensen, H.B., 2017. lmerTest Package: Tests in Linear Mixed Effects Models. Journal of Statistical Software 82, 1–26.</li>
<li>Piepho, H.-P., Büchse, A., Richter, C., 2004. A Mixed Modelling Approach for Randomized Experiments with Repeated Measures. Journal of Agronomy and Crop Science 190, 230–247.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple-linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="nonlinear-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
