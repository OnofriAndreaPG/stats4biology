<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Multi-way ANOVA models | Experimental methods in agriculture</title>
  <meta name="description" content="Chapter 10 Multi-way ANOVA models | Experimental methods in agriculture: a tutorial book with R" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Multi-way ANOVA models | Experimental methods in agriculture" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="http://www.casaonofri.it/images/coversmall.png" />
  <meta property="og:description" content="Chapter 10 Multi-way ANOVA models | Experimental methods in agriculture: a tutorial book with R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Multi-way ANOVA models | Experimental methods in agriculture" />
  <meta name="twitter:site" content="@onofriandreapg" />
  <meta name="twitter:description" content="Chapter 10 Multi-way ANOVA models | Experimental methods in agriculture: a tutorial book with R" />
  <meta name="twitter:image" content="http://www.casaonofri.it/images/coversmall.png" />

<meta name="author" content="Andrea Onofri and Dario Sacco" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="contrasts-and-multiple-comparison-testing.html"/>
<link rel="next" href="multi-way-anova-models-with-interactions.html"/>
<script src="book_assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="book_assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="book_assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="book_assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131792052-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-131792052-1');
  </script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Experimental Methods</a></strong></li> 

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#aims"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-this-book-is-organised"><i class="fa fa-check"></i>How this book is organised</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#statistical-software"><i class="fa fa-check"></i>Statistical software</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-authors"><i class="fa fa-check"></i>The authors</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html"><i class="fa fa-check"></i><b>1</b> Science and pseudoscience</a>
<ul>
<li class="chapter" data-level="1.1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#science-needs-data"><i class="fa fa-check"></i><b>1.1</b> Science needs data</a></li>
<li class="chapter" data-level="1.2" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#not-all-data-support-science"><i class="fa fa-check"></i><b>1.2</b> Not all data support science</a></li>
<li class="chapter" data-level="1.3" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#good-data-is-based-on-good-methods"><i class="fa fa-check"></i><b>1.3</b> Good data is based on good ‘methods’</a></li>
<li class="chapter" data-level="1.4" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#the-falsification-principle"><i class="fa fa-check"></i><b>1.4</b> The ‘falsification’ principle</a></li>
<li class="chapter" data-level="1.5" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#trying-to-falsify-a-result"><i class="fa fa-check"></i><b>1.5</b> Trying to falsify a result</a></li>
<li class="chapter" data-level="1.6" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#the-basic-principles-of-experimental-design"><i class="fa fa-check"></i><b>1.6</b> The basic principles of experimental design</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#control"><i class="fa fa-check"></i><b>1.6.1</b> Control</a></li>
<li class="chapter" data-level="1.6.2" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#replication"><i class="fa fa-check"></i><b>1.6.2</b> Replication</a></li>
<li class="chapter" data-level="1.6.3" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#randomisation"><i class="fa fa-check"></i><b>1.6.3</b> Randomisation</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#invalid-experiments"><i class="fa fa-check"></i><b>1.7</b> Invalid experiments</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#lack-of-good-control"><i class="fa fa-check"></i><b>1.7.1</b> Lack of good control</a></li>
<li class="chapter" data-level="1.7.2" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#confounding-and-spurious-correlation"><i class="fa fa-check"></i><b>1.7.2</b> ‘Confounding’ and spurious correlation</a></li>
<li class="chapter" data-level="1.7.3" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#lack-of-true-replicates-or-careless-randomisation"><i class="fa fa-check"></i><b>1.7.3</b> Lack of true-replicates or careless randomisation</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#how-can-we-assess-whether-the-data-is-valid"><i class="fa fa-check"></i><b>1.8</b> How can we assess whether the data is valid?</a></li>
<li class="chapter" data-level="1.9" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#conclusions"><i class="fa fa-check"></i><b>1.9</b> Conclusions</a></li>
<li class="chapter" data-level="1.10" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#further-readings"><i class="fa fa-check"></i><b>1.10</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="designing-experiments.html"><a href="designing-experiments.html"><i class="fa fa-check"></i><b>2</b> Designing experiments</a>
<ul>
<li class="chapter" data-level="2.1" data-path="designing-experiments.html"><a href="designing-experiments.html#the-elements-of-research"><i class="fa fa-check"></i><b>2.1</b> The elements of research</a></li>
<li class="chapter" data-level="2.2" data-path="designing-experiments.html"><a href="designing-experiments.html#hypothesis-and-objectives"><i class="fa fa-check"></i><b>2.2</b> Hypothesis and objectives</a></li>
<li class="chapter" data-level="2.3" data-path="designing-experiments.html"><a href="designing-experiments.html#the-experimental-treatments"><i class="fa fa-check"></i><b>2.3</b> The experimental treatments</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="designing-experiments.html"><a href="designing-experiments.html#factorial-experiments"><i class="fa fa-check"></i><b>2.3.1</b> Factorial experiments</a></li>
<li class="chapter" data-level="2.3.2" data-path="designing-experiments.html"><a href="designing-experiments.html#the-control"><i class="fa fa-check"></i><b>2.3.2</b> The control</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="designing-experiments.html"><a href="designing-experiments.html#the-experimental-units"><i class="fa fa-check"></i><b>2.4</b> The experimental units</a></li>
<li class="chapter" data-level="2.5" data-path="designing-experiments.html"><a href="designing-experiments.html#the-allocation-of-treatments"><i class="fa fa-check"></i><b>2.5</b> The allocation of treatments</a></li>
<li class="chapter" data-level="2.6" data-path="designing-experiments.html"><a href="designing-experiments.html#the-variables"><i class="fa fa-check"></i><b>2.6</b> The variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="designing-experiments.html"><a href="designing-experiments.html#nominal-variables"><i class="fa fa-check"></i><b>2.6.1</b> Nominal variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="designing-experiments.html"><a href="designing-experiments.html#ordinal-variables"><i class="fa fa-check"></i><b>2.6.2</b> Ordinal variables</a></li>
<li class="chapter" data-level="2.6.3" data-path="designing-experiments.html"><a href="designing-experiments.html#count-and-ratio-variables"><i class="fa fa-check"></i><b>2.6.3</b> Count and ratio variables</a></li>
<li class="chapter" data-level="2.6.4" data-path="designing-experiments.html"><a href="designing-experiments.html#continuous-variables"><i class="fa fa-check"></i><b>2.6.4</b> Continuous variables</a></li>
<li class="chapter" data-level="2.6.5" data-path="designing-experiments.html"><a href="designing-experiments.html#sensory-and-visual-assessments"><i class="fa fa-check"></i><b>2.6.5</b> Sensory and visual assessments</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="designing-experiments.html"><a href="designing-experiments.html#setting-up-a-field-experiment"><i class="fa fa-check"></i><b>2.7</b> Setting up a field experiment</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="designing-experiments.html"><a href="designing-experiments.html#selecting-the-field"><i class="fa fa-check"></i><b>2.7.1</b> Selecting the field</a></li>
<li class="chapter" data-level="2.7.2" data-path="designing-experiments.html"><a href="designing-experiments.html#selecting-the-units-within-the-field"><i class="fa fa-check"></i><b>2.7.2</b> Selecting the units within the field</a></li>
<li class="chapter" data-level="2.7.3" data-path="designing-experiments.html"><a href="designing-experiments.html#number-of-replicates"><i class="fa fa-check"></i><b>2.7.3</b> Number of replicates</a></li>
<li class="chapter" data-level="2.7.4" data-path="designing-experiments.html"><a href="designing-experiments.html#the-field-map"><i class="fa fa-check"></i><b>2.7.4</b> The field map</a></li>
<li class="chapter" data-level="2.7.5" data-path="designing-experiments.html"><a href="designing-experiments.html#the-experimental-lay-out"><i class="fa fa-check"></i><b>2.7.5</b> The experimental lay-out</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="designing-experiments.html"><a href="designing-experiments.html#conclusions-1"><i class="fa fa-check"></i><b>2.8</b> Conclusions</a></li>
<li class="chapter" data-level="2.9" data-path="designing-experiments.html"><a href="designing-experiments.html#further-readings-1"><i class="fa fa-check"></i><b>2.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="describing-the-observations.html"><a href="describing-the-observations.html"><i class="fa fa-check"></i><b>3</b> Describing the observations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="describing-the-observations.html"><a href="describing-the-observations.html#quantitative-data"><i class="fa fa-check"></i><b>3.1</b> Quantitative data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="describing-the-observations.html"><a href="describing-the-observations.html#statistics-of-location"><i class="fa fa-check"></i><b>3.1.1</b> Statistics of location</a></li>
<li class="chapter" data-level="3.1.2" data-path="describing-the-observations.html"><a href="describing-the-observations.html#statistics-of-spread"><i class="fa fa-check"></i><b>3.1.2</b> Statistics of spread</a></li>
<li class="chapter" data-level="3.1.3" data-path="describing-the-observations.html"><a href="describing-the-observations.html#summing-the-uncertainty"><i class="fa fa-check"></i><b>3.1.3</b> Summing the uncertainty</a></li>
<li class="chapter" data-level="3.1.4" data-path="describing-the-observations.html"><a href="describing-the-observations.html#relationship-between-quantitative-variables"><i class="fa fa-check"></i><b>3.1.4</b> Relationship between quantitative variables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="describing-the-observations.html"><a href="describing-the-observations.html#nominal-data"><i class="fa fa-check"></i><b>3.2</b> Nominal data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="describing-the-observations.html"><a href="describing-the-observations.html#distributions-of-frequencies"><i class="fa fa-check"></i><b>3.2.1</b> Distributions of frequencies</a></li>
<li class="chapter" data-level="3.2.2" data-path="describing-the-observations.html"><a href="describing-the-observations.html#descriptive-stats-for-distributions-of-frequencies"><i class="fa fa-check"></i><b>3.2.2</b> Descriptive stats for distributions of frequencies</a></li>
<li class="chapter" data-level="3.2.3" data-path="describing-the-observations.html"><a href="describing-the-observations.html#contingency-tables"><i class="fa fa-check"></i><b>3.2.3</b> Contingency tables</a></li>
<li class="chapter" data-level="3.2.4" data-path="describing-the-observations.html"><a href="describing-the-observations.html#independence"><i class="fa fa-check"></i><b>3.2.4</b> Independence</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="describing-the-observations.html"><a href="describing-the-observations.html#descriptive-stats-with-r"><i class="fa fa-check"></i><b>3.3</b> Descriptive stats with R</a></li>
<li class="chapter" data-level="3.4" data-path="describing-the-observations.html"><a href="describing-the-observations.html#graphical-representations"><i class="fa fa-check"></i><b>3.4</b> Graphical representations</a></li>
<li class="chapter" data-level="3.5" data-path="describing-the-observations.html"><a href="describing-the-observations.html#further-reading"><i class="fa fa-check"></i><b>3.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html"><i class="fa fa-check"></i><b>4</b> Modeling the experimental data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#deterministic-models"><i class="fa fa-check"></i><b>4.1</b> Deterministic models</a></li>
<li class="chapter" data-level="4.2" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#stochastic-models"><i class="fa fa-check"></i><b>4.2</b> Stochastic models</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#probability-functions"><i class="fa fa-check"></i><b>4.2.1</b> Probability functions</a></li>
<li class="chapter" data-level="4.2.2" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#density-functions"><i class="fa fa-check"></i><b>4.2.2</b> Density functions</a></li>
<li class="chapter" data-level="4.2.3" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#the-gaussian-pdf-and-cdf"><i class="fa fa-check"></i><b>4.2.3</b> The Gaussian PDF and CDF</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#a-model-with-two-components"><i class="fa fa-check"></i><b>4.3</b> A model with two components</a></li>
<li class="chapter" data-level="4.4" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#and-so-what"><i class="fa fa-check"></i><b>4.4</b> And so what?</a></li>
<li class="chapter" data-level="4.5" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#monte-carlo-methods-to-simulate-an-experiment"><i class="fa fa-check"></i><b>4.5</b> Monte Carlo methods to simulate an experiment</a></li>
<li class="chapter" data-level="4.6" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#data-analysis-and-model-fitting"><i class="fa fa-check"></i><b>4.6</b> Data analysis and model fitting</a></li>
<li class="chapter" data-level="4.7" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#some-words-of-warning"><i class="fa fa-check"></i><b>4.7</b> Some words of warning</a></li>
<li class="chapter" data-level="4.8" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#further-readings-2"><i class="fa fa-check"></i><b>4.8</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html"><i class="fa fa-check"></i><b>5</b> Estimation of model parameters</a>
<ul>
<li class="chapter" data-level="5.1" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#example-1-a-concentration-value"><i class="fa fa-check"></i><b>5.1</b> Example 1: a concentration value</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#the-empirical-sampling-distribution"><i class="fa fa-check"></i><b>5.1.1</b> The empirical sampling distribution</a></li>
<li class="chapter" data-level="5.1.2" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#a-theoretical-sampling-distribution"><i class="fa fa-check"></i><b>5.1.2</b> A theoretical sampling distribution</a></li>
<li class="chapter" data-level="5.1.3" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#the-frequentist-confidence-interval"><i class="fa fa-check"></i><b>5.1.3</b> The frequentist confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#example-2-a-proportion"><i class="fa fa-check"></i><b>5.2</b> Example 2: a proportion</a></li>
<li class="chapter" data-level="5.3" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#conclusions-2"><i class="fa fa-check"></i><b>5.3</b> Conclusions</a></li>
<li class="chapter" data-level="5.4" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#further-readings-3"><i class="fa fa-check"></i><b>5.4</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html"><i class="fa fa-check"></i><b>6</b> Making Decisions under uncertainty</a>
<ul>
<li class="chapter" data-level="6.1" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#comparing-sample-means-the-students-t-test"><i class="fa fa-check"></i><b>6.1</b> Comparing sample means: the Student’s t-test</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#the-dataset"><i class="fa fa-check"></i><b>6.1.1</b> The dataset</a></li>
<li class="chapter" data-level="6.1.2" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#monte-carlo-simulation"><i class="fa fa-check"></i><b>6.1.2</b> Monte Carlo simulation</a></li>
<li class="chapter" data-level="6.1.3" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#a-formal-solution"><i class="fa fa-check"></i><b>6.1.3</b> A formal solution</a></li>
<li class="chapter" data-level="6.1.4" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#the-t-test-with-r"><i class="fa fa-check"></i><b>6.1.4</b> The t test with R</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#comparing-proportions-the-chi2-test"><i class="fa fa-check"></i><b>6.2</b> Comparing proportions: the <span class="math inline">\(\chi^2\)</span> test</a></li>
<li class="chapter" data-level="6.3" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#correct-interpretation-of-the-p-value"><i class="fa fa-check"></i><b>6.3</b> Correct interpretation of the P-value</a></li>
<li class="chapter" data-level="6.4" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#conclusions-3"><i class="fa fa-check"></i><b>6.4</b> Conclusions</a></li>
<li class="chapter" data-level="6.5" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#further-readings-4"><i class="fa fa-check"></i><b>6.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html"><i class="fa fa-check"></i><b>7</b> One-way ANOVA models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#comparing-herbicides-in-a-pot-experiment"><i class="fa fa-check"></i><b>7.1</b> Comparing herbicides in a pot-experiment</a></li>
<li class="chapter" data-level="7.2" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#data-description"><i class="fa fa-check"></i><b>7.2</b> Data description</a></li>
<li class="chapter" data-level="7.3" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#model-definition"><i class="fa fa-check"></i><b>7.3</b> Model definition</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#parameterisation"><i class="fa fa-check"></i><b>7.3.1</b> Parameterisation</a></li>
<li class="chapter" data-level="7.3.2" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#treatment-constraint"><i class="fa fa-check"></i><b>7.3.2</b> Treatment constraint</a></li>
<li class="chapter" data-level="7.3.3" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#sum-to-zero-constraint"><i class="fa fa-check"></i><b>7.3.3</b> Sum-to-zero constraint</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#basic-assumptions"><i class="fa fa-check"></i><b>7.4</b> Basic assumptions</a></li>
<li class="chapter" data-level="7.5" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#fitting-anova-models-by-hand"><i class="fa fa-check"></i><b>7.5</b> Fitting ANOVA models by hand</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#parameter-estimation"><i class="fa fa-check"></i><b>7.5.1</b> Parameter estimation</a></li>
<li class="chapter" data-level="7.5.2" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#residuals"><i class="fa fa-check"></i><b>7.5.2</b> Residuals</a></li>
<li class="chapter" data-level="7.5.3" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#standard-deviation-sigma"><i class="fa fa-check"></i><b>7.5.3</b> Standard deviation <span class="math inline">\(\sigma\)</span></a></li>
<li class="chapter" data-level="7.5.4" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#sem-and-sed"><i class="fa fa-check"></i><b>7.5.4</b> SEM and SED</a></li>
<li class="chapter" data-level="7.5.5" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#variance-partitioning"><i class="fa fa-check"></i><b>7.5.5</b> Variance partitioning</a></li>
<li class="chapter" data-level="7.5.6" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#hypothesis-testing"><i class="fa fa-check"></i><b>7.5.6</b> Hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#fitting-anova-models-with-r"><i class="fa fa-check"></i><b>7.6</b> Fitting ANOVA models with R</a></li>
<li class="chapter" data-level="7.7" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#expected-marginal-means"><i class="fa fa-check"></i><b>7.7</b> Expected marginal means</a></li>
<li class="chapter" data-level="7.8" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#conclusions-4"><i class="fa fa-check"></i><b>7.8</b> Conclusions</a></li>
<li class="chapter" data-level="7.9" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#further-readings-5"><i class="fa fa-check"></i><b>7.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html"><i class="fa fa-check"></i><b>8</b> Checking for the basic assumptions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#outlying-observations"><i class="fa fa-check"></i><b>8.1</b> Outlying observations</a></li>
<li class="chapter" data-level="8.2" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#the-inspection-of-residuals"><i class="fa fa-check"></i><b>8.2</b> The inspection of residuals</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#plot-of-residuals-against-expected-values"><i class="fa fa-check"></i><b>8.2.1</b> Plot of residuals against expected values</a></li>
<li class="chapter" data-level="8.2.2" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#qq-plot"><i class="fa fa-check"></i><b>8.2.2</b> QQ-plot</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#formal-hypotesis-testing"><i class="fa fa-check"></i><b>8.3</b> Formal hypotesis testing</a></li>
<li class="chapter" data-level="8.4" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#what-do-we-do-in-practice"><i class="fa fa-check"></i><b>8.4</b> What do we do, in practice?</a></li>
<li class="chapter" data-level="8.5" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#correcting-measures"><i class="fa fa-check"></i><b>8.5</b> Correcting measures</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#removing-outliers"><i class="fa fa-check"></i><b>8.5.1</b> Removing outliers</a></li>
<li class="chapter" data-level="8.5.2" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#stabilising-transformations"><i class="fa fa-check"></i><b>8.5.2</b> Stabilising transformations</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#examples-with-r"><i class="fa fa-check"></i><b>8.6</b> Examples with R</a></li>
<li class="chapter" data-level="8.7" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#example-1"><i class="fa fa-check"></i><b>8.7</b> Example 1</a></li>
<li class="chapter" data-level="8.8" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#example-2"><i class="fa fa-check"></i><b>8.8</b> Example 2</a></li>
<li class="chapter" data-level="8.9" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#other-possible-approaches"><i class="fa fa-check"></i><b>8.9</b> Other possible approaches</a></li>
<li class="chapter" data-level="8.10" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#further-readings-6"><i class="fa fa-check"></i><b>8.10</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html"><i class="fa fa-check"></i><b>9</b> Contrasts and multiple comparison testing</a>
<ul>
<li class="chapter" data-level="9.1" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#back-to-the-mixture-example"><i class="fa fa-check"></i><b>9.1</b> Back to the ‘mixture’ example</a></li>
<li class="chapter" data-level="9.2" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#linear-contrasts"><i class="fa fa-check"></i><b>9.2</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#the-variance-of-contrasts"><i class="fa fa-check"></i><b>9.2.1</b> The variance of contrasts</a></li>
<li class="chapter" data-level="9.2.2" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#testing-linear-contrasts-with-r"><i class="fa fa-check"></i><b>9.2.2</b> Testing linear contrasts with R</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#pairwise-comparisons"><i class="fa fa-check"></i><b>9.3</b> Pairwise comparisons</a></li>
<li class="chapter" data-level="9.4" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#letter-display"><i class="fa fa-check"></i><b>9.4</b> Letter display</a></li>
<li class="chapter" data-level="9.5" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#multiplicity-correction"><i class="fa fa-check"></i><b>9.5</b> Multiplicity correction</a></li>
<li class="chapter" data-level="9.6" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#multiple-comparisons-with-transformed-data"><i class="fa fa-check"></i><b>9.6</b> Multiple comparisons with transformed data</a></li>
<li class="chapter" data-level="9.7" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#what-about-the-traditional-mcps"><i class="fa fa-check"></i><b>9.7</b> What about the traditional MCPs?</a></li>
<li class="chapter" data-level="9.8" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#some-practical-suggestions"><i class="fa fa-check"></i><b>9.8</b> Some practical suggestions</a></li>
<li class="chapter" data-level="9.9" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#further-readings-7"><i class="fa fa-check"></i><b>9.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html"><i class="fa fa-check"></i><b>10</b> Multi-way ANOVA models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#motivating-example-a-genotype-experiment-in-blocks"><i class="fa fa-check"></i><b>10.1</b> Motivating example: a genotype experiment in blocks</a></li>
<li class="chapter" data-level="10.2" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-definition-1"><i class="fa fa-check"></i><b>10.2</b> Model definition</a></li>
<li class="chapter" data-level="10.3" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-fitting-by-hand"><i class="fa fa-check"></i><b>10.3</b> Model fitting by hand</a></li>
<li class="chapter" data-level="10.4" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-fitting-with-r"><i class="fa fa-check"></i><b>10.4</b> Model fitting with R</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-checking"><i class="fa fa-check"></i><b>10.4.1</b> Model checking</a></li>
<li class="chapter" data-level="10.4.2" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#variance-partitioning-1"><i class="fa fa-check"></i><b>10.4.2</b> Variance partitioning</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#another-example-comparing-working-protocols"><i class="fa fa-check"></i><b>10.5</b> Another example: comparing working protocols</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html"><i class="fa fa-check"></i><b>11</b> Multi-way ANOVA models with interactions</a>
<ul>
<li class="chapter" data-level="11.1" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#the-interaction-concept"><i class="fa fa-check"></i><b>11.1</b> The ‘interaction’ concept</a></li>
<li class="chapter" data-level="11.2" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#genotype-by-n-interactions"><i class="fa fa-check"></i><b>11.2</b> Genotype by N interactions</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-definition-2"><i class="fa fa-check"></i><b>11.2.1</b> Model definition</a></li>
<li class="chapter" data-level="11.2.2" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-fitting-by-hand-1"><i class="fa fa-check"></i><b>11.2.2</b> Model fitting by hand</a></li>
<li class="chapter" data-level="11.2.3" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-fitting-with-r-1"><i class="fa fa-check"></i><b>11.2.3</b> Model fitting with R</a></li>
<li class="chapter" data-level="11.2.4" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#inferences-and-standard-errors"><i class="fa fa-check"></i><b>11.2.4</b> Inferences and standard errors</a></li>
<li class="chapter" data-level="11.2.5" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#expected-marginal-means-1"><i class="fa fa-check"></i><b>11.2.5</b> Expected marginal means</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#nested-effects-maize-crosses"><i class="fa fa-check"></i><b>11.3</b> Nested effects: maize crosses</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-definition-3"><i class="fa fa-check"></i><b>11.3.1</b> Model definition</a></li>
<li class="chapter" data-level="11.3.2" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#parameter-estimation-1"><i class="fa fa-check"></i><b>11.3.2</b> Parameter estimation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#further-readings-8"><i class="fa fa-check"></i><b>11.4</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>12</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#case-study-n-fertilisation-in-wheat"><i class="fa fa-check"></i><b>12.1</b> Case-study: N fertilisation in wheat</a></li>
<li class="chapter" data-level="12.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#preliminary-analysis"><i class="fa fa-check"></i><b>12.2</b> Preliminary analysis</a></li>
<li class="chapter" data-level="12.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#definition-of-a-linear-model"><i class="fa fa-check"></i><b>12.3</b> Definition of a linear model</a></li>
<li class="chapter" data-level="12.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#parameter-estimation-2"><i class="fa fa-check"></i><b>12.4</b> Parameter estimation</a></li>
<li class="chapter" data-level="12.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#goodness-of-fit"><i class="fa fa-check"></i><b>12.5</b> Goodness of fit</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#graphical-evaluation"><i class="fa fa-check"></i><b>12.5.1</b> Graphical evaluation</a></li>
<li class="chapter" data-level="12.5.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#standard-errors-for-parameter-estimates"><i class="fa fa-check"></i><b>12.5.2</b> Standard errors for parameter estimates</a></li>
<li class="chapter" data-level="12.5.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#f-test-for-lack-of-fit"><i class="fa fa-check"></i><b>12.5.3</b> F test for lack of fit</a></li>
<li class="chapter" data-level="12.5.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#f-test-for-goodness-of-fit-and-coefficient-of-determination"><i class="fa fa-check"></i><b>12.5.4</b> F test for goodness of fit and coefficient of determination</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#making-predictions"><i class="fa fa-check"></i><b>12.6</b> Making predictions</a></li>
<li class="chapter" data-level="12.7" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#further-readings-9"><i class="fa fa-check"></i><b>12.7</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html"><i class="fa fa-check"></i><b>13</b> A brief intro to mixed models</a>
<ul>
<li class="chapter" data-level="13.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#split-plot-or-strip-plot-experiments"><i class="fa fa-check"></i><b>13.1</b> Split-plot or strip-plot experiments</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-1-a-split-plot-experiment"><i class="fa fa-check"></i><b>13.1.1</b> Example 1: a split-plot experiment</a></li>
<li class="chapter" data-level="13.1.2" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-2-a-strip-plot-design"><i class="fa fa-check"></i><b>13.1.2</b> Example 2: a strip-plot design</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#sub-sampling-designs"><i class="fa fa-check"></i><b>13.2</b> Sub-sampling designs</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-3-a-rcbd-with-sub-sampling"><i class="fa fa-check"></i><b>13.2.1</b> Example 3: A RCBD with sub-sampling</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#repeated-experiments"><i class="fa fa-check"></i><b>13.3</b> Repeated experiments</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#a-model-for-pooling-the-results"><i class="fa fa-check"></i><b>13.3.1</b> A model for pooling the results</a></li>
<li class="chapter" data-level="13.3.2" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#preliminary-analyses"><i class="fa fa-check"></i><b>13.3.2</b> Preliminary analyses</a></li>
<li class="chapter" data-level="13.3.3" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#fixed-or-random-runs"><i class="fa fa-check"></i><b>13.3.3</b> Fixed or random runs?</a></li>
<li class="chapter" data-level="13.3.4" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-4-a-seed-germination-experiment-in-two-runs"><i class="fa fa-check"></i><b>13.3.4</b> Example 4: a seed germination experiment in two runs</a></li>
<li class="chapter" data-level="13.3.5" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-5-a-multi-year-winter-wheat-experiment"><i class="fa fa-check"></i><b>13.3.5</b> Example 5: a multi-year winter wheat experiment</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#repeated-measures-in-perennial-crops"><i class="fa fa-check"></i><b>13.4</b> Repeated measures in perennial crops</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-5-genotype-experiment-with-lucerne"><i class="fa fa-check"></i><b>13.4.1</b> Example 5: genotype experiment with lucerne</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#further-readings-10"><i class="fa fa-check"></i><b>13.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>14</b> Nonlinear regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#case-study-a-degradation-curve"><i class="fa fa-check"></i><b>14.1</b> Case-study: a degradation curve</a></li>
<li class="chapter" data-level="14.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#model-selection"><i class="fa fa-check"></i><b>14.2</b> Model selection</a></li>
<li class="chapter" data-level="14.3" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#parameter-estimation-3"><i class="fa fa-check"></i><b>14.3</b> Parameter estimation</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#linearisation"><i class="fa fa-check"></i><b>14.3.1</b> Linearisation</a></li>
<li class="chapter" data-level="14.3.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#approximation-with-a-polynomial-function"><i class="fa fa-check"></i><b>14.3.2</b> Approximation with a polynomial function</a></li>
<li class="chapter" data-level="14.3.3" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#nonlinear-least-squares"><i class="fa fa-check"></i><b>14.3.3</b> Nonlinear least squares</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#nonlinear-regression-with-r"><i class="fa fa-check"></i><b>14.4</b> Nonlinear regression with R</a></li>
<li class="chapter" data-level="14.5" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#checking-the-model"><i class="fa fa-check"></i><b>14.5</b> Checking the model</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#graphical-analyses-of-residuals"><i class="fa fa-check"></i><b>14.5.1</b> Graphical analyses of residuals</a></li>
<li class="chapter" data-level="14.5.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#approximate-f-test-for-lack-of-fit"><i class="fa fa-check"></i><b>14.5.2</b> Approximate F test for lack of fit</a></li>
<li class="chapter" data-level="14.5.3" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#the-coefficient-of-determination-r2"><i class="fa fa-check"></i><b>14.5.3</b> The coefficient of determination (R<sup>2</sup>)</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#stabilising-transformations-1"><i class="fa fa-check"></i><b>14.6</b> Stabilising transformations</a></li>
<li class="chapter" data-level="14.7" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#making-predictions-1"><i class="fa fa-check"></i><b>14.7</b> Making predictions</a></li>
<li class="chapter" data-level="14.8" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#further-readings-11"><i class="fa fa-check"></i><b>14.8</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>15</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.1" data-path="exercises.html"><a href="exercises.html#designing-experiments-ch.-1-to-2"><i class="fa fa-check"></i><b>15.1</b> Designing experiments (ch. 1 to 2)</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="exercises.html"><a href="exercises.html#exercise-1"><i class="fa fa-check"></i><b>15.1.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.1.2" data-path="exercises.html"><a href="exercises.html#exercise-2"><i class="fa fa-check"></i><b>15.1.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.1.3" data-path="exercises.html"><a href="exercises.html#exercise-3"><i class="fa fa-check"></i><b>15.1.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="exercises.html"><a href="exercises.html#describing-the-observations-ch.-3"><i class="fa fa-check"></i><b>15.2</b> Describing the observations (ch. 3)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="exercises.html"><a href="exercises.html#exercise-1-1"><i class="fa fa-check"></i><b>15.2.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.2.2" data-path="exercises.html"><a href="exercises.html#exercise-2-1"><i class="fa fa-check"></i><b>15.2.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.2.3" data-path="exercises.html"><a href="exercises.html#exercise-3-1"><i class="fa fa-check"></i><b>15.2.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="exercises.html"><a href="exercises.html#modeling-the-experimental-data-ch.-4"><i class="fa fa-check"></i><b>15.3</b> Modeling the experimental data (ch. 4)</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="exercises.html"><a href="exercises.html#exercise-1-2"><i class="fa fa-check"></i><b>15.3.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.3.2" data-path="exercises.html"><a href="exercises.html#exercise-2-2"><i class="fa fa-check"></i><b>15.3.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.3.3" data-path="exercises.html"><a href="exercises.html#exercise-3-2"><i class="fa fa-check"></i><b>15.3.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.3.4" data-path="exercises.html"><a href="exercises.html#exercise-4"><i class="fa fa-check"></i><b>15.3.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.3.5" data-path="exercises.html"><a href="exercises.html#exercise-5"><i class="fa fa-check"></i><b>15.3.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.3.6" data-path="exercises.html"><a href="exercises.html#exercise-6"><i class="fa fa-check"></i><b>15.3.6</b> Exercise 6</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="exercises.html"><a href="exercises.html#interval-estimation-of-model-parameters-ch.-5"><i class="fa fa-check"></i><b>15.4</b> Interval estimation of model parameters (ch. 5)</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="exercises.html"><a href="exercises.html#exercise-1-3"><i class="fa fa-check"></i><b>15.4.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.4.2" data-path="exercises.html"><a href="exercises.html#exercise-2-3"><i class="fa fa-check"></i><b>15.4.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.4.3" data-path="exercises.html"><a href="exercises.html#exercise-3-3"><i class="fa fa-check"></i><b>15.4.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.4.4" data-path="exercises.html"><a href="exercises.html#exercise-4-1"><i class="fa fa-check"></i><b>15.4.4</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="exercises.html"><a href="exercises.html#making-decisions-under-uncertainty-ch.-6"><i class="fa fa-check"></i><b>15.5</b> Making decisions under uncertainty (ch. 6)</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="exercises.html"><a href="exercises.html#exercise-1-4"><i class="fa fa-check"></i><b>15.5.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.5.2" data-path="exercises.html"><a href="exercises.html#exercise-2-4"><i class="fa fa-check"></i><b>15.5.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.5.3" data-path="exercises.html"><a href="exercises.html#exercise-3-4"><i class="fa fa-check"></i><b>15.5.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.5.4" data-path="exercises.html"><a href="exercises.html#exercise-4-2"><i class="fa fa-check"></i><b>15.5.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.5.5" data-path="exercises.html"><a href="exercises.html#exercise-5-1"><i class="fa fa-check"></i><b>15.5.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.5.6" data-path="exercises.html"><a href="exercises.html#exercise-6-1"><i class="fa fa-check"></i><b>15.5.6</b> Exercise 6</a></li>
<li class="chapter" data-level="15.5.7" data-path="exercises.html"><a href="exercises.html#exercise-7"><i class="fa fa-check"></i><b>15.5.7</b> Exercise 7</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="exercises.html"><a href="exercises.html#fitting-models-to-data-from-agriculture-experiments"><i class="fa fa-check"></i><b>15.6</b> Fitting models to data from agriculture experiments</a></li>
<li class="chapter" data-level="15.7" data-path="exercises.html"><a href="exercises.html#one-way-anova-models-ch.-7-to-9"><i class="fa fa-check"></i><b>15.7</b> One-way ANOVA models (ch. 7 to 9)</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="exercises.html"><a href="exercises.html#exercise-1-5"><i class="fa fa-check"></i><b>15.7.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.7.2" data-path="exercises.html"><a href="exercises.html#exercise-2-5"><i class="fa fa-check"></i><b>15.7.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.7.3" data-path="exercises.html"><a href="exercises.html#exercise-3-5"><i class="fa fa-check"></i><b>15.7.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.7.4" data-path="exercises.html"><a href="exercises.html#exercise-4-3"><i class="fa fa-check"></i><b>15.7.4</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="exercises.html"><a href="exercises.html#multi-way-anova-models-ch.-10"><i class="fa fa-check"></i><b>15.8</b> Multi-way ANOVA models (ch. 10)</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="exercises.html"><a href="exercises.html#exercise-1-6"><i class="fa fa-check"></i><b>15.8.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.8.2" data-path="exercises.html"><a href="exercises.html#exercise-2-6"><i class="fa fa-check"></i><b>15.8.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.8.3" data-path="exercises.html"><a href="exercises.html#exercise-3-6"><i class="fa fa-check"></i><b>15.8.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="15.9" data-path="exercises.html"><a href="exercises.html#multi-way-anova-models-with-interactions-ch.-11-and-13"><i class="fa fa-check"></i><b>15.9</b> Multi-way ANOVA models with interactions (ch. 11 and 13)</a>
<ul>
<li class="chapter" data-level="15.9.1" data-path="exercises.html"><a href="exercises.html#exercise-1-7"><i class="fa fa-check"></i><b>15.9.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.9.2" data-path="exercises.html"><a href="exercises.html#exercise-2-7"><i class="fa fa-check"></i><b>15.9.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.9.3" data-path="exercises.html"><a href="exercises.html#exercise-3-7"><i class="fa fa-check"></i><b>15.9.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.9.4" data-path="exercises.html"><a href="exercises.html#exercise-4-4"><i class="fa fa-check"></i><b>15.9.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.9.5" data-path="exercises.html"><a href="exercises.html#exercise-5-2"><i class="fa fa-check"></i><b>15.9.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.9.6" data-path="exercises.html"><a href="exercises.html#exercise-6-2"><i class="fa fa-check"></i><b>15.9.6</b> Exercise 6</a></li>
</ul></li>
<li class="chapter" data-level="15.10" data-path="exercises.html"><a href="exercises.html#simple-linear-regression-ch.-12"><i class="fa fa-check"></i><b>15.10</b> Simple linear regression (ch. 12)</a>
<ul>
<li class="chapter" data-level="15.10.1" data-path="exercises.html"><a href="exercises.html#exercise-1-8"><i class="fa fa-check"></i><b>15.10.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.10.2" data-path="exercises.html"><a href="exercises.html#exercise-2-8"><i class="fa fa-check"></i><b>15.10.2</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="15.11" data-path="exercises.html"><a href="exercises.html#nonlinear-regression-ch.-14"><i class="fa fa-check"></i><b>15.11</b> Nonlinear regression (ch. 14)</a>
<ul>
<li class="chapter" data-level="15.11.1" data-path="exercises.html"><a href="exercises.html#exercise-1-9"><i class="fa fa-check"></i><b>15.11.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.11.2" data-path="exercises.html"><a href="exercises.html#exercise-2-9"><i class="fa fa-check"></i><b>15.11.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.11.3" data-path="exercises.html"><a href="exercises.html#exercise-3-8"><i class="fa fa-check"></i><b>15.11.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.11.4" data-path="exercises.html"><a href="exercises.html#exercise-4-5"><i class="fa fa-check"></i><b>15.11.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.11.5" data-path="exercises.html"><a href="exercises.html#exercise-5-3"><i class="fa fa-check"></i><b>15.11.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.11.6" data-path="exercises.html"><a href="exercises.html#exercise-6-3"><i class="fa fa-check"></i><b>15.11.6</b> Exercise 6</a></li>
<li class="chapter" data-level="15.11.7" data-path="exercises.html"><a href="exercises.html#exercise-7-1"><i class="fa fa-check"></i><b>15.11.7</b> Exercise 7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html"><i class="fa fa-check"></i><b>16</b> APPENDIX: A very gentle introduction to R</a>
<ul>
<li class="chapter" data-level="16.1" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#what-is-r"><i class="fa fa-check"></i><b>16.1</b> What is R?</a></li>
<li class="chapter" data-level="16.2" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#installing-r-and-moving-the-first-steps"><i class="fa fa-check"></i><b>16.2</b> Installing R and moving the first steps</a></li>
<li class="chapter" data-level="16.3" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#assignments"><i class="fa fa-check"></i><b>16.3</b> Assignments</a></li>
<li class="chapter" data-level="16.4" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#data-types-and-data-objects"><i class="fa fa-check"></i><b>16.4</b> Data types and data objects</a></li>
<li class="chapter" data-level="16.5" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#matrices"><i class="fa fa-check"></i><b>16.5</b> Matrices</a></li>
<li class="chapter" data-level="16.6" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#dataframes"><i class="fa fa-check"></i><b>16.6</b> Dataframes</a></li>
<li class="chapter" data-level="16.7" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#working-with-objects"><i class="fa fa-check"></i><b>16.7</b> Working with objects</a></li>
<li class="chapter" data-level="16.8" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#expressions-functions-and-arguments"><i class="fa fa-check"></i><b>16.8</b> Expressions, functions and arguments</a></li>
<li class="chapter" data-level="16.9" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#a-few-useful-functions"><i class="fa fa-check"></i><b>16.9</b> A few useful functions</a></li>
<li class="chapter" data-level="16.10" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#extractors"><i class="fa fa-check"></i><b>16.10</b> Extractors</a></li>
<li class="chapter" data-level="16.11" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#reading-external-data"><i class="fa fa-check"></i><b>16.11</b> Reading external data</a></li>
<li class="chapter" data-level="16.12" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#simple-r-graphics"><i class="fa fa-check"></i><b>16.12</b> Simple R graphics</a></li>
<li class="chapter" data-level="16.13" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#further-readings-12"><i class="fa fa-check"></i><b>16.13</b> Further readings</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Experimental methods in agriculture</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multi-way-anova-models" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Multi-way ANOVA models<a href="multi-way-anova-models.html#multi-way-anova-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>Statisticians, like artists, have the bad habit of falling in love with their models (G. Box)</em></p>
<p>In Chapter 7 we showed how we can fit linear models with one categorical predictor and one response variable (one-way ANOVA models). With those models, apart from differences due to the experimental treatments, all units must be completely independent and there should not be any other systematic sources of variability. On the contrary, with the most common experiments laid down as Randomised Complete Blocks (RCBDs) or, less commonly, as Latin Square (LSD), apart from the treatment factor, we also have, respectively, one and two blocking factors, which represent additional sources of systematic variability. Indeed, the block effect produces a more or less relevant increase/decrease in the observed response, with respect to the overall mean; for example, in a field experiment with two blocks, the most fertile one might might produce a yield increase of 1 t/ha, while the other one will produce a corresponding yield decrease of the same amount. Such yield variations will be systematically shared by all plots located in the same block.</p>
<p>In principle, we should not fit one-way ANOVA models to the data obtained from RCBDs or LSDs; if we do so, the residuals will also contain the block effect (<span class="math inline">\(\pm\)</span> 1 t/ha, in the previous example) and, therefore, those obtained in the same block will be more alike than the residuals obtained in different blocks. Consequently, the basic assumption of independence will no longer be valid; in order to avoid this, we need a new type of models that can account for treatment effects and block effects at the same time.</p>
<div id="motivating-example-a-genotype-experiment-in-blocks" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Motivating example: a genotype experiment in blocks<a href="multi-way-anova-models.html#motivating-example-a-genotype-experiment-in-blocks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s consider a field experiment to compare eight winter wheat genotypes, laid down in complete blocks, with three replicates. Each block consists of eight plots, to which genotypes were randomly allocated, one replicate per block; the blocks are laid out one beside the other, following the direction of the fertility gradient, so that plots within each block were as homogeneous as possible. The response variable is the yield, in tons per hectare.</p>
<p>The dataset is available as the ‘csv’ file ‘WinterWheat2002.csv’, which can be loaded from an external repository, as shown in the box below.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="multi-way-anova-models.html#cb115-1" tabindex="-1"></a>repo <span class="ot">&lt;-</span> <span class="st">&quot;https://www.casaonofri.it/_datasets/&quot;</span></span>
<span id="cb115-2"><a href="multi-way-anova-models.html#cb115-2" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">&quot;WinterWheat2002.csv&quot;</span></span>
<span id="cb115-3"><a href="multi-way-anova-models.html#cb115-3" tabindex="-1"></a>pathData <span class="ot">&lt;-</span> <span class="fu">paste</span>(repo, file, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb115-4"><a href="multi-way-anova-models.html#cb115-4" tabindex="-1"></a></span>
<span id="cb115-5"><a href="multi-way-anova-models.html#cb115-5" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(pathData, <span class="at">header =</span> T)</span>
<span id="cb115-6"><a href="multi-way-anova-models.html#cb115-6" tabindex="-1"></a><span class="fu">head</span>(dataset)</span>
<span id="cb115-7"><a href="multi-way-anova-models.html#cb115-7" tabindex="-1"></a><span class="do">##   Plot Block Genotype Yield</span></span>
<span id="cb115-8"><a href="multi-way-anova-models.html#cb115-8" tabindex="-1"></a><span class="do">## 1   57     A COLOSSEO  4.31</span></span>
<span id="cb115-9"><a href="multi-way-anova-models.html#cb115-9" tabindex="-1"></a><span class="do">## 2   61     B COLOSSEO  4.73</span></span>
<span id="cb115-10"><a href="multi-way-anova-models.html#cb115-10" tabindex="-1"></a><span class="do">## 3   11     C COLOSSEO  5.64</span></span>
<span id="cb115-11"><a href="multi-way-anova-models.html#cb115-11" tabindex="-1"></a><span class="do">## 4   60     A    CRESO  3.99</span></span>
<span id="cb115-12"><a href="multi-way-anova-models.html#cb115-12" tabindex="-1"></a><span class="do">## 5   10     B    CRESO  4.82</span></span>
<span id="cb115-13"><a href="multi-way-anova-models.html#cb115-13" tabindex="-1"></a><span class="do">## 6   42     C    CRESO  4.17</span></span></code></pre></div>
<p>The description of the dataset for each genotype (mean and standard deviation) is left to the reader, as an exercise.</p>
</div>
<div id="model-definition-1" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Model definition<a href="multi-way-anova-models.html#model-definition-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Considering the experimental design, the yield of each plot depends on:</p>
<ol style="list-style-type: decimal">
<li>the genotype;</li>
<li>the block;</li>
<li>other random and unknown effects.</li>
</ol>
<p>Consequently, a linear model can be specified as:</p>
<p><span class="math display">\[ Y_{ij} = \mu + \gamma_i + \alpha_j + \varepsilon_{ij}\]</span></p>
<p>where <span class="math inline">\(Y_{ij}\)</span> is the yield for the plot in the <span class="math inline">\(i\)</span><sup>th</sup> block and with the <span class="math inline">\(j\)</span><sup>th</sup> genotype, <span class="math inline">\(\mu\)</span> is the intercept, <span class="math inline">\(\gamma_i\)</span> is the effect of the <span class="math inline">\(i\)</span><sup>th</sup> block, <span class="math inline">\(\alpha_j\)</span> is the effect of the <span class="math inline">\(j\)</span><sup>th</sup> genotype and <span class="math inline">\(\varepsilon\)</span> is the residual plot error, which is assumed as gaussian, with mean equal to 0 and standard deviation equal to <span class="math inline">\(\sigma\)</span>. With respect to the one-way ANOVA model, we have the additional block effect, which accounts for the grouping of observations, so that the residuals only ‘contain’ random and independent effects.</p>
<p>As we did for the one-way ANOVA model, we need to put constraints on <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\gamma\)</span> values, so that model parameters are estimable. Regardless of the constraint, we have 7 genotype parameters and 2 block parameters to estimate, apart from <span class="math inline">\(\sigma\)</span>.</p>
</div>
<div id="model-fitting-by-hand" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Model fitting by hand<a href="multi-way-anova-models.html#model-fitting-by-hand" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Normally, the estimation process is done with R, by using the least squares method. For the sake of exercise, we do the calculations by hand, using the method of moments, which is correct whenever the experiment is balanced (same number of replicates for all genotypes). Hand-calculations are similar to those proposed in Chapter 7 and, if you had enough with them, you can safely skip this section and jump to the next one.</p>
<p>For hand-calculations, we prefer to use the sum-to-zero contraint; therefore, <span class="math inline">\(\mu\)</span> is the overall mean, <span class="math inline">\(\alpha_1\)</span> to <span class="math inline">\(\alpha_8\)</span> are the effects of the genotypes, as differences with respect to the overall mean, <span class="math inline">\(\gamma_1\)</span> to <span class="math inline">\(\gamma_3\)</span> are the effects of blocks. Owing to the sum-to-zero constraint, <span class="math inline">\(\alpha_8\)</span> and <span class="math inline">\(\gamma_3\)</span> must obey the following restrictions: <span class="math inline">\(\alpha_8 = -\sum_{i=1}^{7} \alpha_i\)</span> and <span class="math inline">\(\gamma_3 = -\sum_{i=1}^{2} \gamma_i\)</span>.</p>
<p>The initial step is to calculate the overall mean and the means for genotypes and blocks. As usual, we use the <code>tapply()</code> function to accomplish this task.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="multi-way-anova-models.html#cb116-1" tabindex="-1"></a>allMean <span class="ot">&lt;-</span> <span class="fu">mean</span>(dataset<span class="sc">$</span>Yield)</span>
<span id="cb116-2"><a href="multi-way-anova-models.html#cb116-2" tabindex="-1"></a>gMeans <span class="ot">&lt;-</span> <span class="fu">tapply</span>(dataset<span class="sc">$</span>Yield, dataset<span class="sc">$</span>Genotype, mean)</span>
<span id="cb116-3"><a href="multi-way-anova-models.html#cb116-3" tabindex="-1"></a>bMeans <span class="ot">&lt;-</span> <span class="fu">tapply</span>(dataset<span class="sc">$</span>Yield, dataset<span class="sc">$</span>Block, mean)</span>
<span id="cb116-4"><a href="multi-way-anova-models.html#cb116-4" tabindex="-1"></a>allMean</span>
<span id="cb116-5"><a href="multi-way-anova-models.html#cb116-5" tabindex="-1"></a><span class="do">## [1] 4.424583</span></span>
<span id="cb116-6"><a href="multi-way-anova-models.html#cb116-6" tabindex="-1"></a>gMeans</span>
<span id="cb116-7"><a href="multi-way-anova-models.html#cb116-7" tabindex="-1"></a><span class="do">## COLOSSEO    CRESO   DUILIO   GRAZIA    IRIDE SANCARLO   SIMETO </span></span>
<span id="cb116-8"><a href="multi-way-anova-models.html#cb116-8" tabindex="-1"></a><span class="do">## 4.893333 4.326667 4.240000 4.340000 4.963333 4.503333 3.340000 </span></span>
<span id="cb116-9"><a href="multi-way-anova-models.html#cb116-9" tabindex="-1"></a><span class="do">##    SOLEX </span></span>
<span id="cb116-10"><a href="multi-way-anova-models.html#cb116-10" tabindex="-1"></a><span class="do">## 4.790000</span></span>
<span id="cb116-11"><a href="multi-way-anova-models.html#cb116-11" tabindex="-1"></a>bMeans</span>
<span id="cb116-12"><a href="multi-way-anova-models.html#cb116-12" tabindex="-1"></a><span class="do">##       A       B       C </span></span>
<span id="cb116-13"><a href="multi-way-anova-models.html#cb116-13" tabindex="-1"></a><span class="do">## 4.20625 4.41500 4.65250</span></span></code></pre></div>
<p>Now we can calculate yield differences between the genotype means and the overall mean, so that we obtain the genotype effects <span class="math inline">\(\alpha_i\)</span>. We do the same to obtain the block effects, as shown in the box below.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="multi-way-anova-models.html#cb117-1" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> gMeans <span class="sc">-</span> allMean</span>
<span id="cb117-2"><a href="multi-way-anova-models.html#cb117-2" tabindex="-1"></a>alpha</span>
<span id="cb117-3"><a href="multi-way-anova-models.html#cb117-3" tabindex="-1"></a><span class="do">##    COLOSSEO       CRESO      DUILIO      GRAZIA       IRIDE </span></span>
<span id="cb117-4"><a href="multi-way-anova-models.html#cb117-4" tabindex="-1"></a><span class="do">##  0.46875000 -0.09791667 -0.18458333 -0.08458333  0.53875000 </span></span>
<span id="cb117-5"><a href="multi-way-anova-models.html#cb117-5" tabindex="-1"></a><span class="do">##    SANCARLO      SIMETO       SOLEX </span></span>
<span id="cb117-6"><a href="multi-way-anova-models.html#cb117-6" tabindex="-1"></a><span class="do">##  0.07875000 -1.08458333  0.36541667</span></span>
<span id="cb117-7"><a href="multi-way-anova-models.html#cb117-7" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> bMeans <span class="sc">-</span> allMean</span>
<span id="cb117-8"><a href="multi-way-anova-models.html#cb117-8" tabindex="-1"></a>gamma</span>
<span id="cb117-9"><a href="multi-way-anova-models.html#cb117-9" tabindex="-1"></a><span class="do">##            A            B            C </span></span>
<span id="cb117-10"><a href="multi-way-anova-models.html#cb117-10" tabindex="-1"></a><span class="do">## -0.218333333 -0.009583333  0.227916667</span></span></code></pre></div>
<p>It is useful to sort the dataset by genotypes and blocks and visualise all model parameters in a table; to do so, we need to repeat each genotype effects three times (the number of blocks) and the whole vector of block effects for eight times (the number of genotypes). Lately, we add to the table the expected values (<span class="math inline">\(Y_{E(ij)} = \mu + \gamma_i + \alpha_j\)</span>) and the residuals (<span class="math inline">\(\varepsilon_ij = Y_{ij} - Y_{E(ij)}\)</span>). The resulting data frame is shown in the box below.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="multi-way-anova-models.html#cb118-1" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">rep</span>(alpha, <span class="at">each =</span> <span class="dv">3</span>)</span>
<span id="cb118-2"><a href="multi-way-anova-models.html#cb118-2" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fu">rep</span>(gamma, <span class="dv">8</span>)</span>
<span id="cb118-3"><a href="multi-way-anova-models.html#cb118-3" tabindex="-1"></a>mu <span class="ot">&lt;-</span> allMean</span>
<span id="cb118-4"><a href="multi-way-anova-models.html#cb118-4" tabindex="-1"></a>YE <span class="ot">&lt;-</span> mu <span class="sc">+</span> gamma <span class="sc">+</span> alpha</span>
<span id="cb118-5"><a href="multi-way-anova-models.html#cb118-5" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> dataset<span class="sc">$</span>Yield <span class="sc">-</span> YE</span>
<span id="cb118-6"><a href="multi-way-anova-models.html#cb118-6" tabindex="-1"></a>lmod <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(dataset, mu, gamma, alpha, </span>
<span id="cb118-7"><a href="multi-way-anova-models.html#cb118-7" tabindex="-1"></a>                   YE, epsilon)</span>
<span id="cb118-8"><a href="multi-way-anova-models.html#cb118-8" tabindex="-1"></a><span class="fu">print</span>(lmod, <span class="at">digits =</span> <span class="dv">4</span>)</span>
<span id="cb118-9"><a href="multi-way-anova-models.html#cb118-9" tabindex="-1"></a><span class="do">##    Plot Block Genotype Yield    mu     gamma    alpha    YE  epsilon</span></span>
<span id="cb118-10"><a href="multi-way-anova-models.html#cb118-10" tabindex="-1"></a><span class="do">## 1    57     A COLOSSEO  4.31 4.425 -0.218333  0.46875 4.675 -0.36500</span></span>
<span id="cb118-11"><a href="multi-way-anova-models.html#cb118-11" tabindex="-1"></a><span class="do">## 2    61     B COLOSSEO  4.73 4.425 -0.009583  0.46875 4.884 -0.15375</span></span>
<span id="cb118-12"><a href="multi-way-anova-models.html#cb118-12" tabindex="-1"></a><span class="do">## 3    11     C COLOSSEO  5.64 4.425  0.227917  0.46875 5.121  0.51875</span></span>
<span id="cb118-13"><a href="multi-way-anova-models.html#cb118-13" tabindex="-1"></a><span class="do">## 4    60     A    CRESO  3.99 4.425 -0.218333 -0.09792 4.108 -0.11833</span></span>
<span id="cb118-14"><a href="multi-way-anova-models.html#cb118-14" tabindex="-1"></a><span class="do">## 5    10     B    CRESO  4.82 4.425 -0.009583 -0.09792 4.317  0.50292</span></span>
<span id="cb118-15"><a href="multi-way-anova-models.html#cb118-15" tabindex="-1"></a><span class="do">## 6    42     C    CRESO  4.17 4.425  0.227917 -0.09792 4.555 -0.38458</span></span>
<span id="cb118-16"><a href="multi-way-anova-models.html#cb118-16" tabindex="-1"></a><span class="do">## 7    29     A   DUILIO  4.24 4.425 -0.218333 -0.18458 4.022  0.21833</span></span>
<span id="cb118-17"><a href="multi-way-anova-models.html#cb118-17" tabindex="-1"></a><span class="do">## 8    48     B   DUILIO  4.10 4.425 -0.009583 -0.18458 4.230 -0.13042</span></span>
<span id="cb118-18"><a href="multi-way-anova-models.html#cb118-18" tabindex="-1"></a><span class="do">## 9    81     C   DUILIO  4.38 4.425  0.227917 -0.18458 4.468 -0.08792</span></span>
<span id="cb118-19"><a href="multi-way-anova-models.html#cb118-19" tabindex="-1"></a><span class="do">## 10   32     A   GRAZIA  4.07 4.425 -0.218333 -0.08458 4.122 -0.05167</span></span>
<span id="cb118-20"><a href="multi-way-anova-models.html#cb118-20" tabindex="-1"></a><span class="do">## 11   65     B   GRAZIA  4.18 4.425 -0.009583 -0.08458 4.330 -0.15042</span></span>
<span id="cb118-21"><a href="multi-way-anova-models.html#cb118-21" tabindex="-1"></a><span class="do">## 12   28     C   GRAZIA  4.77 4.425  0.227917 -0.08458 4.568  0.20208</span></span>
<span id="cb118-22"><a href="multi-way-anova-models.html#cb118-22" tabindex="-1"></a><span class="do">## 13   19     A    IRIDE  5.18 4.425 -0.218333  0.53875 4.745  0.43500</span></span>
<span id="cb118-23"><a href="multi-way-anova-models.html#cb118-23" tabindex="-1"></a><span class="do">## 14   79     B    IRIDE  4.88 4.425 -0.009583  0.53875 4.954 -0.07375</span></span>
<span id="cb118-24"><a href="multi-way-anova-models.html#cb118-24" tabindex="-1"></a><span class="do">## 15   55     C    IRIDE  4.83 4.425  0.227917  0.53875 5.191 -0.36125</span></span>
<span id="cb118-25"><a href="multi-way-anova-models.html#cb118-25" tabindex="-1"></a><span class="do">## 16    5     A SANCARLO  4.34 4.425 -0.218333  0.07875 4.285  0.05500</span></span>
<span id="cb118-26"><a href="multi-way-anova-models.html#cb118-26" tabindex="-1"></a><span class="do">## 17   37     B SANCARLO  4.41 4.425 -0.009583  0.07875 4.494 -0.08375</span></span>
<span id="cb118-27"><a href="multi-way-anova-models.html#cb118-27" tabindex="-1"></a><span class="do">## 18   70     C SANCARLO  4.76 4.425  0.227917  0.07875 4.731  0.02875</span></span>
<span id="cb118-28"><a href="multi-way-anova-models.html#cb118-28" tabindex="-1"></a><span class="do">## 19    2     A   SIMETO  3.03 4.425 -0.218333 -1.08458 3.122 -0.09167</span></span>
<span id="cb118-29"><a href="multi-way-anova-models.html#cb118-29" tabindex="-1"></a><span class="do">## 20   34     B   SIMETO  3.21 4.425 -0.009583 -1.08458 3.330 -0.12042</span></span>
<span id="cb118-30"><a href="multi-way-anova-models.html#cb118-30" tabindex="-1"></a><span class="do">## 21   67     C   SIMETO  3.78 4.425  0.227917 -1.08458 3.568  0.21208</span></span>
<span id="cb118-31"><a href="multi-way-anova-models.html#cb118-31" tabindex="-1"></a><span class="do">## 22   74     A    SOLEX  4.49 4.425 -0.218333  0.36542 4.572 -0.08167</span></span>
<span id="cb118-32"><a href="multi-way-anova-models.html#cb118-32" tabindex="-1"></a><span class="do">## 23    9     B    SOLEX  4.99 4.425 -0.009583  0.36542 4.780  0.20958</span></span>
<span id="cb118-33"><a href="multi-way-anova-models.html#cb118-33" tabindex="-1"></a><span class="do">## 24   56     C    SOLEX  4.89 4.425  0.227917  0.36542 5.018 -0.12792</span></span></code></pre></div>
<p>From the above data frame, we can calculate all sum of squares; in detail, the residual sum of squares is obtained by squaring and summing up the residuals:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="multi-way-anova-models.html#cb119-1" tabindex="-1"></a>RSS <span class="ot">&lt;-</span> <span class="fu">sum</span>( epsilon<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb119-2"><a href="multi-way-anova-models.html#cb119-2" tabindex="-1"></a>RSS</span>
<span id="cb119-3"><a href="multi-way-anova-models.html#cb119-3" tabindex="-1"></a><span class="do">## [1] 1.450208</span></span></code></pre></div>
<p>Likewise, the sum of squares for blocks and genotypes is obtained by squaring and summing up the <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\alpha\)</span> effects.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="multi-way-anova-models.html#cb120-1" tabindex="-1"></a>TSS <span class="ot">&lt;-</span> <span class="fu">sum</span>(alpha <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb120-2"><a href="multi-way-anova-models.html#cb120-2" tabindex="-1"></a>BSS <span class="ot">&lt;-</span> <span class="fu">sum</span>(gamma <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb120-3"><a href="multi-way-anova-models.html#cb120-3" tabindex="-1"></a>TSS; BSS</span>
<span id="cb120-4"><a href="multi-way-anova-models.html#cb120-4" tabindex="-1"></a><span class="do">## [1] 5.630529</span></span>
<span id="cb120-5"><a href="multi-way-anova-models.html#cb120-5" tabindex="-1"></a><span class="do">## [1] 0.7976583</span></span></code></pre></div>
<p>If we calculate the total deviance for all observations, we can confirm that this was partitioned in three parts: the first one is due to the block effects, the second one is due to the genotype effects and the third one is due to all other unknown sources of variability.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="multi-way-anova-models.html#cb121-1" tabindex="-1"></a>SS <span class="ot">&lt;-</span> <span class="fu">sum</span>((dataset<span class="sc">$</span>Yield <span class="sc">-</span> mu)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb121-2"><a href="multi-way-anova-models.html#cb121-2" tabindex="-1"></a>SS</span>
<span id="cb121-3"><a href="multi-way-anova-models.html#cb121-3" tabindex="-1"></a><span class="do">## [1] 7.878396</span></span>
<span id="cb121-4"><a href="multi-way-anova-models.html#cb121-4" tabindex="-1"></a>BSS <span class="sc">+</span> TSS <span class="sc">+</span> RSS</span>
<span id="cb121-5"><a href="multi-way-anova-models.html#cb121-5" tabindex="-1"></a><span class="do">## [1] 7.878396</span></span></code></pre></div>
<p>The above hand-calculations should suffice for those who would like to see what happens ‘under the hood’. Now, we can go back to model fitting with R.</p>
</div>
<div id="model-fitting-with-r" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Model fitting with R<a href="multi-way-anova-models.html#model-fitting-with-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As shown in Chapter 7, ANOVA models with more than one predictor can be fit by using the <code>lm()</code> function and adding the block term along with the treatment term. It is fundamental that the block variable is transformed into a factor variable, otherwise R would consider it as numeric and would fit a regression model, instead of an ANOVA model (see later in this book). This error is very common in the most frequent case where a numeric variable is used to represent the blocks and it is easily spotted by checking the number of degrees of freedom in the final ANOVA table; indeed, if this number does not appear to correspond to our expectations (that is the number of blocks minus one; see below), it may mean that our model definition was wrong.</p>
<p>In the box below, we also transform the genotype variable into a factor, although this is optional, as the genotypes are represented by a character vector and not by a numeric vector.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="multi-way-anova-models.html#cb122-1" tabindex="-1"></a>dataset<span class="sc">$</span>Block <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset<span class="sc">$</span>Block)</span>
<span id="cb122-2"><a href="multi-way-anova-models.html#cb122-2" tabindex="-1"></a>dataset<span class="sc">$</span>Genotype <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset<span class="sc">$</span>Genotype)</span>
<span id="cb122-3"><a href="multi-way-anova-models.html#cb122-3" tabindex="-1"></a></span>
<span id="cb122-4"><a href="multi-way-anova-models.html#cb122-4" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Block <span class="sc">+</span> Genotype, <span class="at">data =</span> dataset)</span></code></pre></div>
<p>We do not inspect model coefficients, as they are not particularly useful in this instance. However, should you like to do so, you can use the <code>summary()</code> method; please, remember that the treatment constraint is used by default in R.</p>
<div id="model-checking" class="section level3 hasAnchor" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Model checking<a href="multi-way-anova-models.html#model-checking" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As we have discussed in Chapter 8, once we have got the residuals we should inspect them, searching for possible deviations from basic assumptions. Therefore, we produce a plot of residuals against expected values and a QQ-plot, by using the code below. The output is shown in Figure <a href="multi-way-anova-models.html#fig:figName121">10.1</a>.</p>
<pre><code>par(mfrow=c(1,2))
plot(mod, which = 1)
plot(mod, which = 2)</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figName121"></span>
<img src="_main_files/figure-html/figName121-1.png" alt="Graphical analyses of residuals for the genotype experiment" width="90%" />
<p class="caption">
Figure 10.1: Graphical analyses of residuals for the genotype experiment
</p>
</div>
<p>From that Figure, we observe that there are some slight signs of heteroscedasticity (see plot on the left side), although the Levene’s test is not significant (but it is on the borderline of significance; see the box below). We decide not to address this problem, for the sake of simplicity and based on the unsignificant Levene’s test.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="multi-way-anova-models.html#cb124-1" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">residuals</span>(mod)</span>
<span id="cb124-2"><a href="multi-way-anova-models.html#cb124-2" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">lm</span>(<span class="fu">abs</span>(epsilon) <span class="sc">~</span> <span class="fu">factor</span>(Genotype), <span class="at">data =</span> dataset))</span>
<span id="cb124-3"><a href="multi-way-anova-models.html#cb124-3" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb124-4"><a href="multi-way-anova-models.html#cb124-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb124-5"><a href="multi-way-anova-models.html#cb124-5" tabindex="-1"></a><span class="do">## Response: abs(epsilon)</span></span>
<span id="cb124-6"><a href="multi-way-anova-models.html#cb124-6" tabindex="-1"></a><span class="do">##                  Df  Sum Sq  Mean Sq F value  Pr(&gt;F)  </span></span>
<span id="cb124-7"><a href="multi-way-anova-models.html#cb124-7" tabindex="-1"></a><span class="do">## factor(Genotype)  7 0.24819 0.035455  2.2162 0.08887 .</span></span>
<span id="cb124-8"><a href="multi-way-anova-models.html#cb124-8" tabindex="-1"></a><span class="do">## Residuals        16 0.25597 0.015998                  </span></span>
<span id="cb124-9"><a href="multi-way-anova-models.html#cb124-9" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb124-10"><a href="multi-way-anova-models.html#cb124-10" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="variance-partitioning-1" class="section level3 hasAnchor" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> Variance partitioning<a href="multi-way-anova-models.html#variance-partitioning-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Variance partitioning with R is performed by applying the <code>anova()</code> method to the ‘lm’ object.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="multi-way-anova-models.html#cb125-1" tabindex="-1"></a><span class="fu">anova</span>(mod)</span>
<span id="cb125-2"><a href="multi-way-anova-models.html#cb125-2" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb125-3"><a href="multi-way-anova-models.html#cb125-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb125-4"><a href="multi-way-anova-models.html#cb125-4" tabindex="-1"></a><span class="do">## Response: Yield</span></span>
<span id="cb125-5"><a href="multi-way-anova-models.html#cb125-5" tabindex="-1"></a><span class="do">##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb125-6"><a href="multi-way-anova-models.html#cb125-6" tabindex="-1"></a><span class="do">## Block      2 0.7977 0.39883  3.8502 0.0465178 *  </span></span>
<span id="cb125-7"><a href="multi-way-anova-models.html#cb125-7" tabindex="-1"></a><span class="do">## Genotype   7 5.6305 0.80436  7.7651 0.0006252 ***</span></span>
<span id="cb125-8"><a href="multi-way-anova-models.html#cb125-8" tabindex="-1"></a><span class="do">## Residuals 14 1.4502 0.10359                      </span></span>
<span id="cb125-9"><a href="multi-way-anova-models.html#cb125-9" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb125-10"><a href="multi-way-anova-models.html#cb125-10" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The sum of squares are the same as those obtained by hand-calculations and they measure the amount of data variability that can be attributed to the different effects. Sum of squares cannot be directly compared, because they are based on different degrees of freedom and, therefore, we calculate the corresponding variances.</p>
<p>The number of Degrees of Freedom (DF) for the block effect is equal to the number of blocks <span class="math inline">\(b\)</span> minus one (<span class="math inline">\(DF_b = b - 1 = 2\)</span>), while the number of DF for the genotype effect is equal to the number of genotypes <span class="math inline">\(g\)</span> minus one (<span class="math inline">\(DF_g = g - 1 = 7\)</span>). The number of DF for the residual sum of squares is <span class="math inline">\(g \times (b - 1)\)</span> as in Chapter 7 (the number of blocks is equal to the number of replicates is the number of replicates), but we have to subtract <span class="math inline">\(DF_b\)</span>, so that we have <span class="math inline">\(DF_r = g \times (b - 1) - (b - 1) = (g - 1) \times (b - 1) = 14\)</span>.</p>
<p>The residual mean square is <span class="math inline">\(1.450208/14 = 0.10359\)</span> and, from there, we can get an estimate of <span class="math inline">\(\sigma = \sqrt{0.10359} = 0.3218483\)</span>. More easily, we can get <span class="math inline">\(\sigma\)</span> by using the <code>summary()</code> method and the ‘$sigma’ extractor.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="multi-way-anova-models.html#cb126-1" tabindex="-1"></a><span class="fu">summary</span>(mod)<span class="sc">$</span>sigma</span>
<span id="cb126-2"><a href="multi-way-anova-models.html#cb126-2" tabindex="-1"></a><span class="do">## [1] 0.3218483</span></span></code></pre></div>
<p>Subsequently, we start our inference process by using <span class="math inline">\(\sigma\)</span> to estimate the standard error for a mean (SEM) and the standard error for a difference (SED), which are, respectively, equal to <span class="math inline">\(0.3218483/\sqrt{3} = 0.186\)</span> and <span class="math inline">\(\sqrt{2} \times 0.3218483/\sqrt{3} = 0.263\)</span>.</p>
<p>Next, we set our null hypotheses as:</p>
<p><span class="math display">\[H_0: \gamma_1 = \gamma_2 = \gamma_3 = \gamma\]</span></p>
<p>and:</p>
<p><span class="math display">\[H_0: \alpha_1 = \alpha_2 = ... = \alpha_8 = 0\]</span></p>
<p>Indeed, for a RCBD, we have two F ratios, with the same denominator (residual mean square) and, respectively, the mean square for blocks and the mean square for genotypes as numerators. Based on those F-ratios, we see that both the nulls can be rejected, as the corresponding P-values are below the 0.05 yardstick. In particular, we are interested about the genotype effect, as we introduced the blocks only to be able to account for possible plot-to-plot fertility differences. Consequently, we only proceed to pairwise comparisons between the genotypes.</p>
<p>Please, note that we have 8 genotypes, implying that we need to test <span class="math inline">\(8 \time 7 / 2 = 27\)</span> pairwise differences, which is enough to justify the adoption of a multiplicity correction. For the sake of clarity, we report the means and adopt a letter display, where we order the means in decreasing yield order (the best is the one with highest yield), by using the argument ‘reverse = T’.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="multi-way-anova-models.html#cb127-1" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb127-2"><a href="multi-way-anova-models.html#cb127-2" tabindex="-1"></a>medie <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(mod, <span class="sc">~</span><span class="fu">factor</span>(Genotype))</span>
<span id="cb127-3"><a href="multi-way-anova-models.html#cb127-3" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(medie, <span class="at">Letters =</span> LETTERS, <span class="at">reverse =</span> T)</span>
<span id="cb127-4"><a href="multi-way-anova-models.html#cb127-4" tabindex="-1"></a><span class="do">##  Genotype emmean    SE df lower.CL upper.CL .group</span></span>
<span id="cb127-5"><a href="multi-way-anova-models.html#cb127-5" tabindex="-1"></a><span class="do">##  IRIDE      4.96 0.186 14     4.56     5.36  A    </span></span>
<span id="cb127-6"><a href="multi-way-anova-models.html#cb127-6" tabindex="-1"></a><span class="do">##  COLOSSEO   4.89 0.186 14     4.49     5.29  A    </span></span>
<span id="cb127-7"><a href="multi-way-anova-models.html#cb127-7" tabindex="-1"></a><span class="do">##  SOLEX      4.79 0.186 14     4.39     5.19  A    </span></span>
<span id="cb127-8"><a href="multi-way-anova-models.html#cb127-8" tabindex="-1"></a><span class="do">##  SANCARLO   4.50 0.186 14     4.10     4.90  A    </span></span>
<span id="cb127-9"><a href="multi-way-anova-models.html#cb127-9" tabindex="-1"></a><span class="do">##  GRAZIA     4.34 0.186 14     3.94     4.74  A    </span></span>
<span id="cb127-10"><a href="multi-way-anova-models.html#cb127-10" tabindex="-1"></a><span class="do">##  CRESO      4.33 0.186 14     3.93     4.73  A    </span></span>
<span id="cb127-11"><a href="multi-way-anova-models.html#cb127-11" tabindex="-1"></a><span class="do">##  DUILIO     4.24 0.186 14     3.84     4.64  AB   </span></span>
<span id="cb127-12"><a href="multi-way-anova-models.html#cb127-12" tabindex="-1"></a><span class="do">##  SIMETO     3.34 0.186 14     2.94     3.74   B   </span></span>
<span id="cb127-13"><a href="multi-way-anova-models.html#cb127-13" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb127-14"><a href="multi-way-anova-models.html#cb127-14" tabindex="-1"></a><span class="do">## Results are averaged over the levels of: Block </span></span>
<span id="cb127-15"><a href="multi-way-anova-models.html#cb127-15" tabindex="-1"></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb127-16"><a href="multi-way-anova-models.html#cb127-16" tabindex="-1"></a><span class="do">## P value adjustment: tukey method for comparing a family of 8 estimates </span></span>
<span id="cb127-17"><a href="multi-way-anova-models.html#cb127-17" tabindex="-1"></a><span class="do">## significance level used: alpha = 0.05 </span></span>
<span id="cb127-18"><a href="multi-way-anova-models.html#cb127-18" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: If two or more means share the same grouping symbol,</span></span>
<span id="cb127-19"><a href="multi-way-anova-models.html#cb127-19" tabindex="-1"></a><span class="do">##       then we cannot show them to be different.</span></span>
<span id="cb127-20"><a href="multi-way-anova-models.html#cb127-20" tabindex="-1"></a><span class="do">##       But we also did not show them to be the same.</span></span></code></pre></div>
<p>The comment of results is left as an exercise.</p>
</div>
</div>
<div id="another-example-comparing-working-protocols" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> Another example: comparing working protocols<a href="multi-way-anova-models.html#another-example-comparing-working-protocols" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Chapter 2, we introduced an example relating to the evaluation of the time required to accomplish a certain task, by using four different protocols. Four technicians were involved and each one worked with the four methods in different randomised shifts. The protocols were allocated to the different shifts and technicians so that we could have one replicate for each technician and shift. In the end, the dataset consists of one experimental factor (the protocol, with four levels) and two blocking factors (the technician and the shift for each technician). The results are available in the usual online repository.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="multi-way-anova-models.html#cb128-1" tabindex="-1"></a>filePath <span class="ot">&lt;-</span> <span class="st">&quot;https://www.casaonofri.it/_datasets/&quot;</span></span>
<span id="cb128-2"><a href="multi-way-anova-models.html#cb128-2" tabindex="-1"></a>fileName <span class="ot">&lt;-</span> <span class="st">&quot;Technicians.csv&quot;</span></span>
<span id="cb128-3"><a href="multi-way-anova-models.html#cb128-3" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">paste</span>(filePath, fileName, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb128-4"><a href="multi-way-anova-models.html#cb128-4" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(file, <span class="at">header=</span>T)</span>
<span id="cb128-5"><a href="multi-way-anova-models.html#cb128-5" tabindex="-1"></a><span class="fu">head</span>(dataset)</span>
<span id="cb128-6"><a href="multi-way-anova-models.html#cb128-6" tabindex="-1"></a><span class="do">##   Shift Technician Method Time</span></span>
<span id="cb128-7"><a href="multi-way-anova-models.html#cb128-7" tabindex="-1"></a><span class="do">## 1     I     Andrew      C   90</span></span>
<span id="cb128-8"><a href="multi-way-anova-models.html#cb128-8" tabindex="-1"></a><span class="do">## 2    II     Andrew      B   90</span></span>
<span id="cb128-9"><a href="multi-way-anova-models.html#cb128-9" tabindex="-1"></a><span class="do">## 3   III     Andrew      A   89</span></span>
<span id="cb128-10"><a href="multi-way-anova-models.html#cb128-10" tabindex="-1"></a><span class="do">## 4    IV     Andrew      D  104</span></span>
<span id="cb128-11"><a href="multi-way-anova-models.html#cb128-11" tabindex="-1"></a><span class="do">## 5     I       Anna      D   96</span></span>
<span id="cb128-12"><a href="multi-way-anova-models.html#cb128-12" tabindex="-1"></a><span class="do">## 6    II       Anna      C   91</span></span></code></pre></div>
<p>The time required for the task can be described as follows:</p>
<p><span class="math display">\[Y_{ijk} = \mu + \gamma_k + \beta_j + \alpha_i + \varepsilon_{ijk}\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> is the intercept, <span class="math inline">\(\gamma\)</span> is the effect of the <span class="math inline">\(k\)</span><sup>th</sup> shift, <span class="math inline">\(\beta\)</span> is the effect of the <span class="math inline">\(j\)</span><sup>th</sup> technician and <span class="math inline">\(\alpha\)</span> is the effect of the <span class="math inline">\(i\)</span><sup>th</sup> protocol. The elements <span class="math inline">\(\varepsilon_{ijk}\)</span> represent the individual random sources of experimental error; they are assumed as gaussian, with mean equal to 0 and standard deviation equal to <span class="math inline">\(\sigma\)</span>.</p>
<p>For this example, model fitting is performed only with R, by including all blocking effects in the model.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="multi-way-anova-models.html#cb129-1" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Time <span class="sc">~</span> Method <span class="sc">+</span> Technician <span class="sc">+</span> Shift, <span class="at">data =</span> dataset)</span></code></pre></div>
<p>From the model fit object we extract the residuals and check for the basic assumptions for linear models, by using the usual <code>plot()</code> function. The resulting plots are shown in Figure <a href="multi-way-anova-models.html#fig:figName122">10.2</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figName122"></span>
<img src="_main_files/figure-html/figName122-1.png" alt="Graphical analyses of residuals for a latin square experiment" width="90%" />
<p class="caption">
Figure 10.2: Graphical analyses of residuals for a latin square experiment
</p>
</div>
<p>We do not see problems of any kind and, therefore, we proceed to variance partitioning, to test the significance of all experimental factors.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="multi-way-anova-models.html#cb130-1" tabindex="-1"></a><span class="fu">anova</span>(mod)</span>
<span id="cb130-2"><a href="multi-way-anova-models.html#cb130-2" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb130-3"><a href="multi-way-anova-models.html#cb130-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb130-4"><a href="multi-way-anova-models.html#cb130-4" tabindex="-1"></a><span class="do">## Response: Time</span></span>
<span id="cb130-5"><a href="multi-way-anova-models.html#cb130-5" tabindex="-1"></a><span class="do">##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb130-6"><a href="multi-way-anova-models.html#cb130-6" tabindex="-1"></a><span class="do">## Method      3 145.69  48.563 12.7377 0.0051808 ** </span></span>
<span id="cb130-7"><a href="multi-way-anova-models.html#cb130-7" tabindex="-1"></a><span class="do">## Technician  3  17.19   5.729  1.5027 0.3065491    </span></span>
<span id="cb130-8"><a href="multi-way-anova-models.html#cb130-8" tabindex="-1"></a><span class="do">## Shift       3 467.19 155.729 40.8470 0.0002185 ***</span></span>
<span id="cb130-9"><a href="multi-way-anova-models.html#cb130-9" tabindex="-1"></a><span class="do">## Residuals   6  22.87   3.812                      </span></span>
<span id="cb130-10"><a href="multi-way-anova-models.html#cb130-10" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb130-11"><a href="multi-way-anova-models.html#cb130-11" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The difference between protocols is significant, as well as the difference between shifts, while the technicians did not differ significantly. We might be interested in selecting the best working protocols, which can be done by using pairwise comparisons. I will leave this part to you, as an exercise.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="contrasts-and-multiple-comparison-testing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multi-way-anova-models-with-interactions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
