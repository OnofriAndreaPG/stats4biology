<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Simple linear regression | Experimental methods in agriculture</title>
  <meta name="description" content="Chapter 12 Simple linear regression | Experimental methods in agriculture: a tutorial book with R" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Simple linear regression | Experimental methods in agriculture" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="http://www.casaonofri.it/images/coversmall.png" />
  <meta property="og:description" content="Chapter 12 Simple linear regression | Experimental methods in agriculture: a tutorial book with R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Simple linear regression | Experimental methods in agriculture" />
  <meta name="twitter:site" content="@onofriandreapg" />
  <meta name="twitter:description" content="Chapter 12 Simple linear regression | Experimental methods in agriculture: a tutorial book with R" />
  <meta name="twitter:image" content="http://www.casaonofri.it/images/coversmall.png" />

<meta name="author" content="Andrea Onofri and Dario Sacco" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multi-way-anova-models-with-interactions.html"/>
<link rel="next" href="a-brief-intro-to-mixed-models.html"/>
<script src="book_assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="book_assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="book_assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="book_assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131792052-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-131792052-1');
  </script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Experimental Methods</a></strong></li> 

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#aims"><i class="fa fa-check"></i>Aims</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-this-book-is-organised"><i class="fa fa-check"></i>How this book is organised</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#statistical-software"><i class="fa fa-check"></i>Statistical software</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-authors"><i class="fa fa-check"></i>The authors</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html"><i class="fa fa-check"></i><b>1</b> Science and pseudoscience</a>
<ul>
<li class="chapter" data-level="1.1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#science-needs-data"><i class="fa fa-check"></i><b>1.1</b> Science needs data</a></li>
<li class="chapter" data-level="1.2" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#not-all-data-support-science"><i class="fa fa-check"></i><b>1.2</b> Not all data support science</a></li>
<li class="chapter" data-level="1.3" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#good-data-is-based-on-good-methods"><i class="fa fa-check"></i><b>1.3</b> Good data is based on good ‘methods’</a></li>
<li class="chapter" data-level="1.4" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#the-falsification-principle"><i class="fa fa-check"></i><b>1.4</b> The ‘falsification’ principle</a></li>
<li class="chapter" data-level="1.5" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#trying-to-falsify-a-result"><i class="fa fa-check"></i><b>1.5</b> Trying to falsify a result</a></li>
<li class="chapter" data-level="1.6" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#the-basic-principles-of-experimental-design"><i class="fa fa-check"></i><b>1.6</b> The basic principles of experimental design</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#control"><i class="fa fa-check"></i><b>1.6.1</b> Control</a></li>
<li class="chapter" data-level="1.6.2" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#replication"><i class="fa fa-check"></i><b>1.6.2</b> Replication</a></li>
<li class="chapter" data-level="1.6.3" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#randomisation"><i class="fa fa-check"></i><b>1.6.3</b> Randomisation</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#invalid-experiments"><i class="fa fa-check"></i><b>1.7</b> Invalid experiments</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#lack-of-good-control"><i class="fa fa-check"></i><b>1.7.1</b> Lack of good control</a></li>
<li class="chapter" data-level="1.7.2" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#confounding-and-spurious-correlation"><i class="fa fa-check"></i><b>1.7.2</b> ‘Confounding’ and spurious correlation</a></li>
<li class="chapter" data-level="1.7.3" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#lack-of-true-replicates-or-careless-randomisation"><i class="fa fa-check"></i><b>1.7.3</b> Lack of true-replicates or careless randomisation</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#how-can-we-assess-whether-the-data-is-valid"><i class="fa fa-check"></i><b>1.8</b> How can we assess whether the data is valid?</a></li>
<li class="chapter" data-level="1.9" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#conclusions"><i class="fa fa-check"></i><b>1.9</b> Conclusions</a></li>
<li class="chapter" data-level="1.10" data-path="science-and-pseudoscience.html"><a href="science-and-pseudoscience.html#further-readings"><i class="fa fa-check"></i><b>1.10</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="designing-experiments.html"><a href="designing-experiments.html"><i class="fa fa-check"></i><b>2</b> Designing experiments</a>
<ul>
<li class="chapter" data-level="2.1" data-path="designing-experiments.html"><a href="designing-experiments.html#the-elements-of-research"><i class="fa fa-check"></i><b>2.1</b> The elements of research</a></li>
<li class="chapter" data-level="2.2" data-path="designing-experiments.html"><a href="designing-experiments.html#hypothesis-and-objectives"><i class="fa fa-check"></i><b>2.2</b> Hypothesis and objectives</a></li>
<li class="chapter" data-level="2.3" data-path="designing-experiments.html"><a href="designing-experiments.html#the-experimental-treatments"><i class="fa fa-check"></i><b>2.3</b> The experimental treatments</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="designing-experiments.html"><a href="designing-experiments.html#factorial-experiments"><i class="fa fa-check"></i><b>2.3.1</b> Factorial experiments</a></li>
<li class="chapter" data-level="2.3.2" data-path="designing-experiments.html"><a href="designing-experiments.html#the-control"><i class="fa fa-check"></i><b>2.3.2</b> The control</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="designing-experiments.html"><a href="designing-experiments.html#the-experimental-units"><i class="fa fa-check"></i><b>2.4</b> The experimental units</a></li>
<li class="chapter" data-level="2.5" data-path="designing-experiments.html"><a href="designing-experiments.html#the-allocation-of-treatments"><i class="fa fa-check"></i><b>2.5</b> The allocation of treatments</a></li>
<li class="chapter" data-level="2.6" data-path="designing-experiments.html"><a href="designing-experiments.html#the-variables"><i class="fa fa-check"></i><b>2.6</b> The variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="designing-experiments.html"><a href="designing-experiments.html#nominal-variables"><i class="fa fa-check"></i><b>2.6.1</b> Nominal variables</a></li>
<li class="chapter" data-level="2.6.2" data-path="designing-experiments.html"><a href="designing-experiments.html#ordinal-variables"><i class="fa fa-check"></i><b>2.6.2</b> Ordinal variables</a></li>
<li class="chapter" data-level="2.6.3" data-path="designing-experiments.html"><a href="designing-experiments.html#count-and-ratio-variables"><i class="fa fa-check"></i><b>2.6.3</b> Count and ratio variables</a></li>
<li class="chapter" data-level="2.6.4" data-path="designing-experiments.html"><a href="designing-experiments.html#continuous-variables"><i class="fa fa-check"></i><b>2.6.4</b> Continuous variables</a></li>
<li class="chapter" data-level="2.6.5" data-path="designing-experiments.html"><a href="designing-experiments.html#sensory-and-visual-assessments"><i class="fa fa-check"></i><b>2.6.5</b> Sensory and visual assessments</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="designing-experiments.html"><a href="designing-experiments.html#setting-up-a-field-experiment"><i class="fa fa-check"></i><b>2.7</b> Setting up a field experiment</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="designing-experiments.html"><a href="designing-experiments.html#selecting-the-field"><i class="fa fa-check"></i><b>2.7.1</b> Selecting the field</a></li>
<li class="chapter" data-level="2.7.2" data-path="designing-experiments.html"><a href="designing-experiments.html#selecting-the-units-within-the-field"><i class="fa fa-check"></i><b>2.7.2</b> Selecting the units within the field</a></li>
<li class="chapter" data-level="2.7.3" data-path="designing-experiments.html"><a href="designing-experiments.html#number-of-replicates"><i class="fa fa-check"></i><b>2.7.3</b> Number of replicates</a></li>
<li class="chapter" data-level="2.7.4" data-path="designing-experiments.html"><a href="designing-experiments.html#the-field-map"><i class="fa fa-check"></i><b>2.7.4</b> The field map</a></li>
<li class="chapter" data-level="2.7.5" data-path="designing-experiments.html"><a href="designing-experiments.html#the-experimental-lay-out"><i class="fa fa-check"></i><b>2.7.5</b> The experimental lay-out</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="designing-experiments.html"><a href="designing-experiments.html#conclusions-1"><i class="fa fa-check"></i><b>2.8</b> Conclusions</a></li>
<li class="chapter" data-level="2.9" data-path="designing-experiments.html"><a href="designing-experiments.html#further-readings-1"><i class="fa fa-check"></i><b>2.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="describing-the-observations.html"><a href="describing-the-observations.html"><i class="fa fa-check"></i><b>3</b> Describing the observations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="describing-the-observations.html"><a href="describing-the-observations.html#quantitative-data"><i class="fa fa-check"></i><b>3.1</b> Quantitative data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="describing-the-observations.html"><a href="describing-the-observations.html#statistics-of-location"><i class="fa fa-check"></i><b>3.1.1</b> Statistics of location</a></li>
<li class="chapter" data-level="3.1.2" data-path="describing-the-observations.html"><a href="describing-the-observations.html#statistics-of-spread"><i class="fa fa-check"></i><b>3.1.2</b> Statistics of spread</a></li>
<li class="chapter" data-level="3.1.3" data-path="describing-the-observations.html"><a href="describing-the-observations.html#summing-the-uncertainty"><i class="fa fa-check"></i><b>3.1.3</b> Summing the uncertainty</a></li>
<li class="chapter" data-level="3.1.4" data-path="describing-the-observations.html"><a href="describing-the-observations.html#relationship-between-quantitative-variables"><i class="fa fa-check"></i><b>3.1.4</b> Relationship between quantitative variables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="describing-the-observations.html"><a href="describing-the-observations.html#nominal-data"><i class="fa fa-check"></i><b>3.2</b> Nominal data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="describing-the-observations.html"><a href="describing-the-observations.html#distributions-of-frequencies"><i class="fa fa-check"></i><b>3.2.1</b> Distributions of frequencies</a></li>
<li class="chapter" data-level="3.2.2" data-path="describing-the-observations.html"><a href="describing-the-observations.html#descriptive-stats-for-distributions-of-frequencies"><i class="fa fa-check"></i><b>3.2.2</b> Descriptive stats for distributions of frequencies</a></li>
<li class="chapter" data-level="3.2.3" data-path="describing-the-observations.html"><a href="describing-the-observations.html#contingency-tables"><i class="fa fa-check"></i><b>3.2.3</b> Contingency tables</a></li>
<li class="chapter" data-level="3.2.4" data-path="describing-the-observations.html"><a href="describing-the-observations.html#independence"><i class="fa fa-check"></i><b>3.2.4</b> Independence</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="describing-the-observations.html"><a href="describing-the-observations.html#descriptive-stats-with-r"><i class="fa fa-check"></i><b>3.3</b> Descriptive stats with R</a></li>
<li class="chapter" data-level="3.4" data-path="describing-the-observations.html"><a href="describing-the-observations.html#graphical-representations"><i class="fa fa-check"></i><b>3.4</b> Graphical representations</a></li>
<li class="chapter" data-level="3.5" data-path="describing-the-observations.html"><a href="describing-the-observations.html#further-reading"><i class="fa fa-check"></i><b>3.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html"><i class="fa fa-check"></i><b>4</b> Modeling the experimental data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#deterministic-models"><i class="fa fa-check"></i><b>4.1</b> Deterministic models</a></li>
<li class="chapter" data-level="4.2" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#stochastic-models"><i class="fa fa-check"></i><b>4.2</b> Stochastic models</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#probability-functions"><i class="fa fa-check"></i><b>4.2.1</b> Probability functions</a></li>
<li class="chapter" data-level="4.2.2" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#density-functions"><i class="fa fa-check"></i><b>4.2.2</b> Density functions</a></li>
<li class="chapter" data-level="4.2.3" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#the-gaussian-pdf-and-cdf"><i class="fa fa-check"></i><b>4.2.3</b> The Gaussian PDF and CDF</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#a-model-with-two-components"><i class="fa fa-check"></i><b>4.3</b> A model with two components</a></li>
<li class="chapter" data-level="4.4" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#and-so-what"><i class="fa fa-check"></i><b>4.4</b> And so what?</a></li>
<li class="chapter" data-level="4.5" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#monte-carlo-methods-to-simulate-an-experiment"><i class="fa fa-check"></i><b>4.5</b> Monte Carlo methods to simulate an experiment</a></li>
<li class="chapter" data-level="4.6" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#data-analysis-and-model-fitting"><i class="fa fa-check"></i><b>4.6</b> Data analysis and model fitting</a></li>
<li class="chapter" data-level="4.7" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#some-words-of-warning"><i class="fa fa-check"></i><b>4.7</b> Some words of warning</a></li>
<li class="chapter" data-level="4.8" data-path="modeling-the-experimental-data.html"><a href="modeling-the-experimental-data.html#further-readings-2"><i class="fa fa-check"></i><b>4.8</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html"><i class="fa fa-check"></i><b>5</b> Estimation of model parameters</a>
<ul>
<li class="chapter" data-level="5.1" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#example-1-a-concentration-value"><i class="fa fa-check"></i><b>5.1</b> Example 1: a concentration value</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#the-empirical-sampling-distribution"><i class="fa fa-check"></i><b>5.1.1</b> The empirical sampling distribution</a></li>
<li class="chapter" data-level="5.1.2" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#a-theoretical-sampling-distribution"><i class="fa fa-check"></i><b>5.1.2</b> A theoretical sampling distribution</a></li>
<li class="chapter" data-level="5.1.3" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#the-frequentist-confidence-interval"><i class="fa fa-check"></i><b>5.1.3</b> The frequentist confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#example-2-a-proportion"><i class="fa fa-check"></i><b>5.2</b> Example 2: a proportion</a></li>
<li class="chapter" data-level="5.3" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#conclusions-2"><i class="fa fa-check"></i><b>5.3</b> Conclusions</a></li>
<li class="chapter" data-level="5.4" data-path="estimation-of-model-parameters.html"><a href="estimation-of-model-parameters.html#further-readings-3"><i class="fa fa-check"></i><b>5.4</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html"><i class="fa fa-check"></i><b>6</b> Making Decisions under uncertainty</a>
<ul>
<li class="chapter" data-level="6.1" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#comparing-sample-means-the-students-t-test"><i class="fa fa-check"></i><b>6.1</b> Comparing sample means: the Student’s t-test</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#the-dataset"><i class="fa fa-check"></i><b>6.1.1</b> The dataset</a></li>
<li class="chapter" data-level="6.1.2" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#monte-carlo-simulation"><i class="fa fa-check"></i><b>6.1.2</b> Monte Carlo simulation</a></li>
<li class="chapter" data-level="6.1.3" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#a-formal-solution"><i class="fa fa-check"></i><b>6.1.3</b> A formal solution</a></li>
<li class="chapter" data-level="6.1.4" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#the-t-test-with-r"><i class="fa fa-check"></i><b>6.1.4</b> The t test with R</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#comparing-proportions-the-chi2-test"><i class="fa fa-check"></i><b>6.2</b> Comparing proportions: the <span class="math inline">\(\chi^2\)</span> test</a></li>
<li class="chapter" data-level="6.3" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#correct-interpretation-of-the-p-value"><i class="fa fa-check"></i><b>6.3</b> Correct interpretation of the P-value</a></li>
<li class="chapter" data-level="6.4" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#conclusions-3"><i class="fa fa-check"></i><b>6.4</b> Conclusions</a></li>
<li class="chapter" data-level="6.5" data-path="making-decisions-under-uncertainty.html"><a href="making-decisions-under-uncertainty.html#further-readings-4"><i class="fa fa-check"></i><b>6.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html"><i class="fa fa-check"></i><b>7</b> One-way ANOVA models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#comparing-herbicides-in-a-pot-experiment"><i class="fa fa-check"></i><b>7.1</b> Comparing herbicides in a pot-experiment</a></li>
<li class="chapter" data-level="7.2" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#data-description"><i class="fa fa-check"></i><b>7.2</b> Data description</a></li>
<li class="chapter" data-level="7.3" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#model-definition"><i class="fa fa-check"></i><b>7.3</b> Model definition</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#parameterisation"><i class="fa fa-check"></i><b>7.3.1</b> Parameterisation</a></li>
<li class="chapter" data-level="7.3.2" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#treatment-constraint"><i class="fa fa-check"></i><b>7.3.2</b> Treatment constraint</a></li>
<li class="chapter" data-level="7.3.3" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#sum-to-zero-constraint"><i class="fa fa-check"></i><b>7.3.3</b> Sum-to-zero constraint</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#basic-assumptions"><i class="fa fa-check"></i><b>7.4</b> Basic assumptions</a></li>
<li class="chapter" data-level="7.5" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#fitting-anova-models-by-hand"><i class="fa fa-check"></i><b>7.5</b> Fitting ANOVA models by hand</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#parameter-estimation"><i class="fa fa-check"></i><b>7.5.1</b> Parameter estimation</a></li>
<li class="chapter" data-level="7.5.2" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#residuals"><i class="fa fa-check"></i><b>7.5.2</b> Residuals</a></li>
<li class="chapter" data-level="7.5.3" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#standard-deviation-sigma"><i class="fa fa-check"></i><b>7.5.3</b> Standard deviation <span class="math inline">\(\sigma\)</span></a></li>
<li class="chapter" data-level="7.5.4" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#sem-and-sed"><i class="fa fa-check"></i><b>7.5.4</b> SEM and SED</a></li>
<li class="chapter" data-level="7.5.5" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#variance-partitioning"><i class="fa fa-check"></i><b>7.5.5</b> Variance partitioning</a></li>
<li class="chapter" data-level="7.5.6" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#hypothesis-testing"><i class="fa fa-check"></i><b>7.5.6</b> Hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#fitting-anova-models-with-r"><i class="fa fa-check"></i><b>7.6</b> Fitting ANOVA models with R</a></li>
<li class="chapter" data-level="7.7" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#expected-marginal-means"><i class="fa fa-check"></i><b>7.7</b> Expected marginal means</a></li>
<li class="chapter" data-level="7.8" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#conclusions-4"><i class="fa fa-check"></i><b>7.8</b> Conclusions</a></li>
<li class="chapter" data-level="7.9" data-path="one-way-anova-models.html"><a href="one-way-anova-models.html#further-readings-5"><i class="fa fa-check"></i><b>7.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html"><i class="fa fa-check"></i><b>8</b> Checking for the basic assumptions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#outlying-observations"><i class="fa fa-check"></i><b>8.1</b> Outlying observations</a></li>
<li class="chapter" data-level="8.2" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#the-inspection-of-residuals"><i class="fa fa-check"></i><b>8.2</b> The inspection of residuals</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#plot-of-residuals-against-expected-values"><i class="fa fa-check"></i><b>8.2.1</b> Plot of residuals against expected values</a></li>
<li class="chapter" data-level="8.2.2" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#qq-plot"><i class="fa fa-check"></i><b>8.2.2</b> QQ-plot</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#formal-hypotesis-testing"><i class="fa fa-check"></i><b>8.3</b> Formal hypotesis testing</a></li>
<li class="chapter" data-level="8.4" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#what-do-we-do-in-practice"><i class="fa fa-check"></i><b>8.4</b> What do we do, in practice?</a></li>
<li class="chapter" data-level="8.5" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#correcting-measures"><i class="fa fa-check"></i><b>8.5</b> Correcting measures</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#removing-outliers"><i class="fa fa-check"></i><b>8.5.1</b> Removing outliers</a></li>
<li class="chapter" data-level="8.5.2" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#stabilising-transformations"><i class="fa fa-check"></i><b>8.5.2</b> Stabilising transformations</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#examples-with-r"><i class="fa fa-check"></i><b>8.6</b> Examples with R</a></li>
<li class="chapter" data-level="8.7" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#example-1"><i class="fa fa-check"></i><b>8.7</b> Example 1</a></li>
<li class="chapter" data-level="8.8" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#example-2"><i class="fa fa-check"></i><b>8.8</b> Example 2</a></li>
<li class="chapter" data-level="8.9" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#other-possible-approaches"><i class="fa fa-check"></i><b>8.9</b> Other possible approaches</a></li>
<li class="chapter" data-level="8.10" data-path="checking-for-the-basic-assumptions.html"><a href="checking-for-the-basic-assumptions.html#further-readings-6"><i class="fa fa-check"></i><b>8.10</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html"><i class="fa fa-check"></i><b>9</b> Contrasts and multiple comparison testing</a>
<ul>
<li class="chapter" data-level="9.1" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#back-to-the-mixture-example"><i class="fa fa-check"></i><b>9.1</b> Back to the ‘mixture’ example</a></li>
<li class="chapter" data-level="9.2" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#linear-contrasts"><i class="fa fa-check"></i><b>9.2</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#the-variance-of-contrasts"><i class="fa fa-check"></i><b>9.2.1</b> The variance of contrasts</a></li>
<li class="chapter" data-level="9.2.2" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#testing-linear-contrasts-with-r"><i class="fa fa-check"></i><b>9.2.2</b> Testing linear contrasts with R</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#pairwise-comparisons"><i class="fa fa-check"></i><b>9.3</b> Pairwise comparisons</a></li>
<li class="chapter" data-level="9.4" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#letter-display"><i class="fa fa-check"></i><b>9.4</b> Letter display</a></li>
<li class="chapter" data-level="9.5" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#multiplicity-correction"><i class="fa fa-check"></i><b>9.5</b> Multiplicity correction</a></li>
<li class="chapter" data-level="9.6" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#multiple-comparisons-with-transformed-data"><i class="fa fa-check"></i><b>9.6</b> Multiple comparisons with transformed data</a></li>
<li class="chapter" data-level="9.7" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#what-about-the-traditional-mcps"><i class="fa fa-check"></i><b>9.7</b> What about the traditional MCPs?</a></li>
<li class="chapter" data-level="9.8" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#some-practical-suggestions"><i class="fa fa-check"></i><b>9.8</b> Some practical suggestions</a></li>
<li class="chapter" data-level="9.9" data-path="contrasts-and-multiple-comparison-testing.html"><a href="contrasts-and-multiple-comparison-testing.html#further-readings-7"><i class="fa fa-check"></i><b>9.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html"><i class="fa fa-check"></i><b>10</b> Multi-way ANOVA models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#motivating-example-a-genotype-experiment-in-blocks"><i class="fa fa-check"></i><b>10.1</b> Motivating example: a genotype experiment in blocks</a></li>
<li class="chapter" data-level="10.2" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-definition-1"><i class="fa fa-check"></i><b>10.2</b> Model definition</a></li>
<li class="chapter" data-level="10.3" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-fitting-by-hand"><i class="fa fa-check"></i><b>10.3</b> Model fitting by hand</a></li>
<li class="chapter" data-level="10.4" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-fitting-with-r"><i class="fa fa-check"></i><b>10.4</b> Model fitting with R</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#model-checking"><i class="fa fa-check"></i><b>10.4.1</b> Model checking</a></li>
<li class="chapter" data-level="10.4.2" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#variance-partitioning-1"><i class="fa fa-check"></i><b>10.4.2</b> Variance partitioning</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="multi-way-anova-models.html"><a href="multi-way-anova-models.html#another-example-comparing-working-protocols"><i class="fa fa-check"></i><b>10.5</b> Another example: comparing working protocols</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html"><i class="fa fa-check"></i><b>11</b> Multi-way ANOVA models with interactions</a>
<ul>
<li class="chapter" data-level="11.1" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#the-interaction-concept"><i class="fa fa-check"></i><b>11.1</b> The ‘interaction’ concept</a></li>
<li class="chapter" data-level="11.2" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#genotype-by-n-interactions"><i class="fa fa-check"></i><b>11.2</b> Genotype by N interactions</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-definition-2"><i class="fa fa-check"></i><b>11.2.1</b> Model definition</a></li>
<li class="chapter" data-level="11.2.2" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-fitting-by-hand-1"><i class="fa fa-check"></i><b>11.2.2</b> Model fitting by hand</a></li>
<li class="chapter" data-level="11.2.3" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-fitting-with-r-1"><i class="fa fa-check"></i><b>11.2.3</b> Model fitting with R</a></li>
<li class="chapter" data-level="11.2.4" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#inferences-and-standard-errors"><i class="fa fa-check"></i><b>11.2.4</b> Inferences and standard errors</a></li>
<li class="chapter" data-level="11.2.5" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#expected-marginal-means-1"><i class="fa fa-check"></i><b>11.2.5</b> Expected marginal means</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#nested-effects-maize-crosses"><i class="fa fa-check"></i><b>11.3</b> Nested effects: maize crosses</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#model-definition-3"><i class="fa fa-check"></i><b>11.3.1</b> Model definition</a></li>
<li class="chapter" data-level="11.3.2" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#parameter-estimation-1"><i class="fa fa-check"></i><b>11.3.2</b> Parameter estimation</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="multi-way-anova-models-with-interactions.html"><a href="multi-way-anova-models-with-interactions.html#further-readings-8"><i class="fa fa-check"></i><b>11.4</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>12</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#case-study-n-fertilisation-in-wheat"><i class="fa fa-check"></i><b>12.1</b> Case-study: N fertilisation in wheat</a></li>
<li class="chapter" data-level="12.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#preliminary-analysis"><i class="fa fa-check"></i><b>12.2</b> Preliminary analysis</a></li>
<li class="chapter" data-level="12.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#definition-of-a-linear-model"><i class="fa fa-check"></i><b>12.3</b> Definition of a linear model</a></li>
<li class="chapter" data-level="12.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#parameter-estimation-2"><i class="fa fa-check"></i><b>12.4</b> Parameter estimation</a></li>
<li class="chapter" data-level="12.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#goodness-of-fit"><i class="fa fa-check"></i><b>12.5</b> Goodness of fit</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#graphical-evaluation"><i class="fa fa-check"></i><b>12.5.1</b> Graphical evaluation</a></li>
<li class="chapter" data-level="12.5.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#standard-errors-for-parameter-estimates"><i class="fa fa-check"></i><b>12.5.2</b> Standard errors for parameter estimates</a></li>
<li class="chapter" data-level="12.5.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#f-test-for-lack-of-fit"><i class="fa fa-check"></i><b>12.5.3</b> F test for lack of fit</a></li>
<li class="chapter" data-level="12.5.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#f-test-for-goodness-of-fit-and-coefficient-of-determination"><i class="fa fa-check"></i><b>12.5.4</b> F test for goodness of fit and coefficient of determination</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#making-predictions"><i class="fa fa-check"></i><b>12.6</b> Making predictions</a></li>
<li class="chapter" data-level="12.7" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#further-readings-9"><i class="fa fa-check"></i><b>12.7</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html"><i class="fa fa-check"></i><b>13</b> A brief intro to mixed models</a>
<ul>
<li class="chapter" data-level="13.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#plots-of-different-sizes"><i class="fa fa-check"></i><b>13.1</b> Plots of different sizes</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-1-a-split-plot-experiment"><i class="fa fa-check"></i><b>13.1.1</b> Example 1: a split-plot experiment</a></li>
<li class="chapter" data-level="13.1.2" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#example-2-a-strip-plot-design"><i class="fa fa-check"></i><b>13.1.2</b> Example 2: a strip-plot design</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#subsampling-designs"><i class="fa fa-check"></i><b>13.2</b> Subsampling designs</a></li>
<li class="chapter" data-level="13.3" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#repeated-measures-in-perennial-crops"><i class="fa fa-check"></i><b>13.3</b> Repeated measures in perennial crops</a></li>
<li class="chapter" data-level="13.4" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#repeated-experiments"><i class="fa fa-check"></i><b>13.4</b> Repeated experiments</a></li>
<li class="chapter" data-level="13.5" data-path="a-brief-intro-to-mixed-models.html"><a href="a-brief-intro-to-mixed-models.html#further-readings-10"><i class="fa fa-check"></i><b>13.5</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>14</b> Nonlinear regression</a>
<ul>
<li class="chapter" data-level="14.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#case-study-a-degradation-curve"><i class="fa fa-check"></i><b>14.1</b> Case-study: a degradation curve</a></li>
<li class="chapter" data-level="14.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#model-selection"><i class="fa fa-check"></i><b>14.2</b> Model selection</a></li>
<li class="chapter" data-level="14.3" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#parameter-estimation-3"><i class="fa fa-check"></i><b>14.3</b> Parameter estimation</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#linearisation"><i class="fa fa-check"></i><b>14.3.1</b> Linearisation</a></li>
<li class="chapter" data-level="14.3.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#approximation-with-a-polynomial-function"><i class="fa fa-check"></i><b>14.3.2</b> Approximation with a polynomial function</a></li>
<li class="chapter" data-level="14.3.3" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#nonlinear-least-squares"><i class="fa fa-check"></i><b>14.3.3</b> Nonlinear least squares</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#nonlinear-regression-with-r"><i class="fa fa-check"></i><b>14.4</b> Nonlinear regression with R</a></li>
<li class="chapter" data-level="14.5" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#checking-the-model"><i class="fa fa-check"></i><b>14.5</b> Checking the model</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#graphical-analyses-of-residuals"><i class="fa fa-check"></i><b>14.5.1</b> Graphical analyses of residuals</a></li>
<li class="chapter" data-level="14.5.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#approximate-f-test-for-lack-of-fit"><i class="fa fa-check"></i><b>14.5.2</b> Approximate F test for lack of fit</a></li>
<li class="chapter" data-level="14.5.3" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#the-coefficient-of-determination-r2"><i class="fa fa-check"></i><b>14.5.3</b> The coefficient of determination (R<sup>2</sup>)</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#stabilising-transformations-1"><i class="fa fa-check"></i><b>14.6</b> Stabilising transformations</a></li>
<li class="chapter" data-level="14.7" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#making-predictions-1"><i class="fa fa-check"></i><b>14.7</b> Making predictions</a></li>
<li class="chapter" data-level="14.8" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#further-readings-11"><i class="fa fa-check"></i><b>14.8</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>15</b> Exercises</a>
<ul>
<li class="chapter" data-level="15.1" data-path="exercises.html"><a href="exercises.html#introduction-to-biometry-ch.-1"><i class="fa fa-check"></i><b>15.1</b> Introduction to biometry (ch. 1)</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="exercises.html"><a href="exercises.html#question-1"><i class="fa fa-check"></i><b>15.1.1</b> Question 1</a></li>
<li class="chapter" data-level="15.1.2" data-path="exercises.html"><a href="exercises.html#question-2"><i class="fa fa-check"></i><b>15.1.2</b> Question 2</a></li>
<li class="chapter" data-level="15.1.3" data-path="exercises.html"><a href="exercises.html#question-3"><i class="fa fa-check"></i><b>15.1.3</b> Question 3</a></li>
<li class="chapter" data-level="15.1.4" data-path="exercises.html"><a href="exercises.html#question-4"><i class="fa fa-check"></i><b>15.1.4</b> Question 4</a></li>
<li class="chapter" data-level="15.1.5" data-path="exercises.html"><a href="exercises.html#question-5"><i class="fa fa-check"></i><b>15.1.5</b> Question 5</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="exercises.html"><a href="exercises.html#designing-experiments-ch.-2"><i class="fa fa-check"></i><b>15.2</b> Designing experiments (ch. 2)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="exercises.html"><a href="exercises.html#excercise-1"><i class="fa fa-check"></i><b>15.2.1</b> Excercise 1</a></li>
<li class="chapter" data-level="15.2.2" data-path="exercises.html"><a href="exercises.html#exercise-2"><i class="fa fa-check"></i><b>15.2.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.2.3" data-path="exercises.html"><a href="exercises.html#exercise-3"><i class="fa fa-check"></i><b>15.2.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="exercises.html"><a href="exercises.html#describing-the-observations-ch.-3"><i class="fa fa-check"></i><b>15.3</b> Describing the observations (ch. 3)</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="exercises.html"><a href="exercises.html#exercise-1"><i class="fa fa-check"></i><b>15.3.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.3.2" data-path="exercises.html"><a href="exercises.html#exercise-2-1"><i class="fa fa-check"></i><b>15.3.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.3.3" data-path="exercises.html"><a href="exercises.html#exercise-3-1"><i class="fa fa-check"></i><b>15.3.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="exercises.html"><a href="exercises.html#modeling-the-experimental-data-ch.-4"><i class="fa fa-check"></i><b>15.4</b> Modeling the experimental data (ch. 4)</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="exercises.html"><a href="exercises.html#exercise-1-1"><i class="fa fa-check"></i><b>15.4.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.4.2" data-path="exercises.html"><a href="exercises.html#exercise-2-2"><i class="fa fa-check"></i><b>15.4.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.4.3" data-path="exercises.html"><a href="exercises.html#exercise-3-2"><i class="fa fa-check"></i><b>15.4.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.4.4" data-path="exercises.html"><a href="exercises.html#exercise-4"><i class="fa fa-check"></i><b>15.4.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.4.5" data-path="exercises.html"><a href="exercises.html#exercise-5"><i class="fa fa-check"></i><b>15.4.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.4.6" data-path="exercises.html"><a href="exercises.html#exercise-6"><i class="fa fa-check"></i><b>15.4.6</b> Exercise 6</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="exercises.html"><a href="exercises.html#estimation-of-model-parameters-ch.-5"><i class="fa fa-check"></i><b>15.5</b> Estimation of model parameters (ch. 5)</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="exercises.html"><a href="exercises.html#exercise-1-2"><i class="fa fa-check"></i><b>15.5.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.5.2" data-path="exercises.html"><a href="exercises.html#exercise-2-3"><i class="fa fa-check"></i><b>15.5.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.5.3" data-path="exercises.html"><a href="exercises.html#exercise-3-3"><i class="fa fa-check"></i><b>15.5.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.5.4" data-path="exercises.html"><a href="exercises.html#exercise-4-1"><i class="fa fa-check"></i><b>15.5.4</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="exercises.html"><a href="exercises.html#making-decisions-under-uncertainty-ch.-6"><i class="fa fa-check"></i><b>15.6</b> Making decisions under uncertainty (ch. 6)</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="exercises.html"><a href="exercises.html#exercise-1-3"><i class="fa fa-check"></i><b>15.6.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.6.2" data-path="exercises.html"><a href="exercises.html#exercise-2-4"><i class="fa fa-check"></i><b>15.6.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.6.3" data-path="exercises.html"><a href="exercises.html#exercise-3-4"><i class="fa fa-check"></i><b>15.6.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.6.4" data-path="exercises.html"><a href="exercises.html#exercise-4-2"><i class="fa fa-check"></i><b>15.6.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.6.5" data-path="exercises.html"><a href="exercises.html#exercise-5-1"><i class="fa fa-check"></i><b>15.6.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.6.6" data-path="exercises.html"><a href="exercises.html#exercise-6-1"><i class="fa fa-check"></i><b>15.6.6</b> Exercise 6</a></li>
<li class="chapter" data-level="15.6.7" data-path="exercises.html"><a href="exercises.html#exercise-7"><i class="fa fa-check"></i><b>15.6.7</b> Exercise 7</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="exercises.html"><a href="exercises.html#one-way-anova-models-ch.-7-to-9"><i class="fa fa-check"></i><b>15.7</b> One-way ANOVA models (ch. 7 to 9)</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="exercises.html"><a href="exercises.html#exercise-1-4"><i class="fa fa-check"></i><b>15.7.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.7.2" data-path="exercises.html"><a href="exercises.html#exercise-2-5"><i class="fa fa-check"></i><b>15.7.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.7.3" data-path="exercises.html"><a href="exercises.html#exercise-3-5"><i class="fa fa-check"></i><b>15.7.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.7.4" data-path="exercises.html"><a href="exercises.html#exercise-4-3"><i class="fa fa-check"></i><b>15.7.4</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="exercises.html"><a href="exercises.html#multy-way-anova-models-ch.-10"><i class="fa fa-check"></i><b>15.8</b> Multy-way ANOVA models (ch. 10)</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="exercises.html"><a href="exercises.html#exercise-1-5"><i class="fa fa-check"></i><b>15.8.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.8.2" data-path="exercises.html"><a href="exercises.html#exercise-2-6"><i class="fa fa-check"></i><b>15.8.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.8.3" data-path="exercises.html"><a href="exercises.html#exercise-3-6"><i class="fa fa-check"></i><b>15.8.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="15.9" data-path="exercises.html"><a href="exercises.html#multi-way-anova-models-with-interactions-ch.-11-and-13"><i class="fa fa-check"></i><b>15.9</b> Multi-way ANOVA models with interactions (ch. 11 and 13)</a>
<ul>
<li class="chapter" data-level="15.9.1" data-path="exercises.html"><a href="exercises.html#exercise-1-6"><i class="fa fa-check"></i><b>15.9.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.9.2" data-path="exercises.html"><a href="exercises.html#exercise-2-7"><i class="fa fa-check"></i><b>15.9.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.9.3" data-path="exercises.html"><a href="exercises.html#exercise-3-7"><i class="fa fa-check"></i><b>15.9.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.9.4" data-path="exercises.html"><a href="exercises.html#exercise-4-4"><i class="fa fa-check"></i><b>15.9.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.9.5" data-path="exercises.html"><a href="exercises.html#exercise-5-2"><i class="fa fa-check"></i><b>15.9.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.9.6" data-path="exercises.html"><a href="exercises.html#exercise-6-2"><i class="fa fa-check"></i><b>15.9.6</b> Exercise 6</a></li>
</ul></li>
<li class="chapter" data-level="15.10" data-path="exercises.html"><a href="exercises.html#simple-linear-regression-ch.-12"><i class="fa fa-check"></i><b>15.10</b> Simple linear regression (ch. 12)</a>
<ul>
<li class="chapter" data-level="15.10.1" data-path="exercises.html"><a href="exercises.html#exercise-1-7"><i class="fa fa-check"></i><b>15.10.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.10.2" data-path="exercises.html"><a href="exercises.html#exercise-2-8"><i class="fa fa-check"></i><b>15.10.2</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="15.11" data-path="exercises.html"><a href="exercises.html#nonlinear-regression-ch.-14"><i class="fa fa-check"></i><b>15.11</b> Nonlinear regression (ch. 14)</a>
<ul>
<li class="chapter" data-level="15.11.1" data-path="exercises.html"><a href="exercises.html#exercise-1-8"><i class="fa fa-check"></i><b>15.11.1</b> Exercise 1</a></li>
<li class="chapter" data-level="15.11.2" data-path="exercises.html"><a href="exercises.html#exercise-2-9"><i class="fa fa-check"></i><b>15.11.2</b> Exercise 2</a></li>
<li class="chapter" data-level="15.11.3" data-path="exercises.html"><a href="exercises.html#exercise-3-8"><i class="fa fa-check"></i><b>15.11.3</b> Exercise 3</a></li>
<li class="chapter" data-level="15.11.4" data-path="exercises.html"><a href="exercises.html#exercise-4-5"><i class="fa fa-check"></i><b>15.11.4</b> Exercise 4</a></li>
<li class="chapter" data-level="15.11.5" data-path="exercises.html"><a href="exercises.html#exercise-5-3"><i class="fa fa-check"></i><b>15.11.5</b> Exercise 5</a></li>
<li class="chapter" data-level="15.11.6" data-path="exercises.html"><a href="exercises.html#exercise-6-3"><i class="fa fa-check"></i><b>15.11.6</b> Exercise 6</a></li>
<li class="chapter" data-level="15.11.7" data-path="exercises.html"><a href="exercises.html#exercise-7-1"><i class="fa fa-check"></i><b>15.11.7</b> Exercise 7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html"><i class="fa fa-check"></i><b>16</b> APPENDIX: A very gentle introduction to R</a>
<ul>
<li class="chapter" data-level="16.1" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#what-is-r"><i class="fa fa-check"></i><b>16.1</b> What is R?</a></li>
<li class="chapter" data-level="16.2" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#installing-r-and-moving-the-first-steps"><i class="fa fa-check"></i><b>16.2</b> Installing R and moving the first steps</a></li>
<li class="chapter" data-level="16.3" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#assignments"><i class="fa fa-check"></i><b>16.3</b> Assignments</a></li>
<li class="chapter" data-level="16.4" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#data-types-and-data-objects"><i class="fa fa-check"></i><b>16.4</b> Data types and data objects</a></li>
<li class="chapter" data-level="16.5" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#matrices"><i class="fa fa-check"></i><b>16.5</b> Matrices</a></li>
<li class="chapter" data-level="16.6" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#dataframes"><i class="fa fa-check"></i><b>16.6</b> Dataframes</a></li>
<li class="chapter" data-level="16.7" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#working-with-objects"><i class="fa fa-check"></i><b>16.7</b> Working with objects</a></li>
<li class="chapter" data-level="16.8" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#expressions-functions-and-arguments"><i class="fa fa-check"></i><b>16.8</b> Expressions, functions and arguments</a></li>
<li class="chapter" data-level="16.9" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#a-few-useful-functions"><i class="fa fa-check"></i><b>16.9</b> A few useful functions</a></li>
<li class="chapter" data-level="16.10" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#extractors"><i class="fa fa-check"></i><b>16.10</b> Extractors</a></li>
<li class="chapter" data-level="16.11" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#reading-external-data"><i class="fa fa-check"></i><b>16.11</b> Reading external data</a></li>
<li class="chapter" data-level="16.12" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#simple-r-graphics"><i class="fa fa-check"></i><b>16.12</b> Simple R graphics</a></li>
<li class="chapter" data-level="16.13" data-path="appendix-a-very-gentle-introduction-to-r.html"><a href="appendix-a-very-gentle-introduction-to-r.html#further-readings-12"><i class="fa fa-check"></i><b>16.13</b> Further readings</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Experimental methods in agriculture</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-linear-regression" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> Simple linear regression<a href="simple-linear-regression.html#simple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the previous chapters we have presented several ANOVA models to describe the results of experiments characterised by one or more explanatory factors, in the form of nominal variables. We gave ample space to these models because they are widely used in agriculture research and plant breeding, where the aim is, most often, to compare genotypes. However, experiments are often planned to study the effect of quantitative variables, such as a sequence of doses, time elapsed from an event, the density of seeds and so on. In these cases, factor levels represent quantities and the interest is to describe the whole range of responses, beyond the levels that were actually included in the experimental design.</p>
<p>In those conditions, ANOVA models do not fully respect the dataset characteristics, as they concentrate exclusively on the responses to the selected levels for the factors under investigation. Therefore, we need another class of models, usually known as <strong>regression models</strong>, which we will introduce in these two final chapters.</p>
<div id="case-study-n-fertilisation-in-wheat" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Case-study: N fertilisation in wheat<a href="simple-linear-regression.html#case-study-n-fertilisation-in-wheat" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It may be important to state that this is not a real dataset, but it was generated by using Monte Carlo simulation, at the end of Chapter 4. It refers to an experiment aimed at assessing the effect of nitrogen fertilisation on wheat yield and designed with four N doses and four replicates, according to a completely randomised lay-out. The results are reported in Table <a href="simple-linear-regression.html#tab:tabName141">12.1</a> and they can be loaded into R from the usual repository, as shown in the box below.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="simple-linear-regression.html#cb150-1" aria-hidden="true" tabindex="-1"></a>filePath <span class="ot">&lt;-</span> <span class="st">&quot;https://www.casaonofri.it/_datasets/&quot;</span></span>
<span id="cb150-2"><a href="simple-linear-regression.html#cb150-2" aria-hidden="true" tabindex="-1"></a>fileName <span class="ot">&lt;-</span> <span class="st">&quot;NWheat.csv&quot;</span></span>
<span id="cb150-3"><a href="simple-linear-regression.html#cb150-3" aria-hidden="true" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="fu">paste</span>(filePath, fileName, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb150-4"><a href="simple-linear-regression.html#cb150-4" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(file, <span class="at">header=</span>T)</span></code></pre></div>
<table>
<caption><span id="tab:tabName141">Table 12.1: </span>Dataset relativo ad una prova di concimazione azotata su frumento</caption>
<thead>
<tr class="header">
<th align="right">Dose</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">21.98</td>
<td align="right">25.69</td>
<td align="right">27.71</td>
<td align="right">19.14</td>
</tr>
<tr class="even">
<td align="right">60</td>
<td align="right">35.07</td>
<td align="right">35.27</td>
<td align="right">32.56</td>
<td align="right">32.63</td>
</tr>
<tr class="odd">
<td align="right">120</td>
<td align="right">41.59</td>
<td align="right">40.77</td>
<td align="right">41.81</td>
<td align="right">40.50</td>
</tr>
<tr class="even">
<td align="right">180</td>
<td align="right">50.06</td>
<td align="right">52.16</td>
<td align="right">54.40</td>
<td align="right">51.72</td>
</tr>
</tbody>
</table>
</div>
<div id="preliminary-analysis" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Preliminary analysis<a href="simple-linear-regression.html#preliminary-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Looking at this dataset, we note that it has a similar structure as the dataset proposed in Chapter 7, relating to the one-way ANOVA model. The only difference is that, in this example, the explanatory variable is quantitative, instead of nominal. However, as the first step, it may be useful to forget this characteristic and regard the doses as if they were nominal classes. Therefore, we start by fitting an ANOVA model to this dataset.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="simple-linear-regression.html#cb151-1" aria-hidden="true" tabindex="-1"></a>modelAov <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> <span class="fu">factor</span>(Dose), <span class="at">data =</span> dataset)</span></code></pre></div>
<p>As usual, we inspect the residuals for the basic assumptions for linear models; the graphs at Figure <a href="simple-linear-regression.html#fig:figName141">12.1</a> do not show any relevant deviation and, therefore, we proceed to variance partitioning.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figName141"></span>
<img src="_main_files/figure-html/figName141-1.png" alt="Graphical analyses of residuals for a N-fertilisation experiment" width="90%" />
<p class="caption">
Figure 12.1: Graphical analyses of residuals for a N-fertilisation experiment
</p>
</div>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="simple-linear-regression.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelAov)</span>
<span id="cb152-2"><a href="simple-linear-regression.html#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb152-3"><a href="simple-linear-regression.html#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb152-4"><a href="simple-linear-regression.html#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: Yield</span></span>
<span id="cb152-5"><a href="simple-linear-regression.html#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="do">##              Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb152-6"><a href="simple-linear-regression.html#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="do">## factor(Dose)  3 1725.96  575.32  112.77 4.668e-09 ***</span></span>
<span id="cb152-7"><a href="simple-linear-regression.html#cb152-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals    12   61.22    5.10                      </span></span>
<span id="cb152-8"><a href="simple-linear-regression.html#cb152-8" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb152-9"><a href="simple-linear-regression.html#cb152-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We see that the treatment effect is significant and the residual standard deviation <span class="math inline">\(\sigma\)</span> is equal to <span class="math inline">\(\sqrt{5.10} = 2.258\)</span>. This is a good estimate of the so-called <strong>pure error</strong>, measuring the variability between the replicates for each treatment.</p>
<p>In contrast to what we have done in previous chapters, we do not proceed to contrasts and multiple comparison procedures. It would make no sense to compare, e.g., the yield response at 60 kg N ha<sup>-1</sup> with that at 120 kg N ha <sup>-1</sup>; indeed, we are not specifically interested in those two doses, but we are interested in the whole range of responses, from 0 to 180 kg N ha<sup>-1</sup>. We just selected four rates to cover that interval, but we could have as well selected four different doses, e.g. 0, 55, 125 and 180 kg N ha<sup>-1</sup>. As we are interested in the whole range of responses, our best option is to fit a regression model, where the dose is regarded as a numeric variabile, which can take all values from 0 to 180 kg N ha<sup>-1</sup>.</p>
</div>
<div id="definition-of-a-linear-model" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Definition of a linear model<a href="simple-linear-regression.html#definition-of-a-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this case, we have generated the response by using Monte Carlo simulation and we know that this is linear, within the range from 0 to 180 kg N ha<sup>-1</sup>. In practice, the regression function is selected according to biological realism and simplicity, keeping into account the shape of the observed response. A linear regression model is:</p>
<p><span class="math display">\[Y_i = b_0 + b_1 X_i + \varepsilon_i\]</span></p>
<p>where <span class="math inline">\(Y_i\)</span> is the yield in the <span class="math inline">\(i\)</span><sup>t</sup>h plot, treated with a N rate of <span class="math inline">\(X_i\)</span>, <span class="math inline">\(b_0\)</span> is the intercept (yield level at N = 0) and <span class="math inline">\(b_1\)</span> is the slope, i.e. the yield increase for 1-unit increase in N dose. The stochastic component <span class="math inline">\(\varepsilon\)</span> is assumed as homoscedastic and gaussian, with mean equal to 0 and standard deviation equal to <span class="math inline">\(\sigma\)</span>.</p>
</div>
<div id="parameter-estimation-2" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Parameter estimation<a href="simple-linear-regression.html#parameter-estimation-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In general, we know that parameter estimates for linear models are obtained by using the method of least squares, i.e., by selecting the values that result in the smallest sum of squared residuals. However, for our hand-calculations with ANOVA models, we could use the method of moments, which is very simple and based on means and differences among means. Unfortunately, such a simple method cannot be used for regression models and we have to resort to the general least squares method.</p>
<p>Intuitively, applying this method is rather easy: we need to select the straight line that is the closest to the observed responses. In order to find a algebraic solution, we write the least squares function LS and make some slight mathematical manipulation:</p>
<p><span class="math display">\[\begin{array}{l}
LS = \sum\limits_{i = }^N {\left( {{Y_i} - \hat Y_i} \right)^2 = \sum\limits_{i = }^N {{{\left( {{Y_i} - {b_0} - {b_1}{X_i}} \right)}^2}}  = } \\
= \sum\limits_{i = }^N {\left( {Y_i^2 + b_0^2 + b_1^2X_i^2 - 2{Y_i}{b_0} - 2{Y_i}{b_1}{X_i} + 2{b_0}{b_1}{X_i}} \right)}  = \\
= \sum\limits_{i = }^N {Y_i^2 + Nb_0^2 + b_1^2\sum\limits_{i = }^N {X_i^2 - 2{b_0}\sum\limits_{i = }^N {Y_i^2 - 2{b_1}\sum\limits_{i = }^N {{X_i}{Y_i} + } } } } 2{b_0}{b_1}\sum\limits_{i = }^N {{X_i}}
\end{array} \]</span></p>
<p>where <span class="math inline">\(\hat{Y_i}\)</span> is the expected value (i.e. <span class="math inline">\(\hat{Y_i} = b_0 + b_1 X\)</span>). Now, we have to find the values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> that result in the minimum value of LS. You may remember from high school that a minimisation problem can be solved by setting the first derivative to zero. In this case, we have two unknown quantities <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>, thus we have two partial derivatives, which we can set to zero. By doing so, we get to the following estimating functions:</p>
<p><span class="math display">\[{b_1} = \frac{{\sum\limits_{i = 1}^N {\left[ {\left( {{X_i} - {\mu _X}} \right)\left( {{Y_i} - {\mu _Y}} \right)} \right]} }}{{\sum\limits_{i = 1}^N {{{\left( {{X_i} - {\mu _X}} \right)}^2}} }}\]</span></p>
<p>and:</p>
<p><span class="math display">\[{b_0} = {\mu _Y} - {b_1}{\mu _X}\]</span></p>
<p>The hand-calculations, with R, lead to:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="simple-linear-regression.html#cb153-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> dataset<span class="sc">$</span>Dose</span>
<span id="cb153-2"><a href="simple-linear-regression.html#cb153-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> dataset<span class="sc">$</span>Yield</span>
<span id="cb153-3"><a href="simple-linear-regression.html#cb153-3" aria-hidden="true" tabindex="-1"></a>muX <span class="ot">&lt;-</span> <span class="fu">mean</span>(X)</span>
<span id="cb153-4"><a href="simple-linear-regression.html#cb153-4" aria-hidden="true" tabindex="-1"></a>muY <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y)</span>
<span id="cb153-5"><a href="simple-linear-regression.html#cb153-5" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((X <span class="sc">-</span> muX)<span class="sc">*</span>(Y <span class="sc">-</span> muY))<span class="sc">/</span><span class="fu">sum</span>((X <span class="sc">-</span> muX)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb153-6"><a href="simple-linear-regression.html#cb153-6" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> muY <span class="sc">-</span> b1<span class="sc">*</span>muX</span>
<span id="cb153-7"><a href="simple-linear-regression.html#cb153-7" aria-hidden="true" tabindex="-1"></a>b0; b1</span>
<span id="cb153-8"><a href="simple-linear-regression.html#cb153-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 23.79375</span></span>
<span id="cb153-9"><a href="simple-linear-regression.html#cb153-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1544167</span></span></code></pre></div>
<p>Hand-calculations look rather outdated, today: we would better fit the model by using the usual <code>lm()</code> function and the <code>summary()</code> method. Please, note that we use the ‘Dose’ vector as such, without transforming it into a factor:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="simple-linear-regression.html#cb154-1" aria-hidden="true" tabindex="-1"></a>modelReg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Dose, <span class="at">data =</span> dataset)</span>
<span id="cb154-2"><a href="simple-linear-regression.html#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelReg)</span>
<span id="cb154-3"><a href="simple-linear-regression.html#cb154-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb154-4"><a href="simple-linear-regression.html#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb154-5"><a href="simple-linear-regression.html#cb154-5" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = Yield ~ Dose, data = dataset)</span></span>
<span id="cb154-6"><a href="simple-linear-regression.html#cb154-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb154-7"><a href="simple-linear-regression.html#cb154-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb154-8"><a href="simple-linear-regression.html#cb154-8" aria-hidden="true" tabindex="-1"></a><span class="do">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb154-9"><a href="simple-linear-regression.html#cb154-9" aria-hidden="true" tabindex="-1"></a><span class="do">## -4.6537 -1.5350 -0.4637  1.9250  3.9163 </span></span>
<span id="cb154-10"><a href="simple-linear-regression.html#cb154-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb154-11"><a href="simple-linear-regression.html#cb154-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb154-12"><a href="simple-linear-regression.html#cb154-12" aria-hidden="true" tabindex="-1"></a><span class="do">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb154-13"><a href="simple-linear-regression.html#cb154-13" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) 23.793750   0.937906   25.37 4.19e-13 ***</span></span>
<span id="cb154-14"><a href="simple-linear-regression.html#cb154-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Dose         0.154417   0.008356   18.48 3.13e-11 ***</span></span>
<span id="cb154-15"><a href="simple-linear-regression.html#cb154-15" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb154-16"><a href="simple-linear-regression.html#cb154-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb154-17"><a href="simple-linear-regression.html#cb154-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb154-18"><a href="simple-linear-regression.html#cb154-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 2.242 on 14 degrees of freedom</span></span>
<span id="cb154-19"><a href="simple-linear-regression.html#cb154-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.9606, Adjusted R-squared:  0.9578 </span></span>
<span id="cb154-20"><a href="simple-linear-regression.html#cb154-20" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 341.5 on 1 and 14 DF,  p-value: 3.129e-11</span></span></code></pre></div>
<p>Now, we know that, on average, we can expect that the relationship between wheat yield and N fertilisation dose can be described by using the following model:</p>
<p><span class="math display">\[\hat{Y_i} = 23.794 + 0.154 \times X_i\]</span></p>
<p>However, we also know that the observed response will not follow the above function, because of the stochastic element <span class="math inline">\(\varepsilon_i\)</span>, which is regarded as gaussian and homoscedastic, with mean equal 0 and standard deviation equal to 2.242 (see the residual standard error in the output above).</p>
<p>Are we sure that the above model provides a good description of our dataset? Let’s investigate this issue.</p>
</div>
<div id="goodness-of-fit" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> Goodness of fit<a href="simple-linear-regression.html#goodness-of-fit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Regression models need to be inspected with some further attention with respect to ANOVA models. Indeed, we do not only need to verify that the residuals are gaussian and homoscedastic, we also need to carefully verify that model predictions closely follow the observed data (<strong>goodness of fit</strong>).</p>
<p>The inspection of residuals can be done using the same graphical techniques, as shown for ANOVA models (plot of residuals against expected values and QQ-plot of standardised residuals). In this case, we have already made such inspections with the corresponding ANOVA model and we do not need to do them again with this regression model. However, we need to prove that the linear model provides a good fit to the observed data, which we can accomplish by using several methods.</p>
<div id="graphical-evaluation" class="section level3 hasAnchor" number="12.5.1">
<h3><span class="header-section-number">12.5.1</span> Graphical evaluation<a href="simple-linear-regression.html#graphical-evaluation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first and easiest method to check the goodness of fit is to plot the data along with model predictions, as shown in Figure <a href="simple-linear-regression.html#fig:figName142">12.2</a>. Do we see any deviations from linearity? Clearly, the fitted model provides a good description of the observed data.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figName142"></span>
<img src="_main_files/figure-html/figName142-1.png" alt="Response of wheat yield to N fertilisation: the symbols show the observed data, the dashed line shows the fitted model" width="90%" />
<p class="caption">
Figure 12.2: Response of wheat yield to N fertilisation: the symbols show the observed data, the dashed line shows the fitted model
</p>
</div>
</div>
<div id="standard-errors-for-parameter-estimates" class="section level3 hasAnchor" number="12.5.2">
<h3><span class="header-section-number">12.5.2</span> Standard errors for parameter estimates<a href="simple-linear-regression.html#standard-errors-for-parameter-estimates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In some cases, looking at the standard error for the estimated parameters may help evaluate whether the fitted model is reasonable. For example, in this case, we might ask ourselves whether the regression line is horizontal, which would mean that wheat yield is not related to N fertilisation. A horizontal line has slope equal to 0, while <span class="math inline">\(b_1\)</span> was 0.154; however, we also know that <span class="math inline">\(b_1\)</span> is our best guess for the population slope <span class="math inline">\(\beta_1\)</span> (do not forget that we have observed a sample, but we are interested in the population). Is it possible that the population slope <span class="math inline">\(\beta_1\)</span> is, indeed, zero?</p>
<p>If we remember the content of Chapter 5, we can build confidence intervals around an estimate by taking (approximately) twice the standard error. Consequently, the approximate confidence interval for the slope is 0.137705 - 0.171129 and we see that such an interval does not contain 0, which is, therefore, a very unlikely value. This supports the idea that the observed response is, indeed, a linear function of the predictor and that there is no relevant lack of fit.</p>
<p>More formally, we can test the hypothesis <span class="math inline">\(H_0: \beta_1 = 0\)</span> based on the usual T ratio between an estimate and its standard error:</p>
<p><span class="math display">\[T = \frac{b_1}{SE(b_1)} = \frac{0.154417}{0.008356} = 18.48\]</span></p>
<p>If the null is true, the sampling distribution for T is a Student’s t, with 14 degrees of freedom. Thus we see that we have obtained a very unlikely T value and the P-value is:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="simple-linear-regression.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="fl">0.154417</span><span class="sc">/</span><span class="fl">0.008356</span>, <span class="dv">14</span>, <span class="at">lower.tail =</span> F)</span>
<span id="cb155-2"><a href="simple-linear-regression.html#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 3.131456e-11</span></span></code></pre></div>
<p>Therefore, we can reject the null and conclude that <span class="math inline">\(\beta_1 \ne 0\)</span>. The t-test for model parameters is reported in the output of the <code>summary()</code> method (see above).</p>
</div>
<div id="f-test-for-lack-of-fit" class="section level3 hasAnchor" number="12.5.3">
<h3><span class="header-section-number">12.5.3</span> F test for lack of fit<a href="simple-linear-regression.html#f-test-for-lack-of-fit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another formal test is based on comparing the fit of the ANOVA model above (where the dose was regarded as a nominal factor) and the regression model. The residual sum of squares for the ANOVA model is 61.22, while that for the regression model is 70.37 (see the box below).</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="simple-linear-regression.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelReg)</span>
<span id="cb156-2"><a href="simple-linear-regression.html#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb156-3"><a href="simple-linear-regression.html#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb156-4"><a href="simple-linear-regression.html#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: Yield</span></span>
<span id="cb156-5"><a href="simple-linear-regression.html#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="do">##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb156-6"><a href="simple-linear-regression.html#cb156-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Dose       1 1716.80 1716.80  341.54 3.129e-11 ***</span></span>
<span id="cb156-7"><a href="simple-linear-regression.html#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 14   70.37    5.03                      </span></span>
<span id="cb156-8"><a href="simple-linear-regression.html#cb156-8" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb156-9"><a href="simple-linear-regression.html#cb156-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Indeed, the ANOVA model appears to provide a better description of the experimental data, which is expected, as the residuals contain only the so-called pure error, i.e. the variability of each value around the group mean. On the other hand, the residuals from the regression model contain an additional component, represented by the distances from group means to the regression line. Such a component is the so-called <strong>lack of fit</strong> (LF) and it may be estimated as the following difference:</p>
<p><span class="math display">\[\textrm{LF} = 70.37 - 61.22 = 9.15\]</span></p>
<p>It is perfectly logic to ask ourselves whether the lack of fit component is bigger than the pure error component. We know that we can compare variances based on an F ratio; in this case the number of degrees of freedom for the residuals is 14 for the regression model (16 values minus 2 estimated parameters) and 12 for the ANOVA model (3 <span class="math inline">\(\times\)</span> 4). Consequently, the lack of fit component has 2 degrees of freedom (14 - 12 = 2). The F ratio for lack of fit is:</p>
<p><span class="math display">\[F_{LF} = \frac{ \frac{RSS_r - RSS_a}{DF_r - DF_a} } {\frac{RSS_a}{DF_a}} = \frac{9.15 / 2}{61.22/12} = 0.896\]</span></p>
<p>where RSS<sub>r</sub> is the residual sum of squares for regression, with DF<sub>r</sub> degrees of freedom and RSS<sub>a</sub> is the residual sum of squares for ANOVA, with DF<sub>a</sub> degrees of freedom. More quickly, with R we can use the <code>anova()</code> method, passing both models as arguments:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="simple-linear-regression.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelReg, modelAov)</span>
<span id="cb157-2"><a href="simple-linear-regression.html#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb157-3"><a href="simple-linear-regression.html#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb157-4"><a href="simple-linear-regression.html#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 1: Yield ~ Dose</span></span>
<span id="cb157-5"><a href="simple-linear-regression.html#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 2: Yield ~ factor(Dose)</span></span>
<span id="cb157-6"><a href="simple-linear-regression.html#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)</span></span>
<span id="cb157-7"><a href="simple-linear-regression.html#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     14 70.373                           </span></span>
<span id="cb157-8"><a href="simple-linear-regression.html#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     12 61.219  2    9.1542 0.8972 0.4334</span></span></code></pre></div>
<p>This test is not significant (P &gt; 0.05) and, therefore, we should not reject the null hypothesis of no significant lack of fit effect. Thus, we conclude that the regression model provides a good description of the dataset and it fits as well as an ANOVA model, but it is more parsimonious (in other words, it has a lower number of estimated parameters).</p>
</div>
<div id="f-test-for-goodness-of-fit-and-coefficient-of-determination" class="section level3 hasAnchor" number="12.5.4">
<h3><span class="header-section-number">12.5.4</span> F test for goodness of fit and coefficient of determination<a href="simple-linear-regression.html#f-test-for-goodness-of-fit-and-coefficient-of-determination" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As every other linear models, regression models can be reduced to the model of the mean (<strong>null model</strong>: <span class="math inline">\(Y_i = \mu + \varepsilon_i\)</span>) by removing parameters. For example, if we remove <span class="math inline">\(b_1\)</span>, the simple linear regression model reduces to the model of the mean. If you remember from Chapter 4, the model of the mean has no predictors and, therefore, it must be the worst fitting model, as it assumes that we have no explanation for the data.</p>
<p>Hence, we can compare the regression model with the null model and test whether the former is significantly better than the latter. The residual sum of squares for the null model is given in the following box, while we have seen that the residual sum of squares for the regression model is 70.37.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="simple-linear-regression.html#cb158-1" aria-hidden="true" tabindex="-1"></a>modNull <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> dataset)</span>
<span id="cb158-2"><a href="simple-linear-regression.html#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(modNull)</span>
<span id="cb158-3"><a href="simple-linear-regression.html#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1787.178</span></span></code></pre></div>
<p>The difference between the null model and the regression model represents the so-called <strong>goodness of fit</strong> (GF) and it is:</p>
<p><span class="math display">\[GF = 1787.18 - 70.37 = 1716.81\]</span></p>
<p>The GF value is a measure of how much the fit improves when we add the predictor to the model; we can compare GF with the residual sum of squares from regression, by using another F ratio. The degrees of freedom are, respectively, 1 and 14 for the two sum of squares and, consequently, the F ratio is:</p>
<p><span class="math display">\[ F_{GF} = \frac{\frac{RSS_t - RSS_r}{DF_t - DF_r} } {\frac{RSS_r}{DF_r}} = \frac{1716.81/1}{70.37/14}\]</span></p>
<p>where RSS<sub>t</sub> is the residual sum of squares for the null model, with DF<sub>t</sub> degrees of freedom. In R, we can use the <code>anova()</code> method and we do not even need to include the null model as the argument, as this is included by default:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="simple-linear-regression.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelReg)</span>
<span id="cb159-2"><a href="simple-linear-regression.html#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb159-3"><a href="simple-linear-regression.html#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb159-4"><a href="simple-linear-regression.html#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: Yield</span></span>
<span id="cb159-5"><a href="simple-linear-regression.html#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="do">##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb159-6"><a href="simple-linear-regression.html#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Dose       1 1716.80 1716.80  341.54 3.129e-11 ***</span></span>
<span id="cb159-7"><a href="simple-linear-regression.html#cb159-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 14   70.37    5.03                      </span></span>
<span id="cb159-8"><a href="simple-linear-regression.html#cb159-8" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb159-9"><a href="simple-linear-regression.html#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The null hypothesis (the goodness of fit is not significant) is rejected and we confirm that the regression model is a good model.</p>
<p>In order to express the goodness of fit, a frequently used statistic is the <strong>determination coefficient</strong> or <strong>R<sup>2</sup></strong>, i.e. the ratio of the residual sum of squares from regression to the residual sum of squares from the null model:</p>
<p><span class="math display">\[R^2 = \frac{SS_{reg}}{SS_{tot}} = \frac{1716.81}{1787.18} = 0.961\]</span></p>
<p>This ratio goes from 0 to 1: the highest the value the highest the proportion of the total deviance that can be explained by the regression model (please, remember that the residual sum of squares from the model of the mean corresponds to the total deviance). The determination coefficient is included in the output of the <code>summary()</code> method applied to the ‘modelReg’ object.</p>
</div>
</div>
<div id="making-predictions" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> Making predictions<a href="simple-linear-regression.html#making-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Once we are sure that the model provides a good description of the dataset, we can use it to make predictions for whatever N dose we have in mind, as long as it is included within the minimum and maximum N dose in the experimental design (extrapolations are not allowed). For predictions, we can use the <code>predict()</code> method; it needs two arguments: the model object and the X values to use for the prediction, as a dataframe. In the box below we predict the yield for 30 and 80 kg N ha<sup>-1</sup>:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="simple-linear-regression.html#cb160-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelReg, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Dose=</span><span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">80</span>)), <span class="at">se=</span>T)</span>
<span id="cb160-2"><a href="simple-linear-regression.html#cb160-2" aria-hidden="true" tabindex="-1"></a>pred</span>
<span id="cb160-3"><a href="simple-linear-regression.html#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="do">## $fit</span></span>
<span id="cb160-4"><a href="simple-linear-regression.html#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="do">##        1        2 </span></span>
<span id="cb160-5"><a href="simple-linear-regression.html#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 28.42625 36.14708 </span></span>
<span id="cb160-6"><a href="simple-linear-regression.html#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb160-7"><a href="simple-linear-regression.html#cb160-7" aria-hidden="true" tabindex="-1"></a><span class="do">## $se.fit</span></span>
<span id="cb160-8"><a href="simple-linear-regression.html#cb160-8" aria-hidden="true" tabindex="-1"></a><span class="do">##         1         2 </span></span>
<span id="cb160-9"><a href="simple-linear-regression.html#cb160-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.7519981 0.5666999 </span></span>
<span id="cb160-10"><a href="simple-linear-regression.html#cb160-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb160-11"><a href="simple-linear-regression.html#cb160-11" aria-hidden="true" tabindex="-1"></a><span class="do">## $df</span></span>
<span id="cb160-12"><a href="simple-linear-regression.html#cb160-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 14</span></span>
<span id="cb160-13"><a href="simple-linear-regression.html#cb160-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb160-14"><a href="simple-linear-regression.html#cb160-14" aria-hidden="true" tabindex="-1"></a><span class="do">## $residual.scale</span></span>
<span id="cb160-15"><a href="simple-linear-regression.html#cb160-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2.242025</span></span></code></pre></div>
<p>It is also useful to make inverse prediction, i.e. to calculate the dose giving a certain response level. For example, we may wonder what N dose we need to obtain a yield of 4.5 q ha<sup>-1</sup>. To determine this, we need to solve the model for the dose and make the necessary calculations:</p>
<p><span class="math display">\[X = \frac{Y - b_0}{b_1} = \frac{45 - 23.79}{0.154} = 137.33\]</span></p>
<p>In R, we can use the <code>deltaMethod()</code> function in the <code>car</code> package, that also provides standard errors based on the law of propagation of errors (we spoke about this in a previous chapter):</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="simple-linear-regression.html#cb161-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">deltaMethod</span>(modelReg, <span class="st">&quot;(45 - b0)/b1&quot;</span>, </span>
<span id="cb161-2"><a href="simple-linear-regression.html#cb161-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">parameterNames=</span><span class="fu">c</span>(<span class="st">&quot;b0&quot;</span>, <span class="st">&quot;b1&quot;</span>))</span>
<span id="cb161-3"><a href="simple-linear-regression.html#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="do">##              Estimate       SE    2.5 % 97.5 %</span></span>
<span id="cb161-4"><a href="simple-linear-regression.html#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="do">## (45 - b0)/b1 137.3314   4.4424 128.6244 146.04</span></span></code></pre></div>
<p>The above inverse predictions are often used in chemical laboratories for the process of calibration.</p>
<hr />
</div>
<div id="further-readings-9" class="section level2 hasAnchor" number="12.7">
<h2><span class="header-section-number">12.7</span> Further readings<a href="simple-linear-regression.html#further-readings-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Draper, N.R., Smith, H., 1981. Applied Regression Analysis, in: Applied Regression. John Wiley &amp; Sons, Inc., IDA, pp. 224–241.</li>
<li>Faraway, J.J., 2002. Practical regression and Anova using R. <a href="http://cran.r-project.org/doc/contrib/Faraway-PRA.pdf" class="uri">http://cran.r-project.org/doc/contrib/Faraway-PRA.pdf</a>, R.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multi-way-anova-models-with-interactions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="a-brief-intro-to-mixed-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
