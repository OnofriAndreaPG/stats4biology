<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 4 Time-to-event models for seed germination/emergence | Analysing seed germination and emergence data with R: a tutorial</title>
  <meta name="description" content="This document describes a new framework for the analyses of seed germination and emergence data and it is associated to the new R packages ‘drcte’ and ‘drcSeedGerm’" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 4 Time-to-event models for seed germination/emergence | Analysing seed germination and emergence data with R: a tutorial" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/coversmall.png" />
  <meta property="og:description" content="This document describes a new framework for the analyses of seed germination and emergence data and it is associated to the new R packages ‘drcte’ and ‘drcSeedGerm’" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 4 Time-to-event models for seed germination/emergence | Analysing seed germination and emergence data with R: a tutorial" />
  <meta name="twitter:site" content="@onofriandreapg" />
  <meta name="twitter:description" content="This document describes a new framework for the analyses of seed germination and emergence data and it is associated to the new R packages ‘drcte’ and ‘drcSeedGerm’" />
  <meta name="twitter:image" content="/coversmall.png" />

<meta name="author" content="Andrea Onofri" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reshaping-time-to-event-data.html"/>
<link rel="next" href="comparing-the-time-course-of-events-for-several-groups.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131792052-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-131792052-1');
  </script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time-to-event analyses with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-r-packages"><i class="fa fa-check"></i><b>1.1</b> The R packages</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#our-purpose"><i class="fa fa-check"></i><b>1.2</b> Our purpose</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html"><i class="fa fa-check"></i><b>2</b> What is time-to-event data?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#time-to-event-data-are-censored-data"><i class="fa fa-check"></i><b>2.1</b> Time-to-event data are censored data</a></li>
<li class="chapter" data-level="2.2" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#motivating-example-a-simulated-dataset"><i class="fa fa-check"></i><b>2.2</b> Motivating example: a simulated dataset</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#step-1-the-ungerminated-fraction"><i class="fa fa-check"></i><b>2.2.1</b> Step 1: the ungerminated fraction</a></li>
<li class="chapter" data-level="2.2.2" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#step-2-germination-times-for-the-germinated-fraction"><i class="fa fa-check"></i><b>2.2.2</b> Step 2: germination times for the germinated fraction</a></li>
<li class="chapter" data-level="2.2.3" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#step-3-counts-of-germinated-seeds"><i class="fa fa-check"></i><b>2.2.3</b> Step 3: counts of germinated seeds</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#neglecting-censoring"><i class="fa fa-check"></i><b>2.3</b> Neglecting censoring</a></li>
<li class="chapter" data-level="2.4" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#accounting-for-censoring"><i class="fa fa-check"></i><b>2.4</b> Accounting for censoring</a></li>
<li class="chapter" data-level="2.5" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#neglecting-or-accounting-for-censoring"><i class="fa fa-check"></i><b>2.5</b> Neglecting or accounting for censoring?</a></li>
<li class="chapter" data-level="2.6" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#take-home-message"><i class="fa fa-check"></i><b>2.6</b> Take-home message</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html"><i class="fa fa-check"></i><b>3</b> Reshaping time-to-event data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#motivating-example"><i class="fa fa-check"></i><b>3.1</b> Motivating example</a></li>
<li class="chapter" data-level="3.2" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#transforming-from-wide-to-long-grouped"><i class="fa fa-check"></i><b>3.2</b> Transforming from WIDE to LONG GROUPED</a></li>
<li class="chapter" data-level="3.3" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#transforming-from-wide-to-long-ungrouped"><i class="fa fa-check"></i><b>3.3</b> Transforming from WIDE to LONG UNGROUPED</a></li>
<li class="chapter" data-level="3.4" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#from-long-grouped-to-long-ungrouped-and-vice-versa"><i class="fa fa-check"></i><b>3.4</b> From LONG GROUPED to LONG UNGROUPED (and vice-versa)</a></li>
<li class="chapter" data-level="3.5" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#from-nonlinear-regression-to-long-grouped"><i class="fa fa-check"></i><b>3.5</b> From NONLINEAR REGRESSION to LONG GROUPED</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html"><i class="fa fa-check"></i><b>4</b> Time-to-event models for seed germination/emergence</a>
<ul>
<li class="chapter" data-level="4.1" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#parametric-time-to-event-models"><i class="fa fa-check"></i><b>4.1</b> Parametric time-to-event models</a></li>
<li class="chapter" data-level="4.2" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#nonparametric-time-to-event-models"><i class="fa fa-check"></i><b>4.2</b> Nonparametric time-to-event models</a></li>
<li class="chapter" data-level="4.3" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#kernel-density-estimators"><i class="fa fa-check"></i><b>4.3</b> Kernel density estimators</a></li>
<li class="chapter" data-level="4.4" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#ml-npmle-or-kde"><i class="fa fa-check"></i><b>4.4</b> ML, NPMLE or KDE?</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comparing-the-time-course-of-events-for-several-groups.html"><a href="comparing-the-time-course-of-events-for-several-groups.html"><i class="fa fa-check"></i><b>5</b> Comparing the time course of events for several groups</a>
<ul>
<li class="chapter" data-level="5.1" data-path="comparing-the-time-course-of-events-for-several-groups.html"><a href="comparing-the-time-course-of-events-for-several-groups.html#a-motivating-example"><i class="fa fa-check"></i><b>5.1</b> A motivating example</a></li>
<li class="chapter" data-level="5.2" data-path="comparing-the-time-course-of-events-for-several-groups.html"><a href="comparing-the-time-course-of-events-for-several-groups.html#fitting-several-time-to-event-curves"><i class="fa fa-check"></i><b>5.2</b> Fitting several time-to-event curves</a></li>
<li class="chapter" data-level="5.3" data-path="comparing-the-time-course-of-events-for-several-groups.html"><a href="comparing-the-time-course-of-events-for-several-groups.html#comparing-non-parametric-curves"><i class="fa fa-check"></i><b>5.3</b> Comparing non-parametric curves</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html"><i class="fa fa-check"></i><b>6</b> Fitting time-to-event models with environmental covariates</a>
<ul>
<li class="chapter" data-level="6.1" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#hydro-time-to-event-models"><i class="fa fa-check"></i><b>6.1</b> Hydro-time-to-event models</a></li>
<li class="chapter" data-level="6.2" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#a-better-modelling-approach"><i class="fa fa-check"></i><b>6.2</b> A better modelling approach</a></li>
<li class="chapter" data-level="6.3" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#another-modelling-approach"><i class="fa fa-check"></i><b>6.3</b> Another modelling approach</a></li>
<li class="chapter" data-level="6.4" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#further-detail"><i class="fa fa-check"></i><b>6.4</b> Further detail</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htl"><i class="fa fa-check"></i><b>6.4.1</b> <code>HTL()</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htg"><i class="fa fa-check"></i><b>6.4.2</b> <code>HTG()</code></a></li>
<li class="chapter" data-level="6.4.3" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htll"><i class="fa fa-check"></i><b>6.4.3</b> <code>HTLL()</code></a></li>
<li class="chapter" data-level="6.4.4" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htw1"><i class="fa fa-check"></i><b>6.4.4</b> <code>HTW1()</code></a></li>
<li class="chapter" data-level="6.4.5" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htw2"><i class="fa fa-check"></i><b>6.4.5</b> <code>HTW2()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploring-the-results-of-a-time-to-event-fit-model-parameters.html"><a href="exploring-the-results-of-a-time-to-event-fit-model-parameters.html"><i class="fa fa-check"></i><b>7</b> Exploring the results of a time-to-event fit: model parameters</a></li>
<li class="chapter" data-level="8" data-path="predictions-from-time-to-event-models.html"><a href="predictions-from-time-to-event-models.html"><i class="fa fa-check"></i><b>8</b> Predictions from time-to-event models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="predictions-from-time-to-event-models.html"><a href="predictions-from-time-to-event-models.html#parametric-time-to-event-model"><i class="fa fa-check"></i><b>8.1</b> Parametric time-to-event model</a></li>
<li class="chapter" data-level="8.2" data-path="predictions-from-time-to-event-models.html"><a href="predictions-from-time-to-event-models.html#non-parametric-time-to-event-models"><i class="fa fa-check"></i><b>8.2</b> Non-parametric time-to-event models</a></li>
<li class="chapter" data-level="8.3" data-path="predictions-from-time-to-event-models.html"><a href="predictions-from-time-to-event-models.html#predictions-from-a-time-to-event-model-from-literature"><i class="fa fa-check"></i><b>8.3</b> Predictions from a time-to-event model from literature</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html"><i class="fa fa-check"></i><b>9</b> Quantiles from time-to-event models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#peculiarities-of-seed-science-data"><i class="fa fa-check"></i><b>9.1</b> Peculiarities of seed science data</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#quantiles-and-restricted-quantiles"><i class="fa fa-check"></i><b>9.1.1</b> Quantiles and ‘restricted’ quantiles</a></li>
<li class="chapter" data-level="9.1.2" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#germinationemergence-rates"><i class="fa fa-check"></i><b>9.1.2</b> Germination/emergence rates</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#getting-the-quantiles-with-drcte"><i class="fa fa-check"></i><b>9.2</b> Getting the quantiles with ‘drcte’</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#parametric-models"><i class="fa fa-check"></i><b>9.2.1</b> Parametric models</a></li>
<li class="chapter" data-level="9.2.2" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#parametric-models-with-environmental-covariates"><i class="fa fa-check"></i><b>9.2.2</b> Parametric models with environmental covariates</a></li>
<li class="chapter" data-level="9.2.3" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#non-parametric-npmle-models"><i class="fa fa-check"></i><b>9.2.3</b> Non-parametric (NPMLE) models</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#quantiles-and-effective-doses-ed"><i class="fa fa-check"></i><b>9.3</b> Quantiles and Effective Doses (ED)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html"><i class="fa fa-check"></i><b>10</b> Fitting germination models in two steps</a>
<ul>
<li class="chapter" data-level="10.1" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#fitting-linear-models-in-two-steps"><i class="fa fa-check"></i><b>10.1</b> Fitting linear models in two steps</a></li>
<li class="chapter" data-level="10.2" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#fitting-non-linear-threshold-models-in-two-steps"><i class="fa fa-check"></i><b>10.2</b> Fitting non-linear threshold models in two steps</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#definition-of-threshold-models"><i class="fa fa-check"></i><b>10.2.1</b> Definition of threshold models</a></li>
<li class="chapter" data-level="10.2.2" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#a-possibly-incomplete-list-of-threshold-models"><i class="fa fa-check"></i><b>10.2.2</b> A (possibly incomplete) list of threshold models</a></li>
<li class="chapter" data-level="10.2.3" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#description-of-models"><i class="fa fa-check"></i><b>10.2.3</b> Description of models</a></li>
<li class="chapter" data-level="10.2.4" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#example-1"><i class="fa fa-check"></i><b>10.2.4</b> Example 1</a></li>
<li class="chapter" data-level="10.2.5" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#example-2"><i class="fa fa-check"></i><b>10.2.5</b> Example 2</a></li>
<li class="chapter" data-level="10.2.6" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#warning-message"><i class="fa fa-check"></i><b>10.2.6</b> Warning message!</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#carrying-over-information-to-the-2nd-step"><i class="fa fa-check"></i><b>10.3</b> Carrying over information to the 2<sup>nd</sup> step</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html"><i class="fa fa-check"></i><b>11</b> Examples and case-studies</a>
<ul>
<li class="chapter" data-level="11.1" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#fitting-hydro-thermal-time-models-to-seed-germination-data"><i class="fa fa-check"></i><b>11.1</b> Fitting hydro-thermal-time-models to seed germination data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#preliminary-analyses"><i class="fa fa-check"></i><b>11.1.1</b> Preliminary analyses</a></li>
<li class="chapter" data-level="11.1.2" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#a-better-modelling-approach-1"><i class="fa fa-check"></i><b>11.1.2</b> A better modelling approach</a></li>
<li class="chapter" data-level="11.1.3" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#other-htt-models"><i class="fa fa-check"></i><b>11.1.3</b> Other HTT models</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#fitting-thermal-time-models-to-seed-germination-data"><i class="fa fa-check"></i><b>11.2</b> Fitting thermal-time-models to seed germination data</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#a-motivating-examples"><i class="fa fa-check"></i><b>11.2.1</b> A motivating examples</a></li>
<li class="chapter" data-level="11.2.2" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#a-first-thermal-time-model"><i class="fa fa-check"></i><b>11.2.2</b> A first thermal-time model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>12</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysing seed germination and emergence data with R: a tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="time-to-event-models-for-seed-germinationemergence" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Section 4</span> Time-to-event models for seed germination/emergence<a href="time-to-event-models-for-seed-germinationemergence.html#time-to-event-models-for-seed-germinationemergence" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The individual seeds within a population do not germinate/emerge altogether at the same moment; this is an undisputed fact, resulting from seed-to-seed variability in germination/emergence time. Accordingly, the primary reason why we organise germination assays is to describe the progress to germination for the whole population, by using some appropriate time-to-event model.</p>
<p>What is a time-to-event model? It is a model that describes the probability that the event (germination/emergence, in our case) occurs at any time <span class="math inline">\(t\)</span> or before that time:</p>
<p><span class="math display">\[ P(t) = \Phi(T \le t)\]</span></p>
<p>In practice, it may be easier to think that <span class="math inline">\(P(t)\)</span> is the proportion of germinated/emerged seeds at time <span class="math inline">\(t\)</span>. In statistical terms, <span class="math inline">\(\Phi\)</span> is a Cumulative Distribution Function (CDF), with the following characteristics:</p>
<ol style="list-style-type: decimal">
<li>the time <span class="math inline">\(t\)</span> is constrained from 0 to +<span class="math inline">\(\infty\)</span></li>
<li>the response <span class="math inline">\(P(t)\)</span> is constrained from 0 to 1</li>
<li>the response <span class="math inline">\(P(t)\)</span> is monotonically increasing</li>
<li>due to the possible presence of a final fraction of individuals without the event (e.g., ungerminated seeds), <span class="math inline">\(P(t)\)</span> may not necessarily reach 1.</li>
</ol>
<p>The first task to fit a time-to-event model is to select a form for <span class="math inline">\(\Phi\)</span>. In general, we have three possibilities:</p>
<ol style="list-style-type: decimal">
<li>a parametric maximum likelihood model (ML)</li>
<li>a non-parametric maximum likelihood model (NPMLE)</li>
<li>a kernel density estimator (KDE)</li>
</ol>
<p>Let’s have a closer look at those three options.</p>
<div id="parametric-time-to-event-models" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Parametric time-to-event models<a href="time-to-event-models-for-seed-germinationemergence.html#parametric-time-to-event-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The CDF for parametric time-to-event models is characterised by a pre-defined, usually sigmoidal, shape. Right-skewed CDFs have proven useful, such as the log-normal, log-logistic or Weibull, which are only defined for <span class="math inline">\(t &gt; 0\)</span> (see #1 above). These CDFs contain a location (<span class="math inline">\(e\)</span>) and a scale (<span class="math inline">\(b\)</span>) parameter: the former is a measure of central tendency (e.g., the median for the log-logistic and log-normal CDFs) while the latter is a measure of how fast the curve grows during time. For seed germination/emergence, most often, a third parameter is necessary, to describe the fraction of dormant or nonviable seeds (<span class="math inline">\(0 &lt; d \leq 1\)</span>). As an example, we show a log-logistic CDF, that is also used in ecotoxicology, for dose-response studies:</p>
<p><span class="math display">\[P(t) = \frac{d}{1 + exp\left\{ b \right[ \log(t) - log(e)\left] \right\}}\]</span></p>
<p>Fitting the above parametric model implies that, based on the observed data, we need to assign a specific value to the parameters <span class="math inline">\(b\)</span>, <span class="math inline">\(d\)</span> and <span class="math inline">\(e\)</span>, so that an appropriate likelihood function is maximised (Maximum Likelihood estimation). Relating to the estimation process, we should necessarily take into account that germination/emergence data are censored data; neglecting this fact has some important consequences, as I have described <a href="https://www.statforbiology.com/2021/stat_drcte_2-methods/">in this post</a>.</p>
<p>In practice, parametric time-to-event models can be fitted by the <code>drmte()</code> function in the ‘drcte’ package. As an example, let’s consider a factitious dataset relating to an assay where the germinations of 30 seeds were counted daily for 15 days. A log-logistic time-to-event model can be easily fit as follows:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="time-to-event-models-for-seed-germinationemergence.html#cb20-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://www.casaonofri.it/_datasets/oneFlush.csv&quot;</span>)</span>
<span id="cb20-2"><a href="time-to-event-models-for-seed-germinationemergence.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataset)</span>
<span id="cb20-3"><a href="time-to-event-models-for-seed-germinationemergence.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   timeBef timeAf counts</span></span>
<span id="cb20-4"><a href="time-to-event-models-for-seed-germinationemergence.html#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 1       0      1      3</span></span>
<span id="cb20-5"><a href="time-to-event-models-for-seed-germinationemergence.html#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2       1      2      2</span></span>
<span id="cb20-6"><a href="time-to-event-models-for-seed-germinationemergence.html#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 3       2      3      3</span></span>
<span id="cb20-7"><a href="time-to-event-models-for-seed-germinationemergence.html#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 4       3      4      4</span></span>
<span id="cb20-8"><a href="time-to-event-models-for-seed-germinationemergence.html#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 5       4      5      3</span></span>
<span id="cb20-9"><a href="time-to-event-models-for-seed-germinationemergence.html#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 6       5      6      2</span></span>
<span id="cb20-10"><a href="time-to-event-models-for-seed-germinationemergence.html#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(drcte)</span>
<span id="cb20-11"><a href="time-to-event-models-for-seed-germinationemergence.html#cb20-11" aria-hidden="true" tabindex="-1"></a>te.mod <span class="ot">&lt;-</span> <span class="fu">drmte</span>(counts <span class="sc">~</span> timeBef <span class="sc">+</span> timeAf, <span class="at">fct =</span> <span class="fu">LL.3</span>(),</span>
<span id="cb20-12"><a href="time-to-event-models-for-seed-germinationemergence.html#cb20-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> dataset)</span>
<span id="cb20-13"><a href="time-to-event-models-for-seed-germinationemergence.html#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative</span></span>
<span id="cb20-14"><a href="time-to-event-models-for-seed-germinationemergence.html#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># te.mod &lt;- drm(counts ~ timeBef + timeAf, fct = LL.3(),</span></span>
<span id="cb20-15"><a href="time-to-event-models-for-seed-germinationemergence.html#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                 data = dataset, type = &quot;event&quot;)</span></span></code></pre></div>
<p>We can see that we have directly considered the observed counts as the response variable, with no preliminary transformation. Furthermore, we have two predictors that represent the extremes of each time interval (‘timeBef’ and ‘timeAf’), by which we associate each count to the whole uncertainty interval during which germinations took place and not to a precise time instant. In other words, we fully respect our censored data.</p>
<p>The very same model can be fitted by using the <code>drm()</code> function in the ‘drc’ package, although we should add the argument <code>type = "event"</code>, as this latter package is not specific to time-to-event methods.</p>
<p>The usual <code>coef()</code>, <code>summary()</code>, <code>print()</code> and <code>plot()</code> methods can be used for ‘drcte’ objects as for any other model object in R.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(te.mod)</span>
<span id="cb21-2"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-3"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Model fitted: Log-logistic (ED50 as parameter) with lower limit at 0</span></span>
<span id="cb21-4"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-5"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Robust estimation: no </span></span>
<span id="cb21-6"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-7"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Parameter estimates:</span></span>
<span id="cb21-8"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb21-9"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Std. Error t-value   p-value    </span></span>
<span id="cb21-10"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="do">## b:(Intercept) -1.52553    0.44166 -3.4541 0.0005521 ***</span></span>
<span id="cb21-11"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="do">## d:(Intercept)  0.97842    0.16027  6.1048  1.03e-09 ***</span></span>
<span id="cb21-12"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="do">## e:(Intercept)  4.91400    1.68058  2.9240 0.0034558 ** </span></span>
<span id="cb21-13"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb21-14"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb21-15"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(te.mod, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>),</span>
<span id="cb21-16"><a href="time-to-event-models-for-seed-germinationemergence.html#cb21-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Cumulative proportion of germinated seeds&quot;</span>)</span></code></pre></div>
<p><img src="_seedGerminationTutorial_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="nonparametric-time-to-event-models" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Nonparametric time-to-event models<a href="time-to-event-models-for-seed-germinationemergence.html#nonparametric-time-to-event-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In some cases we are not willing to assume that the germination curve has a certain predefined shape, but we need an extra degree of flexibility. For example, emergences may proceed in successive flushes that are not easily described by using a sigmoidal curve. In these cases, we can fit a non-parametric model, whose shape is not pre-defined, but it is built by closely following the observed data. In survival analyses, time-to-event curves for interval censored data are estimated by using Nonparametric Maximum Likelihood Estimators (NPMLE), that are potentially interesting also for plant science.</p>
<p>For example, we can consider another factitious dataset, where the germination took place in two distinct flushes; a non-parametric maximum likelihood model can be fit by using the <code>NPMLE()</code> function, as shown in the box below.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://www.casaonofri.it/_datasets/twoFlushes.csv&quot;</span>)</span>
<span id="cb22-2"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataset)</span>
<span id="cb22-3"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   timeBef timeAf nEmerg</span></span>
<span id="cb22-4"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 1       0      2      0</span></span>
<span id="cb22-5"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2       2      4      1</span></span>
<span id="cb22-6"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 3       4      6     10</span></span>
<span id="cb22-7"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 4       6      8      9</span></span>
<span id="cb22-8"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 5       8     10      4</span></span>
<span id="cb22-9"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 6      10     12      0</span></span>
<span id="cb22-10"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-10" aria-hidden="true" tabindex="-1"></a>te.npmle <span class="ot">&lt;-</span> <span class="fu">drmte</span>(nEmerg <span class="sc">~</span> timeBef <span class="sc">+</span> timeAf, <span class="at">fct =</span> <span class="fu">NPMLE</span>(),</span>
<span id="cb22-11"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> dataset)</span>
<span id="cb22-12"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(te.npmle)</span>
<span id="cb22-13"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb22-14"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Model fitted: NPML estimator for time-to-event data</span></span>
<span id="cb22-15"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb22-16"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Robust estimation: no </span></span>
<span id="cb22-17"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb22-18"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Turnbull&#39;s intervals and masses:</span></span>
<span id="cb22-19"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb22-20"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="do">##            count   pdf   cdf Naive.SE</span></span>
<span id="cb22-21"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 1.(2,4]     1.00  0.02  0.02   0.0198</span></span>
<span id="cb22-22"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 1.(4,6]    10.00  0.20  0.22   0.0586</span></span>
<span id="cb22-23"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 1.(6,8]     9.00  0.18  0.40   0.0693</span></span>
<span id="cb22-24"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 1.(8,10]    4.00  0.08  0.48   0.0707</span></span>
<span id="cb22-25"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 1.(14,16]   1.00  0.02  0.50   0.0707</span></span>
<span id="cb22-26"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="do">## 1.(18,20]   1.00  0.02  0.52   0.0707</span></span>
<span id="cb22-27"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 1.(20,22]   1.00  0.02  0.54   0.0705</span></span>
<span id="cb22-28"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 1.(22,24]   4.00  0.08  0.62   0.0686</span></span>
<span id="cb22-29"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 1.(24,26]   7.00  0.14  0.76   0.0604</span></span>
<span id="cb22-30"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 1.(26,28]   6.00  0.12  0.88   0.0460</span></span>
<span id="cb22-31"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 1.(28,30]   3.00  0.06  0.94   0.0336</span></span>
<span id="cb22-32"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="do">## 1.(32,Inf)  3.00  0.06  1.00   0.0000</span></span>
<span id="cb22-33"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb22-34"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(te.npmle, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb22-36"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Cumulative proportion of germinated seeds&quot;</span>,</span>
<span id="cb22-37"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Interpolation method&quot;</span>, <span class="at">npmle.points =</span> T)</span>
<span id="cb22-38"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-38" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(te.npmle, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb22-39"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-39" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Cumulative proportion of germinated seeds&quot;</span>,</span>
<span id="cb22-40"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-40" aria-hidden="true" tabindex="-1"></a>     <span class="at">npmle.type =</span> <span class="st">&quot;midpoint&quot;</span>, <span class="at">shading =</span> F,</span>
<span id="cb22-41"><a href="time-to-event-models-for-seed-germinationemergence.html#cb22-41" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Midpoint imputation&quot;</span>)</span></code></pre></div>
<p><img src="_seedGerminationTutorial_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>With NPMLE, the time-to-event curve is only defined at the end of each time interval, while it is undefined elsewhere and it is (optionally) represented by a shaded area (Figure above, left). This shaded area reflects the uncertainty due to censoring.</p>
<p>Although we cannot know at what moment the nonparametric curve went up within the grey interval, we can make some reasonable assumptions. For example, we could assume that events are evenly spread within the interval, which is the approach taken in the ‘interval’ package (Figure above, left panel). In the ‘survival’ package and, most commonly, in survival analysis, it is assumed that the curve goes up in the middle of the interval (midpoint imputation; Figure above, right panel).</p>
</div>
<div id="kernel-density-estimators" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Kernel density estimators<a href="time-to-event-models-for-seed-germinationemergence.html#kernel-density-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>NPMLEs are very flexible and they can be used to describe the progress to germination/emergence with, virtually, every type of datasets, also when the events took place in distinct flushes. However, we may be reluctant to accept a time-to-event curve with a stairstep shape, especially for prediction purposes. A further possibility to describe the time to event curve with a smooth and flexible model is to use a so-called Kernel Density Estimator (KDE). A KDE is built by considering the observed data, a Kernel function (usually gaussian) and a bandwith value, that controls the degree of smoothing; a nice post to see how Kernel density estimation works in practice can be found <a href="https://mathisonian.github.io/kde/">at this link here</a>.</p>
<p>In the box below we show that a KDE can be fitted to the observed data (same example as above) by using the <code>drmte()</code> function and setting the ‘fct’ argument to <code>KDE()</code>. Please, note that this type of KDE is specifically modified to comply with censoring.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-1" aria-hidden="true" tabindex="-1"></a>te.kde <span class="ot">&lt;-</span> <span class="fu">drmte</span>(nEmerg <span class="sc">~</span> timeBef <span class="sc">+</span> timeAf, <span class="at">fct =</span> <span class="fu">KDE</span>(),</span>
<span id="cb23-2"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> dataset)</span>
<span id="cb23-3"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(te.kde)</span>
<span id="cb23-4"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb23-5"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Model fitted: Kernel estimator for the distribution function</span></span>
<span id="cb23-6"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb23-7"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Robust estimation: no </span></span>
<span id="cb23-8"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb23-9"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Bandwidth estimates:</span></span>
<span id="cb23-10"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb23-11"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate</span></span>
<span id="cb23-12"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="do">## h:(bandwidth)   1.7871</span></span>
<span id="cb23-13"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(te.kde, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb23-14"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Cumulative proportion of germinated seeds&quot;</span>)</span>
<span id="cb23-15"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-15" aria-hidden="true" tabindex="-1"></a>paf <span class="ot">&lt;-</span> <span class="fu">KDE.fun</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">35</span>, <span class="dv">1</span>), dataset<span class="sc">$</span>timeBef, dataset<span class="sc">$</span>timeAf, dataset<span class="sc">$</span>nEmerg, </span>
<span id="cb23-16"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">h =</span> <span class="fl">0.5</span>)</span>
<span id="cb23-17"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(paf <span class="sc">~</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">35</span>, <span class="dv">1</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb23-18"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-18" aria-hidden="true" tabindex="-1"></a>paf <span class="ot">&lt;-</span> <span class="fu">KDE.fun</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">35</span>, <span class="dv">1</span>), dataset<span class="sc">$</span>timeBef, dataset<span class="sc">$</span>timeAf, dataset<span class="sc">$</span>nEmerg, </span>
<span id="cb23-19"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">h =</span> <span class="fl">3.0</span>)</span>
<span id="cb23-20"><a href="time-to-event-models-for-seed-germinationemergence.html#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(paf <span class="sc">~</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">35</span>, <span class="dv">1</span>), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="_seedGerminationTutorial_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>We have augmented the above graph with three estimators: the blue one has a bandwidth <span class="math inline">\(h = 3\)</span>, the red one has <span class="math inline">\(b = 0.5\)</span> and the black one has <span class="math inline">\(b = 1.7871\)</span>. Our aim was to show the effect of bandwidth selection on the resulting time-to-event curve, although it is usually necessary to apply an appropriate algorithm for the selection. The function <code>drmte()</code>, by default, uses the AMISE method and, unless you know what you are doing, we recommend that you stick to such an algorithm.</p>
</div>
<div id="ml-npmle-or-kde" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> ML, NPMLE or KDE?<a href="time-to-event-models-for-seed-germinationemergence.html#ml-npmle-or-kde" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There is no rule to select the type of time-to-event model for seed germination/emergence and you will have to make your own choice and defend it at the publication stage. As a swift suggestion, I would say that a parametric model is to be preferred, unless it shows some visible signs of lack of fit.</p>
<p>Whatever model you select, fitting a time-to-event model may be the most unambiguous way to describe the progress to germination/emergence. In a future post, we will see that we can also compare time-to-event models for different experimental treatments and or environmental conditions, which is, most often, the central step in our process of data analyses, for seed germination/emergence assays.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reshaping-time-to-event-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="comparing-the-time-course-of-events-for-several-groups.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_seedGerminationTutorial.pdf", "_seedGerminationTutorial.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
