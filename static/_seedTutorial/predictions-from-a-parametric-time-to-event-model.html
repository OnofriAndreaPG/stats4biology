<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 8 Predictions from a parametric time-to-event model | Analysing seed germination and emergence data with R: a tutorial</title>
  <meta name="description" content="This document describes a new framework for the analyses of seed germination and emergence data and it is associated to the new R packages ‘drcte’ and ‘drcSeedGerm’" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 8 Predictions from a parametric time-to-event model | Analysing seed germination and emergence data with R: a tutorial" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/coversmall.png" />
  <meta property="og:description" content="This document describes a new framework for the analyses of seed germination and emergence data and it is associated to the new R packages ‘drcte’ and ‘drcSeedGerm’" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 8 Predictions from a parametric time-to-event model | Analysing seed germination and emergence data with R: a tutorial" />
  <meta name="twitter:site" content="@onofriandreapg" />
  <meta name="twitter:description" content="This document describes a new framework for the analyses of seed germination and emergence data and it is associated to the new R packages ‘drcte’ and ‘drcSeedGerm’" />
  <meta name="twitter:image" content="/coversmall.png" />

<meta name="author" content="Andrea Onofri" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exploring-the-results-of-a-time-to-event-fit-model-parameters.html"/>
<link rel="next" href="predictions-from-non-parametric-time-to-event-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131792052-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-131792052-1');
  </script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time-to-event analyses with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-r-package"><i class="fa fa-check"></i><b>1.1</b> The R package</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#our-purpose"><i class="fa fa-check"></i><b>1.2</b> Our purpose</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html"><i class="fa fa-check"></i><b>2</b> What is time-to-event data?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#time-to-event-data-are-censored-data"><i class="fa fa-check"></i><b>2.1</b> Time-to-event data are censored data</a></li>
<li class="chapter" data-level="2.2" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#motivating-example-a-simulated-dataset"><i class="fa fa-check"></i><b>2.2</b> Motivating example: a simulated dataset</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#step-1-the-ungerminated-fraction"><i class="fa fa-check"></i><b>2.2.1</b> Step 1: the ungerminated fraction</a></li>
<li class="chapter" data-level="2.2.2" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#step-2-germination-times-for-the-germinated-fraction"><i class="fa fa-check"></i><b>2.2.2</b> Step 2: germination times for the germinated fraction</a></li>
<li class="chapter" data-level="2.2.3" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#step-3-counts-of-germinated-seeds"><i class="fa fa-check"></i><b>2.2.3</b> Step 3: counts of germinated seeds</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#neglecting-censoring"><i class="fa fa-check"></i><b>2.3</b> Neglecting censoring</a></li>
<li class="chapter" data-level="2.4" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#accounting-for-censoring"><i class="fa fa-check"></i><b>2.4</b> Accounting for censoring</a></li>
<li class="chapter" data-level="2.5" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#neglecting-or-accounting-for-censoring"><i class="fa fa-check"></i><b>2.5</b> Neglecting or accounting for censoring?</a></li>
<li class="chapter" data-level="2.6" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#take-home-message"><i class="fa fa-check"></i><b>2.6</b> Take-home message</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html"><i class="fa fa-check"></i><b>3</b> Reshaping time-to-event data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#motivating-example"><i class="fa fa-check"></i><b>3.1</b> Motivating example</a></li>
<li class="chapter" data-level="3.2" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#transforming-from-wide-to-long-grouped"><i class="fa fa-check"></i><b>3.2</b> Transforming from WIDE to LONG GROUPED</a></li>
<li class="chapter" data-level="3.3" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#transforming-from-wide-to-long-ungrouped"><i class="fa fa-check"></i><b>3.3</b> Transforming from WIDE to LONG UNGROUPED</a></li>
<li class="chapter" data-level="3.4" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#from-long-grouped-to-long-ungrouped-and-vice-versa"><i class="fa fa-check"></i><b>3.4</b> From LONG GROUPED to LONG UNGROUPED (and vice-versa)</a></li>
<li class="chapter" data-level="3.5" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#from-nonlinear-regression-to-long-grouped"><i class="fa fa-check"></i><b>3.5</b> From NONLINEAR REGRESSION to LONG GROUPED</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html"><i class="fa fa-check"></i><b>4</b> Time-to-event models for seed germination/emergence</a>
<ul>
<li class="chapter" data-level="4.1" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#parametric-time-to-event-models"><i class="fa fa-check"></i><b>4.1</b> Parametric time-to-event models</a></li>
<li class="chapter" data-level="4.2" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#nonparametric-time-to-event-models"><i class="fa fa-check"></i><b>4.2</b> Nonparametric time-to-event models</a></li>
<li class="chapter" data-level="4.3" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#kernel-density-estimators"><i class="fa fa-check"></i><b>4.3</b> Kernel density estimators</a></li>
<li class="chapter" data-level="4.4" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#ml-npmle-or-kde"><i class="fa fa-check"></i><b>4.4</b> ML, NPMLE or KDE?</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comparing-germinationemergence-for-several-seed-lots.html"><a href="comparing-germinationemergence-for-several-seed-lots.html"><i class="fa fa-check"></i><b>5</b> Comparing germination/emergence for several seed lots</a>
<ul>
<li class="chapter" data-level="5.1" data-path="comparing-germinationemergence-for-several-seed-lots.html"><a href="comparing-germinationemergence-for-several-seed-lots.html#a-motivating-example"><i class="fa fa-check"></i><b>5.1</b> A motivating example</a></li>
<li class="chapter" data-level="5.2" data-path="comparing-germinationemergence-for-several-seed-lots.html"><a href="comparing-germinationemergence-for-several-seed-lots.html#fitting-several-time-to-event-curves"><i class="fa fa-check"></i><b>5.2</b> Fitting several time-to-event curves</a></li>
<li class="chapter" data-level="5.3" data-path="comparing-germinationemergence-for-several-seed-lots.html"><a href="comparing-germinationemergence-for-several-seed-lots.html#comparing-non-parametric-curves"><i class="fa fa-check"></i><b>5.3</b> Comparing non-parametric curves</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html"><i class="fa fa-check"></i><b>6</b> Fitting time-to-event models with environmental covariates</a>
<ul>
<li class="chapter" data-level="6.1" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#hydro-time-to-event-models"><i class="fa fa-check"></i><b>6.1</b> Hydro-time-to-event models</a></li>
<li class="chapter" data-level="6.2" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#a-better-modelling-approach"><i class="fa fa-check"></i><b>6.2</b> A better modelling approach</a></li>
<li class="chapter" data-level="6.3" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#another-modelling-approach"><i class="fa fa-check"></i><b>6.3</b> Another modelling approach</a></li>
<li class="chapter" data-level="6.4" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#further-detail"><i class="fa fa-check"></i><b>6.4</b> Further detail</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htl"><i class="fa fa-check"></i><b>6.4.1</b> <code>HTL()</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htg"><i class="fa fa-check"></i><b>6.4.2</b> <code>HTG()</code></a></li>
<li class="chapter" data-level="6.4.3" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htll"><i class="fa fa-check"></i><b>6.4.3</b> <code>HTLL()</code></a></li>
<li class="chapter" data-level="6.4.4" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htw1"><i class="fa fa-check"></i><b>6.4.4</b> <code>HTW1()</code></a></li>
<li class="chapter" data-level="6.4.5" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htw2"><i class="fa fa-check"></i><b>6.4.5</b> <code>HTW2()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploring-the-results-of-a-time-to-event-fit-model-parameters.html"><a href="exploring-the-results-of-a-time-to-event-fit-model-parameters.html"><i class="fa fa-check"></i><b>7</b> Exploring the results of a time-to-event fit: model parameters</a></li>
<li class="chapter" data-level="8" data-path="predictions-from-a-parametric-time-to-event-model.html"><a href="predictions-from-a-parametric-time-to-event-model.html"><i class="fa fa-check"></i><b>8</b> Predictions from a parametric time-to-event model</a></li>
<li class="chapter" data-level="9" data-path="predictions-from-non-parametric-time-to-event-models.html"><a href="predictions-from-non-parametric-time-to-event-models.html"><i class="fa fa-check"></i><b>9</b> Predictions from non-parametric time-to-event models</a></li>
<li class="chapter" data-level="10" data-path="predictions-from-a-time-to-event-model-from-literature.html"><a href="predictions-from-a-time-to-event-model-from-literature.html"><i class="fa fa-check"></i><b>10</b> Predictions from a time-to-event model from literature</a></li>
<li class="chapter" data-level="11" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html"><i class="fa fa-check"></i><b>11</b> Quantiles from time-to-event models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#peculiarities-of-seed-science-data"><i class="fa fa-check"></i><b>11.1</b> Peculiarities of seed science data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#quantiles-and-restricted-quantiles"><i class="fa fa-check"></i><b>11.1.1</b> Quantiles and ‘restricted’ quantiles</a></li>
<li class="chapter" data-level="11.1.2" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#germinationemergence-rates"><i class="fa fa-check"></i><b>11.1.2</b> Germination/emergence rates</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#getting-the-quantiles-with-drcte"><i class="fa fa-check"></i><b>11.2</b> Getting the quantiles with ‘drcte’</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#parametric-models"><i class="fa fa-check"></i><b>11.2.1</b> Parametric models</a></li>
<li class="chapter" data-level="11.2.2" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#parametric-models-with-environmental-covariates"><i class="fa fa-check"></i><b>11.2.2</b> Parametric models with environmental covariates</a></li>
<li class="chapter" data-level="11.2.3" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#non-parametric-npmle-models"><i class="fa fa-check"></i><b>11.2.3</b> Non-parametric (NPMLE) models</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#quantiles-and-effective-doses-ed"><i class="fa fa-check"></i><b>11.3</b> Quantiles and Effective Doses (ED)</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>12</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysing seed germination and emergence data with R: a tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="predictions-from-a-parametric-time-to-event-model" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Section 8</span> Predictions from a parametric time-to-event model<a href="predictions-from-a-parametric-time-to-event-model.html#predictions-from-a-parametric-time-to-event-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Another key aspect is to use a fitted model to make predictions: what fraction of germinated/emerged seeds will we find in, e.g., one/two weeks? And in one month? For example, let’s consider the hydro-time model we have fitted in some previous posts (the first one is <a href="https://www.statforbiology.com/2022/stat_drcte_6-ht1step/">at this link</a>):</p>
<p><span class="math display">\[ P(t, \Psi) = \Phi \left\{ \frac{\Psi - (\theta_H / t) -\Psi_b }{\sigma_{\Psi_b}} \right\}\]</span></p>
<p>In the above model, <span class="math inline">\(P\)</span> is the cumulative proportion of germinated seeds at time <span class="math inline">\(t\)</span> and water potential <span class="math inline">\(\Psi\)</span>, <span class="math inline">\(\Phi\)</span> is a gaussian cumulative distribution function for base water potential, <span class="math inline">\(\Psi_{b}\)</span> is the median base water potential in the seed lot (in MPa), <span class="math inline">\(\theta_H\)</span> is the hydro-time constant (in MPa day or MPa hour) and <span class="math inline">\(\sigma_{\Psi_b}\)</span> represents the variability of <span class="math inline">\(\Psi_b\)</span> within the population.</p>
<p>The code below can be used to fit the above model to the ‘rape’ dataset in the ‘drcSeedGerm’ package and retreive the estimated parameters, with robust standard errors:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(drcSeedGerm)</span>
<span id="cb45-2"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(drcte)</span>
<span id="cb45-3"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(rape)</span>
<span id="cb45-4"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-4" aria-hidden="true" tabindex="-1"></a>modHTE <span class="ot">&lt;-</span> <span class="fu">drmte</span>(nSeeds <span class="sc">~</span> timeBef <span class="sc">+</span> timeAf <span class="sc">+</span> Psi, </span>
<span id="cb45-5"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> rape, <span class="at">fct =</span> <span class="fu">HTnorm</span>())</span>
<span id="cb45-6"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modHTE, <span class="at">units =</span> Dish)</span>
<span id="cb45-7"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb45-8"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Model fitted: Hydrotime model with normal distribution of Psib (Bradford et al., 2002)</span></span>
<span id="cb45-9"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb45-10"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Robust estimation: Cluster robust sandwich SEs </span></span>
<span id="cb45-11"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb45-12"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Parameter estimates:</span></span>
<span id="cb45-13"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb45-14"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="do">##                        Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb45-15"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="do">## ThetaH:(Intercept)     0.751069   0.131968   5.6913 3.075e-08 ***</span></span>
<span id="cb45-16"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Psib50:(Intercept)    -0.906981   0.039530 -22.9444 &lt; 2.2e-16 ***</span></span>
<span id="cb45-17"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="do">## sigmaPsib:(Intercept)  0.236995   0.031309   7.5696 4.974e-13 ***</span></span>
<span id="cb45-18"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb45-19"><a href="predictions-from-a-parametric-time-to-event-model.html#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Now, we may wonder: if we have a seed lot with the above characteristics (<span class="math inline">\(\theta = 0.751\)</span> MPa d, <span class="math inline">\(\Psi_{b_{50}} = -0.907\)</span> MPa and <span class="math inline">\(\sigma_{\Psi_b} = 0.237\)</span>), what will the proportion of germinated seeds be, e.g., at 1, 3, 5, 7 days after water imbibition, when the base water potential in the substrate is, e.g., 0, -0.25 and -0.5 MPa? To predict this from the model object we can build a data frame with the values of predictors (see below the use of the <code>expand.grid()</code> function) and use it as the ‘newdata’ argument to the <code>predict()</code> method.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-1" aria-hidden="true" tabindex="-1"></a>newd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">time =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>), </span>
<span id="cb46-2"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">psi =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.25</span>, <span class="sc">-</span><span class="fl">0.5</span>))</span>
<span id="cb46-3"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(modHTE, <span class="at">newdata =</span> newd)</span>
<span id="cb46-4"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    time   psi Prediction</span></span>
<span id="cb46-5"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1  0.00 0.74468884</span></span>
<span id="cb46-6"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     3  0.00 0.99720253</span></span>
<span id="cb46-7"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     5  0.00 0.99929640</span></span>
<span id="cb46-8"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 4     7  0.00 0.99962993</span></span>
<span id="cb46-9"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 5     1 -0.25 0.34568239</span></span>
<span id="cb46-10"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 6     3 -0.25 0.95689600</span></span>
<span id="cb46-11"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 7     5 -0.25 0.98375378</span></span>
<span id="cb46-12"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 8     7 -0.25 0.98981312</span></span>
<span id="cb46-13"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 9     1 -0.50 0.07326801</span></span>
<span id="cb46-14"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 10    3 -0.50 0.74565419</span></span>
<span id="cb46-15"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 11    5 -0.50 0.86069050</span></span>
<span id="cb46-16"><a href="predictions-from-a-parametric-time-to-event-model.html#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 12    7 -0.50 0.89697826</span></span></code></pre></div>
<p>With time-to-event models, the ‘newdata’ argument takes a data frame, where the first column is always time and the succeeding columns, wherever needed, represent the environmental covariates, in the same order as they appear in the model definition. If several models have been simultaneously fitted by using the ‘curveid’ argument (not in this case, though), predictions are made for all models, always using the same ‘newdata’.</p>
<p>We can also obtain standard errors and confidence intervals for the predictions, by adding the <code>se.fit = TRUE</code> and <code>interval = TRUE</code> arguments. We also recommend to add the <code>robust = T</code> argument, so that we obtain robust standard errors, accounting for the clustering of seeds within Petri dishes (lack of independence). With parametric time-to-event models, robust standard errors are obtained by using a cluster-robust sandwich variance-covariance matrix (Zeileis et al. 2020); in this case, a clustering variable needs to be provided with the <code>units</code> argument.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="predictions-from-a-parametric-time-to-event-model.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Naive standard errors and confidence intervals</span></span>
<span id="cb47-2"><a href="predictions-from-a-parametric-time-to-event-model.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(modHTE, <span class="at">newdata =</span> newd, <span class="at">se.fit =</span> T, <span class="at">interval =</span> T)</span>
<span id="cb47-3"><a href="predictions-from-a-parametric-time-to-event-model.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    time   psi Prediction           SE      Lower     Upper</span></span>
<span id="cb47-4"><a href="predictions-from-a-parametric-time-to-event-model.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1  0.00 0.74468884 0.0452433821 0.65601344 0.8333642</span></span>
<span id="cb47-5"><a href="predictions-from-a-parametric-time-to-event-model.html#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     3  0.00 0.99720253 0.0008053309 0.99562411 0.9987809</span></span>
<span id="cb47-6"><a href="predictions-from-a-parametric-time-to-event-model.html#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     5  0.00 0.99929640 0.0002384085 0.99882913 0.9997637</span></span>
<span id="cb47-7"><a href="predictions-from-a-parametric-time-to-event-model.html#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 4     7  0.00 0.99962993 0.0001358778 0.99936362 0.9998963</span></span>
<span id="cb47-8"><a href="predictions-from-a-parametric-time-to-event-model.html#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 5     1 -0.25 0.34568239 0.0488012921 0.25003362 0.4413312</span></span>
<span id="cb47-9"><a href="predictions-from-a-parametric-time-to-event-model.html#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 6     3 -0.25 0.95689600 0.0060636345 0.94501149 0.9687805</span></span>
<span id="cb47-10"><a href="predictions-from-a-parametric-time-to-event-model.html#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 7     5 -0.25 0.98375378 0.0027953655 0.97827496 0.9892326</span></span>
<span id="cb47-11"><a href="predictions-from-a-parametric-time-to-event-model.html#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 8     7 -0.25 0.98981312 0.0019555787 0.98598025 0.9936460</span></span>
<span id="cb47-12"><a href="predictions-from-a-parametric-time-to-event-model.html#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 9     1 -0.50 0.07326801 0.0182524957 0.03749378 0.1090422</span></span>
<span id="cb47-13"><a href="predictions-from-a-parametric-time-to-event-model.html#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 10    3 -0.50 0.74565419 0.0143630866 0.71750306 0.7738053</span></span>
<span id="cb47-14"><a href="predictions-from-a-parametric-time-to-event-model.html#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 11    5 -0.50 0.86069050 0.0098002073 0.84148245 0.8798986</span></span>
<span id="cb47-15"><a href="predictions-from-a-parametric-time-to-event-model.html#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 12    7 -0.50 0.89697826 0.0084761895 0.88036524 0.9135913</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster robust standard errors and confidence intervals</span></span>
<span id="cb48-2"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(modHTE, <span class="at">newdata =</span> newd, <span class="at">se.fit =</span> T, <span class="at">interval =</span> T,</span>
<span id="cb48-3"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">robust =</span> T, <span class="at">units =</span> Dish)</span>
<span id="cb48-4"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    time   psi Prediction           SE      Lower     Upper</span></span>
<span id="cb48-5"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1  0.00 0.74468884 0.1450176755 0.46045941 1.0289183</span></span>
<span id="cb48-6"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     3  0.00 0.99720253 0.0035012373 0.99034023 1.0040648</span></span>
<span id="cb48-7"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     5  0.00 0.99929640 0.0011070141 0.99712670 1.0014661</span></span>
<span id="cb48-8"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 4     7  0.00 0.99962993 0.0006427237 0.99837022 1.0008897</span></span>
<span id="cb48-9"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 5     1 -0.25 0.34568239 0.1576339911 0.03672545 0.6546393</span></span>
<span id="cb48-10"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 6     3 -0.25 0.95689600 0.0251911861 0.90752218 1.0062698</span></span>
<span id="cb48-11"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 7     5 -0.25 0.98375378 0.0129567170 0.95835908 1.0091485</span></span>
<span id="cb48-12"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 8     7 -0.25 0.98981312 0.0093141326 0.97155775 1.0080685</span></span>
<span id="cb48-13"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 9     1 -0.50 0.07326801 0.0622953823 0.00000000 0.1953647</span></span>
<span id="cb48-14"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 10    3 -0.50 0.74565419 0.0498559815 0.64793826 0.8433701</span></span>
<span id="cb48-15"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 11    5 -0.50 0.86069050 0.0424570614 0.77747619 0.9439048</span></span>
<span id="cb48-16"><a href="predictions-from-a-parametric-time-to-event-model.html#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 12    7 -0.50 0.89697826 0.0388178876 0.82089660 0.9730599</span></span></code></pre></div>
<p>We are currently studying a way to avoid that confidence intervals return unrealistic predictions (see above some values that are higher than 1). We may note that cluster robust standard errors are higher than naive standard errors: the seed in the same Petri dish are correlated and, thus, they do not contribute full information.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exploring-the-results-of-a-time-to-event-fit-model-parameters.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="predictions-from-non-parametric-time-to-event-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_seedGerminationTutorial.pdf", "_seedGerminationTutorial.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
