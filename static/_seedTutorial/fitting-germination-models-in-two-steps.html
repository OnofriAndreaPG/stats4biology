<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 10 Fitting germination models in two steps | Analysing seed germination and emergence data with R: a tutorial</title>
  <meta name="description" content="This document describes a new framework for the analyses of seed germination and emergence data and it is associated to the new R packages ‘drcte’ and ‘drcSeedGerm’" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 10 Fitting germination models in two steps | Analysing seed germination and emergence data with R: a tutorial" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/coversmall.png" />
  <meta property="og:description" content="This document describes a new framework for the analyses of seed germination and emergence data and it is associated to the new R packages ‘drcte’ and ‘drcSeedGerm’" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 10 Fitting germination models in two steps | Analysing seed germination and emergence data with R: a tutorial" />
  <meta name="twitter:site" content="@onofriandreapg" />
  <meta name="twitter:description" content="This document describes a new framework for the analyses of seed germination and emergence data and it is associated to the new R packages ‘drcte’ and ‘drcSeedGerm’" />
  <meta name="twitter:image" content="/coversmall.png" />

<meta name="author" content="Andrea Onofri" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="quantiles-from-time-to-event-models.html"/>
<link rel="next" href="examples-and-case-studies.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131792052-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-131792052-1');
  </script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time-to-event analyses with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-r-packages"><i class="fa fa-check"></i><b>1.1</b> The R packages</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#our-purpose"><i class="fa fa-check"></i><b>1.2</b> Our purpose</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html"><i class="fa fa-check"></i><b>2</b> What is time-to-event data?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#time-to-event-data-are-censored-data"><i class="fa fa-check"></i><b>2.1</b> Time-to-event data are censored data</a></li>
<li class="chapter" data-level="2.2" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#motivating-example-a-simulated-dataset"><i class="fa fa-check"></i><b>2.2</b> Motivating example: a simulated dataset</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#step-1-the-ungerminated-fraction"><i class="fa fa-check"></i><b>2.2.1</b> Step 1: the ungerminated fraction</a></li>
<li class="chapter" data-level="2.2.2" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#step-2-germination-times-for-the-germinated-fraction"><i class="fa fa-check"></i><b>2.2.2</b> Step 2: germination times for the germinated fraction</a></li>
<li class="chapter" data-level="2.2.3" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#step-3-counts-of-germinated-seeds"><i class="fa fa-check"></i><b>2.2.3</b> Step 3: counts of germinated seeds</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#neglecting-censoring"><i class="fa fa-check"></i><b>2.3</b> Neglecting censoring</a></li>
<li class="chapter" data-level="2.4" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#accounting-for-censoring"><i class="fa fa-check"></i><b>2.4</b> Accounting for censoring</a></li>
<li class="chapter" data-level="2.5" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#neglecting-or-accounting-for-censoring"><i class="fa fa-check"></i><b>2.5</b> Neglecting or accounting for censoring?</a></li>
<li class="chapter" data-level="2.6" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#take-home-message"><i class="fa fa-check"></i><b>2.6</b> Take-home message</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html"><i class="fa fa-check"></i><b>3</b> Reshaping time-to-event data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#motivating-example"><i class="fa fa-check"></i><b>3.1</b> Motivating example</a></li>
<li class="chapter" data-level="3.2" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#transforming-from-wide-to-long-grouped"><i class="fa fa-check"></i><b>3.2</b> Transforming from WIDE to LONG GROUPED</a></li>
<li class="chapter" data-level="3.3" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#transforming-from-wide-to-long-ungrouped"><i class="fa fa-check"></i><b>3.3</b> Transforming from WIDE to LONG UNGROUPED</a></li>
<li class="chapter" data-level="3.4" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#from-long-grouped-to-long-ungrouped-and-vice-versa"><i class="fa fa-check"></i><b>3.4</b> From LONG GROUPED to LONG UNGROUPED (and vice-versa)</a></li>
<li class="chapter" data-level="3.5" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#from-nonlinear-regression-to-long-grouped"><i class="fa fa-check"></i><b>3.5</b> From NONLINEAR REGRESSION to LONG GROUPED</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html"><i class="fa fa-check"></i><b>4</b> Time-to-event models for seed germination/emergence</a>
<ul>
<li class="chapter" data-level="4.1" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#parametric-time-to-event-models"><i class="fa fa-check"></i><b>4.1</b> Parametric time-to-event models</a></li>
<li class="chapter" data-level="4.2" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#nonparametric-time-to-event-models"><i class="fa fa-check"></i><b>4.2</b> Nonparametric time-to-event models</a></li>
<li class="chapter" data-level="4.3" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#kernel-density-estimators"><i class="fa fa-check"></i><b>4.3</b> Kernel density estimators</a></li>
<li class="chapter" data-level="4.4" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#ml-npmle-or-kde"><i class="fa fa-check"></i><b>4.4</b> ML, NPMLE or KDE?</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comparing-the-time-course-of-events-for-several-groups.html"><a href="comparing-the-time-course-of-events-for-several-groups.html"><i class="fa fa-check"></i><b>5</b> Comparing the time course of events for several groups</a>
<ul>
<li class="chapter" data-level="5.1" data-path="comparing-the-time-course-of-events-for-several-groups.html"><a href="comparing-the-time-course-of-events-for-several-groups.html#a-motivating-example"><i class="fa fa-check"></i><b>5.1</b> A motivating example</a></li>
<li class="chapter" data-level="5.2" data-path="comparing-the-time-course-of-events-for-several-groups.html"><a href="comparing-the-time-course-of-events-for-several-groups.html#fitting-several-time-to-event-curves"><i class="fa fa-check"></i><b>5.2</b> Fitting several time-to-event curves</a></li>
<li class="chapter" data-level="5.3" data-path="comparing-the-time-course-of-events-for-several-groups.html"><a href="comparing-the-time-course-of-events-for-several-groups.html#comparing-non-parametric-curves"><i class="fa fa-check"></i><b>5.3</b> Comparing non-parametric curves</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html"><i class="fa fa-check"></i><b>6</b> Fitting time-to-event models with environmental covariates</a>
<ul>
<li class="chapter" data-level="6.1" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#hydro-time-to-event-models"><i class="fa fa-check"></i><b>6.1</b> Hydro-time-to-event models</a></li>
<li class="chapter" data-level="6.2" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#a-better-modelling-approach"><i class="fa fa-check"></i><b>6.2</b> A better modelling approach</a></li>
<li class="chapter" data-level="6.3" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#another-modelling-approach"><i class="fa fa-check"></i><b>6.3</b> Another modelling approach</a></li>
<li class="chapter" data-level="6.4" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#further-detail"><i class="fa fa-check"></i><b>6.4</b> Further detail</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htl"><i class="fa fa-check"></i><b>6.4.1</b> <code>HTL()</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htg"><i class="fa fa-check"></i><b>6.4.2</b> <code>HTG()</code></a></li>
<li class="chapter" data-level="6.4.3" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htll"><i class="fa fa-check"></i><b>6.4.3</b> <code>HTLL()</code></a></li>
<li class="chapter" data-level="6.4.4" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htw1"><i class="fa fa-check"></i><b>6.4.4</b> <code>HTW1()</code></a></li>
<li class="chapter" data-level="6.4.5" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htw2"><i class="fa fa-check"></i><b>6.4.5</b> <code>HTW2()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploring-the-results-of-a-time-to-event-fit-model-parameters.html"><a href="exploring-the-results-of-a-time-to-event-fit-model-parameters.html"><i class="fa fa-check"></i><b>7</b> Exploring the results of a time-to-event fit: model parameters</a></li>
<li class="chapter" data-level="8" data-path="predictions-from-time-to-event-models.html"><a href="predictions-from-time-to-event-models.html"><i class="fa fa-check"></i><b>8</b> Predictions from time-to-event models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="predictions-from-time-to-event-models.html"><a href="predictions-from-time-to-event-models.html#parametric-time-to-event-model"><i class="fa fa-check"></i><b>8.1</b> Parametric time-to-event model</a></li>
<li class="chapter" data-level="8.2" data-path="predictions-from-time-to-event-models.html"><a href="predictions-from-time-to-event-models.html#non-parametric-time-to-event-models"><i class="fa fa-check"></i><b>8.2</b> Non-parametric time-to-event models</a></li>
<li class="chapter" data-level="8.3" data-path="predictions-from-time-to-event-models.html"><a href="predictions-from-time-to-event-models.html#predictions-from-a-time-to-event-model-from-literature"><i class="fa fa-check"></i><b>8.3</b> Predictions from a time-to-event model from literature</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html"><i class="fa fa-check"></i><b>9</b> Quantiles from time-to-event models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#peculiarities-of-seed-science-data"><i class="fa fa-check"></i><b>9.1</b> Peculiarities of seed science data</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#quantiles-and-restricted-quantiles"><i class="fa fa-check"></i><b>9.1.1</b> Quantiles and ‘restricted’ quantiles</a></li>
<li class="chapter" data-level="9.1.2" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#germinationemergence-rates"><i class="fa fa-check"></i><b>9.1.2</b> Germination/emergence rates</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#getting-the-quantiles-with-drcte"><i class="fa fa-check"></i><b>9.2</b> Getting the quantiles with ‘drcte’</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#parametric-models"><i class="fa fa-check"></i><b>9.2.1</b> Parametric models</a></li>
<li class="chapter" data-level="9.2.2" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#parametric-models-with-environmental-covariates"><i class="fa fa-check"></i><b>9.2.2</b> Parametric models with environmental covariates</a></li>
<li class="chapter" data-level="9.2.3" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#non-parametric-npmle-models"><i class="fa fa-check"></i><b>9.2.3</b> Non-parametric (NPMLE) models</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#quantiles-and-effective-doses-ed"><i class="fa fa-check"></i><b>9.3</b> Quantiles and Effective Doses (ED)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html"><i class="fa fa-check"></i><b>10</b> Fitting germination models in two steps</a>
<ul>
<li class="chapter" data-level="10.1" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#fitting-linear-models-in-two-steps"><i class="fa fa-check"></i><b>10.1</b> Fitting linear models in two steps</a></li>
<li class="chapter" data-level="10.2" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#fitting-non-linear-threshold-models-in-two-steps"><i class="fa fa-check"></i><b>10.2</b> Fitting non-linear threshold models in two steps</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#definition-of-threshold-models"><i class="fa fa-check"></i><b>10.2.1</b> Definition of threshold models</a></li>
<li class="chapter" data-level="10.2.2" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#a-possibly-incomplete-list-of-threshold-models"><i class="fa fa-check"></i><b>10.2.2</b> A (possibly incomplete) list of threshold models</a></li>
<li class="chapter" data-level="10.2.3" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#description-of-models"><i class="fa fa-check"></i><b>10.2.3</b> Description of models</a></li>
<li class="chapter" data-level="10.2.4" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#example-1"><i class="fa fa-check"></i><b>10.2.4</b> Example 1</a></li>
<li class="chapter" data-level="10.2.5" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#example-2"><i class="fa fa-check"></i><b>10.2.5</b> Example 2</a></li>
<li class="chapter" data-level="10.2.6" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#warning-message"><i class="fa fa-check"></i><b>10.2.6</b> Warning message!</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#carrying-over-information-to-the-2nd-step"><i class="fa fa-check"></i><b>10.3</b> Carrying over information to the 2<sup>nd</sup> step</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html"><i class="fa fa-check"></i><b>11</b> Examples and case-studies</a>
<ul>
<li class="chapter" data-level="11.1" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#fitting-hydro-thermal-time-models-to-seed-germination-data"><i class="fa fa-check"></i><b>11.1</b> Fitting hydro-thermal-time-models to seed germination data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#preliminary-analyses"><i class="fa fa-check"></i><b>11.1.1</b> Preliminary analyses</a></li>
<li class="chapter" data-level="11.1.2" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#a-better-modelling-approach-1"><i class="fa fa-check"></i><b>11.1.2</b> A better modelling approach</a></li>
<li class="chapter" data-level="11.1.3" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#other-htt-models"><i class="fa fa-check"></i><b>11.1.3</b> Other HTT models</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#fitting-thermal-time-models-to-seed-germination-data"><i class="fa fa-check"></i><b>11.2</b> Fitting thermal-time-models to seed germination data</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#a-motivating-examples"><i class="fa fa-check"></i><b>11.2.1</b> A motivating examples</a></li>
<li class="chapter" data-level="11.2.2" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#a-first-thermal-time-model"><i class="fa fa-check"></i><b>11.2.2</b> A first thermal-time model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>12</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysing seed germination and emergence data with R: a tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fitting-germination-models-in-two-steps" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Section 10</span> Fitting germination models in two steps<a href="fitting-germination-models-in-two-steps.html#fitting-germination-models-in-two-steps" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the previous sections I have shown how to fit time-to-event curves to seed germination data. I have also shown that these curves can be modified to include the effect of external factors (e.g., the species) or covariates (e.g., temperature or humidity content in the substrate), which brought us to the definition of hydro-time, thernal-time or hydro-thermal-time models. So far, in this tutorial, we have fitted these modified time-to-event curves in ‘one-step’, i.e., we started from the germination data, fitted the selected model and retrieved the estimates of model parameters. In such a one-step approach, we showed that one problem was that, most of the times, seeds were not independent, but, they were clustered within Petri dishes, trays, boxes or other containers. Such a clustering, if not appropriately accounted for, brakes the independence assumption that is made by most linear and nonlinear models, invalidating the inferences based on those models.</p>
<p>So far, we have accounted for the above mentioned clustering by using cluster robust standard errors, which are easily calculated within the ‘drcte’ package. However, we should also say that one-step model fitting may often be complex, particularly when we have to deal with a high number of seeds, complex models and multi-tier experimental designs. In order to avoid such complexities, we might like to follow a different approach, that is accomplished in two-steps. Let’s consider an example where we have performed germination assays where seeds have been submitted to 10 different treatment levels: instead of building a time-to-event model that contains the treatment as an external factor, we could:</p>
<ol style="list-style-type: decimal">
<li>independently fit a different time-to-event curve to the germination data for each treatment level, so that we have ten independent time-to-event curves;</li>
<li>derive from each curve a summary statistic of interest, such as the germination rate for the 50-th percentile (GR50; see earlier in this tutorial);</li>
<li>fit, e.g., a thermal-time model to those derived statistics (second step of data analyses).</li>
</ol>
<p>Fitting models in two-steps has always been a common practice in agriculture/biology (see, e.g., multienvironment genotype experiments): it is usually simpler, quicker and requires lower computing power than one-step fitting. The drawback is that some infomation may be lost between the two steps, and, for this reason, one-step and two-steps model fitting do not necessarily lead to the same results. But, we’ll make this point later.</p>
<p>Let’s show some examples of this two-steps approach.</p>
<div id="fitting-linear-models-in-two-steps" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Fitting linear models in two steps<a href="fitting-germination-models-in-two-steps.html#fitting-linear-models-in-two-steps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>(yet to be done)</p>
</div>
<div id="fitting-non-linear-threshold-models-in-two-steps" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Fitting non-linear threshold models in two steps<a href="fitting-germination-models-in-two-steps.html#fitting-non-linear-threshold-models-in-two-steps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="definition-of-threshold-models" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Definition of threshold models<a href="fitting-germination-models-in-two-steps.html#definition-of-threshold-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Threshold models are used to describe a relationship where the response variable changes abruptly, following a small change in the predictor. A typical threshold model looks like that in the Figure below, where we see three threshold levels:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(X1 = 5.5\)</span>: at this threshold, the response changes abruptly from ‘flat’ to linearly increasing;</li>
<li><span class="math inline">\(X2 = 23.1\)</span>: at this threshold, the response changes abruptly from linearly increasing to linearly decreasing;</li>
<li><span class="math inline">\(X3 = 37.2\)</span>: at this threshold, the response changes abruptly from linearly decreasing to ‘flat’.</li>
</ol>
<p>You may recognise a ‘broken-stick’ pattern, although threshold models can also be curvilinear, as we will see later.</p>
<p><img src="_seedGerminationTutorial_files/figure-html/unnamed-chunk-57-1.png" width="90%" /></p>
<p>I have already considered threshold models in a previous post (<a href="https://www.statforbiology.com/2021/stat_seedgermination_htt2step/">see here</a>) and I have already mentioned that thermal-time, hydro-time and hydro-thermal-time models for seed germination can also be cast as threshold models; if we consider, e.g., the Germination Rate (GR) as the response variable and the environmental temperature as the predictor, the relationship could be very close to that represented in Figure 1 and the three thresholds would, respectively, be the <em>base temperature</em> (T_b_), the <em>optimal temperature</em> (T_o_) and the <em>ceiling temperature</em> (T_c_). On the other hand, if we consider the effect of soil humidity on GR, we should expect a response pattern with only one threshold, i.e. the <em>base water potential</em> level (e.g. the first half of the figure above, up to the maximum response level).</p>
</div>
<div id="a-possibly-incomplete-list-of-threshold-models" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> A (possibly incomplete) list of threshold models<a href="fitting-germination-models-in-two-steps.html#a-possibly-incomplete-list-of-threshold-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I have made a review of literature, searching for all threshold models that have been used so far in seed germination studies. For all those models, I have built the related R functions, together with self-starting routines, which can be used for nonlinear regression fitting with the <code>drm()</code> function in the <code>drc</code> package (Ritz et al., 2019). The availability of self-starting routines will free you from the hassle of having to provide initial guesses for model parameters. All these R functions are available within the <code>drcSeedGerm</code> package (Onofri et al., 2018) and their names, with links to the relevant parts of the appendix to this post are:</p>
<ol style="list-style-type: decimal">
<li><a href="fitting-germination-models-in-two-steps.html#grpsilin---grt.gh">GRPsi.Lin() - GRT.GH()</a></li>
<li><a href="fitting-germination-models-in-two-steps.html#grpsipol---grpsipol2">GRPsi.Pol() - GRPsi.Pol2()</a></li>
<li><a href="fitting-germination-models-in-two-steps.html#pmaxpsi1-and-pmaxt1">PmaxPsi1() - PmaxT1()</a></li>
<li><a href="fitting-germination-models-in-two-steps.html#grt.bs">GRT.BS()</a></li>
<li><a href="fitting-germination-models-in-two-steps.html#grt.rf">GRT.RF()</a></li>
<li><a href="fitting-germination-models-in-two-steps.html#grt.m">GRT.M()</a></li>
<li><a href="fitting-germination-models-in-two-steps.html#grt.ex">GRT.Ex()</a></li>
<li><a href="fitting-germination-models-in-two-steps.html#grt.yl">GRT.YL()</a></li>
</ol>
<p>It may be helpful to look at the shapes of the above models in the Figure below, while the equations are motivated in the appendix, at the end of this post.</p>
<p><img src="_seedGerminationTutorial_files/figure-html/unnamed-chunk-58-1.png" width="90%" /></p>
<p>Now, let’s look at a few examples of two-steps fitting. But, before working through this, you will need to install and load the <code>drcSeedGerm</code> package, by using the code below.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="fitting-germination-models-in-two-steps.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># installing drcSeedGerm package, if not yet available</span></span>
<span id="cb58-2"><a href="fitting-germination-models-in-two-steps.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(devtools)</span></span>
<span id="cb58-3"><a href="fitting-germination-models-in-two-steps.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install_github(&quot;onofriandreapg/drcSeedGerm&quot;)</span></span>
<span id="cb58-4"><a href="fitting-germination-models-in-two-steps.html#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="fitting-germination-models-in-two-steps.html#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># loading package</span></span>
<span id="cb58-6"><a href="fitting-germination-models-in-two-steps.html#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(drcSeedGerm)</span>
<span id="cb58-7"><a href="fitting-germination-models-in-two-steps.html#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb58-8"><a href="fitting-germination-models-in-two-steps.html#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb58-9"><a href="fitting-germination-models-in-two-steps.html#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span></code></pre></div>
</div>
<div id="description-of-models" class="section level3 hasAnchor" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Description of models<a href="fitting-germination-models-in-two-steps.html#description-of-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="grpsilin---grt.gh" class="section level4 hasAnchor" number="10.2.3.1">
<h4><span class="header-section-number">10.2.3.1</span> GRPsiLin() - GRT.GH()<a href="fitting-germination-models-in-two-steps.html#grpsilin---grt.gh" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The equation behind <code>GRPsiLin()</code> has been used to describe the effect of environmental humidity (<span class="math inline">\(\Psi\)</span>, in MPa) on germination rate (Bradford, 2002):</p>
<p><span class="math display">\[GR = \frac{\max\left[\Psi, \Psi_b\right] - \Psi_b}{\theta_H}\]</span></p>
<p>The parameter <span class="math inline">\(\Psi_b\)</span> is the <em>base water potential</em> (in MPa), representing the minimum level of humidity in the substrate to trigger the germination process. The other parameter <span class="math inline">\(\theta_H\)</span> (in MPa day or MPa hour) is the hydro-time constant.</p>
<p>A totally similar equation (with different parameter names) has been used by Garcia-Huidobro et al (1982), to describe the effect of sub-optimal temperatures (T in °C) on the germination rate:</p>
<p><span class="math display">\[GR = \frac{\max \left[T, T_b\right] - T_b}{\theta_T}\]</span></p>
<p>where <span class="math inline">\(T_b\)</span> is the base temperature and <span class="math inline">\(\theta_T\)</span> is the thermal time (in °C d). This second model is available <code>GRT.GH()</code>.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="fitting-germination-models-in-two-steps.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample code (not executed)</span></span>
<span id="cb59-2"><a href="fitting-germination-models-in-two-steps.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Tlev &lt;- c(2, 5, 10, 15, 20, 25)</span></span>
<span id="cb59-3"><a href="fitting-germination-models-in-two-steps.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># GR &lt;- c(0, 0, 0.21, 0.49, 0.68, 0.86)</span></span>
<span id="cb59-4"><a href="fitting-germination-models-in-two-steps.html#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># modGH &lt;- drm(GR ~ Tlev, fct = GRT.GH())</span></span>
<span id="cb59-5"><a href="fitting-germination-models-in-two-steps.html#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co"># library(sandwich); library(lmtest)</span></span>
<span id="cb59-6"><a href="fitting-germination-models-in-two-steps.html#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co"># coeftest(modGH, vcov = sandwich)</span></span>
<span id="cb59-7"><a href="fitting-germination-models-in-two-steps.html#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(modGH, log=&quot;&quot;, xlim = c(0, 25), legendPos = c(5, 1.2),</span></span>
<span id="cb59-8"><a href="fitting-germination-models-in-two-steps.html#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co">#      xlab = &quot;Temperature (°C)&quot;)</span></span></code></pre></div>
</div>
<div id="grpsipol---grpsipol2" class="section level4 hasAnchor" number="10.2.3.2">
<h4><span class="header-section-number">10.2.3.2</span> GRPsiPol() - GRPsiPol2()<a href="fitting-germination-models-in-two-steps.html#grpsipol---grpsipol2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In my experience, I have found that the relationship between GR and water potential in the substrate may, sometimes, be curvilinear. For these situations, I have successfully used the following equations:</p>
<p><span class="math display">\[GR = \frac{\max\left[\Psi,\Psi_b\right]^2 - \Psi^2_b}{\theta_H}\]</span></p>
<p>and:</p>
<p><span class="math display">\[GR = \frac{\left(\max\left[\Psi, \Psi_b\right] - \Psi_b \right)^2}{ \theta_H }\]</span></p>
<p>Both models can be fitted in R, by using the two functions <code>GRPsi.Pol()</code> and <code>GRPsi.Pol2()</code></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="fitting-germination-models-in-two-steps.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample code (not executed)</span></span>
<span id="cb60-2"><a href="fitting-germination-models-in-two-steps.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Psi &lt;- c(-2, -1.5, -1.2, -1, -0.8, -0.6, -0.4, -0.25,</span></span>
<span id="cb60-3"><a href="fitting-germination-models-in-two-steps.html#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">#          -0.12, -0.06, -0.03, 0)</span></span>
<span id="cb60-4"><a href="fitting-germination-models-in-two-steps.html#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># GR &lt;- c(0, 0, 0, 0, 0.0585, 0.094, 0.1231, 0.1351,</span></span>
<span id="cb60-5"><a href="fitting-germination-models-in-two-steps.html#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co">#         0.1418, 0.1453, 0.1458, 0.1459)</span></span>
<span id="cb60-6"><a href="fitting-germination-models-in-two-steps.html#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Psi2 &lt;- c(-0.5, -0.6, -0.7, -0.8, -0.9, -1, -1.1, -1.2,</span></span>
<span id="cb60-7"><a href="fitting-germination-models-in-two-steps.html#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co">#           -1.5)</span></span>
<span id="cb60-8"><a href="fitting-germination-models-in-two-steps.html#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co"># GR2 &lt;- c(1.4018, 1.0071, 0.5614, 0.3546, 0.2293, 0, 0,</span></span>
<span id="cb60-9"><a href="fitting-germination-models-in-two-steps.html#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co">#          0, 0)</span></span>
<span id="cb60-10"><a href="fitting-germination-models-in-two-steps.html#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb60-11"><a href="fitting-germination-models-in-two-steps.html#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb60-12"><a href="fitting-germination-models-in-two-steps.html#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="co"># modHT &lt;- drm(GR ~ Psi, fct = GRPsiPol())</span></span>
<span id="cb60-13"><a href="fitting-germination-models-in-two-steps.html#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co"># modHT2 &lt;- drm(GR2 ~ Psi2, fct = GRPsiPol2())</span></span>
<span id="cb60-14"><a href="fitting-germination-models-in-two-steps.html#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mfrow = c(1,2))</span></span>
<span id="cb60-15"><a href="fitting-germination-models-in-two-steps.html#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(modHT, log=&quot;&quot;, legendPos = c(-1.5, 0.15), </span></span>
<span id="cb60-16"><a href="fitting-germination-models-in-two-steps.html#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="co">#      ylim = c(0, 0.20), xlab = &quot;Water potential (MPa)&quot;)</span></span>
<span id="cb60-17"><a href="fitting-germination-models-in-two-steps.html#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(modHT2, log=&quot;&quot;, legendPos=c(-1.3, 1), </span></span>
<span id="cb60-18"><a href="fitting-germination-models-in-two-steps.html#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="co">#      xlab = &quot;Water potential (MPa)&quot;)</span></span></code></pre></div>
</div>
<div id="pmaxpsi1-and-pmaxt1" class="section level4 hasAnchor" number="10.2.3.3">
<h4><span class="header-section-number">10.2.3.3</span> PmaxPsi1() and PmaxT1()<a href="fitting-germination-models-in-two-steps.html#pmaxpsi1-and-pmaxt1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>All the previous models tend to go up to infinity when the predictor value (temperature or water potential) goes to infinity. In some instances, we may need an asymptotic model, to describe the response of the maximum proportion of germinated seeds to soil humidity (Onofri et al., 2018).</p>
<p>In practice, we could use a shifted exponential model:</p>
<p><span class="math display">\[ \pi = G \, \left[ 1 - exp \left( \frac{ \max\left[\Psi, \Psi_b\right] - \Psi_b }{\sigma} \right) \right]\]</span></p>
<p>where <span class="math inline">\(\pi\)</span> is the proportion of germinated seeds, <span class="math inline">\(G\)</span> is the fraction of non-germinable seeds (e.g., dormant seeds) and <span class="math inline">\(\sigma\)</span> describes how quickly the population of seeds responds to increased humidity in the substrate. This model can be fitted by using the R function the self-starters <code>PmaxPsi1()</code>.</p>
<p>If we reverse the sign of <span class="math inline">\(\sigma\)</span> in the previous equation, we obtain a decreasing trend, which might be useful to describe the effect of super-optimal temperatures on the proportion of germinated seeds, going down to 0 at the ceiling temperature threshold. Also this model is available in R, under the name <code>PmaxT1()</code>. <code>PmaxPsi1()</code> <code>PmaxT1()</code> are two equivalent R functions, apart from the name of model parameters.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="fitting-germination-models-in-two-steps.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample code (not executed)</span></span>
<span id="cb61-2"><a href="fitting-germination-models-in-two-steps.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mfrow = c(1,2))</span></span>
<span id="cb61-3"><a href="fitting-germination-models-in-two-steps.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # Pmax vs Psi</span></span>
<span id="cb61-4"><a href="fitting-germination-models-in-two-steps.html#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Psi &lt;- seq(-2.2, 0, by = 0.2)</span></span>
<span id="cb61-5"><a href="fitting-germination-models-in-two-steps.html#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pmax &lt;- c(0, 0, 0.076, 0.413, 0.514, 0.643, 0.712,</span></span>
<span id="cb61-6"><a href="fitting-germination-models-in-two-steps.html#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co">#           0.832, 0.865, 0.849, 0.89, 0.90)</span></span>
<span id="cb61-7"><a href="fitting-germination-models-in-two-steps.html#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># mod &lt;- drm(Pmax ~ Psi, fct = PmaxPsi1())</span></span>
<span id="cb61-8"><a href="fitting-germination-models-in-two-steps.html#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mod, log = &quot;&quot;, xlab = &quot;Water potential (MPa)&quot;, </span></span>
<span id="cb61-9"><a href="fitting-germination-models-in-two-steps.html#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co">#      ylab = &quot;Proportion of germinating seeds&quot;)</span></span>
<span id="cb61-10"><a href="fitting-germination-models-in-two-steps.html#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb61-11"><a href="fitting-germination-models-in-two-steps.html#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # Pmax vs temperature</span></span>
<span id="cb61-12"><a href="fitting-germination-models-in-two-steps.html#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Tval &lt;- c(0, 2.5, 5, 7.5, 10, 12.5, 15, 17.5,</span></span>
<span id="cb61-13"><a href="fitting-germination-models-in-two-steps.html#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="co">#           20, 22.5, 25, 27.5, 30, 32.5, 35)</span></span>
<span id="cb61-14"><a href="fitting-germination-models-in-two-steps.html#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Pmax2 &lt;- c(0.79, 0.81, 0.807, 0.776, 0.83,</span></span>
<span id="cb61-15"><a href="fitting-germination-models-in-two-steps.html#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="co">#            0.73, 0.744, 0.73, 0.828, 0.818,</span></span>
<span id="cb61-16"><a href="fitting-germination-models-in-two-steps.html#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="co">#            0.805, 0.706, 0.41, 0.002, 0)</span></span>
<span id="cb61-17"><a href="fitting-germination-models-in-two-steps.html#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="co"># mod2 &lt;- drm(Pmax2 ~ Tval, fct = PmaxT1())</span></span>
<span id="cb61-18"><a href="fitting-germination-models-in-two-steps.html#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mod2, log = &quot;&quot;, xlab = &quot;Temperature (°C)&quot;, </span></span>
<span id="cb61-19"><a href="fitting-germination-models-in-two-steps.html#cb61-19" aria-hidden="true" tabindex="-1"></a><span class="co">#      ylab = &quot;Proportion of germinating seeds&quot;)</span></span></code></pre></div>
</div>
<div id="grt.bs" class="section level4 hasAnchor" number="10.2.3.4">
<h4><span class="header-section-number">10.2.3.4</span> GRT.BS()<a href="fitting-germination-models-in-two-steps.html#grt.bs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A broken-stick trend, as the one depicted in the first Figure above was used by Alvarado and Bradford (2002) to model the effect of temperature on the germination rate. Their equation is:</p>
<p><span class="math display">\[GR = \frac{\max \left[\min \left[T,T_o \right], Tb \right] - T_b}{\theta_{T}} \, \left\{ 1 - k \left( \max \left[ T,T_o \right] - T_o \right) \right\}\]</span>
The right factor is only meaningful when it is positive, that happens when <span class="math inline">\(T &lt; T_c\)</span>, i.e. when the environmental temperature is lower than the ceiling temperature. On this basis, the ceiling temperature is equal to:</p>
<p><span class="math display">\[ T_c = \frac{1}{k} + T_o\]</span></p>
<p>The above equation can be easily fitted with the <code>GRT.BS()</code> function in the ‘drcSeedGerm’ package. We have also implemented the reparameterised equation, where the parameter ‘k’ is replaced with <span class="math inline">\(1/(T_c - T_b)\)</span>:</p>
<p><span class="math display">\[GR = \frac{\min \left[T,T_o \right] - T_b}{\theta_{T}} \, \left\{ 1 - \frac {\min \left[\max \left[ T,T_o \right], T_c \right] - T_o}{T_c - T_o} \right\}\]</span></p>
<p>This reparameterised equation is available as <code>GRT.BSb()</code>; it is handy, because the ceiling temperature is included as a parameter, but its fitting properties are not as good as those of the previous equation.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="fitting-germination-models-in-two-steps.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample code</span></span>
<span id="cb62-2"><a href="fitting-germination-models-in-two-steps.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Tval &lt;- c(2, 5, 10, 15, 20, 25, 30, 35, 40)</span></span>
<span id="cb62-3"><a href="fitting-germination-models-in-two-steps.html#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># GR &lt;- c(0, 0, 0.209, 0.435, 0.759, 0.821, 0.417, 0.145, 0)</span></span>
<span id="cb62-4"><a href="fitting-germination-models-in-two-steps.html#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb62-5"><a href="fitting-germination-models-in-two-steps.html#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># modBS &lt;- drm(GR ~ Tval, fct = GRT.BS())</span></span>
<span id="cb62-6"><a href="fitting-germination-models-in-two-steps.html#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(modBS, log=&quot;&quot;, xlim = c(0, 40), ylim=c(0,1.2),</span></span>
<span id="cb62-7"><a href="fitting-germination-models-in-two-steps.html#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co">#      legendPos = c(5, 1.0), xlab = &quot;Temperature (°C)&quot;)</span></span>
<span id="cb62-8"><a href="fitting-germination-models-in-two-steps.html#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co"># coeftest(modBS, vcov = sandwich)</span></span>
<span id="cb62-9"><a href="fitting-germination-models-in-two-steps.html#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb62-10"><a href="fitting-germination-models-in-two-steps.html#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # Reparameterised (self-starter is less accurate)</span></span>
<span id="cb62-11"><a href="fitting-germination-models-in-two-steps.html#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># modBS &lt;- drm(GR ~ Tval, fct = GRT.BSb())</span></span>
<span id="cb62-12"><a href="fitting-germination-models-in-two-steps.html#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(modBS, log=&quot;&quot;, xlim = c(0, 40), ylim=c(0,1.2),</span></span>
<span id="cb62-13"><a href="fitting-germination-models-in-two-steps.html#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co">#      legendPos = c(5, 1.0), xlab = &quot;Temperature (°C)&quot;)</span></span>
<span id="cb62-14"><a href="fitting-germination-models-in-two-steps.html#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co"># coeftest(modBS, vcov = sandwich)</span></span></code></pre></div>
</div>
<div id="grt.rf" class="section level4 hasAnchor" number="10.2.3.5">
<h4><span class="header-section-number">10.2.3.5</span> GRT.RF()<a href="fitting-germination-models-in-two-steps.html#grt.rf" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Broken-stick trends may not be reasonable for biological processes, which might be better described by curvilinear equations. Rowse and Finch-Savage (2003) proposed another equation with two components: the first one depicts a linear increase of the GR value with temperature, which is off-set by the second component, starting from <span class="math inline">\(T = T_d\)</span>, which is close to (but not coincident with) <span class="math inline">\(T_o\)</span>. The equation is:</p>
<p><span class="math display">\[GR = \frac{ \max \left( T, T_b \right) - T_b}{\theta_{T}} \left\{ 1 - k \left[ \max \left(T,T_d\right) - T_d \right] \right\}\]</span>
The optimal temperature can be derived as:</p>
<p><span class="math display">\[ T_o = \frac{1 + kT_b + kT_d}{2k}\]</span>
while the ceiling temperature is:</p>
<p><span class="math display">\[ T_c = \frac{1}{k} + T_d\]</span></p>
<p>For this equation, you will find the <code>GRT.RF()</code> self-starter in the ‘drcSeedGerm’ package. We also provide the self-starter <code>GRT.RFb()</code>, where the parameters ‘k’ is replaced by $ 1/(T_c - T_d)$:</p>
<p><span class="math display">\[GR = \frac{ \max \left[ T, T_b \right] - T_b}{\theta_{T}} \left\{ 1 - \frac{\left[ \max \left(T,T_d\right) - T_d \right]}{T_c - T_d}  \right\}\]</span></p>
<p>This reparameterised equation contains the ceiling temperature as a parameter, but its fitting properties are as good as those pf the previous equation.</p>
</div>
<div id="grt.m" class="section level4 hasAnchor" number="10.2.3.6">
<h4><span class="header-section-number">10.2.3.6</span> GRT.M()<a href="fitting-germination-models-in-two-steps.html#grt.m" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>According to Mesgaran et al (2017), the negative and positive effects of temperature coexist for all temperatures above <span class="math inline">\(T_b\)</span>. Their proposed equation is:</p>
<p><span class="math display">\[GR = \frac{ \max \left( T, T_b \right) - T_b}{\theta_{T}} \left\{ 1 - k \left[ \min \left(T,T_c\right) - T_b \right] \right\}\]</span>
This equation is only defined from base to ceiling temperature, while it is 0 elsewhere. The ceiling temperature is:</p>
<p><span class="math display">\[ T_c = \frac{1}{k} + T_b\]</span></p>
<p>It is also easy to see that the GR value is a second-order polynomial function of <span class="math inline">\(T - T_b\)</span> and, therefore, the curve is symmetric around the optimal temperature value, which can be derived as:</p>
<p><span class="math display">\[T_o = \frac{T_c - T_b}{2} + T_b\]</span></p>
<p>For this model, the self-starting function in <code>drcSeedGerm</code> is <code>GRT.M()</code>. The model can also be reparameterised to include the ceiling temperature as an explicit parameter:</p>
<p><span class="math display">\[GR = \frac{\max \left[ T, T_b \right] - T_b}{\theta_{T}} \left[ 1 - \frac{\min \left[ T, T_c \right] - T_b}{T_c - T_b}  \right]\]</span>
This reparameterised model is available as <code>GRT.Mb()</code>.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="fitting-germination-models-in-two-steps.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample code (not executed)</span></span>
<span id="cb63-2"><a href="fitting-germination-models-in-two-steps.html#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Tval &lt;- c(2, 5, 10, 15, 20, 25, 30, 35, 40)</span></span>
<span id="cb63-3"><a href="fitting-germination-models-in-two-steps.html#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># GR &lt;- c(0, 0, 0.209, 0.435, 0.759, 0.821, 0.417, 0.145, 0)</span></span>
<span id="cb63-4"><a href="fitting-germination-models-in-two-steps.html#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># modM &lt;- drm(GR ~ Tval, fct = GRT.Mb())</span></span>
<span id="cb63-5"><a href="fitting-germination-models-in-two-steps.html#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(modM, log=&quot;&quot;, xlim = c(0, 40), ylim=c(0,1.2),</span></span>
<span id="cb63-6"><a href="fitting-germination-models-in-two-steps.html#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co">#      legendPos = c(5, 1.0), xlab = &quot;Temperature (°C)&quot;)</span></span>
<span id="cb63-7"><a href="fitting-germination-models-in-two-steps.html#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># coeftest(modM, vcov. = sandwich)</span></span></code></pre></div>
</div>
<div id="grt.ex" class="section level4 hasAnchor" number="10.2.3.7">
<h4><span class="header-section-number">10.2.3.7</span> GRT.Ex()<a href="fitting-germination-models-in-two-steps.html#grt.ex" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>All the equations above use a product, wherein the first term represents the accumulation of thermal time and the second term may be seen as a switch-off term that is 1 either when <span class="math inline">\(T &lt; T_o\)</span> (Alvarado-Bradford equation) or <span class="math inline">\(T &lt; T_d\)</span> (Rowse-Fintch-Savage equation) or <span class="math inline">\(T = T_b\)</span> (Mesgaran equation) and decreases progressively as temperature increases. In all the above equations, the switch-off term is linear, although we can use other types of switch-off terms, to obtain more flexible models. One possibility is to use an exponential switch-off term, as in the equation below:</p>
<p><span class="math display">\[ GR = \frac{\max \left[T, T_b \right] - T_b}{\theta_T} \left\{ \frac{1 - \exp \left[ k (\min \left[T, T_c \right] - T_c) \right]}{1 - \exp \left[ k (T_b - T_c) \right]}  \right\}\]</span></p>
<p>where <span class="math inline">\(k\)</span> is the switch-off parameter: the lower the value, the higher the negative effect of temperature at super-optimal levels. The response of GR to temperature is highly asymmetric with a slow increase below <span class="math inline">\(T_o\)</span> and a steep drop afterwards.</p>
<p>I have successfully used this model in Catara et al (2016) and Masin et al (2017). The self-starting function in R is <code>GRT.Ex()</code>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="fitting-germination-models-in-two-steps.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample code</span></span>
<span id="cb64-2"><a href="fitting-germination-models-in-two-steps.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Tval &lt;- c(2, 5, 10, 15, 20, 25, 30, 35, 40)</span></span>
<span id="cb64-3"><a href="fitting-germination-models-in-two-steps.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># GR &lt;- c(0, 0, 0.209, 0.435, 0.759, 0.821, 0.917, 0.445, 0)</span></span>
<span id="cb64-4"><a href="fitting-germination-models-in-two-steps.html#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb64-5"><a href="fitting-germination-models-in-two-steps.html#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># modExb &lt;- drm(GR ~ Tval, fct = GRT.Ex())</span></span>
<span id="cb64-6"><a href="fitting-germination-models-in-two-steps.html#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(modExb)</span></span>
<span id="cb64-7"><a href="fitting-germination-models-in-two-steps.html#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(modExb, log=&quot;&quot;, xlim = c(0, 40), ylim=c(0,1.2),</span></span>
<span id="cb64-8"><a href="fitting-germination-models-in-two-steps.html#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     legendPos = c(5, 1.0), xlab = &quot;Temperature (°C)&quot;)</span></span></code></pre></div>
<p><a href="fitting-germination-models-in-two-steps.html#a-possibly-incomplete-list-of-threshold-models">Go up</a></p>
<hr />
</div>
<div id="grt.yl" class="section level4 hasAnchor" number="10.2.3.8">
<h4><span class="header-section-number">10.2.3.8</span> GRT.YL()<a href="fitting-germination-models-in-two-steps.html#grt.yl" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another switch-off function can be derived from the simple yield loss function devised by Kropff and van Laar (1993). It is very flexible, as it may depict different types of relationships between temperature and base water potential, according to the value taken by the parameter <span class="math inline">\(q\)</span>.</p>
<p><span class="math display">\[GR(g, T) = \frac{\max \left[T, T_b\right] - T_b}{\theta_T} \left( 1 - \frac{q \frac{\min \left[T, T_c\right] -T_b}{T_c- T_b} }{1 + (q-1) \frac{T-T_b}{T_c- T_b}}  \right)\]</span></p>
<p>In R, this model can be fitted by using the self-starter <code>GRT.YL()</code>.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="fitting-germination-models-in-two-steps.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample code</span></span>
<span id="cb65-2"><a href="fitting-germination-models-in-two-steps.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Tval &lt;- c(2, 5, 10, 15, 20, 25, 30, 35, 40)</span></span>
<span id="cb65-3"><a href="fitting-germination-models-in-two-steps.html#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># GR &lt;- c(0, 0, 0.209, 0.435, 0.759, 0.821, 0.917, 0.445, 0)</span></span>
<span id="cb65-4"><a href="fitting-germination-models-in-two-steps.html#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># modYL &lt;- drm(GR ~ Tval, fct = GRT.YL())</span></span>
<span id="cb65-5"><a href="fitting-germination-models-in-two-steps.html#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(modYL, log=&quot;&quot;, xlim = c(0, 40), ylim=c(0,1.2),</span></span>
<span id="cb65-6"><a href="fitting-germination-models-in-two-steps.html#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co">#      legendPos = c(5, 1.0), xlab = &quot;Temperature (°C)&quot;)</span></span></code></pre></div>
<p><a href="fitting-germination-models-in-two-steps.html#a-possibly-incomplete-list-of-threshold-models">Go up</a></p>
<hr />
</div>
</div>
<div id="example-1" class="section level3 hasAnchor" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> Example 1<a href="fitting-germination-models-in-two-steps.html#example-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This dataset describes the germination of rapeseed (cv. Excalibur) at different water potential levels in the substrate. It has been already used for fitting a hydro-time model in one step (<a href="https://www.statforbiology.com/2022/stat_drcte_6-ht1step/">see here</a>); in this present post, we try a different line of attack.</p>
<p>First of all, we remove all dishes with water potential levels higher than -0.7 MPa, because the germinations were too quick to obtain a reliable estimate of the whole time-to-event curve. Next, we independently (‘separate = T’) fit a time to event model to the data observed in each dish. Lately, for each time to event curve, we retrieve the maximum proportion of germinated seeds (Pmax, i.e. the ‘d’ parameter of the time-to-event curve) and the germination rates for the 10<sup>th</sup>, 30<sup>th</sup> and 50<sup>th</sup> percentile.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="fitting-germination-models-in-two-steps.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First-step of data analyses</span></span>
<span id="cb66-2"><a href="fitting-germination-models-in-two-steps.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(rape2G)</span>
<span id="cb66-3"><a href="fitting-germination-models-in-two-steps.html#cb66-3" aria-hidden="true" tabindex="-1"></a>rape2G <span class="ot">&lt;-</span> rape2G <span class="sc">%&gt;%</span> </span>
<span id="cb66-4"><a href="fitting-germination-models-in-two-steps.html#cb66-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Psi <span class="sc">&lt;=-</span><span class="fl">0.7</span> <span class="sc">&amp;</span> CV <span class="sc">==</span> <span class="st">&quot;Excalibur&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb66-5"><a href="fitting-germination-models-in-two-steps.html#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dish2 =</span> <span class="fu">paste</span>(Dish, Psi, <span class="at">sep =</span> <span class="st">&quot;:&quot;</span>))</span>
<span id="cb66-6"><a href="fitting-germination-models-in-two-steps.html#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="fitting-germination-models-in-two-steps.html#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># model fit</span></span>
<span id="cb66-8"><a href="fitting-germination-models-in-two-steps.html#cb66-8" aria-hidden="true" tabindex="-1"></a>mod.first <span class="ot">&lt;-</span> <span class="fu">drmte</span>(nSeeds <span class="sc">~</span> timeBef <span class="sc">+</span> timeAf, </span>
<span id="cb66-9"><a href="fitting-germination-models-in-two-steps.html#cb66-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> rape2G,</span>
<span id="cb66-10"><a href="fitting-germination-models-in-two-steps.html#cb66-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fct =</span> <span class="fu">LL.3</span>(), <span class="at">curveid =</span> Dish2, </span>
<span id="cb66-11"><a href="fitting-germination-models-in-two-steps.html#cb66-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">separate =</span> T)</span>
<span id="cb66-12"><a href="fitting-germination-models-in-two-steps.html#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="fitting-germination-models-in-two-steps.html#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve maximum proportion of germinated seeds</span></span>
<span id="cb66-14"><a href="fitting-germination-models-in-two-steps.html#cb66-14" aria-hidden="true" tabindex="-1"></a>Pmax <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod.first)[<span class="fu">substr</span>(<span class="fu">names</span>(<span class="fu">coef</span>(mod.first)), <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">==</span> <span class="st">&quot;d&quot;</span>]</span>
<span id="cb66-15"><a href="fitting-germination-models-in-two-steps.html#cb66-15" aria-hidden="true" tabindex="-1"></a>PmaxList <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Pmax =</span>  Pmax) <span class="sc">%&gt;%</span> </span>
<span id="cb66-16"><a href="fitting-germination-models-in-two-steps.html#cb66-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp =</span> <span class="fu">names</span>(Pmax), <span class="at">.before =</span> Pmax) <span class="sc">%&gt;%</span> </span>
<span id="cb66-17"><a href="fitting-germination-models-in-two-steps.html#cb66-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> <span class="st">&quot;temp&quot;</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span>, <span class="st">&quot;Dish&quot;</span>, <span class="st">&quot;Psi&quot;</span>),</span>
<span id="cb66-18"><a href="fitting-germination-models-in-two-steps.html#cb66-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">sep =</span> <span class="st">&quot;:&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb66-19"><a href="fitting-germination-models-in-two-steps.html#cb66-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Psi =</span> <span class="fu">as.numeric</span>(Psi)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-20"><a href="fitting-germination-models-in-two-steps.html#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb66-21"><a href="fitting-germination-models-in-two-steps.html#cb66-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(PmaxList)</span>
<span id="cb66-22"><a href="fitting-germination-models-in-two-steps.html#cb66-22" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 6 × 3</span></span>
<span id="cb66-23"><a href="fitting-germination-models-in-two-steps.html#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="do">##   Dish    Psi  Pmax</span></span>
<span id="cb66-24"><a href="fitting-germination-models-in-two-steps.html#cb66-24" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb66-25"><a href="fitting-germination-models-in-two-steps.html#cb66-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 64     -0.7 0.901</span></span>
<span id="cb66-26"><a href="fitting-germination-models-in-two-steps.html#cb66-26" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 65     -0.7 0.986</span></span>
<span id="cb66-27"><a href="fitting-germination-models-in-two-steps.html#cb66-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 66     -0.7 0.922</span></span>
<span id="cb66-28"><a href="fitting-germination-models-in-two-steps.html#cb66-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 67     -0.8 0.914</span></span>
<span id="cb66-29"><a href="fitting-germination-models-in-two-steps.html#cb66-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 68     -0.8 0.887</span></span>
<span id="cb66-30"><a href="fitting-germination-models-in-two-steps.html#cb66-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 6 69     -0.8 0.835</span></span>
<span id="cb66-31"><a href="fitting-germination-models-in-two-steps.html#cb66-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve the GR values</span></span>
<span id="cb66-32"><a href="fitting-germination-models-in-two-steps.html#cb66-32" aria-hidden="true" tabindex="-1"></a>GR <span class="ot">&lt;-</span> <span class="fu">quantile</span>(mod.first, <span class="at">rate =</span> T, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>))</span>
<span id="cb66-33"><a href="fitting-germination-models-in-two-steps.html#cb66-33" aria-hidden="true" tabindex="-1"></a>GRlist <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">temp =</span> <span class="fu">row.names</span>(GR), GR, <span class="at">row.names =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb66-34"><a href="fitting-germination-models-in-two-steps.html#cb66-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> <span class="st">&quot;temp&quot;</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;Dish&quot;</span>, <span class="st">&quot;Psi&quot;</span>, <span class="st">&quot;g&quot;</span>),</span>
<span id="cb66-35"><a href="fitting-germination-models-in-two-steps.html#cb66-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">sep =</span> <span class="st">&quot;:&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb66-36"><a href="fitting-germination-models-in-two-steps.html#cb66-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Psi =</span> <span class="fu">as.numeric</span>(Psi)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-37"><a href="fitting-germination-models-in-two-steps.html#cb66-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_rownames</span>()</span>
<span id="cb66-38"><a href="fitting-germination-models-in-two-steps.html#cb66-38" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(GRlist)</span>
<span id="cb66-39"><a href="fitting-germination-models-in-two-steps.html#cb66-39" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 6 × 5</span></span>
<span id="cb66-40"><a href="fitting-germination-models-in-two-steps.html#cb66-40" aria-hidden="true" tabindex="-1"></a><span class="do">##   Dish    Psi g     Estimate     SE</span></span>
<span id="cb66-41"><a href="fitting-germination-models-in-two-steps.html#cb66-41" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb66-42"><a href="fitting-germination-models-in-two-steps.html#cb66-42" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 64     -0.7 10%      0.581 0.0895</span></span>
<span id="cb66-43"><a href="fitting-germination-models-in-two-steps.html#cb66-43" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 64     -0.7 30%      0.416 0.0397</span></span>
<span id="cb66-44"><a href="fitting-germination-models-in-two-steps.html#cb66-44" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 64     -0.7 50%      0.333 0.0239</span></span>
<span id="cb66-45"><a href="fitting-germination-models-in-two-steps.html#cb66-45" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 65     -0.7 10%      0.718 0.149 </span></span>
<span id="cb66-46"><a href="fitting-germination-models-in-two-steps.html#cb66-46" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 65     -0.7 30%      0.468 0.0595</span></span>
<span id="cb66-47"><a href="fitting-germination-models-in-two-steps.html#cb66-47" aria-hidden="true" tabindex="-1"></a><span class="do">## 6 65     -0.7 50%      0.357 0.0330</span></span></code></pre></div>
<p>Now, we are ready to move on to the second step of data analysis. Relating to the Pmax value, we can see that this values stays constant and equal to 0 up to -1 MPa and increases steadily afterwords. We can model this behaviour by using the <code>PmaxPsi1()</code> function, as shown in the box below.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="fitting-germination-models-in-two-steps.html#cb67-1" aria-hidden="true" tabindex="-1"></a>modPmax <span class="ot">&lt;-</span> <span class="fu">drm</span>(Pmax <span class="sc">~</span> Psi, <span class="at">data =</span> PmaxList,</span>
<span id="cb67-2"><a href="fitting-germination-models-in-two-steps.html#cb67-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">fct =</span> <span class="fu">PmaxPsi1</span>())</span>
<span id="cb67-3"><a href="fitting-germination-models-in-two-steps.html#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modPmax, <span class="at">log =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="_seedGerminationTutorial_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="fitting-germination-models-in-two-steps.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(modPmax, <span class="at">vcov. =</span> sandwich)</span>
<span id="cb68-2"><a href="fitting-germination-models-in-two-steps.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb68-3"><a href="fitting-germination-models-in-two-steps.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="do">## t test of coefficients:</span></span>
<span id="cb68-4"><a href="fitting-germination-models-in-two-steps.html#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb68-5"><a href="fitting-germination-models-in-two-steps.html#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="do">##                     Estimate Std. Error   t value  Pr(&gt;|t|)    </span></span>
<span id="cb68-6"><a href="fitting-germination-models-in-two-steps.html#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="do">## G:(Intercept)      1.0737381  0.0746708   14.3796 2.608e-11 ***</span></span>
<span id="cb68-7"><a href="fitting-germination-models-in-two-steps.html#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Psib:(Intercept)  -1.0053956  0.0016495 -609.5109 &lt; 2.2e-16 ***</span></span>
<span id="cb68-8"><a href="fitting-germination-models-in-two-steps.html#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma:(Intercept)  0.1367469  0.0272873    5.0114 9.058e-05 ***</span></span>
<span id="cb68-9"><a href="fitting-germination-models-in-two-steps.html#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb68-10"><a href="fitting-germination-models-in-two-steps.html#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Regarding the germination percentiles, a look at the data shows that, for all percentiles, germination rates stay constant up to -1 MPa and, afterwords, they increase linearly. We can model this behaviour by using the <code>GRPsiLin()</code> equation and, following Bradford (2002), we code a common base water potential level for the different germination percentiles. The code is given in the box below.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="fitting-germination-models-in-two-steps.html#cb69-1" aria-hidden="true" tabindex="-1"></a>modGR <span class="ot">&lt;-</span> <span class="fu">drm</span>(Estimate <span class="sc">~</span> Psi, <span class="at">data =</span> GRlist,</span>
<span id="cb69-2"><a href="fitting-germination-models-in-two-steps.html#cb69-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">fct =</span> <span class="fu">GRPsi.Lin</span>(), <span class="at">curveid =</span> g,</span>
<span id="cb69-3"><a href="fitting-germination-models-in-two-steps.html#cb69-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">pmodels =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span>g <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb69-4"><a href="fitting-germination-models-in-two-steps.html#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modGR, <span class="at">log =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb69-5"><a href="fitting-germination-models-in-two-steps.html#cb69-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">legendPos =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="fl">0.7</span>))</span></code></pre></div>
<p><img src="_seedGerminationTutorial_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="fitting-germination-models-in-two-steps.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(modGR, <span class="at">vcov. =</span> sandwich)</span>
<span id="cb70-2"><a href="fitting-germination-models-in-two-steps.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb70-3"><a href="fitting-germination-models-in-two-steps.html#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="do">## t test of coefficients:</span></span>
<span id="cb70-4"><a href="fitting-germination-models-in-two-steps.html#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb70-5"><a href="fitting-germination-models-in-two-steps.html#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="do">##                   Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb70-6"><a href="fitting-germination-models-in-two-steps.html#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Psib:(Intercept) -0.989504   0.031937 -30.9832 &lt; 2.2e-16 ***</span></span>
<span id="cb70-7"><a href="fitting-germination-models-in-two-steps.html#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="do">## thetaH:g10%       0.446550   0.081366   5.4881 8.977e-07 ***</span></span>
<span id="cb70-8"><a href="fitting-germination-models-in-two-steps.html#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="do">## thetaH:g30%       0.649827   0.099213   6.5498 1.557e-08 ***</span></span>
<span id="cb70-9"><a href="fitting-germination-models-in-two-steps.html#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="do">## thetaH:g50%       0.852974   0.134058   6.3627 3.209e-08 ***</span></span>
<span id="cb70-10"><a href="fitting-germination-models-in-two-steps.html#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb70-11"><a href="fitting-germination-models-in-two-steps.html#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Usually, we are interested in the base osmotic potential level (<span class="math inline">\(\Psi_b\)</span>) that is given in the output of the <code>coeftest()</code> method. We used <code>coeftest()</code> in the <code>lmtest</code> package for reasons that will be clearer later on.</p>
</div>
<div id="example-2" class="section level3 hasAnchor" number="10.2.5">
<h3><span class="header-section-number">10.2.5</span> Example 2<a href="fitting-germination-models-in-two-steps.html#example-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This second dataset was obtained from a germination assays with barley, where three replicates of 50 seeds were placed in Petri dishes and assayed at 9 constant temperature levels (1, 3, 7, 10, 15, 20, 25, 30, 35, 40 °C). Germinated seeds were counted and removed daily for 10 days. We have already presented this analysis in a previous paper (Onofri et al., 2018), although in this post we use a different (and updated) coding.</p>
<p>Also in this second example, the first step of data analysis is based on loading the data and fitting a separate time-to-event curve to the data at each temperature level.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="fitting-germination-models-in-two-steps.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(barley)</span>
<span id="cb71-2"><a href="fitting-germination-models-in-two-steps.html#cb71-2" aria-hidden="true" tabindex="-1"></a>barley <span class="ot">&lt;-</span> barley <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="fitting-germination-models-in-two-steps.html#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TempF =</span> <span class="fu">factor</span>(Temp))</span>
<span id="cb71-4"><a href="fitting-germination-models-in-two-steps.html#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="fitting-germination-models-in-two-steps.html#cb71-5" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">drmte</span>(nSeeds <span class="sc">~</span> timeBef <span class="sc">+</span> timeAf, <span class="at">fct=</span><span class="fu">W2.3</span>(),</span>
<span id="cb71-6"><a href="fitting-germination-models-in-two-steps.html#cb71-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">curveid =</span> TempF,</span>
<span id="cb71-7"><a href="fitting-germination-models-in-two-steps.html#cb71-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> barley,</span>
<span id="cb71-8"><a href="fitting-germination-models-in-two-steps.html#cb71-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">separate =</span> T)</span></code></pre></div>
<p>Now, we retrieve the germination rates for the 10^th, 30<sup>th</sup> and 50<sup>th</sup> percentile; for analogy with the published paper, we restrict the percentiles to the germinated fraction, althoug it might be better to avoid such a restriction.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="fitting-germination-models-in-two-steps.html#cb72-1" aria-hidden="true" tabindex="-1"></a>GR <span class="ot">&lt;-</span> <span class="fu">quantile</span>(mod1, <span class="at">rate =</span> T, <span class="at">restricted =</span> T, </span>
<span id="cb72-2"><a href="fitting-germination-models-in-two-steps.html#cb72-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>),</span>
<span id="cb72-3"><a href="fitting-germination-models-in-two-steps.html#cb72-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">display =</span> F)</span>
<span id="cb72-4"><a href="fitting-germination-models-in-two-steps.html#cb72-4" aria-hidden="true" tabindex="-1"></a>GRlist <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">temp =</span> <span class="fu">row.names</span>(GR), GR, <span class="at">row.names =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb72-5"><a href="fitting-germination-models-in-two-steps.html#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> <span class="st">&quot;temp&quot;</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;Temp&quot;</span>, <span class="st">&quot;g&quot;</span>),</span>
<span id="cb72-6"><a href="fitting-germination-models-in-two-steps.html#cb72-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">sep =</span> <span class="st">&quot;:&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb72-7"><a href="fitting-germination-models-in-two-steps.html#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Temp =</span> <span class="fu">as.numeric</span>(Temp)) <span class="sc">%&gt;%</span> </span>
<span id="cb72-8"><a href="fitting-germination-models-in-two-steps.html#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_rownames</span>()</span>
<span id="cb72-9"><a href="fitting-germination-models-in-two-steps.html#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(GRlist)</span>
<span id="cb72-10"><a href="fitting-germination-models-in-two-steps.html#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 6 × 4</span></span>
<span id="cb72-11"><a href="fitting-germination-models-in-two-steps.html#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="do">##    Temp g     Estimate      SE</span></span>
<span id="cb72-12"><a href="fitting-germination-models-in-two-steps.html#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb72-13"><a href="fitting-germination-models-in-two-steps.html#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1 10%     0.0982 0.00328</span></span>
<span id="cb72-14"><a href="fitting-germination-models-in-two-steps.html#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     1 30%     0.0777 0.00177</span></span>
<span id="cb72-15"><a href="fitting-germination-models-in-two-steps.html#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     1 50%     0.0682 0.00125</span></span>
<span id="cb72-16"><a href="fitting-germination-models-in-two-steps.html#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 4     3 10%     0.124  0.00307</span></span>
<span id="cb72-17"><a href="fitting-germination-models-in-two-steps.html#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 5     3 30%     0.105  0.00173</span></span>
<span id="cb72-18"><a href="fitting-germination-models-in-two-steps.html#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 6     3 50%     0.0962 0.00126</span></span></code></pre></div>
<p>The behaviour of germination rates against temperature can be described, e.g., by using the threshold model proposed by Masin et al. (2017), that is implemented in the R function <code>GRT.Ex()</code>, as shown in the box below. Preliminary trials show that the three percentiles share the same ‘k’ parameter and base temperature level, which we can request by using the ‘pmodels’ argument.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="fitting-germination-models-in-two-steps.html#cb73-1" aria-hidden="true" tabindex="-1"></a>modGR <span class="ot">&lt;-</span> <span class="fu">drm</span>(Estimate <span class="sc">~</span> Temp, <span class="at">data =</span> GRlist,</span>
<span id="cb73-2"><a href="fitting-germination-models-in-two-steps.html#cb73-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">fct =</span> <span class="fu">GRT.Ex</span>(),</span>
<span id="cb73-3"><a href="fitting-germination-models-in-two-steps.html#cb73-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">curveid =</span> g, <span class="at">pmodels =</span> <span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span>g <span class="sc">-</span> <span class="dv">1</span>, <span class="sc">~</span>g <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb73-4"><a href="fitting-germination-models-in-two-steps.html#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(modGR, <span class="at">vcov. =</span> sandwich)</span>
<span id="cb73-5"><a href="fitting-germination-models-in-two-steps.html#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb73-6"><a href="fitting-germination-models-in-two-steps.html#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="do">## t test of coefficients:</span></span>
<span id="cb73-7"><a href="fitting-germination-models-in-two-steps.html#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb73-8"><a href="fitting-germination-models-in-two-steps.html#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="do">##                 Estimate Std. Error   t value  Pr(&gt;|t|)    </span></span>
<span id="cb73-9"><a href="fitting-germination-models-in-two-steps.html#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="do">## k:(Intercept)   0.876849   0.138731    6.3205 4.577e-06 ***</span></span>
<span id="cb73-10"><a href="fitting-germination-models-in-two-steps.html#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Tb:(Intercept) -0.553318   0.774412   -0.7145    0.4836    </span></span>
<span id="cb73-11"><a href="fitting-germination-models-in-two-steps.html#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Tc:g10%        35.200942   0.021761 1617.5850 &lt; 2.2e-16 ***</span></span>
<span id="cb73-12"><a href="fitting-germination-models-in-two-steps.html#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Tc:g30%        33.235421   0.321386  103.4129 &lt; 2.2e-16 ***</span></span>
<span id="cb73-13"><a href="fitting-germination-models-in-two-steps.html#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Tc:g50%        32.198489   0.225161  143.0021 &lt; 2.2e-16 ***</span></span>
<span id="cb73-14"><a href="fitting-germination-models-in-two-steps.html#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="do">## ThetaT:g10%    25.454497   1.788195   14.2347 1.378e-11 ***</span></span>
<span id="cb73-15"><a href="fitting-germination-models-in-two-steps.html#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="do">## ThetaT:g30%    40.458899   2.001762   20.2116 2.630e-14 ***</span></span>
<span id="cb73-16"><a href="fitting-germination-models-in-two-steps.html#cb73-16" aria-hidden="true" tabindex="-1"></a><span class="do">## ThetaT:g50%    51.413920   2.415663   21.2836 1.025e-14 ***</span></span>
<span id="cb73-17"><a href="fitting-germination-models-in-two-steps.html#cb73-17" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb73-18"><a href="fitting-germination-models-in-two-steps.html#cb73-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb73-19"><a href="fitting-germination-models-in-two-steps.html#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modGR, <span class="at">log =</span> <span class="st">&quot;&quot;</span>, <span class="at">type =</span> <span class="st">&quot;all&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>),</span>
<span id="cb73-20"><a href="fitting-germination-models-in-two-steps.html#cb73-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.3</span>),</span>
<span id="cb73-21"><a href="fitting-germination-models-in-two-steps.html#cb73-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;GR&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Temperature (°C)&quot;</span>,</span>
<span id="cb73-22"><a href="fitting-germination-models-in-two-steps.html#cb73-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">legendPos =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="fl">0.9</span>))</span></code></pre></div>
<p><img src="_seedGerminationTutorial_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
</div>
<div id="warning-message" class="section level3 hasAnchor" number="10.2.6">
<h3><span class="header-section-number">10.2.6</span> Warning message!<a href="fitting-germination-models-in-two-steps.html#warning-message" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we collect data about the response of germination rates to temperature and use them to parameterise nonlinear regression models by using nonlinear least squares, the basic assumption of homoscedasticity is rarely tenable. <strong>We should not forget this!</strong>. In the above examples I used a robust variance-covariance sandwich estimator (Zeileis, 2006; see the use of the <code>coeftest()</code> method, instead of the <code>summary()</code> method), although other techniques can be successfully used to deal with this problem.</p>
</div>
</div>
<div id="carrying-over-information-to-the-2nd-step" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Carrying over information to the 2<sup>nd</sup> step<a href="fitting-germination-models-in-two-steps.html#carrying-over-information-to-the-2nd-step" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>(yet to be done)</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="quantiles-from-time-to-event-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="examples-and-case-studies.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_seedGerminationTutorial.pdf", "_seedGerminationTutorial.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
