<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 2 What is time-to-event data? | Analysing seed germination and emergence data with R: a tutorial</title>
  <meta name="description" content="This document describes a new framework for the analyses of seed germination and emergence data and it is associated to the new R packages ‘drcte’ and ‘drcSeedGerm’" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 2 What is time-to-event data? | Analysing seed germination and emergence data with R: a tutorial" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/coversmall.png" />
  <meta property="og:description" content="This document describes a new framework for the analyses of seed germination and emergence data and it is associated to the new R packages ‘drcte’ and ‘drcSeedGerm’" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 2 What is time-to-event data? | Analysing seed germination and emergence data with R: a tutorial" />
  <meta name="twitter:site" content="@onofriandreapg" />
  <meta name="twitter:description" content="This document describes a new framework for the analyses of seed germination and emergence data and it is associated to the new R packages ‘drcte’ and ‘drcSeedGerm’" />
  <meta name="twitter:image" content="/coversmall.png" />

<meta name="author" content="Andrea Onofri" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="reshaping-time-to-event-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131792052-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-131792052-1');
  </script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time-to-event analyses with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-r-packages"><i class="fa fa-check"></i><b>1.1</b> The R packages</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#our-purpose"><i class="fa fa-check"></i><b>1.2</b> Our purpose</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html"><i class="fa fa-check"></i><b>2</b> What is time-to-event data?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#time-to-event-data-are-censored-data"><i class="fa fa-check"></i><b>2.1</b> Time-to-event data are censored data</a></li>
<li class="chapter" data-level="2.2" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#motivating-example-a-simulated-dataset"><i class="fa fa-check"></i><b>2.2</b> Motivating example: a simulated dataset</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#step-1-the-ungerminated-fraction"><i class="fa fa-check"></i><b>2.2.1</b> Step 1: the ungerminated fraction</a></li>
<li class="chapter" data-level="2.2.2" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#step-2-germination-times-for-the-germinated-fraction"><i class="fa fa-check"></i><b>2.2.2</b> Step 2: germination times for the germinated fraction</a></li>
<li class="chapter" data-level="2.2.3" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#step-3-counts-of-germinated-seeds"><i class="fa fa-check"></i><b>2.2.3</b> Step 3: counts of germinated seeds</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#neglecting-censoring"><i class="fa fa-check"></i><b>2.3</b> Neglecting censoring</a></li>
<li class="chapter" data-level="2.4" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#accounting-for-censoring"><i class="fa fa-check"></i><b>2.4</b> Accounting for censoring</a></li>
<li class="chapter" data-level="2.5" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#neglecting-or-accounting-for-censoring"><i class="fa fa-check"></i><b>2.5</b> Neglecting or accounting for censoring?</a></li>
<li class="chapter" data-level="2.6" data-path="what-is-time-to-event-data.html"><a href="what-is-time-to-event-data.html#take-home-message"><i class="fa fa-check"></i><b>2.6</b> Take-home message</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html"><i class="fa fa-check"></i><b>3</b> Reshaping time-to-event data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#motivating-example"><i class="fa fa-check"></i><b>3.1</b> Motivating example</a></li>
<li class="chapter" data-level="3.2" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#transforming-from-wide-to-long-grouped"><i class="fa fa-check"></i><b>3.2</b> Transforming from WIDE to LONG GROUPED</a></li>
<li class="chapter" data-level="3.3" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#transforming-from-wide-to-long-ungrouped"><i class="fa fa-check"></i><b>3.3</b> Transforming from WIDE to LONG UNGROUPED</a></li>
<li class="chapter" data-level="3.4" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#from-long-grouped-to-long-ungrouped-and-vice-versa"><i class="fa fa-check"></i><b>3.4</b> From LONG GROUPED to LONG UNGROUPED (and vice-versa)</a></li>
<li class="chapter" data-level="3.5" data-path="reshaping-time-to-event-data.html"><a href="reshaping-time-to-event-data.html#from-nonlinear-regression-to-long-grouped"><i class="fa fa-check"></i><b>3.5</b> From NONLINEAR REGRESSION to LONG GROUPED</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html"><i class="fa fa-check"></i><b>4</b> Time-to-event models for seed germination/emergence</a>
<ul>
<li class="chapter" data-level="4.1" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#parametric-time-to-event-models"><i class="fa fa-check"></i><b>4.1</b> Parametric time-to-event models</a></li>
<li class="chapter" data-level="4.2" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#nonparametric-time-to-event-models"><i class="fa fa-check"></i><b>4.2</b> Nonparametric time-to-event models</a></li>
<li class="chapter" data-level="4.3" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#kernel-density-estimators"><i class="fa fa-check"></i><b>4.3</b> Kernel density estimators</a></li>
<li class="chapter" data-level="4.4" data-path="time-to-event-models-for-seed-germinationemergence.html"><a href="time-to-event-models-for-seed-germinationemergence.html#ml-npmle-or-kde"><i class="fa fa-check"></i><b>4.4</b> ML, NPMLE or KDE?</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="comparing-the-time-course-of-events-for-several-groups.html"><a href="comparing-the-time-course-of-events-for-several-groups.html"><i class="fa fa-check"></i><b>5</b> Comparing the time course of events for several groups</a>
<ul>
<li class="chapter" data-level="5.1" data-path="comparing-the-time-course-of-events-for-several-groups.html"><a href="comparing-the-time-course-of-events-for-several-groups.html#a-motivating-example"><i class="fa fa-check"></i><b>5.1</b> A motivating example</a></li>
<li class="chapter" data-level="5.2" data-path="comparing-the-time-course-of-events-for-several-groups.html"><a href="comparing-the-time-course-of-events-for-several-groups.html#fitting-several-time-to-event-curves"><i class="fa fa-check"></i><b>5.2</b> Fitting several time-to-event curves</a></li>
<li class="chapter" data-level="5.3" data-path="comparing-the-time-course-of-events-for-several-groups.html"><a href="comparing-the-time-course-of-events-for-several-groups.html#comparing-non-parametric-curves"><i class="fa fa-check"></i><b>5.3</b> Comparing non-parametric curves</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html"><i class="fa fa-check"></i><b>6</b> Fitting time-to-event models with environmental covariates</a>
<ul>
<li class="chapter" data-level="6.1" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#hydro-time-to-event-models"><i class="fa fa-check"></i><b>6.1</b> Hydro-time-to-event models</a></li>
<li class="chapter" data-level="6.2" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#a-better-modelling-approach"><i class="fa fa-check"></i><b>6.2</b> A better modelling approach</a></li>
<li class="chapter" data-level="6.3" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#another-modelling-approach"><i class="fa fa-check"></i><b>6.3</b> Another modelling approach</a></li>
<li class="chapter" data-level="6.4" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#further-detail"><i class="fa fa-check"></i><b>6.4</b> Further detail</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htl"><i class="fa fa-check"></i><b>6.4.1</b> <code>HTL()</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htg"><i class="fa fa-check"></i><b>6.4.2</b> <code>HTG()</code></a></li>
<li class="chapter" data-level="6.4.3" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htll"><i class="fa fa-check"></i><b>6.4.3</b> <code>HTLL()</code></a></li>
<li class="chapter" data-level="6.4.4" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htw1"><i class="fa fa-check"></i><b>6.4.4</b> <code>HTW1()</code></a></li>
<li class="chapter" data-level="6.4.5" data-path="fitting-time-to-event-models-with-environmental-covariates.html"><a href="fitting-time-to-event-models-with-environmental-covariates.html#htw2"><i class="fa fa-check"></i><b>6.4.5</b> <code>HTW2()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploring-the-results-of-a-time-to-event-fit-model-parameters.html"><a href="exploring-the-results-of-a-time-to-event-fit-model-parameters.html"><i class="fa fa-check"></i><b>7</b> Exploring the results of a time-to-event fit: model parameters</a></li>
<li class="chapter" data-level="8" data-path="predictions-from-time-to-event-models.html"><a href="predictions-from-time-to-event-models.html"><i class="fa fa-check"></i><b>8</b> Predictions from time-to-event models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="predictions-from-time-to-event-models.html"><a href="predictions-from-time-to-event-models.html#parametric-time-to-event-model"><i class="fa fa-check"></i><b>8.1</b> Parametric time-to-event model</a></li>
<li class="chapter" data-level="8.2" data-path="predictions-from-time-to-event-models.html"><a href="predictions-from-time-to-event-models.html#non-parametric-time-to-event-models"><i class="fa fa-check"></i><b>8.2</b> Non-parametric time-to-event models</a></li>
<li class="chapter" data-level="8.3" data-path="predictions-from-time-to-event-models.html"><a href="predictions-from-time-to-event-models.html#predictions-from-a-time-to-event-model-from-literature"><i class="fa fa-check"></i><b>8.3</b> Predictions from a time-to-event model from literature</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html"><i class="fa fa-check"></i><b>9</b> Quantiles from time-to-event models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#peculiarities-of-seed-science-data"><i class="fa fa-check"></i><b>9.1</b> Peculiarities of seed science data</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#quantiles-and-restricted-quantiles"><i class="fa fa-check"></i><b>9.1.1</b> Quantiles and ‘restricted’ quantiles</a></li>
<li class="chapter" data-level="9.1.2" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#germinationemergence-rates"><i class="fa fa-check"></i><b>9.1.2</b> Germination/emergence rates</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#getting-the-quantiles-with-drcte"><i class="fa fa-check"></i><b>9.2</b> Getting the quantiles with ‘drcte’</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#parametric-models"><i class="fa fa-check"></i><b>9.2.1</b> Parametric models</a></li>
<li class="chapter" data-level="9.2.2" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#parametric-models-with-environmental-covariates"><i class="fa fa-check"></i><b>9.2.2</b> Parametric models with environmental covariates</a></li>
<li class="chapter" data-level="9.2.3" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#non-parametric-npmle-models"><i class="fa fa-check"></i><b>9.2.3</b> Non-parametric (NPMLE) models</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="quantiles-from-time-to-event-models.html"><a href="quantiles-from-time-to-event-models.html#quantiles-and-effective-doses-ed"><i class="fa fa-check"></i><b>9.3</b> Quantiles and Effective Doses (ED)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html"><i class="fa fa-check"></i><b>10</b> Fitting germination models in two steps</a>
<ul>
<li class="chapter" data-level="10.1" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#fitting-linear-models-in-two-steps"><i class="fa fa-check"></i><b>10.1</b> Fitting linear models in two steps</a></li>
<li class="chapter" data-level="10.2" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#fitting-non-linear-threshold-models-in-two-steps"><i class="fa fa-check"></i><b>10.2</b> Fitting non-linear threshold models in two steps</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#definition-of-threshold-models"><i class="fa fa-check"></i><b>10.2.1</b> Definition of threshold models</a></li>
<li class="chapter" data-level="10.2.2" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#a-possibly-incomplete-list-of-threshold-models"><i class="fa fa-check"></i><b>10.2.2</b> A (possibly incomplete) list of threshold models</a></li>
<li class="chapter" data-level="10.2.3" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#description-of-models"><i class="fa fa-check"></i><b>10.2.3</b> Description of models</a></li>
<li class="chapter" data-level="10.2.4" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#example-1"><i class="fa fa-check"></i><b>10.2.4</b> Example 1</a></li>
<li class="chapter" data-level="10.2.5" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#example-2"><i class="fa fa-check"></i><b>10.2.5</b> Example 2</a></li>
<li class="chapter" data-level="10.2.6" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#warning-message"><i class="fa fa-check"></i><b>10.2.6</b> Warning message!</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="fitting-germination-models-in-two-steps.html"><a href="fitting-germination-models-in-two-steps.html#carrying-over-information-to-the-2nd-step"><i class="fa fa-check"></i><b>10.3</b> Carrying over information to the 2<sup>nd</sup> step</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html"><i class="fa fa-check"></i><b>11</b> Examples and case-studies</a>
<ul>
<li class="chapter" data-level="11.1" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#fitting-hydro-thermal-time-models-to-seed-germination-data"><i class="fa fa-check"></i><b>11.1</b> Fitting hydro-thermal-time-models to seed germination data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#preliminary-analyses"><i class="fa fa-check"></i><b>11.1.1</b> Preliminary analyses</a></li>
<li class="chapter" data-level="11.1.2" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#a-better-modelling-approach-1"><i class="fa fa-check"></i><b>11.1.2</b> A better modelling approach</a></li>
<li class="chapter" data-level="11.1.3" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#other-htt-models"><i class="fa fa-check"></i><b>11.1.3</b> Other HTT models</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#fitting-thermal-time-models-to-seed-germination-data"><i class="fa fa-check"></i><b>11.2</b> Fitting thermal-time-models to seed germination data</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#a-motivating-examples"><i class="fa fa-check"></i><b>11.2.1</b> A motivating examples</a></li>
<li class="chapter" data-level="11.2.2" data-path="examples-and-case-studies.html"><a href="examples-and-case-studies.html#a-first-thermal-time-model"><i class="fa fa-check"></i><b>11.2.2</b> A first thermal-time model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>12</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysing seed germination and emergence data with R: a tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="what-is-time-to-event-data" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Section 2</span> What is time-to-event data?<a href="what-is-time-to-event-data.html#what-is-time-to-event-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In general, time-to-event data describe the amount of time elapsed before an event of interest occurs. In medicine, such an event is, e.g., the death, or the remission from a disease; in agriculture we are more often interested in other types of events, such as germination, emergence or flowering. Regardless the discipline, studying the time to en event of interest requires periodical inspections on a population of individuals (people, animals, seeds, plants…) to record, for each individual, the date when the event is achieved. The data resulting from such a series of periodical inspections is usually called <strong>time-to-event data</strong>.</p>
<p>Please, note that we have been talking about periodical inspections; in some cases, germination/emergence assays are performed with only one inspection at a pre-defined time. With this type of assays we can only record the proportion of germinated seeds (in general: the proportion of individuals with the event) at a given time point, while we cannot record the event time for all individuals. Therefore, this type of data are NOT time-to-event data and they will not be the object of this tutorial.</p>
<div id="time-to-event-data-are-censored-data" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Time-to-event data are censored data<a href="what-is-time-to-event-data.html#time-to-event-data-are-censored-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You may wonder: what’s the matter with time-to-event data? Do they have anything special that needs our attention? The answer is, definitely, yes!</p>
<p>Indeed, with very few exceptions, time-to-event data are affected by a peculiar form of uncertainty, which takes the name of <strong>censoring</strong>. It relates to the fact that, due to the typical monitoring schedule, the exact time-to-event may not always be determined. Think about a germination assay, where we put, e.g., 100 seeds in a Petri dish and make daily inspections. At each inspection, we count the number of germinated seeds. In the end, what have we learnt about the germination time of each seed? It is easy to note that we do not have exact values, we only have a set of intervals. Let’s consider three possible situations.</p>
<ol style="list-style-type: decimal">
<li>If we found a germinated seed at the first inspection time, we only know that germination took place before the inspection (left-censoring).</li>
<li>If we find a germinated seed at the second (or later) inspection time, we only know that germination took place somewhere between the previous and the present inspection (interval-censoring).</li>
<li>If we find an ungerminated seed at the end of the experiment, we only know that its germination time, if any, is higher than the duration of the experiment (right-censoring).</li>
</ol>
<p>Censoring implies a lot of uncertainty, which is additional to other more common sources of uncertainty, such as the individual-to-individual variability or random errors in the manipulation process. The problem of censoring has been widely recognised in other disciplines, such as medicine, in relation to survival data (time-to-death data). In order to address that problem, a vast body of methods has developed, which goes under the name of ‘survival analysis’.</p>
<p>In principle, time-to-germination and time-to-emergence data are totally similar to time-to-death data, apart from the fact that we usually deal with different (and less sad) events. Unfortunately, such a connection has been largely overlooked by plant biologists and, as the consequence, the problem of censoring has been most often neglected. This is not an unfortunate practice and it is important that we become aware about the possible consequences of neglecting censoring during the data analysis step.</p>
</div>
<div id="motivating-example-a-simulated-dataset" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Motivating example: a simulated dataset<a href="what-is-time-to-event-data.html#motivating-example-a-simulated-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It may be useful to think about a possible mechanism by which time-to-event data arise. Let’s imagine that we have a population with 85% of germinable seeds (the other ones are dormant and, therefore, they are not immediately able to germinate). The germinable fraction is composed by seeds with variables germination times, as dictated by their genotypes and environmental conditions. Let’s assume that such a variability can be described by using a log-logistic distribution, with a median germination time <span class="math inline">\(e = 4.5\)</span> days and a shape parameter <span class="math inline">\(b = 1.6\)</span>.</p>
<p>If we sample 100 seeds from that population, the sample will not necessarily reflect the characteristics of the whole population. We can do this sampling in R, by using a three-steps approach.</p>
<div id="step-1-the-ungerminated-fraction" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Step 1: the ungerminated fraction<a href="what-is-time-to-event-data.html#step-1-the-ungerminated-fraction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, let’s simulate the number of germinated seeds, assuming a binomial distribution with a proportion of successes equal to 0.85. We use the random number generator <code>rbinom()</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="what-is-time-to-event-data.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Monte Carlo simulation - Step 1</span></span>
<span id="cb2-2"><a href="what-is-time-to-event-data.html#cb2-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fl">0.85</span></span>
<span id="cb2-3"><a href="what-is-time-to-event-data.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb2-4"><a href="what-is-time-to-event-data.html#cb2-4" aria-hidden="true" tabindex="-1"></a>nGerm <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">100</span>, d)</span>
<span id="cb2-5"><a href="what-is-time-to-event-data.html#cb2-5" aria-hidden="true" tabindex="-1"></a>nGerm</span>
<span id="cb2-6"><a href="what-is-time-to-event-data.html#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 89</span></span></code></pre></div>
<p>We see that, in this instance, 89 seeds germinated out of 100, which is not the expected 85%. This may be regarded as an expression of the typical random sampling variability.</p>
</div>
<div id="step-2-germination-times-for-the-germinated-fraction" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Step 2: germination times for the germinated fraction<a href="what-is-time-to-event-data.html#step-2-germination-times-for-the-germinated-fraction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Second, let’s simulate the germination times for these 89 germinable seeds, by drawing from a log-logistic distribution with <span class="math inline">\(b = 1.6\)</span> and <span class="math inline">\(e = 4.5\)</span>. To this aim, we use the <code>rllogis()</code> function in the <code>actuar</code> package (Dutang et al., 2008):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="what-is-time-to-event-data.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Monte Carlo simulation - Step 2</span></span>
<span id="cb3-2"><a href="what-is-time-to-event-data.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(actuar)</span>
<span id="cb3-3"><a href="what-is-time-to-event-data.html#cb3-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">1.6</span>; e <span class="ot">&lt;-</span> <span class="fl">4.5</span> </span>
<span id="cb3-4"><a href="what-is-time-to-event-data.html#cb3-4" aria-hidden="true" tabindex="-1"></a>Gtimes <span class="ot">&lt;-</span> <span class="fu">rllogis</span>(nGerm, <span class="at">shape =</span> b, <span class="at">scale =</span> e)</span>
<span id="cb3-5"><a href="what-is-time-to-event-data.html#cb3-5" aria-hidden="true" tabindex="-1"></a>Gtimes <span class="ot">&lt;-</span> <span class="fu">c</span>(Gtimes, <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">100</span> <span class="sc">-</span> nGerm))</span>
<span id="cb3-6"><a href="what-is-time-to-event-data.html#cb3-6" aria-hidden="true" tabindex="-1"></a>Gtimes</span>
<span id="cb3-7"><a href="what-is-time-to-event-data.html#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   [1]  3.2936708  3.4089762  3.2842199  1.4401630  3.1381457</span></span>
<span id="cb3-8"><a href="what-is-time-to-event-data.html#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   [6] 82.1611955  9.4906364  2.9226745  4.3424551  2.7006042</span></span>
<span id="cb3-9"><a href="what-is-time-to-event-data.html#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  [11]  4.0202158  8.0519663  0.9492013  7.8199588  1.6163588</span></span>
<span id="cb3-10"><a href="what-is-time-to-event-data.html#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  [16]  7.9661485  8.4641154 11.2879041  9.5014360  7.2786264</span></span>
<span id="cb3-11"><a href="what-is-time-to-event-data.html#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  [21]  7.5809838 12.7421713 32.7999661  9.9691944  1.8137333</span></span>
<span id="cb3-12"><a href="what-is-time-to-event-data.html#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  [26]  4.2197542  1.0218849  1.6604417 30.0352308  5.0235265</span></span>
<span id="cb3-13"><a href="what-is-time-to-event-data.html#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  [31]  8.5085067  7.5367739  4.4185382 11.5555259  2.1919263</span></span>
<span id="cb3-14"><a href="what-is-time-to-event-data.html#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  [36] 10.6509339  8.6857151  0.2185902  1.8377033  3.9362727</span></span>
<span id="cb3-15"><a href="what-is-time-to-event-data.html#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  [41]  3.0864702  7.3804164  3.2978782  7.0100360  4.4775843</span></span>
<span id="cb3-16"><a href="what-is-time-to-event-data.html#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  [46]  2.8328842  4.6721090  9.1258796  2.1485568 21.8749808</span></span>
<span id="cb3-17"><a href="what-is-time-to-event-data.html#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  [51]  7.4265984  2.5148724  4.4491466 13.1132301  4.4559642</span></span>
<span id="cb3-18"><a href="what-is-time-to-event-data.html#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  [56]  4.5684584  2.2556488 11.8783556  1.5338755  1.4106592</span></span>
<span id="cb3-19"><a href="what-is-time-to-event-data.html#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  [61] 31.8419420  7.2666641 65.0154287  9.2798476  2.5988399</span></span>
<span id="cb3-20"><a href="what-is-time-to-event-data.html#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  [66]  7.4612907  4.4048509 27.7439121  3.8257187 15.4967751</span></span>
<span id="cb3-21"><a href="what-is-time-to-event-data.html#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  [71]  1.1960785 62.5152642  2.0169970 19.1134899  4.2891084</span></span>
<span id="cb3-22"><a href="what-is-time-to-event-data.html#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  [76]  6.0420938 22.6521417  7.1946293  2.9028993  0.9241876</span></span>
<span id="cb3-23"><a href="what-is-time-to-event-data.html#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  [81]  4.8277336 13.8068124  4.0273655 10.8651761  1.1509735</span></span>
<span id="cb3-24"><a href="what-is-time-to-event-data.html#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  [86]  5.9593534  7.4009589 12.6839405  1.1698335         NA</span></span>
<span id="cb3-25"><a href="what-is-time-to-event-data.html#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  [91]         NA         NA         NA         NA         NA</span></span>
<span id="cb3-26"><a href="what-is-time-to-event-data.html#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  [96]         NA         NA         NA         NA         NA</span></span></code></pre></div>
<p>Now, we have a vector hosting 100 germination times (‘Gtimes’). Please, note that I also added 11 NA values, to represent non-germinable seeds.</p>
</div>
<div id="step-3-counts-of-germinated-seeds" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Step 3: counts of germinated seeds<a href="what-is-time-to-event-data.html#step-3-counts-of-germinated-seeds" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Unfortunately, due to the monitoring schedule, we cannot observe the exact germination time for each single seed in the sample; we can only count the seeds which have germinated between two assessment times. Therefore, as the third step, we simulate the observed counts, by assuming daily monitoring for 40 days; what we do, is a sort of ‘binning’ process, where we assign each seed to the time interval during which it germinated.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="what-is-time-to-event-data.html#cb4-1" aria-hidden="true" tabindex="-1"></a>obsT <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">40</span>, <span class="at">by=</span><span class="dv">1</span>) <span class="co">#Observation schedule</span></span>
<span id="cb4-2"><a href="what-is-time-to-event-data.html#cb4-2" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span> <span class="fu">table</span>( <span class="fu">cut</span>(Gtimes, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, obsT)) )</span>
<span id="cb4-3"><a href="what-is-time-to-event-data.html#cb4-3" aria-hidden="true" tabindex="-1"></a>count</span>
<span id="cb4-4"><a href="what-is-time-to-event-data.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb4-5"><a href="what-is-time-to-event-data.html#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   (0,1]   (1,2]   (2,3]   (3,4]   (4,5]   (5,6]   (6,7]   (7,8] </span></span>
<span id="cb4-6"><a href="what-is-time-to-event-data.html#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="do">##       3      11      10       8      13       2       1      12 </span></span>
<span id="cb4-7"><a href="what-is-time-to-event-data.html#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   (8,9]  (9,10] (10,11] (11,12] (12,13] (13,14] (14,15] (15,16] </span></span>
<span id="cb4-8"><a href="what-is-time-to-event-data.html#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="do">##       4       5       2       3       2       2       0       1 </span></span>
<span id="cb4-9"><a href="what-is-time-to-event-data.html#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="do">## (16,17] (17,18] (18,19] (19,20] (20,21] (21,22] (22,23] (23,24] </span></span>
<span id="cb4-10"><a href="what-is-time-to-event-data.html#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="do">##       0       0       0       1       0       1       1       0 </span></span>
<span id="cb4-11"><a href="what-is-time-to-event-data.html#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="do">## (24,25] (25,26] (26,27] (27,28] (28,29] (29,30] (30,31] (31,32] </span></span>
<span id="cb4-12"><a href="what-is-time-to-event-data.html#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="do">##       0       0       0       1       0       0       1       1 </span></span>
<span id="cb4-13"><a href="what-is-time-to-event-data.html#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="do">## (32,33] (33,34] (34,35] (35,36] (36,37] (37,38] (38,39] (39,40] </span></span>
<span id="cb4-14"><a href="what-is-time-to-event-data.html#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="do">##       1       0       0       0       0       0       0       0</span></span></code></pre></div>
<p>We can see that, e.g., 11 germinated seeds were counted at day 2; therefore they germinated between day 1 and day 2 and their real germination time is unknown, but included in the range between 1 and 2 (left-open and right-closed). This is a typical example of interval-censoring (see above).</p>
<p>We can also see that, in total, we counted 86 germinated seeds and, therefore, 14 seeds were still ungerminated at the end of the assay. For this simulation exercise, we know that 11 seeds were non-germinable and three seeds were germinable, but they were not allowed enough time to germinate (look at the table above: there are 3 seeds with germination times higher than 40). In real life, this is another source of uncertainty: we might be able to ascertain whether these 14 seeds are viable or not (e.g. by using a tetrazolium test), but, if they are viable, we would never be able to tell whether they are dormant or their germination time is simply longer than the duration of the assay. In real life, we can only reach an uncertain conclusion: the germination time of the 14 ungerminated seeds is comprised between 40 days to infinity; this is an example of right-censoring.</p>
<p>The above uncertainty affects our capability of describing the germination time-course from the observed data. We can try to picture the situation in the graph below.</p>
<p><img src="_seedGerminationTutorial_files/figure-html/unnamed-chunk-4-1.png" width="576" /></p>
<p>What is the real germination time-course? The red one? The blue one? Something in between? We cannot really say this from our dataset, we are uncertain. The grey areas represent the uncertainty due to censoring. Do you think that we can reasonably neglect it?</p>
</div>
</div>
<div id="neglecting-censoring" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Neglecting censoring<a href="what-is-time-to-event-data.html#neglecting-censoring" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For a moment, let’s forget about those grey uncertainty areas. Let’s forget about censoring; this is what it is often done in literature for germination data: we associate the observed proportion of germinated seeds to the exact time when it was observed. It is, indeed, an abuse, as the observed data tell us a different story: the observed proportion of germinated seeds might have been attained before the moment of inspection (and not necessarily at the moment of inspection). But we disregard this and fit a nonlinear regression model, i.e. a log-logistic function:</p>
<p><span class="math display">\[
G(t) = \frac{d}{ 1 + exp \left\{ - b \right[ \log(t) - \log(e) \left] \right\}}
\]</span></p>
<p>where <span class="math inline">\(G\)</span> is the fraction of germinated seeds at time <span class="math inline">\(t\)</span>, <span class="math inline">\(d\)</span> is the germinable fraction, <span class="math inline">\(e\)</span> is the median germination time for the germinable fraction and <span class="math inline">\(b\)</span> is the slope around the inflection point. The above model is sygmoidally shaped and it is symmetric on a log-time scale. The three parameters are biologically relevant, as they describe the three main features of seed germination, i.e. capability (<span class="math inline">\(d\)</span>), speed (<span class="math inline">\(e\)</span>) and uniformity (<span class="math inline">\(b\)</span>).</p>
<p>In order to fit a nonlinear regression model, we need to transform the observed data, as follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="what-is-time-to-event-data.html#cb5-1" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>( <span class="fu">table</span>( <span class="fu">cut</span>(Gtimes, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, obsT)) ) )</span>
<span id="cb5-2"><a href="what-is-time-to-event-data.html#cb5-2" aria-hidden="true" tabindex="-1"></a>propCum <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(counts)<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb5-3"><a href="what-is-time-to-event-data.html#cb5-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> obsT, <span class="at">counts =</span> counts, <span class="at">propCum =</span> propCum) </span>
<span id="cb5-4"><a href="what-is-time-to-event-data.html#cb5-4" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb5-5"><a href="what-is-time-to-event-data.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="do">##    time counts propCum</span></span>
<span id="cb5-6"><a href="what-is-time-to-event-data.html#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1      3    0.03</span></span>
<span id="cb5-7"><a href="what-is-time-to-event-data.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     2     11    0.14</span></span>
<span id="cb5-8"><a href="what-is-time-to-event-data.html#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     3     10    0.24</span></span>
<span id="cb5-9"><a href="what-is-time-to-event-data.html#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 4     4      8    0.32</span></span>
<span id="cb5-10"><a href="what-is-time-to-event-data.html#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 5     5     13    0.45</span></span>
<span id="cb5-11"><a href="what-is-time-to-event-data.html#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 6     6      2    0.47</span></span>
<span id="cb5-12"><a href="what-is-time-to-event-data.html#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 7     7      1    0.48</span></span>
<span id="cb5-13"><a href="what-is-time-to-event-data.html#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 8     8     12    0.60</span></span>
<span id="cb5-14"><a href="what-is-time-to-event-data.html#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 9     9      4    0.64</span></span>
<span id="cb5-15"><a href="what-is-time-to-event-data.html#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 10   10      5    0.69</span></span>
<span id="cb5-16"><a href="what-is-time-to-event-data.html#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 11   11      2    0.71</span></span>
<span id="cb5-17"><a href="what-is-time-to-event-data.html#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 12   12      3    0.74</span></span>
<span id="cb5-18"><a href="what-is-time-to-event-data.html#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 13   13      2    0.76</span></span>
<span id="cb5-19"><a href="what-is-time-to-event-data.html#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 14   14      2    0.78</span></span>
<span id="cb5-20"><a href="what-is-time-to-event-data.html#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 15   15      0    0.78</span></span>
<span id="cb5-21"><a href="what-is-time-to-event-data.html#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 16   16      1    0.79</span></span>
<span id="cb5-22"><a href="what-is-time-to-event-data.html#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 17   17      0    0.79</span></span>
<span id="cb5-23"><a href="what-is-time-to-event-data.html#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 18   18      0    0.79</span></span>
<span id="cb5-24"><a href="what-is-time-to-event-data.html#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 19   19      0    0.79</span></span>
<span id="cb5-25"><a href="what-is-time-to-event-data.html#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 20   20      1    0.80</span></span>
<span id="cb5-26"><a href="what-is-time-to-event-data.html#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="do">## 21   21      0    0.80</span></span>
<span id="cb5-27"><a href="what-is-time-to-event-data.html#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 22   22      1    0.81</span></span>
<span id="cb5-28"><a href="what-is-time-to-event-data.html#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 23   23      1    0.82</span></span>
<span id="cb5-29"><a href="what-is-time-to-event-data.html#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 24   24      0    0.82</span></span>
<span id="cb5-30"><a href="what-is-time-to-event-data.html#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 25   25      0    0.82</span></span>
<span id="cb5-31"><a href="what-is-time-to-event-data.html#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 26   26      0    0.82</span></span>
<span id="cb5-32"><a href="what-is-time-to-event-data.html#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="do">## 27   27      0    0.82</span></span>
<span id="cb5-33"><a href="what-is-time-to-event-data.html#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="do">## 28   28      1    0.83</span></span>
<span id="cb5-34"><a href="what-is-time-to-event-data.html#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="do">## 29   29      0    0.83</span></span>
<span id="cb5-35"><a href="what-is-time-to-event-data.html#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="do">## 30   30      0    0.83</span></span>
<span id="cb5-36"><a href="what-is-time-to-event-data.html#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="do">## 31   31      1    0.84</span></span>
<span id="cb5-37"><a href="what-is-time-to-event-data.html#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="do">## 32   32      1    0.85</span></span>
<span id="cb5-38"><a href="what-is-time-to-event-data.html#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="do">## 33   33      1    0.86</span></span>
<span id="cb5-39"><a href="what-is-time-to-event-data.html#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="do">## 34   34      0    0.86</span></span>
<span id="cb5-40"><a href="what-is-time-to-event-data.html#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="do">## 35   35      0    0.86</span></span>
<span id="cb5-41"><a href="what-is-time-to-event-data.html#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="do">## 36   36      0    0.86</span></span>
<span id="cb5-42"><a href="what-is-time-to-event-data.html#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="do">## 37   37      0    0.86</span></span>
<span id="cb5-43"><a href="what-is-time-to-event-data.html#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="do">## 38   38      0    0.86</span></span>
<span id="cb5-44"><a href="what-is-time-to-event-data.html#cb5-44" aria-hidden="true" tabindex="-1"></a><span class="do">## 39   39      0    0.86</span></span>
<span id="cb5-45"><a href="what-is-time-to-event-data.html#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="do">## 40   40      0    0.86</span></span></code></pre></div>
<p>In practice, we determine the cumulative proportion (or percentage) of germinated seeds (‘propCum’), which is used as the response variable, while the observation time (‘time’) is used as the independent variable. Then, we fit the log-logistic function by non-linear least squares regression. I’ll say this again: <strong>you can clearly see that, by doing so, we totally neglect the grey areas in the figure above, we only look at the observed points</strong>.</p>
<p>Let’s use the ‘drm’ function, in the ‘drc’ package (Ritz et al., 2015). The argument ‘fct’ is used to set the fitted function to log-logistic with three parameters (the equation above).</p>
<p>The <code>plot()</code> and <code>summary()</code> methods can be used to plot a graph and to retrieve the estimated parameters.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="what-is-time-to-event-data.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(drc)</span>
<span id="cb6-2"><a href="what-is-time-to-event-data.html#cb6-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">drm</span>(propCum <span class="sc">~</span> time, <span class="at">data =</span> df,</span>
<span id="cb6-3"><a href="what-is-time-to-event-data.html#cb6-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">fct =</span> <span class="fu">LL.3</span>() )</span>
<span id="cb6-4"><a href="what-is-time-to-event-data.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod, <span class="at">log =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb6-5"><a href="what-is-time-to-event-data.html#cb6-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>,</span>
<span id="cb6-6"><a href="what-is-time-to-event-data.html#cb6-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;Proportion of germinated seeds&quot;</span>)</span></code></pre></div>
<p><img src="_seedGerminationTutorial_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="what-is-time-to-event-data.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span>
<span id="cb7-2"><a href="what-is-time-to-event-data.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-3"><a href="what-is-time-to-event-data.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Model fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)</span></span>
<span id="cb7-4"><a href="what-is-time-to-event-data.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-5"><a href="what-is-time-to-event-data.html#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Parameter estimates:</span></span>
<span id="cb7-6"><a href="what-is-time-to-event-data.html#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-7"><a href="what-is-time-to-event-data.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="do">##                 Estimate Std. Error t-value   p-value    </span></span>
<span id="cb7-8"><a href="what-is-time-to-event-data.html#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="do">## b:(Intercept) -1.8497771  0.0702626 -26.327 &lt; 2.2e-16 ***</span></span>
<span id="cb7-9"><a href="what-is-time-to-event-data.html#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="do">## d:(Intercept)  0.8768793  0.0070126 125.044 &lt; 2.2e-16 ***</span></span>
<span id="cb7-10"><a href="what-is-time-to-event-data.html#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="do">## e:(Intercept)  5.2691575  0.1020457  51.635 &lt; 2.2e-16 ***</span></span>
<span id="cb7-11"><a href="what-is-time-to-event-data.html#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb7-12"><a href="what-is-time-to-event-data.html#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-13"><a href="what-is-time-to-event-data.html#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-14"><a href="what-is-time-to-event-data.html#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error:</span></span>
<span id="cb7-15"><a href="what-is-time-to-event-data.html#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-16"><a href="what-is-time-to-event-data.html#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  0.01762168 (37 degrees of freedom)</span></span></code></pre></div>
<p>We see that our estimates are very close to the real values (<span class="math inline">\(b\)</span> = 1.85 vs. 1.6; <span class="math inline">\(e\)</span> = 5.27 vs. 4.5; <span class="math inline">\(d\)</span> = 0.88 vs. 0.86) and we also see that standard errors are rather small (the coefficient of variability goes from 1 to 4%). There is a difference in sign for <span class="math inline">\(b\)</span>, which relates to the fact that the <code>LL.3()</code> function in ‘drc’ removes the minus sign in the equation above. Please, disregard this aspect, which stems from the fact that the ‘drc’ package is rooted in pesticide bioassays.</p>
<p>Do you think that this analysis is not that bad? Wait a moment. Let’s see what happens if we account for censoring.</p>
</div>
<div id="accounting-for-censoring" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Accounting for censoring<a href="what-is-time-to-event-data.html#accounting-for-censoring" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>How can we account for censoring? The answer is simple: we should use fitting methods which are specifically devised to incorporate the uncertainty due to censoring. We said that, in medicine, the body of these methods goes under the name of survival analysis and, from this framework, we can borrow a parametric survival model. However, I will not use the name ‘survival model’ as we are not dealing with a survival process. Instead, I will use the name <strong>parametric time-to-event model</strong>.</p>
<p>My colleagues and I have extensively talked about parametric time-to-event models in two of our recent papers and related appendices (Onofri et al., 2019; Onofri et al., 2018). Therefore, I will not go into detail, now. I will just say that time-to-event models directly consider the observed counts as the response variable. As the independent variable, they consider the extremes of each time interval (‘timeBef’ and ‘timeAf’; see below). We immediately see two differences with nonlinear regression: (1) we do not need to transform the observed counts into cumulative proportions, and (2) by using an interval as the independent variable, we inject into the model the uncertainty due to censoring (the grey areas in the figure above). Let’s reshape the dataset as shown below.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="what-is-time-to-event-data.html#cb8-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">timeBef =</span> <span class="fu">c</span>(<span class="dv">0</span>, obsT), <span class="at">timeAf =</span> <span class="fu">c</span>(obsT, <span class="cn">Inf</span>), <span class="at">counts =</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(counts), <span class="dv">100</span> <span class="sc">-</span> <span class="fu">sum</span>(counts)) )</span>
<span id="cb8-2"><a href="what-is-time-to-event-data.html#cb8-2" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb8-3"><a href="what-is-time-to-event-data.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    timeBef timeAf counts</span></span>
<span id="cb8-4"><a href="what-is-time-to-event-data.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 1        0      1      3</span></span>
<span id="cb8-5"><a href="what-is-time-to-event-data.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 2        1      2     11</span></span>
<span id="cb8-6"><a href="what-is-time-to-event-data.html#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 3        2      3     10</span></span>
<span id="cb8-7"><a href="what-is-time-to-event-data.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 4        3      4      8</span></span>
<span id="cb8-8"><a href="what-is-time-to-event-data.html#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 5        4      5     13</span></span>
<span id="cb8-9"><a href="what-is-time-to-event-data.html#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 6        5      6      2</span></span>
<span id="cb8-10"><a href="what-is-time-to-event-data.html#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 7        6      7      1</span></span>
<span id="cb8-11"><a href="what-is-time-to-event-data.html#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 8        7      8     12</span></span>
<span id="cb8-12"><a href="what-is-time-to-event-data.html#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 9        8      9      4</span></span>
<span id="cb8-13"><a href="what-is-time-to-event-data.html#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 10       9     10      5</span></span>
<span id="cb8-14"><a href="what-is-time-to-event-data.html#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 11      10     11      2</span></span>
<span id="cb8-15"><a href="what-is-time-to-event-data.html#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 12      11     12      3</span></span>
<span id="cb8-16"><a href="what-is-time-to-event-data.html#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 13      12     13      2</span></span>
<span id="cb8-17"><a href="what-is-time-to-event-data.html#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 14      13     14      2</span></span>
<span id="cb8-18"><a href="what-is-time-to-event-data.html#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 15      14     15      0</span></span>
<span id="cb8-19"><a href="what-is-time-to-event-data.html#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 16      15     16      1</span></span>
<span id="cb8-20"><a href="what-is-time-to-event-data.html#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 17      16     17      0</span></span>
<span id="cb8-21"><a href="what-is-time-to-event-data.html#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 18      17     18      0</span></span>
<span id="cb8-22"><a href="what-is-time-to-event-data.html#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 19      18     19      0</span></span>
<span id="cb8-23"><a href="what-is-time-to-event-data.html#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 20      19     20      1</span></span>
<span id="cb8-24"><a href="what-is-time-to-event-data.html#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 21      20     21      0</span></span>
<span id="cb8-25"><a href="what-is-time-to-event-data.html#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 22      21     22      1</span></span>
<span id="cb8-26"><a href="what-is-time-to-event-data.html#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="do">## 23      22     23      1</span></span>
<span id="cb8-27"><a href="what-is-time-to-event-data.html#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 24      23     24      0</span></span>
<span id="cb8-28"><a href="what-is-time-to-event-data.html#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 25      24     25      0</span></span>
<span id="cb8-29"><a href="what-is-time-to-event-data.html#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 26      25     26      0</span></span>
<span id="cb8-30"><a href="what-is-time-to-event-data.html#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 27      26     27      0</span></span>
<span id="cb8-31"><a href="what-is-time-to-event-data.html#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 28      27     28      1</span></span>
<span id="cb8-32"><a href="what-is-time-to-event-data.html#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="do">## 29      28     29      0</span></span>
<span id="cb8-33"><a href="what-is-time-to-event-data.html#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="do">## 30      29     30      0</span></span>
<span id="cb8-34"><a href="what-is-time-to-event-data.html#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="do">## 31      30     31      1</span></span>
<span id="cb8-35"><a href="what-is-time-to-event-data.html#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="do">## 32      31     32      1</span></span>
<span id="cb8-36"><a href="what-is-time-to-event-data.html#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="do">## 33      32     33      1</span></span>
<span id="cb8-37"><a href="what-is-time-to-event-data.html#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="do">## 34      33     34      0</span></span>
<span id="cb8-38"><a href="what-is-time-to-event-data.html#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="do">## 35      34     35      0</span></span>
<span id="cb8-39"><a href="what-is-time-to-event-data.html#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="do">## 36      35     36      0</span></span>
<span id="cb8-40"><a href="what-is-time-to-event-data.html#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="do">## 37      36     37      0</span></span>
<span id="cb8-41"><a href="what-is-time-to-event-data.html#cb8-41" aria-hidden="true" tabindex="-1"></a><span class="do">## 38      37     38      0</span></span>
<span id="cb8-42"><a href="what-is-time-to-event-data.html#cb8-42" aria-hidden="true" tabindex="-1"></a><span class="do">## 39      38     39      0</span></span>
<span id="cb8-43"><a href="what-is-time-to-event-data.html#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="do">## 40      39     40      0</span></span>
<span id="cb8-44"><a href="what-is-time-to-event-data.html#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="do">## 41      40    Inf     14</span></span></code></pre></div>
<p>Can you see the difference? Please, note that we also added the ungerminated seeds at the end, with an uncertainty interval going from 40 days to infinity.</p>
<p>Time-to-event models can be easily fitted by using the <code>drm()</code> function in the ‘drc’ package, although we should specify that we want to use a time-to-event method, by setting the <code>type = "event"</code> argument. More simply, we can use the <code>drmte()</code> function in the ‘drcte’ package, that is a specific package for time-to-event methods. Both the functions use the same syntax and, with respect to nonlinear regression, there are some important differences in the model call. In particular, a nonlinear regression model is defined as:</p>
<pre><code>CumulativeProportion ~ timeAf</code></pre>
<p>On the other hand, a time-to-event model is defined as:</p>
<pre><code>Count ~ timeBef + timeAf</code></pre>
<p>The full model call is shown below, both with <code>drm()</code> and with <code>drmte()</code></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="what-is-time-to-event-data.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Time-to-event model</span></span>
<span id="cb11-2"><a href="what-is-time-to-event-data.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(drcte)</span>
<span id="cb11-3"><a href="what-is-time-to-event-data.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># modTE &lt;- drm(counts ~ timeBef + timeAf, data = df, </span></span>
<span id="cb11-4"><a href="what-is-time-to-event-data.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#            fct = LL.3(), type = &quot;event&quot;)</span></span>
<span id="cb11-5"><a href="what-is-time-to-event-data.html#cb11-5" aria-hidden="true" tabindex="-1"></a>modTE <span class="ot">&lt;-</span> <span class="fu">drmte</span>(counts <span class="sc">~</span> timeBef <span class="sc">+</span> timeAf, <span class="at">data =</span> df, </span>
<span id="cb11-6"><a href="what-is-time-to-event-data.html#cb11-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">fct =</span> <span class="fu">LL.3</span>())</span>
<span id="cb11-7"><a href="what-is-time-to-event-data.html#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modTE)</span>
<span id="cb11-8"><a href="what-is-time-to-event-data.html#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-9"><a href="what-is-time-to-event-data.html#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Model fitted: Log-logistic (ED50 as parameter) with lower limit at 0</span></span>
<span id="cb11-10"><a href="what-is-time-to-event-data.html#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-11"><a href="what-is-time-to-event-data.html#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Robust estimation: no </span></span>
<span id="cb11-12"><a href="what-is-time-to-event-data.html#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-13"><a href="what-is-time-to-event-data.html#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Parameter estimates:</span></span>
<span id="cb11-14"><a href="what-is-time-to-event-data.html#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb11-15"><a href="what-is-time-to-event-data.html#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="do">##                Estimate Std. Error t-value   p-value    </span></span>
<span id="cb11-16"><a href="what-is-time-to-event-data.html#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="do">## b:(Intercept) -1.826006   0.194579 -9.3844 &lt; 2.2e-16 ***</span></span>
<span id="cb11-17"><a href="what-is-time-to-event-data.html#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="do">## d:(Intercept)  0.881476   0.036928 23.8701 &lt; 2.2e-16 ***</span></span>
<span id="cb11-18"><a href="what-is-time-to-event-data.html#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="do">## e:(Intercept)  5.302109   0.565273  9.3797 &lt; 2.2e-16 ***</span></span>
<span id="cb11-19"><a href="what-is-time-to-event-data.html#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb11-20"><a href="what-is-time-to-event-data.html#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>With respect to the nonlinear regression fit, the estimates from a time-to-event fit are very similar, but the standard errors are much higher (the coefficient of variability now goes from 4 to 11%). That was expected: we have added the uncertainty due to censoring.</p>
</div>
<div id="neglecting-or-accounting-for-censoring" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Neglecting or accounting for censoring?<a href="what-is-time-to-event-data.html#neglecting-or-accounting-for-censoring" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You may wonder which of the two analysis is right and which is wrong. We cannot say this from just one dataset. However, we can repeat the Monte Carlo simulation above to extract 1000 samples, fit the model by using the two methods and retrieve parameter estimates and standard errors for each sample and method. We do this by using the code below (please, be patient… it may take some time).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="what-is-time-to-event-data.html#cb12-1" aria-hidden="true" tabindex="-1"></a>GermSampling <span class="ot">&lt;-</span> <span class="cf">function</span>(nSeeds, timeLast, stepOss, e, b, d){</span>
<span id="cb12-2"><a href="what-is-time-to-event-data.html#cb12-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-3"><a href="what-is-time-to-event-data.html#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Draw a sample as above</span></span>
<span id="cb12-4"><a href="what-is-time-to-event-data.html#cb12-4" aria-hidden="true" tabindex="-1"></a>    nGerm <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, nSeeds, d)</span>
<span id="cb12-5"><a href="what-is-time-to-event-data.html#cb12-5" aria-hidden="true" tabindex="-1"></a>    Gtimes <span class="ot">&lt;-</span> <span class="fu">rllogis</span>(nGerm, <span class="at">shape =</span> b, <span class="at">scale =</span> e)</span>
<span id="cb12-6"><a href="what-is-time-to-event-data.html#cb12-6" aria-hidden="true" tabindex="-1"></a>    Gtimes <span class="ot">&lt;-</span> <span class="fu">c</span>(Gtimes, <span class="fu">rep</span>(<span class="cn">Inf</span>, <span class="dv">100</span> <span class="sc">-</span> nGerm))</span>
<span id="cb12-7"><a href="what-is-time-to-event-data.html#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="what-is-time-to-event-data.html#cb12-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-9"><a href="what-is-time-to-event-data.html#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Generate the observed data</span></span>
<span id="cb12-10"><a href="what-is-time-to-event-data.html#cb12-10" aria-hidden="true" tabindex="-1"></a>    obsT <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, timeLast, <span class="at">by=</span>stepOss) </span>
<span id="cb12-11"><a href="what-is-time-to-event-data.html#cb12-11" aria-hidden="true" tabindex="-1"></a>    counts <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>( <span class="fu">table</span>( <span class="fu">cut</span>(Gtimes, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, obsT)) ) )</span>
<span id="cb12-12"><a href="what-is-time-to-event-data.html#cb12-12" aria-hidden="true" tabindex="-1"></a>    propCum <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(counts)<span class="sc">/</span>nSeeds</span>
<span id="cb12-13"><a href="what-is-time-to-event-data.html#cb12-13" aria-hidden="true" tabindex="-1"></a>    timeBef <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, obsT)</span>
<span id="cb12-14"><a href="what-is-time-to-event-data.html#cb12-14" aria-hidden="true" tabindex="-1"></a>    timeAf <span class="ot">&lt;-</span> <span class="fu">c</span>(obsT, <span class="cn">Inf</span>)</span>
<span id="cb12-15"><a href="what-is-time-to-event-data.html#cb12-15" aria-hidden="true" tabindex="-1"></a>    counts <span class="ot">&lt;-</span> <span class="fu">c</span>(counts, nSeeds <span class="sc">-</span> <span class="fu">sum</span>(counts))</span>
<span id="cb12-16"><a href="what-is-time-to-event-data.html#cb12-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-17"><a href="what-is-time-to-event-data.html#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Calculate the T50 with two methods</span></span>
<span id="cb12-18"><a href="what-is-time-to-event-data.html#cb12-18" aria-hidden="true" tabindex="-1"></a>    mod <span class="ot">&lt;-</span> <span class="fu">drm</span>(propCum <span class="sc">~</span> obsT, <span class="at">fct =</span> <span class="fu">LL.3</span>() )</span>
<span id="cb12-19"><a href="what-is-time-to-event-data.html#cb12-19" aria-hidden="true" tabindex="-1"></a>    modTE <span class="ot">&lt;-</span> <span class="fu">drm</span>(counts <span class="sc">~</span> timeBef <span class="sc">+</span> timeAf, </span>
<span id="cb12-20"><a href="what-is-time-to-event-data.html#cb12-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">fct =</span> <span class="fu">LL.3</span>(), <span class="at">type =</span> <span class="st">&quot;event&quot;</span>)</span>
<span id="cb12-21"><a href="what-is-time-to-event-data.html#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="at">b1 =</span> <span class="fu">summary</span>(mod)[[<span class="dv">3</span>]][<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb12-22"><a href="what-is-time-to-event-data.html#cb12-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">ESb1 =</span> <span class="fu">summary</span>(mod)[[<span class="dv">3</span>]][<span class="dv">1</span>,<span class="dv">2</span>],</span>
<span id="cb12-23"><a href="what-is-time-to-event-data.html#cb12-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">b2 =</span> <span class="fu">summary</span>(modTE)[[<span class="dv">3</span>]][<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb12-24"><a href="what-is-time-to-event-data.html#cb12-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">ESb2 =</span> <span class="fu">summary</span>(modTE)[[<span class="dv">3</span>]][<span class="dv">1</span>,<span class="dv">2</span>],</span>
<span id="cb12-25"><a href="what-is-time-to-event-data.html#cb12-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">d1 =</span> <span class="fu">summary</span>(mod)[[<span class="dv">3</span>]][<span class="dv">2</span>,<span class="dv">1</span>],</span>
<span id="cb12-26"><a href="what-is-time-to-event-data.html#cb12-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">ESd1 =</span> <span class="fu">summary</span>(mod)[[<span class="dv">3</span>]][<span class="dv">2</span>,<span class="dv">2</span>],</span>
<span id="cb12-27"><a href="what-is-time-to-event-data.html#cb12-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">d2 =</span> <span class="fu">summary</span>(modTE)[[<span class="dv">3</span>]][<span class="dv">2</span>,<span class="dv">1</span>],</span>
<span id="cb12-28"><a href="what-is-time-to-event-data.html#cb12-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">ESd2 =</span> <span class="fu">summary</span>(modTE)[[<span class="dv">3</span>]][<span class="dv">2</span>,<span class="dv">2</span>],</span>
<span id="cb12-29"><a href="what-is-time-to-event-data.html#cb12-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">e1 =</span> <span class="fu">summary</span>(mod)[[<span class="dv">3</span>]][<span class="dv">3</span>,<span class="dv">1</span>],</span>
<span id="cb12-30"><a href="what-is-time-to-event-data.html#cb12-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">ESe1 =</span> <span class="fu">summary</span>(mod)[[<span class="dv">3</span>]][<span class="dv">3</span>,<span class="dv">2</span>],</span>
<span id="cb12-31"><a href="what-is-time-to-event-data.html#cb12-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">e2 =</span> <span class="fu">summary</span>(modTE)[[<span class="dv">3</span>]][<span class="dv">3</span>,<span class="dv">1</span>],</span>
<span id="cb12-32"><a href="what-is-time-to-event-data.html#cb12-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">ESe2 =</span> <span class="fu">summary</span>(modTE)[[<span class="dv">3</span>]][<span class="dv">3</span>,<span class="dv">2</span>] )</span>
<span id="cb12-33"><a href="what-is-time-to-event-data.html#cb12-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-34"><a href="what-is-time-to-event-data.html#cb12-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-35"><a href="what-is-time-to-event-data.html#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb12-36"><a href="what-is-time-to-event-data.html#cb12-36" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb12-37"><a href="what-is-time-to-event-data.html#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb12-38"><a href="what-is-time-to-event-data.html#cb12-38" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">GermSampling</span>(<span class="dv">100</span>, <span class="dv">40</span>, <span class="dv">1</span>, <span class="fl">4.5</span>, <span class="fl">1.6</span>, <span class="fl">0.85</span>)</span>
<span id="cb12-39"><a href="what-is-time-to-event-data.html#cb12-39" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result, res)</span>
<span id="cb12-40"><a href="what-is-time-to-event-data.html#cb12-40" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb12-41"><a href="what-is-time-to-event-data.html#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;b1&quot;</span>, <span class="st">&quot;ESb1&quot;</span>, <span class="st">&quot;b2&quot;</span>, <span class="st">&quot;ESb2&quot;</span>,</span>
<span id="cb12-42"><a href="what-is-time-to-event-data.html#cb12-42" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;d1&quot;</span>, <span class="st">&quot;ESd1&quot;</span>, <span class="st">&quot;d2&quot;</span>, <span class="st">&quot;ESd2&quot;</span>,</span>
<span id="cb12-43"><a href="what-is-time-to-event-data.html#cb12-43" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;e1&quot;</span>, <span class="st">&quot;ESe1&quot;</span>, <span class="st">&quot;e2&quot;</span>, <span class="st">&quot;ESe2&quot;</span>)</span>
<span id="cb12-44"><a href="what-is-time-to-event-data.html#cb12-44" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> result[result<span class="sc">$</span>d2 <span class="sc">&gt;</span> <span class="dv">0</span>,]</span></code></pre></div>
<p>We have stored our results in the data frame ‘result’. The means of estimates obtained for both methods should be equal to the real values that we used for the simulation, which will ensure that estimators are unbiased. The means of standard errors (in brackets, below) should represent the real sample-to-sample variability, which may be obtained from the Monte Carlo standard deviation, i.e. from the standard deviation of the 1000 estimates for each parameter and method.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left"><span class="math inline">\(b\)</span></th>
<th align="left"><span class="math inline">\(d\)</span></th>
<th align="left"><span class="math inline">\(e\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Nonlinear regression</td>
<td align="left">1.63 (0.051)</td>
<td align="left">0.85 (0.006)</td>
<td align="left">4.55 (0.086)</td>
</tr>
<tr class="even">
<td align="left">Time-to-event method</td>
<td align="left">1.62 (0.187)</td>
<td align="left">0.85 (0.041)</td>
<td align="left">4.55 (0.579)</td>
</tr>
<tr class="odd">
<td align="left">Real values</td>
<td align="left">1.60 (0.188)</td>
<td align="left">0.85 (0.041)</td>
<td align="left">4.55 (0.593)</td>
</tr>
</tbody>
</table>
<p>We clearly see that both nonlinear regression and the time-to-event method lead to unbiased estimates of model parameters. However, standard errors from nonlinear regression are severely biased and underestimated. On the contrary, standard errors from time-to-event method are unbiased.</p>
</div>
<div id="take-home-message" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Take-home message<a href="what-is-time-to-event-data.html#take-home-message" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Censoring is peculiar to germination assays and other time-to-event studies. It may have a strong impact on the reliability of our standard errors and, consequently, on hypotheses testing. Therefore, censoring should never be neglected and time-to-event methods should necessarily be used for data analyses. The body of time-to-event methods often goes under the name of ‘survival analysis’, which creates a direct connection between survival data and germination/emergence data.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reshaping-time-to-event-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_seedGerminationTutorial.pdf", "_seedGerminationTutorial.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
