<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capitolo 9 Combinazioni lineari/nonlineari dei parametri | Metodologia sperimentale per le scienze agrarie</title>
  <meta name="description" content="Capitolo 9 Combinazioni lineari/nonlineari dei parametri | Metodologia sperimentale per le scienze agrarie con applicazioni in R" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Capitolo 9 Combinazioni lineari/nonlineari dei parametri | Metodologia sperimentale per le scienze agrarie" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Capitolo 9 Combinazioni lineari/nonlineari dei parametri | Metodologia sperimentale per le scienze agrarie con applicazioni in R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capitolo 9 Combinazioni lineari/nonlineari dei parametri | Metodologia sperimentale per le scienze agrarie" />
  
  <meta name="twitter:description" content="Capitolo 9 Combinazioni lineari/nonlineari dei parametri | Metodologia sperimentale per le scienze agrarie con applicazioni in R" />
  

<meta name="author" content="Andrea Onofri e Dario Sacco" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="verifica-dei-modelli.html"/>
<link rel="next" href="ricomponiamo-il-puzzle.html"/>
<script src="book_assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="book_assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="book_assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="book_assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131792052-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-131792052-1');
  </script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Metodologia sperimentale</a></strong></li> 

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Premessa</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#obiettivi"><i class="fa fa-check"></i>Obiettivi</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organizzazione"><i class="fa fa-check"></i>Organizzazione</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-statistico"><i class="fa fa-check"></i>Software statistico</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#gli-autori"><i class="fa fa-check"></i>Gli autori</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ringraziamenti-e-scuse"><i class="fa fa-check"></i>Ringraziamenti e scuse</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acronimi"><i class="fa fa-check"></i>Acronimi</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html"><i class="fa fa-check"></i><b>1</b> Scienza e pseudo-scienza</a>
<ul>
<li class="chapter" data-level="1.1" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#scienza-dati"><i class="fa fa-check"></i><b>1.1</b> Scienza = dati</a></li>
<li class="chapter" data-level="1.2" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#dati-buoni-e-cattivi"><i class="fa fa-check"></i><b>1.2</b> Dati ‘buoni’ e ‘cattivi’</a></li>
<li class="chapter" data-level="1.3" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#dati-buoni-e-metodi-buoni"><i class="fa fa-check"></i><b>1.3</b> Dati ‘buoni’ e metodi ‘buoni’</a></li>
<li class="chapter" data-level="1.4" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#il-principio-di-falsificazione"><i class="fa fa-check"></i><b>1.4</b> Il principio di falsificazione</a></li>
<li class="chapter" data-level="1.5" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#falsificare-un-risultato"><i class="fa fa-check"></i><b>1.5</b> Falsificare un risultato</a></li>
<li class="chapter" data-level="1.6" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#elementi-fondamentali-del-disegno-sperimentale"><i class="fa fa-check"></i><b>1.6</b> Elementi fondamentali del disegno sperimentale</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#controllo-degli-errori"><i class="fa fa-check"></i><b>1.6.1</b> Controllo degli errori</a></li>
<li class="chapter" data-level="1.6.2" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#replicazione"><i class="fa fa-check"></i><b>1.6.2</b> Replicazione</a></li>
<li class="chapter" data-level="1.6.3" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#randomizzazione"><i class="fa fa-check"></i><b>1.6.3</b> Randomizzazione</a></li>
<li class="chapter" data-level="1.6.4" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#esperimenti-invalidi"><i class="fa fa-check"></i><b>1.6.4</b> Esperimenti invalidi</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#chi-valuta-se-un-esperimento-è-attendibile"><i class="fa fa-check"></i><b>1.7</b> Chi valuta se un esperimento è attendibile?</a></li>
<li class="chapter" data-level="1.8" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#conclusioni"><i class="fa fa-check"></i><b>1.8</b> Conclusioni</a></li>
<li class="chapter" data-level="1.9" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#esercizi-e-domande"><i class="fa fa-check"></i><b>1.9</b> Esercizi e domande</a></li>
<li class="chapter" data-level="1.10" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#altre-letture"><i class="fa fa-check"></i><b>1.10</b> Altre letture</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html"><i class="fa fa-check"></i><b>2</b> Progettare un esperimento</a>
<ul>
<li class="chapter" data-level="2.1" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#gli-elementi-della-ricerca"><i class="fa fa-check"></i><b>2.1</b> Gli elementi della ricerca</a></li>
<li class="chapter" data-level="2.2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#ipotesi-scientifica-rightarrow-obiettivo-dellesperimento"><i class="fa fa-check"></i><b>2.2</b> Ipotesi scientifica <span class="math inline">\(\rightarrow\)</span> obiettivo dell’esperimento</a></li>
<li class="chapter" data-level="2.3" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#identificazione-dei-fattori-sperimentali"><i class="fa fa-check"></i><b>2.3</b> Identificazione dei fattori sperimentali</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esperimenti-multi-fattoriali"><i class="fa fa-check"></i><b>2.3.1</b> Esperimenti (multi-)fattoriali</a></li>
<li class="chapter" data-level="2.3.2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#controllo-o-testimone"><i class="fa fa-check"></i><b>2.3.2</b> Controllo o testimone</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#le-unità-sperimentali"><i class="fa fa-check"></i><b>2.4</b> Le unità sperimentali</a></li>
<li class="chapter" data-level="2.5" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#allocazione-dei-trattamenti"><i class="fa fa-check"></i><b>2.5</b> Allocazione dei trattamenti</a></li>
<li class="chapter" data-level="2.6" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#le-variabili-sperimentali"><i class="fa fa-check"></i><b>2.6</b> Le variabili sperimentali</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#variabili-nominali-categoriche"><i class="fa fa-check"></i><b>2.6.1</b> Variabili nominali (categoriche)</a></li>
<li class="chapter" data-level="2.6.2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#variabili-ordinali"><i class="fa fa-check"></i><b>2.6.2</b> Variabili ordinali</a></li>
<li class="chapter" data-level="2.6.3" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#variabili-quantitative-discrete"><i class="fa fa-check"></i><b>2.6.3</b> Variabili quantitative discrete</a></li>
<li class="chapter" data-level="2.6.4" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#variabili-quantitative-continue"><i class="fa fa-check"></i><b>2.6.4</b> Variabili quantitative continue</a></li>
<li class="chapter" data-level="2.6.5" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#rilievi-visivi-e-sensoriali"><i class="fa fa-check"></i><b>2.6.5</b> Rilievi visivi e sensoriali</a></li>
<li class="chapter" data-level="2.6.6" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#variabili-di-confondimento"><i class="fa fa-check"></i><b>2.6.6</b> Variabili di confondimento</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esperimenti-di-campo"><i class="fa fa-check"></i><b>2.7</b> Esperimenti di campo</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#scegliere-il-campo"><i class="fa fa-check"></i><b>2.7.1</b> Scegliere il campo</a></li>
<li class="chapter" data-level="2.7.2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#le-unità-sperimentali-in-campo"><i class="fa fa-check"></i><b>2.7.2</b> Le unità sperimentali in campo</a></li>
<li class="chapter" data-level="2.7.3" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#numero-di-repliche"><i class="fa fa-check"></i><b>2.7.3</b> Numero di repliche</a></li>
<li class="chapter" data-level="2.7.4" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#la-mappa-di-campo"><i class="fa fa-check"></i><b>2.7.4</b> La mappa di campo</a></li>
<li class="chapter" data-level="2.7.5" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#lay-out-sperimentale"><i class="fa fa-check"></i><b>2.7.5</b> Lay-out sperimentale</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#altre-letture-1"><i class="fa fa-check"></i><b>2.8</b> Altre letture</a></li>
<li class="chapter" data-level="2.9" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domande-ed-esercizi"><i class="fa fa-check"></i><b>2.9</b> Domande ed esercizi</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-1"><i class="fa fa-check"></i><b>2.9.1</b> Domanda 1</a></li>
<li class="chapter" data-level="2.9.2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-2"><i class="fa fa-check"></i><b>2.9.2</b> Domanda 2</a></li>
<li class="chapter" data-level="2.9.3" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-3"><i class="fa fa-check"></i><b>2.9.3</b> Domanda 3</a></li>
<li class="chapter" data-level="2.9.4" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-4"><i class="fa fa-check"></i><b>2.9.4</b> Domanda 4</a></li>
<li class="chapter" data-level="2.9.5" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-5"><i class="fa fa-check"></i><b>2.9.5</b> Domanda 5</a></li>
<li class="chapter" data-level="2.9.6" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-6"><i class="fa fa-check"></i><b>2.9.6</b> Domanda 6</a></li>
<li class="chapter" data-level="2.9.7" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-7"><i class="fa fa-check"></i><b>2.9.7</b> Domanda 7</a></li>
<li class="chapter" data-level="2.9.8" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-8"><i class="fa fa-check"></i><b>2.9.8</b> Domanda 8</a></li>
<li class="chapter" data-level="2.9.9" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-9"><i class="fa fa-check"></i><b>2.9.9</b> Domanda 9</a></li>
<li class="chapter" data-level="2.9.10" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-10"><i class="fa fa-check"></i><b>2.9.10</b> Domanda 10</a></li>
<li class="chapter" data-level="2.9.11" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-12"><i class="fa fa-check"></i><b>2.9.11</b> Domanda 12</a></li>
<li class="chapter" data-level="2.9.12" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-13"><i class="fa fa-check"></i><b>2.9.12</b> Domanda 13</a></li>
<li class="chapter" data-level="2.9.13" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esercizio-1"><i class="fa fa-check"></i><b>2.9.13</b> Esercizio 1</a></li>
<li class="chapter" data-level="2.9.14" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esercizio-2"><i class="fa fa-check"></i><b>2.9.14</b> Esercizio 2</a></li>
<li class="chapter" data-level="2.9.15" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esercizio-3"><i class="fa fa-check"></i><b>2.9.15</b> Esercizio 3</a></li>
<li class="chapter" data-level="2.9.16" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esercizio-4"><i class="fa fa-check"></i><b>2.9.16</b> Esercizio 4</a></li>
<li class="chapter" data-level="2.9.17" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esercizio-5"><i class="fa fa-check"></i><b>2.9.17</b> Esercizio 5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html"><i class="fa fa-check"></i><b>3</b> Richiami di statistica descrittiva</a>
<ul>
<li class="chapter" data-level="3.1" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#descrizione-di-dati-quantitativi"><i class="fa fa-check"></i><b>3.1</b> Descrizione di dati quantitativi</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#indicatori-di-tendenza-centrale"><i class="fa fa-check"></i><b>3.1.1</b> Indicatori di tendenza centrale</a></li>
<li class="chapter" data-level="3.1.2" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#indicatori-di-dispersione"><i class="fa fa-check"></i><b>3.1.2</b> Indicatori di dispersione</a></li>
<li class="chapter" data-level="3.1.3" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#incertezza-delle-misure-derivate"><i class="fa fa-check"></i><b>3.1.3</b> Incertezza delle misure derivate</a></li>
<li class="chapter" data-level="3.1.4" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#relazioni-tra-variabili-quantitative-correlazione"><i class="fa fa-check"></i><b>3.1.4</b> Relazioni tra variabili quantitative: correlazione</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#statistiche-descrittive-con-r"><i class="fa fa-check"></i><b>3.2</b> Statistiche descrittive con R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#descrizione-dei-sottogruppi"><i class="fa fa-check"></i><b>3.2.1</b> Descrizione dei sottogruppi</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#altre-letture-2"><i class="fa fa-check"></i><b>3.3</b> Altre letture</a></li>
<li class="chapter" data-level="3.4" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#domande-ed-esercizi-1"><i class="fa fa-check"></i><b>3.4</b> Domande ed esercizi</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html"><i class="fa fa-check"></i><b>4</b> Le relazioni causa-effetto</a>
<ul>
<li class="chapter" data-level="4.1" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#modelli-matematici-e-statistici"><i class="fa fa-check"></i><b>4.1</b> Modelli matematici e statistici</a></li>
<li class="chapter" data-level="4.2" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#componenti-di-un-modello"><i class="fa fa-check"></i><b>4.2</b> Componenti di un modello</a></li>
<li class="chapter" data-level="4.3" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#fitting-di-un-modello"><i class="fa fa-check"></i><b>4.3</b> <em>Fitting</em> di un modello</a></li>
<li class="chapter" data-level="4.4" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#esempio-1-il-modello-della-media"><i class="fa fa-check"></i><b>4.4</b> Esempio 1: il ‘modello della media’</a></li>
<li class="chapter" data-level="4.5" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#esempio-2-un-predittore-quantitativo"><i class="fa fa-check"></i><b>4.5</b> Esempio 2: un predittore quantitativo</a></li>
<li class="chapter" data-level="4.6" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#esempio-3-un-predittore-nominale"><i class="fa fa-check"></i><b>4.6</b> Esempio 3: un predittore nominale</a></li>
<li class="chapter" data-level="4.7" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#lanalisi-della-varianza-anova"><i class="fa fa-check"></i><b>4.7</b> L’analisi della varianza (ANOVA)</a></li>
<li class="chapter" data-level="4.8" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#example-4-due-predittori-nominali"><i class="fa fa-check"></i><b>4.8</b> Example 4: due predittori nominali</a></li>
<li class="chapter" data-level="4.9" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#example-5-due-predittori-nominali-con-interazione"><i class="fa fa-check"></i><b>4.9</b> Example 5: due predittori nominali con interazione</a></li>
<li class="chapter" data-level="4.10" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#interazione-tra-fattori-sperimentali"><i class="fa fa-check"></i><b>4.10</b> Interazione tra fattori sperimentali</a></li>
<li class="chapter" data-level="4.11" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#example-5-segue"><i class="fa fa-check"></i><b>4.11</b> Example 5 (segue)</a></li>
<li class="chapter" data-level="4.12" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#dati-non-bilanciati"><i class="fa fa-check"></i><b>4.12</b> Dati non bilanciati</a></li>
<li class="chapter" data-level="4.13" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#esempio-6-un-crbd-con-un-valore-mancante"><i class="fa fa-check"></i><b>4.13</b> Esempio 6: un CRBD con un valore mancante</a></li>
<li class="chapter" data-level="4.14" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#conclusioni-1"><i class="fa fa-check"></i><b>4.14</b> Conclusioni</a></li>
<li class="chapter" data-level="4.15" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#altre-letture-3"><i class="fa fa-check"></i><b>4.15</b> Altre letture</a></li>
<li class="chapter" data-level="4.16" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#domande-ed-esercizi-2"><i class="fa fa-check"></i><b>4.16</b> Domande ed esercizi</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html"><i class="fa fa-check"></i><b>5</b> Modelli stocastici</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#funzioni-di-probabilitàdensità"><i class="fa fa-check"></i><b>5.1</b> Funzioni di probabilità/densità</a></li>
<li class="chapter" data-level="5.2" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#calcolare-le-probabilità"><i class="fa fa-check"></i><b>5.2</b> Calcolare le probabilità</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#esempio-5.1-calcolare-la-probabilità-in-un-esperimento-misurativo"><i class="fa fa-check"></i><b>5.2.1</b> Esempio 5.1: Calcolare la probabilità in un esperimento misurativo</a></li>
<li class="chapter" data-level="5.2.2" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#esempio-5.2-calcolo-della-probabilità-per-un-esperimento-di-degradazione"><i class="fa fa-check"></i><b>5.2.2</b> Esempio 5.2: Calcolo della probabilità per un esperimento di degradazione</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#simulazione-stocastica"><i class="fa fa-check"></i><b>5.3</b> Simulazione stocastica</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#esempio-5.3.-simulazione-di-un-esperimento-misurativo"><i class="fa fa-check"></i><b>5.3.1</b> Esempio 5.3. Simulazione di un esperimento misurativo</a></li>
<li class="chapter" data-level="5.3.2" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#esempio-5.4-simulazione-di-un-esperimento-di-fertilizzazione"><i class="fa fa-check"></i><b>5.3.2</b> Esempio 5.4: simulazione di un esperimento di fertilizzazione</a></li>
<li class="chapter" data-level="5.3.3" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#esempio-5.4-simulazione-di-una-prova-di-confronto-varietale"><i class="fa fa-check"></i><b>5.3.3</b> Esempio 5.4: Simulazione di una prova di confronto varietale</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#conclusioni-2"><i class="fa fa-check"></i><b>5.4</b> Conclusioni</a></li>
<li class="chapter" data-level="5.5" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#altre-letture-4"><i class="fa fa-check"></i><b>5.5</b> Altre letture</a></li>
<li class="chapter" data-level="5.6" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#domande-ed-esercizi-3"><i class="fa fa-check"></i><b>5.6</b> Domande ed esercizi</a></li>
<li class="chapter" data-level="5.7" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#soluzioni"><i class="fa fa-check"></i><b>5.7</b> Soluzioni</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html"><i class="fa fa-check"></i><b>6</b> Stime ed incertezza</a>
<ul>
<li class="chapter" data-level="6.1" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#ripetere-gli-esperimenti"><i class="fa fa-check"></i><b>6.1</b> Ripetere gli esperimenti</a></li>
<li class="chapter" data-level="6.2" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#la-sampling-distribution-teorica"><i class="fa fa-check"></i><b>6.2</b> La ‘sampling distribution’ teorica</a></li>
<li class="chapter" data-level="6.3" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#lintervallo-di-confidenza-frequentista"><i class="fa fa-check"></i><b>6.3</b> L’intervallo di confidenza frequentista</a></li>
<li class="chapter" data-level="6.4" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#come-otteniamo-lerrore-standard"><i class="fa fa-check"></i><b>6.4</b> Come otteniamo l’errore standard?</a></li>
<li class="chapter" data-level="6.5" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#come-otteniamo-il-moltiplicatore-k"><i class="fa fa-check"></i><b>6.5</b> Come otteniamo il moltiplicatore <span class="math inline">\(k\)</span>?</a></li>
<li class="chapter" data-level="6.6" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#gli-intervalli-di-confidenza-in-pratica"><i class="fa fa-check"></i><b>6.6</b> Gli intervalli di confidenza in pratica</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#esempio-6.1-ic-per-una-media-campionaria"><i class="fa fa-check"></i><b>6.6.1</b> Esempio 6.1: IC per una media campionaria</a></li>
<li class="chapter" data-level="6.6.2" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#example-6.2-cis-for-model-parameters"><i class="fa fa-check"></i><b>6.6.2</b> Example 6.2: CIs for model parameters</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#altri-approcci-per-il-calcolo-dei-ci"><i class="fa fa-check"></i><b>6.7</b> Altri approcci per il calcolo dei CI</a></li>
<li class="chapter" data-level="6.8" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#limitazioni-del-ci-frequentista"><i class="fa fa-check"></i><b>6.8</b> Limitazioni del CI frequentista</a></li>
<li class="chapter" data-level="6.9" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#altre-letture-5"><i class="fa fa-check"></i><b>6.9</b> Altre letture</a></li>
<li class="chapter" data-level="6.10" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#domande-ed-esercizi-4"><i class="fa fa-check"></i><b>6.10</b> Domande ed esercizi</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html"><i class="fa fa-check"></i><b>7</b> Decisioni ed incertezza</a>
<ul>
<li class="chapter" data-level="7.1" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#esempio-7.1-confronto-tra-due-genotipi"><i class="fa fa-check"></i><b>7.1</b> Esempio 7.1: Confronto tra due genotipi</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#lipotesi-nulla"><i class="fa fa-check"></i><b>7.1.1</b> L’ipotesi ‘nulla’</a></li>
<li class="chapter" data-level="7.1.2" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#il-test-di-t-wald-test"><i class="fa fa-check"></i><b>7.1.2</b> Il test di t (Wald test)</a></li>
<li class="chapter" data-level="7.1.3" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#simulazione-monte-carlo"><i class="fa fa-check"></i><b>7.1.3</b> Simulazione Monte Carlo</a></li>
<li class="chapter" data-level="7.1.4" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#una-soluzione-formale"><i class="fa fa-check"></i><b>7.1.4</b> Una soluzione formale</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#altri-test-di-t"><i class="fa fa-check"></i><b>7.2</b> Altri test di t</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#il-test-t-di-student"><i class="fa fa-check"></i><b>7.2.1</b> Il test t di Student</a></li>
<li class="chapter" data-level="7.2.2" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#il-test-di-welch"><i class="fa fa-check"></i><b>7.2.2</b> Il test di Welch</a></li>
<li class="chapter" data-level="7.2.3" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#il-test-di-t-appaiato"><i class="fa fa-check"></i><b>7.2.3</b> Il test di t appaiato</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#differenze-generalizzate-tra-parametri"><i class="fa fa-check"></i><b>7.3</b> Differenze generalizzate tra parametri</a></li>
<li class="chapter" data-level="7.4" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#il-test-f-nellanova"><i class="fa fa-check"></i><b>7.4</b> Il test F nell’ANOVA</a></li>
<li class="chapter" data-level="7.5" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#conclusioni-3"><i class="fa fa-check"></i><b>7.5</b> Conclusioni</a></li>
<li class="chapter" data-level="7.6" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#altre-letture-6"><i class="fa fa-check"></i><b>7.6</b> Altre letture</a></li>
<li class="chapter" data-level="7.7" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#esercizi"><i class="fa fa-check"></i><b>7.7</b> Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html"><i class="fa fa-check"></i><b>8</b> Verifica dei modelli</a>
<ul>
<li class="chapter" data-level="8.1" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#deviazioni-rispetto-alle-assunzioni-di-base"><i class="fa fa-check"></i><b>8.1</b> Deviazioni rispetto alle assunzioni di base</a></li>
<li class="chapter" data-level="8.2" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#scoprire-le-violazioni"><i class="fa fa-check"></i><b>8.2</b> Scoprire le violazioni</a></li>
<li class="chapter" data-level="8.3" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#analisi-grafica-dei-residui"><i class="fa fa-check"></i><b>8.3</b> Analisi grafica dei residui</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#grafico-dei-valori-osservati-aumentato-con-le-previsioni-del-modello"><i class="fa fa-check"></i><b>8.3.1</b> Grafico dei valori osservati, aumentato con le previsioni del modello</a></li>
<li class="chapter" data-level="8.3.2" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#grafico-dei-residui-contro-i-valori-attesi"><i class="fa fa-check"></i><b>8.3.2</b> Grafico dei residui contro i valori attesi</a></li>
<li class="chapter" data-level="8.3.3" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#qq-plot"><i class="fa fa-check"></i><b>8.3.3</b> QQ-plot</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#test-dipotesi"><i class="fa fa-check"></i><b>8.4</b> Test d’ipotesi</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#test-di-levene-per-lomogeneità-delle-varianze"><i class="fa fa-check"></i><b>8.4.1</b> Test di Levene per l’omogeneità delle varianze</a></li>
<li class="chapter" data-level="8.4.2" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#test-di-shapiro-wilk-per-la-normalità"><i class="fa fa-check"></i><b>8.4.2</b> Test di Shapiro-Wilk per la normalità</a></li>
<li class="chapter" data-level="8.4.3" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#altri-test"><i class="fa fa-check"></i><b>8.4.3</b> Altri test</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#esempio-8.1-analisi-dei-residui-per-il-dataset-mixture"><i class="fa fa-check"></i><b>8.5</b> Esempio 8.1: Analisi dei residui per il dataset “mixture”</a></li>
<li class="chapter" data-level="8.6" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#esempio-8.2-analisi-dei-residui-per-il-dataset-insects"><i class="fa fa-check"></i><b>8.6</b> Esempio 8.2: Analisi dei residui per il dataset ‘insects’</a></li>
<li class="chapter" data-level="8.7" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#misure-correttive"><i class="fa fa-check"></i><b>8.7</b> Misure correttive</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#correzionerimozione-degli-outliers"><i class="fa fa-check"></i><b>8.7.1</b> Correzione/Rimozione degli outliers</a></li>
<li class="chapter" data-level="8.7.2" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#correzione-del-modello"><i class="fa fa-check"></i><b>8.7.2</b> Correzione del modello</a></li>
<li class="chapter" data-level="8.7.3" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#trasformazione-del-predittore"><i class="fa fa-check"></i><b>8.7.3</b> Trasformazione del predittore</a></li>
<li class="chapter" data-level="8.7.4" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#trasformazione-della-risposta"><i class="fa fa-check"></i><b>8.7.4</b> Trasformazione della risposta</a></li>
<li class="chapter" data-level="8.7.5" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#esempio-8.1-segue"><i class="fa fa-check"></i><b>8.7.5</b> Esempio 8.1 (segue)</a></li>
<li class="chapter" data-level="8.7.6" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#esempio-8.2-segue"><i class="fa fa-check"></i><b>8.7.6</b> Esempio 8.2 (segue)</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#risultati-contraddittori"><i class="fa fa-check"></i><b>8.8</b> Risultati contraddittori</a></li>
<li class="chapter" data-level="8.9" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#altri-approcci-avanzati"><i class="fa fa-check"></i><b>8.9</b> Altri approcci ‘avanzati’</a></li>
<li class="chapter" data-level="8.10" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#altre-letture-7"><i class="fa fa-check"></i><b>8.10</b> Altre letture</a></li>
<li class="chapter" data-level="8.11" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#esercizi-1"><i class="fa fa-check"></i><b>8.11</b> Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html"><i class="fa fa-check"></i><b>9</b> Combinazioni lineari/nonlineari dei parametri</a>
<ul>
<li class="chapter" data-level="9.1" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.1-determinare-leffetto-medio-degli-erbicidi"><i class="fa fa-check"></i><b>9.1</b> Esempio 9.1: Determinare l’effetto medio degli erbicidi</a></li>
<li class="chapter" data-level="9.2" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.2-determinare-lefficiacia-erbicida-media"><i class="fa fa-check"></i><b>9.2</b> Esempio 9.2: Determinare l’efficiacia erbicida media</a></li>
<li class="chapter" data-level="9.3" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#combinazioni-di-interesse-generale"><i class="fa fa-check"></i><b>9.3</b> Combinazioni di interesse generale</a></li>
<li class="chapter" data-level="9.4" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#example-9.4-contrasti-ortogonali-e-non"><i class="fa fa-check"></i><b>9.4</b> Example 9.4: Contrasti ortogonali (e non)</a></li>
<li class="chapter" data-level="9.5" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.5-i-confronti-multipli-a-coppie"><i class="fa fa-check"></i><b>9.5</b> Esempio 9.5: I confronti multipli a coppie</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#display-a-lettere"><i class="fa fa-check"></i><b>9.5.1</b> Display a lettere</a></li>
<li class="chapter" data-level="9.5.2" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#correzione-per-la-molteplicità"><i class="fa fa-check"></i><b>9.5.2</b> Correzione per la molteplicità</a></li>
<li class="chapter" data-level="9.5.3" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#procedure-classiche-di-confronto-multiplo"><i class="fa fa-check"></i><b>9.5.3</b> Procedure ‘classiche’ di confronto multiplo</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.6-confronti-multipli-con-dati-trasformati"><i class="fa fa-check"></i><b>9.6</b> Esempio 9.6: confronti multipli con dati trasformati</a></li>
<li class="chapter" data-level="9.7" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.7-previsioni-e-previsioni-inverse"><i class="fa fa-check"></i><b>9.7</b> Esempio 9.7: Previsioni e previsioni inverse</a></li>
<li class="chapter" data-level="9.8" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#altre-letture-8"><i class="fa fa-check"></i><b>9.8</b> Altre letture</a></li>
<li class="chapter" data-level="9.9" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esercizi-2"><i class="fa fa-check"></i><b>9.9</b> Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html"><i class="fa fa-check"></i><b>10</b> Ricomponiamo il ‘puzzle’</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esempio-10.1-confronto-tra-erbicidi-in-un-esperimento-a-blocchi-randomizzati"><i class="fa fa-check"></i><b>10.1</b> Esempio 10.1: Confronto tra erbicidi in un esperimento a blocchi randomizzati</a></li>
<li class="chapter" data-level="10.2" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esempio-10.2-confronto-tra-co-adiuvanti-in-un-esperimento-a-quadrato-latino"><i class="fa fa-check"></i><b>10.2</b> Esempio 10.2: confronto tra co-adiuvanti in un esperimento a quadrato latino</a></li>
<li class="chapter" data-level="10.3" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esempio-10.3-interazione-tra-genotipo-e-concimazione-azotata"><i class="fa fa-check"></i><b>10.3</b> Esempio 10.3: interazione tra genotipo e concimazione azotata</a></li>
<li class="chapter" data-level="10.4" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esempio-10.4-confronto-tra-incroci-in-un-disegno-fattoriale-gerarchico"><i class="fa fa-check"></i><b>10.4</b> Esempio 10.4: confronto tra incroci in un disegno fattoriale gerarchico</a></li>
<li class="chapter" data-level="10.5" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esempio-10.5-un-esperimento-di-germinazione-ripetuto-due-volte"><i class="fa fa-check"></i><b>10.5</b> Esempio 10.5: un esperimento di germinazione ripetuto due volte</a></li>
<li class="chapter" data-level="10.6" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#altre-letture-9"><i class="fa fa-check"></i><b>10.6</b> Altre letture</a></li>
<li class="chapter" data-level="10.7" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esercizi-3"><i class="fa fa-check"></i><b>10.7</b> Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="modelli-di-regressione-avanzati.html"><a href="modelli-di-regressione-avanzati.html"><i class="fa fa-check"></i><b>11</b> Modelli di regressione ‘avanzati’</a></li>
<li class="chapter" data-level="12" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html"><i class="fa fa-check"></i><b>12</b> Breve introduzione ai modelli misti</a>
<ul>
<li class="chapter" data-level="12.1" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.1-un-esperimento-di-lavorazione-a-split-plot"><i class="fa fa-check"></i><b>12.1</b> Esempio 12.1: un esperimento di lavorazione a split-plot</a></li>
<li class="chapter" data-level="12.2" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.2-un-esperimento-di-recropping-a-strip-plot"><i class="fa fa-check"></i><b>12.2</b> Esempio 12.2: un esperimento di ‘recropping’ a strip-plot</a></li>
<li class="chapter" data-level="12.3" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.3-confronto-varietale-con-blocchi-random"><i class="fa fa-check"></i><b>12.3</b> Esempio 12.3: confronto varietale con blocchi ‘random’</a></li>
<li class="chapter" data-level="12.4" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.4-blocchi-randomizzati-con-sub-campionamento"><i class="fa fa-check"></i><b>12.4</b> Esempio 12.4: blocchi randomizzati con sub-campionamento</a></li>
<li class="chapter" data-level="12.5" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.5-confronto-varietale-ripetuto-in-più-anni"><i class="fa fa-check"></i><b>12.5</b> Esempio 12.5: confronto varietale ripetuto in più anni</a></li>
<li class="chapter" data-level="12.6" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.6-misure-ripetute-nelle-colture-poliennali"><i class="fa fa-check"></i><b>12.6</b> Esempio 12.6: misure ripetute nelle colture poliennali</a></li>
<li class="chapter" data-level="12.7" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#fattori-di-raggruppamento-nei-modelli-di-regressione"><i class="fa fa-check"></i><b>12.7</b> Fattori di raggruppamento nei modelli di regressione</a></li>
<li class="chapter" data-level="12.8" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#altre-letture-10"><i class="fa fa-check"></i><b>12.8</b> Altre letture</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html"><i class="fa fa-check"></i><b>13</b> Appendice A: Breve introduzione ad R</a>
<ul>
<li class="chapter" data-level="" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#cosa-è-r"><i class="fa fa-check"></i>Cosa è R?</a></li>
<li class="chapter" data-level="" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#installazione-di-r"><i class="fa fa-check"></i>Installazione di R</a></li>
<li class="chapter" data-level="13.1" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#prima-di-iniziare"><i class="fa fa-check"></i><b>13.1</b> Prima di iniziare</a></li>
<li class="chapter" data-level="13.2" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#oggetti-e-assegnazioni"><i class="fa fa-check"></i><b>13.2</b> Oggetti e assegnazioni</a></li>
<li class="chapter" data-level="13.3" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#tipi-di-oggetti"><i class="fa fa-check"></i><b>13.3</b> Tipi di oggetti</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#costanti-e-vettori"><i class="fa fa-check"></i><b>13.3.1</b> Costanti e vettori</a></li>
<li class="chapter" data-level="13.3.2" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#matrici"><i class="fa fa-check"></i><b>13.3.2</b> Matrici</a></li>
<li class="chapter" data-level="13.3.3" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#dataframe"><i class="fa fa-check"></i><b>13.3.3</b> Dataframe</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#lavorare-con-gli-oggetti"><i class="fa fa-check"></i><b>13.4</b> Lavorare con gli oggetti</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#visualizzazione"><i class="fa fa-check"></i><b>13.4.1</b> Visualizzazione</a></li>
<li class="chapter" data-level="13.4.2" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#indicizzazione"><i class="fa fa-check"></i><b>13.4.2</b> Indicizzazione</a></li>
<li class="chapter" data-level="13.4.3" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#estrazione-di-slots"><i class="fa fa-check"></i><b>13.4.3</b> Estrazione di <em>slots</em></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#espressioni-funzioni-e-argomenti"><i class="fa fa-check"></i><b>13.5</b> Espressioni, funzioni e argomenti</a></li>
<li class="chapter" data-level="13.6" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#funzioni-di-uso-comune"><i class="fa fa-check"></i><b>13.6</b> Funzioni di uso comune</a></li>
<li class="chapter" data-level="13.7" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#creazione-di-funzioni-personalizzate"><i class="fa fa-check"></i><b>13.7</b> Creazione di funzioni personalizzate</a></li>
<li class="chapter" data-level="13.8" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#uso-di-librerie-aggiuntive"><i class="fa fa-check"></i><b>13.8</b> Uso di librerie aggiuntive</a></li>
<li class="chapter" data-level="13.9" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#workspace"><i class="fa fa-check"></i><b>13.9</b> Workspace</a></li>
<li class="chapter" data-level="13.10" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#importare-dati-esterni"><i class="fa fa-check"></i><b>13.10</b> Importare dati esterni</a></li>
<li class="chapter" data-level="13.11" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#cenni-sulle-funzionalità-grafiche-in-r"><i class="fa fa-check"></i><b>13.11</b> Cenni sulle funzionalità grafiche in R</a></li>
<li class="chapter" data-level="13.12" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#altre-letture-11"><i class="fa fa-check"></i><b>13.12</b> Altre letture</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><i class="fa fa-check"></i><b>14</b> Appendice B: Statistica descrittiva per le variabili nominali</a>
<ul>
<li class="chapter" data-level="14.1" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#distribuzioni-di-frequenze-e-classamento"><i class="fa fa-check"></i><b>14.1</b> Distribuzioni di frequenze e classamento</a></li>
<li class="chapter" data-level="14.2" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#statistiche-descrittive-per-le-distribuzioni-di-frequenze"><i class="fa fa-check"></i><b>14.2</b> Statistiche descrittive per le distribuzioni di frequenze</a></li>
<li class="chapter" data-level="14.3" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#rappresentazione-grafica-delle-distribuzioni-di-frequenza"><i class="fa fa-check"></i><b>14.3</b> Rappresentazione grafica delle distribuzioni di frequenza</a></li>
<li class="chapter" data-level="14.4" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#distribuzioni-di-frequenza-bivariate-le-tabelle-di-contingenze"><i class="fa fa-check"></i><b>14.4</b> Distribuzioni di frequenza bivariate: le tabelle di contingenze</a></li>
<li class="chapter" data-level="14.5" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#connessione"><i class="fa fa-check"></i><b>14.5</b> Connessione</a></li>
<li class="chapter" data-level="14.6" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#il-chi-quadro-con-r"><i class="fa fa-check"></i><b>14.6</b> Il chi quadro con R</a></li>
<li class="chapter" data-level="14.7" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#altre-letture-12"><i class="fa fa-check"></i><b>14.7</b> Altre letture</a></li>
<li class="chapter" data-level="14.8" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#esercizi-4"><i class="fa fa-check"></i><b>14.8</b> Esercizi</a></li>
<li class="chapter" data-level="14.9" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#soluzioni-1"><i class="fa fa-check"></i><b>14.9</b> Soluzioni</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="appendice-c-intervalli-di-confidenza-per-una-proporzione.html"><a href="appendice-c-intervalli-di-confidenza-per-una-proporzione.html"><i class="fa fa-check"></i><b>15</b> Appendice C: Intervalli di confidenza per una proporzione</a>
<ul>
<li class="chapter" data-level="15.1" data-path="appendice-c-intervalli-di-confidenza-per-una-proporzione.html"><a href="appendice-c-intervalli-di-confidenza-per-una-proporzione.html#popolazioni-gaussiane-e-non"><i class="fa fa-check"></i><b>15.1</b> Popolazioni gaussiane e non</a></li>
<li class="chapter" data-level="15.2" data-path="appendice-c-intervalli-di-confidenza-per-una-proporzione.html"><a href="appendice-c-intervalli-di-confidenza-per-una-proporzione.html#cosa-fare-se-il-teorema-centrale-del-limite-non-funziona"><i class="fa fa-check"></i><b>15.2</b> Cosa fare se il teorema centrale del limite non funziona?</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="appendice-e-confronto-di-due-proporzioni.html"><a href="appendice-e-confronto-di-due-proporzioni.html"><i class="fa fa-check"></i><b>16</b> Appendice E: Confronto di due proporzioni</a>
<ul>
<li class="chapter" data-level="16.1" data-path="appendice-e-confronto-di-due-proporzioni.html"><a href="appendice-e-confronto-di-due-proporzioni.html#il-test-di-chi-quadro"><i class="fa fa-check"></i><b>16.1</b> Il test di ‘chi quadro’</a></li>
<li class="chapter" data-level="16.2" data-path="appendice-e-confronto-di-due-proporzioni.html"><a href="appendice-e-confronto-di-due-proporzioni.html#confronto-tra-due-proporzioni-con-simulazione-di-monte-carlo"><i class="fa fa-check"></i><b>16.2</b> Confronto tra due proporzioni con simulazione di Monte Carlo</a></li>
<li class="chapter" data-level="16.3" data-path="appendice-e-confronto-di-due-proporzioni.html"><a href="appendice-e-confronto-di-due-proporzioni.html#esercizi-5"><i class="fa fa-check"></i><b>16.3</b> Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="appendice-f-alcuni-problemi-collegati-con-le-deviazioni-rispetti-agli-assunti-di-base.html"><a href="appendice-f-alcuni-problemi-collegati-con-le-deviazioni-rispetti-agli-assunti-di-base.html"><i class="fa fa-check"></i><b>17</b> Appendice F: Alcuni problemi collegati con le deviazioni rispetti agli assunti di base</a></li>
<li class="divider"></li>
<li><strong><a href="https://www.statforbiology.com">Back to blog</a></strong></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Metodologia sperimentale per le scienze agrarie</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="combinazioni-linearinonlineari-dei-parametri" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Capitolo 9</span> Combinazioni lineari/nonlineari dei parametri<a href="combinazioni-linearinonlineari-dei-parametri.html#combinazioni-linearinonlineari-dei-parametri" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Dopo aver dimostrato che un modello fornisca una buona descrizione dei dati sperimentali e che non vi siano violazioni degli assunti di base, è possibile testare diverse ipotesi rilevanti che siano ‘traducibili’ in combinazioni lineari o non lineari dei parametri del modello, cioè delle funzioni che coinvolgono i parametri ed un insieme di coefficienti; per comprendere questo concetto e la sua importanza, iniziamo con un esempio.</p>
<div id="esempio-9.1-determinare-leffetto-medio-degli-erbicidi" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Esempio 9.1: Determinare l’effetto medio degli erbicidi<a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.1-determinare-leffetto-medio-degli-erbicidi" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Torniamo al nostro esperimento in cui abbiamo confrontato due erbicidi e la loro miscela con il testimone non trattato, in un disegno sperimentale completamente randomizzato con quattro repliche. Nel capitolo precedente, abbiamo visto che non vi sono problemi con nessuna delle assunzioni di base per il fitting dei modelli lineari, mentre l’analisi della varianza ed il relativo test di F hanno mostrato come esistano differenze significative tra alcuni dei trattamenti. Nel riquadro sottostante riportimo nuovamente il codice R per l’adattamento del modello.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 9.1</span></span>
<span id="cb83-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Determining the average effect of herbicides in the &#39;mixture&#39; data</span></span>
<span id="cb83-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the packages</span></span>
<span id="cb83-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statforbiology)</span>
<span id="cb83-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb83-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the data</span></span>
<span id="cb83-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-9" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">getAgroData</span>(<span class="st">&quot;mixture&quot;</span>)</span>
<span id="cb83-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting a one-way ANOVA model</span></span>
<span id="cb83-12"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-12" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Weight <span class="sc">~</span> Treat, <span class="at">data=</span>dataset)</span>
<span id="cb83-13"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb83-14"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb83-15"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb83-16"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = Weight ~ Treat, data = dataset)</span></span>
<span id="cb83-17"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb83-18"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb83-19"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="do">##    Min     1Q Median     3Q    Max </span></span>
<span id="cb83-20"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-20" aria-hidden="true" tabindex="-1"></a><span class="do">## -6.360 -2.469  0.380  2.567  6.025 </span></span>
<span id="cb83-21"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-21" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb83-22"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb83-23"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-23" aria-hidden="true" tabindex="-1"></a><span class="do">##                     Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb83-24"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-24" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)            9.175      1.959   4.684 0.000529 ***</span></span>
<span id="cb83-25"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-25" aria-hidden="true" tabindex="-1"></a><span class="do">## TreatMixture_378      -4.047      2.770  -1.461 0.169679    </span></span>
<span id="cb83-26"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-26" aria-hidden="true" tabindex="-1"></a><span class="do">## TreatRimsulfuron_30    7.685      2.770   2.774 0.016832 *  </span></span>
<span id="cb83-27"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-27" aria-hidden="true" tabindex="-1"></a><span class="do">## TreatUnweeded         17.598      2.770   6.352 3.65e-05 ***</span></span>
<span id="cb83-28"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-28" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb83-29"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb83-30"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-30" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb83-31"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 3.918 on 12 degrees of freedom</span></span>
<span id="cb83-32"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.8554, Adjusted R-squared:  0.8193 </span></span>
<span id="cb83-33"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-33" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 23.66 on 3 and 12 DF,  p-value: 2.509e-05</span></span>
<span id="cb83-34"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance partitioning</span></span>
<span id="cb83-35"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-35" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model)</span>
<span id="cb83-36"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb83-37"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-37" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb83-38"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: Weight</span></span>
<span id="cb83-39"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-39" aria-hidden="true" tabindex="-1"></a><span class="do">##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb83-40"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Treat      3 1089.53  363.18  23.663 2.509e-05 ***</span></span>
<span id="cb83-41"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-41" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 12  184.18   15.35                      </span></span>
<span id="cb83-42"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-42" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb83-43"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb83-43" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>A questo punto, è rilevante chiedersi: “Il controllo delle piante infestanti è stato (in media) una pratica efficace?”. Questa domanda ‘biologica’ può essere tradotta in una combinazione lineare dei parametri stimati, cioè: <span class="math inline">\(\mu\)</span> = 9.175, <span class="math inline">\(\alpha_2\)</span> = -4,0475, <span class="math inline">\(\alpha_3\)</span> = 7.685 e <span class="math inline">\(\alpha_4\)</span> = 17.5975, dove <span class="math inline">\(\mu\)</span> è la media del primo erbicida (in ordine alfabetico), <span class="math inline">\(\alpha_2\)</span>, <span class="math inline">\(\alpha_3\)</span> e <span class="math inline">\(\alpha_4\)</span> sono, rispettivamente, le differenze tra le medie del secondo, terzo e quarto trattamento e la media del primo (vedi Capitolo 4). Con queste stime, possiamo calcolare la media dei vasi non trattati come <span class="math inline">\(\mu_u = \mu + \alpha_4\)</span>, e la media dei vasi trattati come <span class="math inline">\(\mu_t = [\mu + (\mu + \alpha_2) + (\mu + \alpha_3)]/3\)</span>, ovvero <span class="math inline">\(\mu_t = \mu + 1/3 \, \alpha_2 + 1/3 \, \alpha_3\)</span>. Di conseguenza, la differenza tra vasi trattati e non trattati è uguale alla seguente combinazione lineare: <span class="math inline">\(\delta_{tu} = \mu_t - \mu_{ut} = 1/3 \, \alpha_2 + 1/3 \, \alpha_3 - \alpha_4\)</span>. Il risultato di questa combinazione (<span class="math inline">\(\delta_{tu}\)</span>) risponde alla domanda precedente: se <span class="math inline">\(\delta_{tu} &lt; 0\)</span> possiamo concludere che il trattamento erbicida è, in media, efficace nel ridurre la biomassa di <em>Solanum nigrum</em>.</p>
<p>La combinazione lineare sopra definita può essere espressa come somma dei prodotti di un insieme di parametri per un insieme di coefficienti:</p>
<p><span class="math display">\[C = 0 \cdot \mu + \frac{1}{3} \cdot \alpha_2 + \frac{1}{3} \cdot \alpha_3 - 1 \cdot \alpha_4\]</span></p>
<p>In questa espressione, la matrice dei coefficienti è:</p>
<p><span class="math display">\[K = \left[0 \,\,\, 1/3 \,\,\, 1/3 \,\, -1 \right]\]</span></p>
<p>Vedremo che in R esistono alcune funzioni che ricevono in input l’elenco dei parametri stimati e la matrice dei coefficienti e restituiscono il valore della combinazione (in questo caso: <span class="math inline">\(C = \delta_{tu} = -16,385\)</span>), insieme al suo errore standard ottenuto tramite la legge di propagazione degli errori, considerando le varianze e le covarianze dei parametri del modello. Maggiori dettagli sulla propagazione degli errori sono reperibili nel blog associato a questo libro<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>.</p>
<p>Una delle funzioni più importanti è flessibili è <code>glht()</code>, contenuta nel package <code>multcomp</code>, il cui impiego è mostrato nel riquadro sottostante, insieme a quello della funzione <code>confint()</code> che può essere utilizzata per ottenere l’intervallo di confidenza.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 9.1 [continuation]</span></span>
<span id="cb84-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting linear combinations with the &#39;glht()&#39; function in R</span></span>
<span id="cb84-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb84-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting the matrix of coefficients</span></span>
<span id="cb84-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-7" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb84-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> T)</span>
<span id="cb84-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(K) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;delta_tu&quot;</span>)</span>
<span id="cb84-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-10" aria-hidden="true" tabindex="-1"></a>K</span>
<span id="cb84-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="do">##          [,1]      [,2]      [,3] [,4]</span></span>
<span id="cb84-12"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="do">## delta_tu    0 0.3333333 0.3333333   -1</span></span>
<span id="cb84-13"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting the contrast</span></span>
<span id="cb84-14"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-14" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">glht</span>(model, <span class="at">linfct =</span> K)</span>
<span id="cb84-15"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(con)</span>
<span id="cb84-16"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb84-17"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="do">##   Simultaneous Tests for General Linear Hypotheses</span></span>
<span id="cb84-18"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb84-19"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit: lm(formula = Weight ~ Treat, data = dataset)</span></span>
<span id="cb84-20"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-20" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb84-21"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Linear Hypotheses:</span></span>
<span id="cb84-22"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-22" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb84-23"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-23" aria-hidden="true" tabindex="-1"></a><span class="do">## delta_tu == 0  -16.385      2.262  -7.244 1.02e-05 ***</span></span>
<span id="cb84-24"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-24" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb84-25"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb84-26"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-26" aria-hidden="true" tabindex="-1"></a><span class="do">## (Adjusted p values reported -- single-step method)</span></span>
<span id="cb84-27"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Confidence intervals </span></span>
<span id="cb84-28"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-28" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(con)</span>
<span id="cb84-29"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-29" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb84-30"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-30" aria-hidden="true" tabindex="-1"></a><span class="do">##   Simultaneous Confidence Intervals</span></span>
<span id="cb84-31"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-31" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb84-32"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit: lm(formula = Weight ~ Treat, data = dataset)</span></span>
<span id="cb84-33"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-33" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb84-34"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Quantile = 2.1788</span></span>
<span id="cb84-35"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-35" aria-hidden="true" tabindex="-1"></a><span class="do">## 95% family-wise confidence level</span></span>
<span id="cb84-36"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  </span></span>
<span id="cb84-37"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-37" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb84-38"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Linear Hypotheses:</span></span>
<span id="cb84-39"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-39" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate lwr      upr     </span></span>
<span id="cb84-40"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb84-40" aria-hidden="true" tabindex="-1"></a><span class="do">## delta_tu == 0 -16.3850 -21.3132 -11.4568</span></span></code></pre></div>
<p>È importante notare che la stima <span class="math inline">\(\delta_{tu}\)</span> può essere divisa per il suo errore standard per ottenere un test t per l’ipotesi nulla che la stima osservata non sia significativamente diversa da zero (vedere Sezione 7.1). Il valore P corrispondente è molto basso, consentendo il rifiuto dell’ipotesi nulla. Pertanto, concludiamo che l’effetto medio dell’erbicida è statisticamente significativo.</p>
</div>
<div id="esempio-9.2-determinare-lefficiacia-erbicida-media" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Esempio 9.2: Determinare l’efficiacia erbicida media<a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.2-determinare-lefficiacia-erbicida-media" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I concetti precedenti possono essere estesi a qualsiasi altra funzione dei parametri del modello, anche se non può essere ricondotta alla somma dei prodotti dei coefficienti per i parametri (come nell’Equazione riportata nel precedente paragrafo) oppure se è intrinsecamente non lineare (cioè contiene logaritmi o altre funzioni che non siano semplici somme di parametri). L’unica differenza è che, con le combinazioni non lineari, gli errori standard non possono essere calcolati con il metodo di propagazione degli errori, ma debbono essere approssimati utilizzando il cosiddetto <strong>metodo delta</strong> (Weisberg, 2005)<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>.</p>
<p>In R, possiamo utilizzare la funzione <code>gnlht()</code> nel package <code>statforbiology</code>, che generalizza l’approccio della <code>glht()</code>. Come esempio, riconsideriamo il dataset “mixture” ed utilizziamo i parametri del modello per calcolare la riduzione percentuale della crescita delle infestanti rispetto al controllo non trattato (efficacia erbicida; HE). Per il primo erbicida, è:</p>
<p><span class="math display">\[\textrm{HE} = \frac{\mu_4 - \mu_1}{\mu_4} \times 100 = \frac{\mu_1 + \alpha_4 - \mu_1}{\mu_1 + \alpha_4} \times 100 = \frac{\alpha_4}{\mu_1 + \alpha_4} \times 100\]</span></p>
<p>In questa espressione, i parametri <span class="math inline">\(\mu_1\)</span> e <span class="math inline">\(\alpha_4\)</span> sono al denominatore e, pertanto, questa combinazione è non lineare. Le espressioni per ottenere gli HE per tutti gli altri erbicidi possono essere ottenute con semplici calcoli algebrici, come riportato nel succesivo riquadro.</p>
<p>Per utilizzare la funzione <code>gnlht()</code> bisogna codificare la lista delle funzioni da calcolare e passarla come argomento. Inoltre, il legame tra il nome dei parametri utilizzati in tali combinazioni e la posizione delle relative stime come risulta nell’output della funzione <code>coef()</code> viene creato con l’argomento <code>parameterNames</code>. Le efficacie dei tre erbicidi sono rispettivamente del 65%, 80% e 37% e sono tutte significativamente diverse da 0 (riquadro sottostante)</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Esempio 9.2</span></span>
<span id="cb85-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Determinazione dell&#39;efficacia media degli erbicidi nei dati della miscela</span></span>
<span id="cb85-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Caricamento dei pacchetti e dei dati</span></span>
<span id="cb85-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statforbiology)</span>
<span id="cb85-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-6" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">getAgroData</span>(<span class="st">&quot;mixture&quot;</span>)</span>
<span id="cb85-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Adattamento di un modello ANOVA ad una via</span></span>
<span id="cb85-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-9" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Weight <span class="sc">~</span> Treat, <span class="at">data=</span>dataset)</span>
<span id="cb85-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Adattamento di combinazioni non lineari con &#39;gnlht()&#39;</span></span>
<span id="cb85-12"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statforbiology)</span>
<span id="cb85-13"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-13" aria-hidden="true" tabindex="-1"></a>funList <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="sc">~</span> a4<span class="sc">/</span>(mu1 <span class="sc">+</span> a4) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb85-14"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-14" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span> (a4 <span class="sc">-</span> a2)<span class="sc">/</span>(mu1 <span class="sc">+</span> a4) <span class="sc">*</span> <span class="dv">100</span>, </span>
<span id="cb85-15"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-15" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span> (a4 <span class="sc">-</span> a3)<span class="sc">/</span>(mu1 <span class="sc">+</span> a4) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb85-16"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="fu">gnlht</span>(model, funList, <span class="at">parameterNames =</span> <span class="fu">c</span>(<span class="st">&quot;mu1&quot;</span>, <span class="st">&quot;a2&quot;</span>, <span class="st">&quot;a3&quot;</span>, <span class="st">&quot;a4&quot;</span>))</span>
<span id="cb85-17"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-17" aria-hidden="true" tabindex="-1"></a><span class="do">##                         Form Estimate       SE   t-value      p-value</span></span>
<span id="cb85-18"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 1        a4/(mu1 + a4) * 100 65.72976 7.734313  8.498461 2.014359e-06</span></span>
<span id="cb85-19"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 (a4 - a2)/(mu1 + a4) * 100 80.84788 7.449568 10.852694 1.469226e-07</span></span>
<span id="cb85-20"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb85-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 (a4 - a3)/(mu1 + a4) * 100 37.02493 8.646543  4.282050 1.065143e-03</span></span></code></pre></div>
</div>
<div id="combinazioni-di-interesse-generale" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Combinazioni di interesse generale<a href="combinazioni-linearinonlineari-dei-parametri.html#combinazioni-di-interesse-generale" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Le funzioni lineari e non lineari dei parametri del modello sono molto utili per rispondere a specifiche domande di ricerca, anche se, soprattutto quando sono molte, la codifica ‘manuale’ della matrice dei coefficienti può rivelarsi un compito molto noioso. Fortunatamente, R ci ci mette a disposizione diverse matrici pre-definite per le combinazioni lineari o non lineari di maggior interesse generale, cioè:</p>
<ol style="list-style-type: decimal">
<li>Medie Marginali attese (EMMs)</li>
<li>Contrasti ortogonali (e non)</li>
<li>Confronti a coppie</li>
<li>Retrotrasformazioni</li>
<li>Previsioni e previsioni inverse</li>
</ol>
<p>Nelle situazioni in cui abbiamo uno o più predittori nominali, il nostro interesse principale, di solito, è quello di stimare le medie della popolazione per ogni livello di trattamento (ad esempio, <span class="math inline">\(\mu_1\)</span>, <span class="math inline">\(\mu_2\)</span>, <span class="math inline">\(\mu_3\)</span>, <span class="math inline">\(\ldots{}\)</span> e <span class="math inline">\(\mu_n\)</span>, dove <span class="math inline">\(n\)</span> è il numero di livelli di trattamento). Sebbene le medie aritmetiche dei gruppi di trattamento possano essere utilizzate come stimatori delle medie delle relative popolazioni (vedere la funzione <code>tapply()</code> nel Capitolo 3), è necessario tener conto che si tratta di stimatori che, in alcune circostanze, possono essere distorti, ad esempio quando i dati sono sbilanciati (numero diverso di repliche per ciascun gruppo di trattamento). Le medie marginali attese (Expected Marginal Means; EMMs) rappresentano un’importante alternativa: sono uguali alle medie aritmetiche quando i dati sono bilanciati, mentre forniscono stimatori migliori delle medie della popolazione quando i dati sono sbilanciati. Le EMMs possono essere facilmente ottenute come combinazioni lineari dei parametri del modello; ad esempio, tornando al dataset “mixture”, nell’esempio 9.1, dove i parametri stimati sono <span class="math inline">\(\mu = 9.175\)</span>, <span class="math inline">\(\alpha_2 = -4.0475\)</span>, <span class="math inline">\(\alpha_3 = 7.685\)</span> e <span class="math inline">\(\alpha_4 = 17.5975\)</span> ed hanno il significato biologico illustrato in precedenza (media del primo gruppo e differenze tra le medie degli altri gruppi rispetto al primo), le quattro EMMs possono essere ottenuti dalle seguenti combinazioni lineari:</p>
<p><span class="math display">\[\left\{ {\begin{array}{l}
C_1 = \mu_1 = 1 \cdot \mu + 0 \cdot \alpha_2 + 0 \cdot\alpha_3 + 0 \cdot\alpha_4 = 9,18\\
C_2 = \mu_2 = 1 \cdot \mu + 1 \cdot \alpha_2 + 0 \cdot\alpha_3 + 0 \cdot\alpha_4 = 5,13\\
C_3 = \mu_3 = 1 \cdot \mu + 0 \cdot \alpha_2 + 1 \cdot\alpha_3 + 0 \cdot\alpha_4 = 16:86\\
C_4 = \mu_4 = 1 \cdot \mu + 0 \cdot \alpha_2 + 0 \cdot\alpha_3 + 1 \cdot\alpha_4 = 26,77\\
\end{array}} \right.\]</span></p>
<p>La matrice dei coefficienti è:</p>
<p><span class="math display">\[ K = \left[ {\begin{array}{llll}
1 &amp; 0 &amp; 0 &amp; 0\\
1 &amp; 1 &amp; 0 &amp; 0\\
1 &amp; 0 &amp; 1 &amp; 0\\
1 &amp; 0 &amp; 0 &amp; 1
\end{array}} \right]\]</span></p>
<p>In linea di principio, per calcolare queste combinazioni si può utilizzare la funzione <code>glht()</code> nel package <code>multcomp</code>, come mostrato nel riquadro sottostante.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Esempio 9.3</span></span>
<span id="cb86-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Medie dei minimi quadrati per i dati &#39;mixture&#39;</span></span>
<span id="cb86-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Caricamento dei pacchetti</span></span>
<span id="cb86-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statforbiology)</span>
<span id="cb86-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb86-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Caricamento dei dati</span></span>
<span id="cb86-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-9" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">getAgroData</span>(<span class="st">&quot;mixture&quot;</span>)</span>
<span id="cb86-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Adattamento di un modello ANOVA ad una via</span></span>
<span id="cb86-12"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-12" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Weight <span class="sc">~</span> Treat, <span class="at">data=</span>dataset)</span>
<span id="cb86-13"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-14"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Stima degli EMM con la funzione &#39;glht()&#39;</span></span>
<span id="cb86-15"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-16"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Impostazione della matrice dei coefficienti</span></span>
<span id="cb86-17"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-17" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb86-18"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>, <span class="at">byrow =</span> T)</span>
<span id="cb86-19"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-19" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(K) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mu1&quot;</span>, <span class="st">&quot;mu2&quot;</span>, <span class="st">&quot;mu3&quot;</span>, <span class="st">&quot;mu4&quot;</span>)</span>
<span id="cb86-20"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-20" aria-hidden="true" tabindex="-1"></a>K</span>
<span id="cb86-21"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-21" aria-hidden="true" tabindex="-1"></a><span class="do">##     [,1] [,2] [,3] [,4]</span></span>
<span id="cb86-22"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-22" aria-hidden="true" tabindex="-1"></a><span class="do">## mu1    1    0    0    0</span></span>
<span id="cb86-23"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-23" aria-hidden="true" tabindex="-1"></a><span class="do">## mu2    1    1    0    0</span></span>
<span id="cb86-24"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-24" aria-hidden="true" tabindex="-1"></a><span class="do">## mu3    1    0    1    0</span></span>
<span id="cb86-25"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-25" aria-hidden="true" tabindex="-1"></a><span class="do">## mu4    1    0    0    1</span></span>
<span id="cb86-26"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcolo della combinazione lineare</span></span>
<span id="cb86-27"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-27" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">glht</span>(model, <span class="at">linfct =</span> K)</span>
<span id="cb86-28"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-28" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(con)</span>
<span id="cb86-29"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-29" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb86-30"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-30" aria-hidden="true" tabindex="-1"></a><span class="do">##   Simultaneous Tests for General Linear Hypotheses</span></span>
<span id="cb86-31"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-31" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb86-32"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit: lm(formula = Weight ~ Treat, data = dataset)</span></span>
<span id="cb86-33"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-33" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb86-34"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Linear Hypotheses:</span></span>
<span id="cb86-35"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-35" aria-hidden="true" tabindex="-1"></a><span class="do">##          Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb86-36"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-36" aria-hidden="true" tabindex="-1"></a><span class="do">## mu1 == 0    9.175      1.959   4.684  0.00199 ** </span></span>
<span id="cb86-37"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-37" aria-hidden="true" tabindex="-1"></a><span class="do">## mu2 == 0    5.127      1.959   2.618  0.08143 .  </span></span>
<span id="cb86-38"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-38" aria-hidden="true" tabindex="-1"></a><span class="do">## mu3 == 0   16.860      1.959   8.607  &lt; 0.001 ***</span></span>
<span id="cb86-39"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-39" aria-hidden="true" tabindex="-1"></a><span class="do">## mu4 == 0   26.773      1.959  13.668  &lt; 0.001 ***</span></span>
<span id="cb86-40"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-40" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb86-41"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-41" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb86-42"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-42" aria-hidden="true" tabindex="-1"></a><span class="do">## (Adjusted p values reported -- single-step method)</span></span>
<span id="cb86-43"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalli di confidenza</span></span>
<span id="cb86-44"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-44" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(con)</span>
<span id="cb86-45"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-45" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb86-46"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-46" aria-hidden="true" tabindex="-1"></a><span class="do">##   Simultaneous Confidence Intervals</span></span>
<span id="cb86-47"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-47" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb86-48"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-48" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit: lm(formula = Weight ~ Treat, data = dataset)</span></span>
<span id="cb86-49"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-49" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb86-50"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-50" aria-hidden="true" tabindex="-1"></a><span class="do">## Quantile = 2.8936</span></span>
<span id="cb86-51"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-51" aria-hidden="true" tabindex="-1"></a><span class="do">## 95% family-wise confidence level</span></span>
<span id="cb86-52"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-52" aria-hidden="true" tabindex="-1"></a><span class="do">##  </span></span>
<span id="cb86-53"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-53" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb86-54"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-54" aria-hidden="true" tabindex="-1"></a><span class="do">## Linear Hypotheses:</span></span>
<span id="cb86-55"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-55" aria-hidden="true" tabindex="-1"></a><span class="do">##          Estimate lwr     upr    </span></span>
<span id="cb86-56"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-56" aria-hidden="true" tabindex="-1"></a><span class="do">## mu1 == 0  9.1750   3.5069 14.8431</span></span>
<span id="cb86-57"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-57" aria-hidden="true" tabindex="-1"></a><span class="do">## mu2 == 0  5.1275  -0.5406 10.7956</span></span>
<span id="cb86-58"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-58" aria-hidden="true" tabindex="-1"></a><span class="do">## mu3 == 0 16.8600  11.1919 22.5281</span></span>
<span id="cb86-59"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb86-59" aria-hidden="true" tabindex="-1"></a><span class="do">## mu4 == 0 26.7725  21.1044 32.4406</span></span></code></pre></div>
<p>Tuttavia, soprattutto quando il numero di medie è molto elevato, codificare la matrice dei coefficienti da zero può essere un compito arduo; pertanto, per il calcolo degli EMMs, si preferisce la funzione <code>emmeans()</code> nel pacchetto <code>emmeans</code> (Lenth, 2016), perché è molto più semplice da usare. Richiede due argomenti di base: l’oggetto modello e il predittore per il quale si desidera calcolare le EMMs (riquadro sottostante).</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Esempio 9.3 [continuazione]</span></span>
<span id="cb87-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co"># EMMs con la funzione &#39;emmeans()&#39;</span></span>
<span id="cb87-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans) <span class="co"># Carica il pacchetto</span></span>
<span id="cb87-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb87-6" aria-hidden="true" tabindex="-1"></a>muj <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span>Treat)</span>
<span id="cb87-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb87-7" aria-hidden="true" tabindex="-1"></a>muj</span>
<span id="cb87-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  Treat           emmean   SE df lower.CL upper.CL</span></span>
<span id="cb87-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348   9.18 1.96 12     4.91     13.4</span></span>
<span id="cb87-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378       5.13 1.96 12     0.86      9.4</span></span>
<span id="cb87-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30   16.86 1.96 12    12.59     21.1</span></span>
<span id="cb87-12"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  Unweeded         26.77 1.96 12    22.50     31.0</span></span>
<span id="cb87-13"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb87-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb87-14"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95</span></span></code></pre></div>
<p>Oltre a essere stime affidabili delle medie della popolazione, le EMMs possono anche servire come punto di partenza per costruire ulteriori combinazioni lineari o non lineari, che saranno esaminate in seguito.</p>
</div>
<div id="example-9.4-contrasti-ortogonali-e-non" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Example 9.4: Contrasti ortogonali (e non)<a href="combinazioni-linearinonlineari-dei-parametri.html#example-9.4-contrasti-ortogonali-e-non" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nell’Esempio 9.1, abbiamo visto che una combinazione lineare dei parametri del modello può aiutare a rispondere ad una domanda ‘biologica’ rilevante, basata sulla differenza tra la media dei vasi non trattati e la media dei vasi trattati. Considerando sempre il dataset “mixture”, è possibile pianificare tre combinazioni che reppresentano differenze tra medie, cioè:</p>
<ol style="list-style-type: decimal">
<li>trattato vs. non trattato (in media)</li>
<li>miscela vs. erbicidi singoli (in media)</li>
<li>metribuzin vs. rimsulfuron</li>
</ol>
<p>Invece che combinare i parametri del modello come nell’Esempio 9.1, le tre combinazioni di cui sopra possono anche essere codificate come combinazioni tra le medie. Se consideriamo l’ordine con cui compaiono le quattro medie nel dataset <code>muj</code> in un riquadro precedente, in Code box 9.5, le tre combinazioni lineari possono essere scritte come:</p>
<p><span class="math display">\[\left\{ {\begin{array}{l}
C_1 = \frac{1}{3} \, \mu_1 + \frac{1}{3} \, \mu_2 + \frac{1}{3} \,\mu_3 - \mu_4\\
C_2 = \frac{1}{2} \, \mu_1 - \mu_2 + \frac{1}{2} \,\mu_3 - 0 \cdot \mu_4\\
C_3 = \mu_1 - 0 \cdot \mu_2  - \mu_3 - 0 \cdot \mu_4
\end{array}} \right.\]</span></p>
<p>Le tre combinazioni lineari C1, C2 e C3 hanno la tipica proprietà che, per ognuna, la somma dei coefficienti è zero e, per questo, sono chiamate <strong>contrasti</strong>. Ne consegue che il risultato di un contrasto deve essere uguale a 0, quando la differenza tra medie o gruppi di medie che esso sottende è uguale a zero, di modo che sia possibile utilizzare un test di t per saggiare questa ipotesi nulla.</p>
<p>Inoltre, i tre contrasti sopra riportati hanno l’ulteriore caratteristica che i loro coefficienti sono reciprocamente non correlati e, pertanto, sono chiamati <strong>contrasti ortogonali</strong>. Normalmente, in un dataset esistono tanti contrasti ortogonali quante sono le medie meno una.</p>
<p>L’ortogonalità era considerata una proprietà desiderabile perché la somma delle devianze associate ad ogni contrasto corrisponde alla devianza del trattamento (vedere il riquadro sottostante). Pertanto, l’applicazione dei contrasti ortogonali era considerata un metodo elegante ed efficiente per sfruttare l’intera informazione contenuta (Chew, 1976). Oggigiorno, l’enfasi sull’ortogonalità è minore, ma può essere utile fornire un esempio di come i contrasti ortogonali possano essere calcolati con R, utilizzando la funzione <code>contrast()</code> nel package <code>emmeans</code>.</p>
<p>I tre passaggi tipici sono:</p>
<ol style="list-style-type: decimal">
<li>preparare una lista con i coefficienti, assegnando un nome a ciascun contrasto (si noti che questa è una differenza rispetto alla funzione <code>glht()</code>, che richiede una matrice di coefficienti, non una lista);</li>
<li>utilizzare la funzione <code>contrast()</code> nel package <code>emmeans</code>, passando i seguenti argomenti: (i) l’oggetto risultante dalla chiamata alla funzione <code>emmeans()</code>; (ii) la lista dei contrasti <span class="math inline">\(K\)</span>, come argomento <code>method</code>; (iii) il tipo di aggiustamento (ne parleremo più avanti, per ora utilizzate il comando così come mostrato nel riquadro sottostante)</li>
</ol>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 9.4</span></span>
<span id="cb88-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Orthogonal contrasts with the &#39;emmeans()&#39; function</span></span>
<span id="cb88-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the packages</span></span>
<span id="cb88-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statforbiology)</span>
<span id="cb88-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb88-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb88-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the data</span></span>
<span id="cb88-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-10" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">getAgroData</span>(<span class="st">&quot;mixture&quot;</span>)</span>
<span id="cb88-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting a one-way ANOVA model</span></span>
<span id="cb88-13"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-13" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Weight <span class="sc">~</span> Treat, <span class="at">data=</span>dataset)</span>
<span id="cb88-14"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-15"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a vector of coefficients for each contrast</span></span>
<span id="cb88-16"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-16" aria-hidden="true" tabindex="-1"></a>C1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb88-17"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-17" aria-hidden="true" tabindex="-1"></a>C2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb88-18"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-18" aria-hidden="true" tabindex="-1"></a>C3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb88-19"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-20"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a list of contrasts (NOT a matrix)</span></span>
<span id="cb88-21"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-21" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;U vs T&quot;</span> <span class="ot">=</span> C1, </span>
<span id="cb88-22"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-22" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;mix vs single&quot;</span> <span class="ot">=</span> C2,</span>
<span id="cb88-23"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-23" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;met vs rim&quot;</span> <span class="ot">=</span> C3)</span>
<span id="cb88-24"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-25"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting the contrasts, using the &#39;muj&#39; object</span></span>
<span id="cb88-26"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-26" aria-hidden="true" tabindex="-1"></a>muj <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span>Treat)</span>
<span id="cb88-27"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-27" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">contrast</span>(muj, <span class="at">method =</span> K, <span class="at">adjust=</span><span class="st">&quot;none&quot;</span>)</span>
<span id="cb88-28"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-28" aria-hidden="true" tabindex="-1"></a>con</span>
<span id="cb88-29"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast      estimate   SE df t.ratio p.value</span></span>
<span id="cb88-30"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  U vs T          -16.39 2.26 12  -7.244  &lt;.0001</span></span>
<span id="cb88-31"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-31" aria-hidden="true" tabindex="-1"></a><span class="do">##  mix vs single     7.89 2.40 12   3.289  0.0065</span></span>
<span id="cb88-32"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-32" aria-hidden="true" tabindex="-1"></a><span class="do">##  met vs rim       -7.68 2.77 12  -2.774  0.0168</span></span>
<span id="cb88-33"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Confidence intervals</span></span>
<span id="cb88-34"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-34" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(con)</span>
<span id="cb88-35"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-35" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast      estimate   SE df lower.CL upper.CL</span></span>
<span id="cb88-36"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  U vs T          -16.39 2.26 12   -21.31   -11.46</span></span>
<span id="cb88-37"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-37" aria-hidden="true" tabindex="-1"></a><span class="do">##  mix vs single     7.89 2.40 12     2.66    13.12</span></span>
<span id="cb88-38"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-38" aria-hidden="true" tabindex="-1"></a><span class="do">##  met vs rim       -7.68 2.77 12   -13.72    -1.65</span></span>
<span id="cb88-39"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-39" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb88-40"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb88-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95</span></span></code></pre></div>
<p>I contrasti ortogonali possono essere calcolati anche utilizzando la funzione <code>aov()</code>. In questo caso, l’elenco dei contrasti deve essere trasformato in una matrice e associato al fattore sperimentale tramite la funzione <code>C()</code> (notare la lettera maiuscola; vedere il riquadro sottostante). Utilizzando questa codifica, è possibile vedere che la somma dei quadrati per l’effetto del trattamento è completamente suddivisa in tre parti, una per ciascun contrasto, producendo valori P identici a quelli mostrati nel riquadro precedente.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 9.4 [continuation]</span></span>
<span id="cb89-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting orthogonal contrasts and partitioning</span></span>
<span id="cb89-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the sum of squares for the treatment effect</span></span>
<span id="cb89-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a vector of coefficients for each contrast (as in Code box 9.6)</span></span>
<span id="cb89-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-7" aria-hidden="true" tabindex="-1"></a>C1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb89-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-8" aria-hidden="true" tabindex="-1"></a>C2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb89-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-9" aria-hidden="true" tabindex="-1"></a>C3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb89-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a list of contrasts (as in Code box 9.6)</span></span>
<span id="cb89-12"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-12" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;U vs T&quot;</span> <span class="ot">=</span> C1, </span>
<span id="cb89-13"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-13" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;mix vs single&quot;</span> <span class="ot">=</span> C2,</span>
<span id="cb89-14"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-14" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;met vs rim&quot;</span> <span class="ot">=</span> C3)</span>
<span id="cb89-15"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-16"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the list of contrasts into a matrix</span></span>
<span id="cb89-17"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-17" aria-hidden="true" tabindex="-1"></a>Kmat <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, K)</span>
<span id="cb89-18"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-19"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Associate the matrix of coefficients to the treatment factor</span></span>
<span id="cb89-20"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-20" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Treat2 <span class="ot">&lt;-</span> <span class="fu">C</span>(<span class="fu">factor</span>(dataset<span class="sc">$</span>Treat), <span class="fu">t</span>(Kmat))</span>
<span id="cb89-21"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-22"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model with the &#39;aov()&#39; function</span></span>
<span id="cb89-23"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-23" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">aov</span>(Weight <span class="sc">~</span> Treat2, dataset)</span>
<span id="cb89-24"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-24" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod, <span class="at">split =</span> <span class="fu">list</span>(<span class="at">Treat2 =</span> <span class="fu">list</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)))</span>
<span id="cb89-25"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-25" aria-hidden="true" tabindex="-1"></a><span class="do">##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span></span>
<span id="cb89-26"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Treat2        3 1089.5   363.2  23.663 2.51e-05 ***</span></span>
<span id="cb89-27"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-27" aria-hidden="true" tabindex="-1"></a><span class="do">##   Treat2: C1  1  805.4   805.4  52.476 1.02e-05 ***</span></span>
<span id="cb89-28"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-28" aria-hidden="true" tabindex="-1"></a><span class="do">##   Treat2: C2  1  166.0   166.0  10.816  0.00647 ** </span></span>
<span id="cb89-29"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-29" aria-hidden="true" tabindex="-1"></a><span class="do">##   Treat2: C3  1  118.1   118.1   7.696  0.01683 *  </span></span>
<span id="cb89-30"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals    12  184.2    15.3                     </span></span>
<span id="cb89-31"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-31" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb89-32"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb89-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="esempio-9.5-i-confronti-multipli-a-coppie" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Esempio 9.5: I confronti multipli a coppie<a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.5-i-confronti-multipli-a-coppie" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Non sempre le prove sperimentali consentono di saggiare pochi contrasti pre-stabiliti, ma spesso è necessario confrontare tutte le possibili coppie di trattamenti (<em>pairwise comparisons</em>). In questo caso dovremmo definire un contrasto per ogni coppia di medie, anche se l’impiego del package ‘emmeans’ agevola, non di poco, il lavoro.</p>
<p>In particolare, possiamo immaginare due situazioni di riferimento: tutti contro tutti (confronti tipo “Tukey”) e tutti verso uno (confronti tipo “Dunnett”)(Hsu, 1996). Questo secondo tipo di contrasto può essere interessante, quando sia importante confrantare tutti i trattamenti verso un riferimento prescelto, ad esempio la miscela tra i due erbicidi. Con il metodo di Tukey, il numero di contrasti è molto elevato, ed è pari a <span class="math inline">\(n \times (n - 1) / 2\)</span>, dove <span class="math inline">\(n\)</span> è il numero di medie da confrontare. Con il metodo di Dunnett, il numero di contrasti si riduce a <span class="math inline">\(n - 1\)</span>, e tale riduzione potrebbe essere importante per ragioni che verranno descritte più avanti.</p>
<p>Bisogna tener presente che l’adozione di confronti a coppie non è particolarmente elegante perché implica molti test non pianificati e privi di un obiettivo chiaro (una sorta di “spray and pray”; Cousens, 1988). Inoltre, secondo lo scienziato inglese John Tukey: “tutto ciò che sappiamo del mondo ci insegna che gli effetti di A e B sono sempre diversi, purchè noi consideriamo un numero di decimali sufficientemente elevato. Pertanto, chiedersi se gli effetti siano diversi è sciocco”. Ciononostante, i confronti a coppie possono essere molto utili; sono di moda da quasi un secolo e quindi vale la pena conoscerli.</p>
<p>Per il dataset “mixture”, ci sono quattro medie da confrontare e, quindi, un totale di sei confronti a coppie che possono essere definiti come segue:</p>
<p><span class="math display">\[\left\{ {\begin{array}{*{20}{c}}
C_1 = \mu_1 - \mu_2 = 1 \cdot \mu_1 - 1 \cdot \mu_2 + 0 \cdot \mu_3 + 0 \cdot \mu_4 \\
C_2 = \mu_1 - \mu_3 = 1 \cdot \mu_1 - 0 \cdot \mu_2 - 1 \cdot \mu_3 + 0 \cdot \mu_4 \\
C_3 = \mu_1 - \mu_4 = 1 \cdot \mu_1 - 0 \cdot \mu_2 + 0 \cdot \mu_3 - 1 \cdot \mu_4 \\
C_4 = \mu_2 - \mu_3 = 0 \cdot \mu_1 + 1 \cdot \mu_2 - 1 \cdot \mu_3 + 0 \cdot \mu_4 \\
C_5 = \mu_2 - \mu_4 = 0 \cdot \mu_1 + 1 \cdot \mu_2 + 0 \cdot \mu_3 - 1 \cdot \mu_4 \\
C_6 = \mu_3 - \mu_4 = 0 \cdot \mu_1 + 0 \cdot \mu_2 + 1 \cdot \mu_3 - 1 \cdot \mu_4
\end{array}} \right.\]</span></p>
<p>La matrice dei coefficienti è:</p>
<p><span class="math display">\[K = \left[ {\begin{array}{rrrr}
1 &amp; - 1 &amp; 0 &amp; 0\\
1 &amp; 0 &amp; - 1 &amp; 0\\
1 &amp; 0 &amp; 0 &amp; - 1\\
0 &amp; 1 &amp; - 1 &amp; 0\\
0 &amp; 1 &amp; 0 &amp; - 1\\
0 &amp; 0 &amp; 1 &amp; - 1
\end{array}} \right]\]</span></p>
<p>Fortunatamente, non è necessario codificare la matrice <span class="math inline">\(K\)</span> da zero; nel quadro sottostante mostriamo come si possa ottenere il confronto multiplo con la funzione <code>contrast()</code> (come sopra) e passando il valore ‘tukey’ o ‘dunnett’ all’argomento ‘method’. In questo secondo caso, R confronta tutte le tesi con metribuzin, che è il primo livello in ordine alfabetico, mentre noi avremmo preferito confrontare tutte le tesi con la miscela. Per ottenere questo risultato basta aggiungere l’argomento ‘ref’ ed assegnare il valore ‘2’, considerando che la miscela è la seconda tesi in ordine alfabetico:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 9.5</span></span>
<span id="cb90-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pairwise comparisons for the &#39;mixture&#39; data</span></span>
<span id="cb90-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the packages</span></span>
<span id="cb90-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statforbiology)</span>
<span id="cb90-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb90-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the data</span></span>
<span id="cb90-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-9" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">getAgroData</span>(<span class="st">&quot;mixture&quot;</span>)</span>
<span id="cb90-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting a one-way ANOVA model</span></span>
<span id="cb90-12"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-12" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Weight <span class="sc">~</span> Treat, <span class="at">data=</span>dataset)</span>
<span id="cb90-13"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-14"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Determining the least square means</span></span>
<span id="cb90-15"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-15" aria-hidden="true" tabindex="-1"></a>muj <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(model, <span class="sc">~</span>Treat)</span>
<span id="cb90-16"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-17"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-17" aria-hidden="true" tabindex="-1"></a><span class="co"># All-pairwise comparisons (Tukey&#39;s method)</span></span>
<span id="cb90-18"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-18" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(muj, <span class="at">adjust=</span><span class="st">&quot;none&quot;</span>, <span class="at">method=</span><span class="st">&quot;tukey&quot;</span>)</span>
<span id="cb90-19"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast                         estimate   SE df t.ratio p.value</span></span>
<span id="cb90-20"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Mixture_378        4.05 2.77 12   1.461  0.1697</span></span>
<span id="cb90-21"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Rimsulfuron_30    -7.68 2.77 12  -2.774  0.0168</span></span>
<span id="cb90-22"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Unweeded         -17.60 2.77 12  -6.352  &lt;.0001</span></span>
<span id="cb90-23"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Rimsulfuron_30       -11.73 2.77 12  -4.235  0.0012</span></span>
<span id="cb90-24"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Unweeded             -21.64 2.77 12  -7.813  &lt;.0001</span></span>
<span id="cb90-25"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30 - Unweeded           -9.91 2.77 12  -3.578  0.0038</span></span>
<span id="cb90-26"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Comparisons all-against-one (Dunnett&#39;s method)</span></span>
<span id="cb90-27"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-27" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">contrast</span>(muj, <span class="at">adjust=</span><span class="st">&quot;none&quot;</span>, <span class="at">method=</span><span class="st">&quot;dunnett&quot;</span>, <span class="at">ref =</span> <span class="dv">2</span>)</span>
<span id="cb90-28"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-28" aria-hidden="true" tabindex="-1"></a>con</span>
<span id="cb90-29"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast                      estimate   SE df t.ratio p.value</span></span>
<span id="cb90-30"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Mixture_378     4.05 2.77 12   1.461  0.1697</span></span>
<span id="cb90-31"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-31" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30 - Mixture_378     11.73 2.77 12   4.235  0.0012</span></span>
<span id="cb90-32"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-32" aria-hidden="true" tabindex="-1"></a><span class="do">##  Unweeded - Mixture_378           21.64 2.77 12   7.813  &lt;.0001</span></span>
<span id="cb90-33"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence intervals</span></span>
<span id="cb90-34"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-34" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(con)</span>
<span id="cb90-35"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-35" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast                      estimate   SE df lower.CL upper.CL</span></span>
<span id="cb90-36"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Mixture_378     4.05 2.77 12    -1.99     10.1</span></span>
<span id="cb90-37"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-37" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30 - Mixture_378     11.73 2.77 12     5.70     17.8</span></span>
<span id="cb90-38"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-38" aria-hidden="true" tabindex="-1"></a><span class="do">##  Unweeded - Mixture_378           21.64 2.77 12    15.61     27.7</span></span>
<span id="cb90-39"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-39" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb90-40"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb90-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95</span></span></code></pre></div>
<p>Il risultato delle elaborazioni sovrastanti mostra i contrasti con il loro errore standard e potrebbe essere interessante calcolare anche l’intervallo di confidenza per le differenze stimate. Ciò può esser fatto facilmente assegnando il risultato della funzione <code>contrast()</code> ad una variabile ed esplorando quest’ultima con il metodo <code>confint()</code>.</p>
<div id="display-a-lettere" class="section level3 hasAnchor" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> Display a lettere<a href="combinazioni-linearinonlineari-dei-parametri.html#display-a-lettere" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I risultati di un confronto multiplo a coppie possono essere presentati anche con un display a lettere, nel quale le medie seguite da lettere diverse sono significativamente diverse per un livello di probabilità di errore minore di quello dato.</p>
<p>Realizzare un display a lettere manualmente è piuttosto facile, utilizzando la seguente procedura:</p>
<ol style="list-style-type: decimal">
<li>ordinare le medie in senso crescente/decrescente</li>
<li>partire dalla prima media e aggiungere la lettera A a tutte quelle che non sono significativamente diverse</li>
<li>passare alla seconda media e aggiungere la lettera B a tutte quelle che non sono significativamente diverse</li>
<li>procedere analogamente con tutte le medie successive, finche non vengono più individuate differenze significative.</li>
</ol>
<p>Con R si può sfruttare il package ‘emmeans’, utilizzando i comandi sottostanti.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb91-1" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(muj, <span class="at">adjust=</span><span class="st">&quot;none&quot;</span>, <span class="at">Letters=</span>LETTERS)</span>
<span id="cb91-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  Treat           emmean   SE df lower.CL upper.CL .group</span></span>
<span id="cb91-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378       5.13 1.96 12     0.86      9.4  A    </span></span>
<span id="cb91-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348   9.18 1.96 12     4.91     13.4  A    </span></span>
<span id="cb91-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30   16.86 1.96 12    12.59     21.1   B   </span></span>
<span id="cb91-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Unweeded         26.77 1.96 12    22.50     31.0    C  </span></span>
<span id="cb91-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb91-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb91-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="do">## significance level used: alpha = 0.05 </span></span>
<span id="cb91-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: If two or more means share the same grouping symbol,</span></span>
<span id="cb91-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="do">##       then we cannot show them to be different.</span></span>
<span id="cb91-12"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="do">##       But we also did not show them to be the same.</span></span></code></pre></div>
</div>
<div id="correzione-per-la-molteplicità" class="section level3 hasAnchor" number="9.5.2">
<h3><span class="header-section-number">9.5.2</span> Correzione per la molteplicità<a href="combinazioni-linearinonlineari-dei-parametri.html#correzione-per-la-molteplicità" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Operando nel modo anzidetto, ogni contrasto/confronto ha una probabilità di errore del 5% (<span class="math inline">\(\alpha_C = 0.05\)</span>). Se i contrasti/confronti sono più di uno (‘famiglia’ di <em>n</em> contrasti), la probabilità di sbagliarne almeno uno (<em>maximum experimentwise error rate</em>: <span class="math inline">\(\alpha_E\)</span>) è data da:</p>
<p><span class="math display">\[\alpha_E = 1 - (1 - \alpha_C)^n\]</span></p>
<p>Bisogna premettere che l’anzidetta formula vale quando i contrasti sono totalmente indipendenti tra loro, cosa che quasi mai avviene, dato che, anche in un semplice modello ANOVA, i contrasti condividono la stessa varianza d’errore e sono quindi più o meno correlati tra di loro. Con contrasti non indipendenti la formula anzidetta fornisce una sovrastima di <span class="math inline">\(\alpha_E\)</span> (per questo si parla di <em>maximum experimentwise error rate</em>).</p>
<p>Il numero di confronti a coppie per esperimento può essere anche molto elevato: se ho <em>k</em> medie il numero dei confronti possibili è pari a <span class="math inline">\(k \cdot (k-1)/2\)</span>. Di conseguenza, la probabilità di errore per esperimento (<span class="math inline">\(\alpha_E\)</span>) può essere molto più alta del valore <span class="math inline">\(\alpha_C\)</span> prefissato per confronto.</p>
<p>Ad esempio, se ho 15 medie, ho <span class="math inline">\((15 \cdot 14)/2 = 105\)</span> confronti possibili. Se uso <span class="math inline">\(\alpha_C = 0.05\)</span> per ogni confronto, la probabilità di sbagliarne almeno uno è pari (in caso di confronti indipendenti) a <span class="math inline">\(1 - (1 - 0.05)^105 = 0.995\)</span>. Sostanzialmente, vi è pressoché la certezza che in questo esperimento qualcosa sia sbagliato!</p>
<p>Per questo motivo, quando si elaborano i dati di un esperimento nel quale è necessario fare molti contrasti, o confronti, o, più in generale, molti test d’ipotesi simultanei, si potrebbe voler esprimere un giudizio globale (simultaneo) sull’intera famiglia di contrasti/confronti, minimizzando la possibilità che anche solo uno o pochi di essi siano sbagliati. In particolare, ciò potrebbe capitare quando:</p>
<ol style="list-style-type: decimal">
<li>vogliamo trovare i migliori di <em>k</em> trattamenti, senza correre rischi di escluderne erroneamente qualcuno. In questa situazione, facendo ogni confronto con il 5% di probabilità di errore, la probabilità di escludere erroneamente anche solo un trattamento dal lotto dei migliori è molto più alta di quella prefissata, perché basta sbagliare anche uno solo dei <em>k - 1</em> confronti con il migliore.</li>
<li>Abbiamo utilizzato un display a lettere e intendiamo affermare che ‘i trattamenti seguiti da lettere diverse sono significativamente diversi’. In questo caso, stiamo tirando una conclusione basata sull’intera famiglia di confronti e non possiamo lecitamente riportare la probabilità di errore di un singolo confronto.</li>
</ol>
<p>In tutte le condizioni analoghe a quelle più sopra accennate si pone il problema di applicare un aggiustamento per la molteplicità, in modo da rispettare un certo livello prestabilito di protezione per esperimento (e non per confronto). La prima possibilità che abbiamo è quella di aggiustare il P-level per ogni confronto, in modo da diminuire la probabilità di errore per l’intera famiglia di sei confronti. Utilizzando la formula che lega la probabilità d’errore per esperimento (<span class="math inline">\(\alpha_E\)</span>) alla probabilità d’errore per confronto (<span class="math inline">\(\alpha_C\)</span>; vedi sopra), possiamo prendere la sesta colonna del dataframe ‘con’, quella che contiene i P-levels non corretti, e trasformarla come segue:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb92-1" aria-hidden="true" tabindex="-1"></a>alphaC <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(con)[,<span class="dv">6</span>]</span>
<span id="cb92-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> alphaC)<span class="sc">^</span><span class="dv">6</span></span>
<span id="cb92-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 6.722991e-01 6.923077e-03 2.869757e-05</span></span></code></pre></div>
<p>Più facilmente, possiamo arrivare allo stesso risultato con il package ‘emmeans’:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(muj, <span class="at">method =</span> <span class="st">&quot;tukey&quot;</span>, <span class="at">adjust =</span> <span class="st">&quot;sidak&quot;</span>)</span>
<span id="cb93-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast                         estimate   SE df t.ratio p.value</span></span>
<span id="cb93-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Mixture_378        4.05 2.77 12   1.461  0.6723</span></span>
<span id="cb93-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Rimsulfuron_30    -7.68 2.77 12  -2.774  0.0968</span></span>
<span id="cb93-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Unweeded         -17.60 2.77 12  -6.352  0.0002</span></span>
<span id="cb93-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Rimsulfuron_30       -11.73 2.77 12  -4.235  0.0069</span></span>
<span id="cb93-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Unweeded             -21.64 2.77 12  -7.813  &lt;.0001</span></span>
<span id="cb93-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30 - Unweeded           -9.91 2.77 12  -3.578  0.0226</span></span>
<span id="cb93-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb93-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="do">## P value adjustment: sidak method for 6 tests</span></span></code></pre></div>
<p>Vediamo che il secondo confronto, che era significativo, non è più tale adottando la correzione di Sidak.</p>
<p>Un’alternativa più nota (e semplice) è quella di utilizzare la diseguaglianza di Bonferroni:</p>
<p><span class="math display">\[\alpha_E = \alpha_C \cdot k\]</span></p>
<p>Quest’ultima è un po’ più conservativa della precedente, nel senso che fornisce un P-level aggiustato leggermente più alto dell’altra.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb94-1" aria-hidden="true" tabindex="-1"></a>alphaC <span class="sc">*</span> <span class="dv">6</span></span>
<span id="cb94-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.018071e+00 6.943132e-03 2.869792e-05</span></span></code></pre></div>
<p>Oppure possiamo utilizzare la funzione <code>contrast()</code>:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(muj, <span class="at">method =</span> <span class="st">&quot;pairwise&quot;</span>, <span class="at">adjust =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb95-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast                         estimate   SE df t.ratio p.value</span></span>
<span id="cb95-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Mixture_378        4.05 2.77 12   1.461  1.0000</span></span>
<span id="cb95-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Rimsulfuron_30    -7.68 2.77 12  -2.774  0.1010</span></span>
<span id="cb95-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Unweeded         -17.60 2.77 12  -6.352  0.0002</span></span>
<span id="cb95-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Rimsulfuron_30       -11.73 2.77 12  -4.235  0.0069</span></span>
<span id="cb95-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Unweeded             -21.64 2.77 12  -7.813  &lt;.0001</span></span>
<span id="cb95-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30 - Unweeded           -9.91 2.77 12  -3.578  0.0228</span></span>
<span id="cb95-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb95-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="do">## P value adjustment: bonferroni method for 6 tests</span></span></code></pre></div>
<p>Esistono altre procedure di aggiustamento del P-level (metodi di Holm, Hochberg, Hommel), ma nessuna di queste tiene conto della correlazione eventualmente esistente tra i contrasti e tutte quindi sono da definirsi più o meno ‘conservative’.</p>
<p>Oltre che aggiustare il P-level, possiamo anche utilizzare altre procedure di aggiustamento, basate sulla distribuzione multivariata di t e in grado di tener conto dell’eventuale correlazione esistente tra i contrasti stessi. Una di queste procedure viene impiegata di default nella funzione <code>contrast()</code> nel package ‘emmeans’:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Confronti multipli a coppie, basati sul t multivariato</span></span>
<span id="cb96-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(muj, <span class="at">method=</span><span class="st">&quot;tukey&quot;</span>)</span>
<span id="cb96-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast                         estimate   SE df t.ratio p.value</span></span>
<span id="cb96-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Mixture_378        4.05 2.77 12   1.461  0.4885</span></span>
<span id="cb96-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Rimsulfuron_30    -7.68 2.77 12  -2.774  0.0698</span></span>
<span id="cb96-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Metribuzin__348 - Unweeded         -17.60 2.77 12  -6.352  0.0002</span></span>
<span id="cb96-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Rimsulfuron_30       -11.73 2.77 12  -4.235  0.0055</span></span>
<span id="cb96-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Unweeded             -21.64 2.77 12  -7.813  &lt;.0001</span></span>
<span id="cb96-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30 - Unweeded           -9.91 2.77 12  -3.578  0.0173</span></span>
<span id="cb96-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb96-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="do">## P value adjustment: tukey method for comparing a family of 4 estimates</span></span></code></pre></div>
<p>Possiamo notare che i P-levels sono leggermente più bassi di quelli ottenuti con Bonferroni, che conferma quindi di essere una procedura molto conservativa, mentre l’impiego del t multivariato consente di rispettare esattamente il tasso di errore ‘per esperimento’.</p>
<p>Ovviamente la correzione per la molteplicità ed il conseguente innalzamento del P-level sono fortemente dipendenti dal numero di contrasti effettuati; se utilizziamo un set di confronti tipo ‘dunnett’ invece che tipo ‘pairwise’, avremo meno confronti e quindi una correzione più ‘leggera’.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Confronti multipli a coppie, basati sul t multivariato</span></span>
<span id="cb97-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(muj, <span class="at">method=</span><span class="st">&quot;dunnett&quot;</span>)</span>
<span id="cb97-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  contrast                         estimate   SE df t.ratio p.value</span></span>
<span id="cb97-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mixture_378 - Metribuzin__348       -4.05 2.77 12  -1.461  0.3711</span></span>
<span id="cb97-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Rimsulfuron_30 - Metribuzin__348     7.68 2.77 12   2.774  0.0442</span></span>
<span id="cb97-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb97-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Unweeded - Metribuzin__348          17.60 2.77 12   6.352  0.0001</span></span>
<span id="cb97-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb97-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="do">## P value adjustment: dunnettx method for 3 tests</span></span></code></pre></div>
</div>
<div id="procedure-classiche-di-confronto-multiplo" class="section level3 hasAnchor" number="9.5.3">
<h3><span class="header-section-number">9.5.3</span> Procedure ‘classiche’ di confronto multiplo<a href="combinazioni-linearinonlineari-dei-parametri.html#procedure-classiche-di-confronto-multiplo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In questo libro, i confronti a coppie sono inseriti nel contesto dei contrasti lineari, come, ad esempio, in Hsu (1996). In passato, i confronti multipli si basavano sulla determinazione di una differenza critica, in base alla quale due medie venivano considerate significativamente diverse quando la loro differenza superava la differenza critica. Nella letteratura scientifica si trovano molte procedure di questo tipo, tra le quali segnaliamo:</p>
<ol style="list-style-type: decimal">
<li>Minima Differenza Significativa (MDS o LSD)</li>
<li><em>Honest Significant Difference</em> di Tukey</li>
<li>Test di Dunnett</li>
<li>Test di Duncan</li>
<li>Test di Newman-Keuls</li>
<li>Test di confronto multiplo di Tukey</li>
</ol>
<p>Il primo metodo corrisponde esattamente a quello che abbiamo utilizzato all’inizio, per fare confronti multipli ‘tutti contro tutti’, senza correzione per la molteplicità. Il secondo e il terzo metodo corrispondono rispettivamente al test di confronto ‘tutti verso tutti’ e ‘uno verso tutti’ indicati in precedenza, con correzione per la molteplicità.</p>
<p>Non è necessario dettagliare gli altri test, in quanto, seppur siano ancora molto utilizzati, vengono ormai ritenuti obsoleti e sconsigliabili, da parecchi ricercatori. Chi vuole, trova altre informazioni nella letteratura indicata in fondo al capitolo; mostriamo solo come la HSD di Tukey HSD possa essere calcolata ed utilizzata per in confronto multiplo, utilizzando la funzione <code>aov()</code> per la stima del modello e la funzione <code>TukeyHSD()</code> per il confronto multiplo con correzione per la molteplicità (Code Box 9.13).</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Esempio 9.5 [continuazione]</span></span>
<span id="cb98-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Tukey HSD per un modello lineare adattato con la funzione &#39;aov()&#39; </span></span>
<span id="cb98-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-3" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(Weight <span class="sc">~</span> Treat, <span class="at">data =</span> dataset)</span>
<span id="cb98-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(mod2)</span>
<span id="cb98-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   Tukey multiple comparisons of means</span></span>
<span id="cb98-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="do">##     95% family-wise confidence level</span></span>
<span id="cb98-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb98-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit: aov(formula = Weight ~ Treat, data = dataset)</span></span>
<span id="cb98-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb98-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="do">## $Treat</span></span>
<span id="cb98-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="do">##                                   diff        lwr       upr     p adj</span></span>
<span id="cb98-12"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Mixture_378-Metribuzin__348    -4.0475 -12.271978  4.176978 0.4884620</span></span>
<span id="cb98-13"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Rimsulfuron_30-Metribuzin__348  7.6850  -0.539478 15.909478 0.0698118</span></span>
<span id="cb98-14"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Unweeded-Metribuzin__348       17.5975   9.373022 25.821978 0.0001854</span></span>
<span id="cb98-15"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Rimsulfuron_30-Mixture_378     11.7325   3.508022 19.956978 0.0055015</span></span>
<span id="cb98-16"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Unweeded-Mixture_378           21.6450  13.420522 29.869478 0.0000247</span></span>
<span id="cb98-17"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb98-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Unweeded-Rimsulfuron_30         9.9125   1.688022 18.136978 0.0172572</span></span></code></pre></div>
<p>Per concludere la sezione sui confronti multipli vogliamo dare alcuni consigli pratici di buon senso.</p>
<ol style="list-style-type: decimal">
<li>Quando è possibile, pianificare gli esperimenti in modo da ottenere le risposte cercate con pochi contrasti di interesse. In questo modo il problema della molteplicità è minimizzato.</li>
<li>Non usare mai contrasti con serie di dati quantitative. In questo caso la regressione è l’approccio corretto e ne parleremo in un prossimo capitolo. In generale, utilizzare i contrasti solo se sono coerenti con la logica dell’esperimento.</li>
<li>Evitare di utilizzare i confronti multipli nei disegno fattoriale per confrontare tutte le combinazioni dei fattori sperimentali e preferire invece il confronto dei lvelli di un fattore all’interno dei livelli dell’altri.</li>
<li>Pianificare esattamente il numero di contrasti necessari ed eseguirli, fornendo il valore del contrasto e il suo errore standard.</li>
<li>Decidere è necessario aggiustare il p-level (e gli intervalli di confidenza) per la molteplicità (tasso di errore <em>comparisonwise</em> o <em>experimentwise</em>).</li>
<li>Se si decide di aggiustare il p-level, considerare che le procedure di Bonferroni o Sidak possono essere eccessivamente protette. Preferire quindi le procedure di aggiustamento basate sulla distribuzione t multivariata, il che, a livello di confronto multiplo con dati bilanciati, è equivalente ad utilizzate la Tukey HSD o il test di Dunnett.</li>
<li>Evitare le procedure di Duncan e Newmann-Keuls: non danno il livello di protezione cercato e, inoltre, non sono basate su una differenza critica costante (quindi sono difficili da discutere).</li>
</ol>
</div>
</div>
<div id="esempio-9.6-confronti-multipli-con-dati-trasformati" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Esempio 9.6: confronti multipli con dati trasformati<a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.6-confronti-multipli-con-dati-trasformati" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Un altro aspetto di cui tener conto è relativo al fatto che, nel caso in cui si fosse reso necessario qualche tipo di trasformazione stabilizzante, il test di confronto multiplo deve opportunamente adeguato. Per capire questo aspetto, possiamo riprendere in mano il dataset ‘insects.csv’ già esplorato nel capitolo precedente e relativo alle quindici piante trattate con tre insetticidi (cinque piante per insetticida), su ciascuna delle quali, alcune settimane dopo il trattamento, sono stati contati gli insetti presenti e vitali. Ricarichiamo il dataset e, tenendo conto dell’esigenza emerse nel capitolo precedente, analizziamo i dati previa trasformazione logaritmica. Quest’ultima viene eseguita direttamente nel corso del ‘model fitting’ e non nel dataset, per un motivo che sarà chiaro in seguito.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb99-1" aria-hidden="true" tabindex="-1"></a>fileName <span class="ot">&lt;-</span> <span class="st">&quot;https://www.casaonofri.it/_datasets/insects.csv&quot;</span></span>
<span id="cb99-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb99-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(fileName, <span class="at">header =</span> T)</span>
<span id="cb99-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb99-3" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>Insecticide <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset<span class="sc">$</span>Insecticide)</span>
<span id="cb99-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb99-4" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Count) <span class="sc">~</span> Insecticide, <span class="at">data =</span> dataset)</span></code></pre></div>
<p>A questo punto, possiamo calcolare le medie marginali attese, che, tuttavia, sono su scala logaritmica, come indicato nel codice sottostante.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb100-1" aria-hidden="true" tabindex="-1"></a>medie <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(mod, <span class="sc">~</span>Insecticide)</span>
<span id="cb100-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb100-2" aria-hidden="true" tabindex="-1"></a>medie</span>
<span id="cb100-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Insecticide emmean    SE df lower.CL upper.CL</span></span>
<span id="cb100-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  T1            6.34 0.178 12     5.96     6.73</span></span>
<span id="cb100-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  T2            5.81 0.178 12     5.43     6.20</span></span>
<span id="cb100-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  T3            3.95 0.178 12     3.56     4.34</span></span>
<span id="cb100-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb100-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Results are given on the log (not the response) scale. </span></span>
<span id="cb100-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95</span></span></code></pre></div>
<p>Presentare le medie su scala logaritmica, in molti casi, potrebbe non essere di immediata o facile lettura. Per questo, potremmo pensare di retro-trasformare le medie, utilizzando la trasformazione inversa di quella logaritmica, cioè l’antilogaritmo. Ad esempio, per la prima media:</p>
<p><span class="math display">\[e^{6.34} = 566.7963\]</span></p>
<p>In questo modo la nostra unità di misura ridiventa quella originale, anche se il valore ottenuto non coincide con la media dei dati originali; in effetti la trasformazione è non lineare e la media dei logaritmi non può coincidere con il logaritmo della media. Possiamo osservare che la media del trattamento A, sulla scala originale, è:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dataset[dataset<span class="sc">$</span>Insecticide <span class="sc">==</span> <span class="st">&quot;T1&quot;</span>,<span class="st">&quot;Count&quot;</span>])</span>
<span id="cb101-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 589.8</span></span></code></pre></div>
<p>e risulta più alta della media retro-trasformata. In realtà, se è vero che i logaritmi sono normalmente distribuiti, la media dei logaritmi (6.34) dovrebbe essere uguale alla mediana (ricordiamo che in una distribuzione normale media e mediana coincidono). La mediana è il valore centrale; dato che la retro-trasformazione è monotona, il valore centrale resta centrale, anche se io retro-trasformo. Quindi la media retro-trasformata è uno stimatore della mediana della popolazione originale, non della sua media. Questo non è uno svantaggio: infatti il QQ-plot suggerisce un’asimmetria positiva (vedi capitolo precedente) cosa che è confermata dal fatto che la mediana è minore della media. Se la distribuzione dei dati è asimmetrica, la mediana è un indicatore di tendenza centrale migliore della media, perché meno sensibile ai valori estremi, che sono più frequenti in caso di asimmetria.</p>
<p>Il problema è che, se vogliamo utilizzare la media retro-trasformata, dobbiamo trovare un valore di errore standard per questo stima, con il quale esprimere la sua incertezza. In realtà, anche l’errore standard può essere retro-trasformato, con una tecnica detta metodo ‘delta’, che costituisce un estensione della legge di propagazione degli errori per le trasformazioni non-lineari. È inutile andare nel dettaglio; diciamo solo che la funzione <code>emmeans()</code> rende semplicissima l’implementazione del metodo delta, con il comando seguente:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb102-1" aria-hidden="true" tabindex="-1"></a>retroMedie <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(mod, <span class="sc">~</span>Insecticide, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb102-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb102-2" aria-hidden="true" tabindex="-1"></a>retroMedie</span>
<span id="cb102-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Insecticide response     SE df lower.CL upper.CL</span></span>
<span id="cb102-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  T1             568.6 101.01 12    386.1    837.3</span></span>
<span id="cb102-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  T2             335.1  59.54 12    227.6    493.5</span></span>
<span id="cb102-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  T3              51.9   9.22 12     35.2     76.4</span></span>
<span id="cb102-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb102-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb102-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Intervals are back-transformed from the log scale</span></span></code></pre></div>
<p>Con questo abbiamo tutto quello che ci serve: stime ed errori standard, che, ovviamente, sono diversi per le diverse medie retro-trasformate, coerentemente con la mancanza di omoscedasticità. Il test di confronto multiplo è, pertanto:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb103-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(retroMedie, <span class="at">Letters =</span> LETTERS)</span>
<span id="cb103-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Insecticide response     SE df lower.CL upper.CL .group</span></span>
<span id="cb103-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  T3              51.9   9.22 12     35.2     76.4  A    </span></span>
<span id="cb103-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  T2             335.1  59.54 12    227.6    493.5   B   </span></span>
<span id="cb103-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  T1             568.6 101.01 12    386.1    837.3   B   </span></span>
<span id="cb103-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb103-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb103-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Intervals are back-transformed from the log scale </span></span>
<span id="cb103-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="do">## P value adjustment: tukey method for comparing a family of 3 estimates </span></span>
<span id="cb103-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Tests are performed on the log scale </span></span>
<span id="cb103-12"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="do">## significance level used: alpha = 0.05 </span></span>
<span id="cb103-13"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: If two or more means share the same grouping symbol,</span></span>
<span id="cb103-14"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="do">##       then we cannot show them to be different.</span></span>
<span id="cb103-15"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="do">##       But we also did not show them to be the same.</span></span></code></pre></div>
<p>La retrotrasformazione è immediata in quanto la funzione <code>emmeans()</code> è stata in grado di riconoscere la trasformazione stabilizzante applicata all’interno del ‘model fitting’. La situazione diviene più complessa se la trasformazione è applicata prima del ‘model fitting’ oppure se non viene automaticamente riconosciuta. Ad esempio, una trasformazione inversa non viene automaticamente riconosciuta e, di conseguenza, la retrotrasformazione non viene effettuata.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb104-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="dv">1</span><span class="sc">/</span>Count <span class="sc">~</span> Insecticide, <span class="at">data =</span> dataset)</span>
<span id="cb104-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(mod2, <span class="sc">~</span>Insecticide, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb104-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  Insecticide  emmean      SE df lower.CL upper.CL</span></span>
<span id="cb104-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  T1          0.00182 0.00279 12 -0.00426  0.00789</span></span>
<span id="cb104-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  T2          0.00317 0.00279 12 -0.00291  0.00924</span></span>
<span id="cb104-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  T3          0.02120 0.00279 12  0.01513  0.02727</span></span>
<span id="cb104-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb104-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95</span></span></code></pre></div>
<p>In questo caso, dobbiamo eseguire la trasformazione prima del ‘model fitting’ e poi cambiare la griglia di riferimento per il modello (<code>update(ref_grid(mod2), ....)</code>) specificando la trasformazione effettuata (<code>tran = "inverse"</code>). La griglia così modificata viene passata al posto del modello alla funzione <code>emmeans()</code>, come indicato di seguito.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb105-1" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>InvCount <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>dataset<span class="sc">$</span>Count</span>
<span id="cb105-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb105-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(InvCount <span class="sc">~</span> Insecticide, <span class="at">data =</span> dataset)</span>
<span id="cb105-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb105-3" aria-hidden="true" tabindex="-1"></a>updGrid <span class="ot">&lt;-</span> <span class="fu">update</span>(<span class="fu">ref_grid</span>(mod3), <span class="at">tran =</span> <span class="st">&quot;inverse&quot;</span>)</span>
<span id="cb105-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(updGrid, <span class="sc">~</span>Insecticide, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb105-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Insecticide response    SE df lower.CL upper.CL</span></span>
<span id="cb105-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  T1             550.9 845.9 12    126.8      Inf</span></span>
<span id="cb105-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  T2             315.8 278.0 12    108.2      Inf</span></span>
<span id="cb105-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  T3              47.2   6.2 12     36.7       66</span></span>
<span id="cb105-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb105-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb105-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Intervals are back-transformed from the inverse scale</span></span></code></pre></div>
<p>Questo metodo si può utilizzare con numerose funzioni, come, ad esempio “identity”, “1/mu^2”, “inverse”, “reciprocal”, “log10”, “log2”, “asin.sqrt” e “asinh.sqrt”.</p>
<p>Un approccio analogo può essere utilizzato se vogliamo effettuare la trasformazione di Box-Cox nella sua forma semplificata (<span class="math inline">\(W = Y^{\lambda}\)</span>), utilizzando un valore <span class="math inline">\(\lambda\)</span> diverso da quelli ‘semplici’ (cioè diverso da 1, 0, 0.5 o -1). Ad esempio, se vogliamo utilizzare <span class="math inline">\(\lambda = 0.25\)</span>, dobbiamo operare in modo simile a quello descritto in precedenza, utilizzando la funzione <code>make.tran()</code>, come evidenziato nel box seguente.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb106-1" aria-hidden="true" tabindex="-1"></a>dataset<span class="sc">$</span>lCount <span class="ot">&lt;-</span> dataset<span class="sc">$</span>Count<span class="sc">^</span><span class="fl">0.25</span></span>
<span id="cb106-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb106-2" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(lCount <span class="sc">~</span> Insecticide, <span class="at">data =</span> dataset)</span>
<span id="cb106-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb106-3" aria-hidden="true" tabindex="-1"></a>updGrid <span class="ot">&lt;-</span> <span class="fu">update</span>(<span class="fu">ref_grid</span>(mod4), <span class="at">tran =</span> <span class="fu">make.tran</span>(<span class="st">&quot;power&quot;</span>, <span class="fl">0.25</span>))</span>
<span id="cb106-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(updGrid, <span class="sc">~</span>Insecticide, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb106-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Insecticide response   SE df lower.CL upper.CL</span></span>
<span id="cb106-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  T1             573.5 78.7 12    420.3    765.3</span></span>
<span id="cb106-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  T2             340.5 53.2 12    238.5    472.1</span></span>
<span id="cb106-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  T3              53.1 13.2 12     29.6     88.3</span></span>
<span id="cb106-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb106-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb106-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Intervals are back-transformed from the mu^0.25 scale</span></span></code></pre></div>
</div>
<div id="esempio-9.7-previsioni-e-previsioni-inverse" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> Esempio 9.7: Previsioni e previsioni inverse<a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.7-previsioni-e-previsioni-inverse" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Per i modelli di regressione lineare o non lineare, lavorare con le medie è solitamente irrilevante, mentre può essere necessario utilizzare il modello per fare previsioni, ovvero per calcolare la risposta attesa con un certo valore della variabile indipendente oppure per calcolare quale valore di una variabile indipendente consente di ottenere la risposta voluta (previsione inversa). Anche le previsioni possono essere considerate combinazioni lineari o non lineari dei parametri del modello e possono essere calcolate con R, utilizzando una delle numerose funzioni disponibili, come <code>predict()</code>, <code>emmeans()</code>, <code>glht()</code> e <code>gnlht()</code>.</p>
<p>A titolo di esempio, possiamo considerare i dati ‘Ammi94’, relativi a un esperimento per definire la relazione tra la densità di <em>Ammi majus</em> (un’importante infestante di diverse colture primaverili nell’Italia centrale) espressa come numero di piante per metro quadrato e la resa del girasole in tonnellate per ettaro. Le diverse densità delle infestanti sono state ottenute con semina mauale, mentre i dati di resa rappresentano la media di quattro repliche (Onofri et al., 1994). Il dataset è disponibile nel pacchetto <code>statforbiology</code> e nel riquadro successivo, si vede come venga adattato un semplice modello di regressione lineare e le due stime (intercetta e pendenza, ovvero <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span>) vengono recuperate e visualizzate.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 9.7</span></span>
<span id="cb107-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions and inverse predictions for linear regression</span></span>
<span id="cb107-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Weed density/Yield relationship for Ammi majus</span></span>
<span id="cb107-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the packages</span></span>
<span id="cb107-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statforbiology)</span>
<span id="cb107-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb107-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb107-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the data</span></span>
<span id="cb107-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-11" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">getAgroData</span>(<span class="st">&quot;Ammi94&quot;</span>)</span>
<span id="cb107-12"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-12" aria-hidden="true" tabindex="-1"></a>dataset</span>
<span id="cb107-13"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="do">##   Density  Yield</span></span>
<span id="cb107-14"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 1       0 2.4866</span></span>
<span id="cb107-15"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 2      16 2.1806</span></span>
<span id="cb107-16"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 3      21 1.8456</span></span>
<span id="cb107-17"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 4      36 1.8412</span></span>
<span id="cb107-18"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 5      49 1.6486</span></span>
<span id="cb107-19"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting a regression model</span></span>
<span id="cb107-20"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-20" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Density, <span class="at">data =</span> dataset)</span>
<span id="cb107-21"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span>
<span id="cb107-22"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb107-23"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb107-24"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-24" aria-hidden="true" tabindex="-1"></a><span class="do">## lm(formula = Yield ~ Density, data = dataset)</span></span>
<span id="cb107-25"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-25" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb107-26"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb107-27"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-27" aria-hidden="true" tabindex="-1"></a><span class="do">##        1        2        3        4        5 </span></span>
<span id="cb107-28"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  0.08403  0.04167 -0.21094  0.03182  0.05342 </span></span>
<span id="cb107-29"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-29" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb107-30"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb107-31"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-31" aria-hidden="true" tabindex="-1"></a><span class="do">##              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb107-32"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-32" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)  2.402566   0.108697  22.103 0.000203 ***</span></span>
<span id="cb107-33"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Density     -0.016477   0.003667  -4.494 0.020567 *  </span></span>
<span id="cb107-34"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-34" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb107-35"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb107-36"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-36" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb107-37"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-37" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual standard error: 0.138 on 3 degrees of freedom</span></span>
<span id="cb107-38"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.8707, Adjusted R-squared:  0.8275 </span></span>
<span id="cb107-39"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb107-39" aria-hidden="true" tabindex="-1"></a><span class="do">## F-statistic: 20.19 on 1 and 3 DF,  p-value: 0.02057</span></span></code></pre></div>
<p>In un esperimento del genere, vi sono due interessi fondamentali:</p>
<ol style="list-style-type: decimal">
<li>Prevedere la resa con misurazioni precoci della densità delle infestanti (previsione);</li>
<li>Determinare la densità delle infestanti che provoca un certo livello di perdita di resa (previsione inversa).</li>
</ol>
<p>Queste stime possono essere ottenute come combinazioni lineari o non lineari. Ad esempio, immaginiamo di voler determinare il livello di resa previsto con 10 piante di <em>Ammi majus</em> per metro quadrato. Ci sono tre possibilità:</p>
<ol style="list-style-type: decimal">
<li>Utilizzare la funzione <code>glht()</code> per adattare un contrasto <span class="math inline">\(C = 1 \times \beta_0 + 10 \times \beta_1\)</span>, dove i parametri <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> sono, rispettivamente, l’intercetta e la pendenza del modello lineare;</li>
<li>Utilizzare la funzione <code>predict()</code> e passare un dataframe (non un vettore!) contenente il livello di densità per la previsione (argomento ‘newdata’);</li>
<li>Utilizzare la funzione <code>emmeans()</code>, passando il livello di densità come dataframe all’argomento ‘at’.</li>
</ol>
<p>Tutte e tre le possibilità sono illustrate nel riquadro sottostante; i risultati sono, ovviamente, del tutto equivalenti.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 9.7 [continuation]</span></span>
<span id="cb108-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Three methods for predictions</span></span>
<span id="cb108-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.Fitting with &#39;glht()&#39;##################</span></span>
<span id="cb108-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting a contrast matrix</span></span>
<span id="cb108-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-7" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb108-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(mod, <span class="at">linfct =</span> K))</span>
<span id="cb108-9"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb108-10"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="do">##   Simultaneous Tests for General Linear Hypotheses</span></span>
<span id="cb108-11"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb108-12"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit: lm(formula = Yield ~ Density, data = dataset)</span></span>
<span id="cb108-13"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb108-14"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Linear Hypotheses:</span></span>
<span id="cb108-15"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="do">##        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb108-16"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 == 0  2.23779    0.08123   27.55 0.000105 ***</span></span>
<span id="cb108-17"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb108-18"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb108-19"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="do">## (Adjusted p values reported -- single-step method)</span></span>
<span id="cb108-20"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.Fitting with &#39;predict()&#39; ################</span></span>
<span id="cb108-21"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-21" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(mod, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Density=</span> <span class="fu">c</span>(<span class="dv">10</span>)), <span class="at">se.fit =</span> T)</span>
<span id="cb108-22"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-22" aria-hidden="true" tabindex="-1"></a><span class="do">## $fit</span></span>
<span id="cb108-23"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-23" aria-hidden="true" tabindex="-1"></a><span class="do">##        1 </span></span>
<span id="cb108-24"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 2.237793 </span></span>
<span id="cb108-25"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-25" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb108-26"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-26" aria-hidden="true" tabindex="-1"></a><span class="do">## $se.fit</span></span>
<span id="cb108-27"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-27" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.08123191</span></span>
<span id="cb108-28"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-28" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb108-29"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-29" aria-hidden="true" tabindex="-1"></a><span class="do">## $df</span></span>
<span id="cb108-30"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-30" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 3</span></span>
<span id="cb108-31"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-31" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb108-32"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-32" aria-hidden="true" tabindex="-1"></a><span class="do">## $residual.scale</span></span>
<span id="cb108-33"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-33" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1380352</span></span>
<span id="cb108-34"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.Fitting with &#39;emmeans()&#39; ####################</span></span>
<span id="cb108-35"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-35" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(mod, <span class="sc">~</span>Density, <span class="at">at =</span> <span class="fu">data.frame</span>(<span class="at">Density=</span> <span class="fu">c</span>(<span class="dv">10</span>)))</span>
<span id="cb108-36"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  Density emmean     SE df lower.CL upper.CL</span></span>
<span id="cb108-37"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-37" aria-hidden="true" tabindex="-1"></a><span class="do">##       10   2.24 0.0812  3     1.98      2.5</span></span>
<span id="cb108-38"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-38" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb108-39"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb108-39" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95</span></span></code></pre></div>
<p>Immaginiamo ora di voler stimare il livello di densità delle malerbe che provoca una riduzione della resa del 10%. Considerando che la resa senza malerbe è di 2.403 tonnellate per ettaro (l’intercetta stimata più sopra), una riduzione della resa del 10% corrisponde all’ottenimento di un livello di resa pari a <span class="math inline">\(2.403 - 0.1 \times 2.403 = 2.163\)</span>, che è pari a <span class="math inline">\((2,163 - \beta_0)/\beta_1\)</span>. Quest’ultima equazione è intrinsecamente non lineare; pertanto, si deve utilizzare la funzione <code>gnlht()</code>, come mostrato qui sotto.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 9.7 [continuation]</span></span>
<span id="cb109-2"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Inverse prediction with gnlht()</span></span>
<span id="cb109-4"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="fu">gnlht</span>(mod, <span class="at">func =</span> <span class="fu">list</span>(<span class="sc">~</span>(<span class="fl">21.53</span> <span class="sc">-</span> b0)<span class="sc">/</span>b1), </span>
<span id="cb109-6"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb109-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">parameterNames =</span> <span class="fu">c</span>(<span class="st">&quot;b0&quot;</span>, <span class="st">&quot;b1&quot;</span>))</span>
<span id="cb109-7"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="do">##              Form  Estimate       SE  t-value   p-value</span></span>
<span id="cb109-8"><a href="combinazioni-linearinonlineari-dei-parametri.html#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 (21.53 - b0)/b1 -1160.835 263.7767 4.400825 0.0217523</span></span></code></pre></div>
<hr />
</div>
<div id="altre-letture-8" class="section level2 hasAnchor" number="9.8">
<h2><span class="header-section-number">9.8</span> Altre letture<a href="combinazioni-linearinonlineari-dei-parametri.html#altre-letture-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Bretz F, Hothorn T, Westfall P (2011) Multiple Comparisons Using R. CRC Press, Boca Raton, FL</li>
<li>Chew V (1976) Comparing treatment means: a compendium. Hortscience 11(4):348–357</li>
<li>Cousens R (1988) Misinterpretetion of results in weed research through inappropriate use of statistics. Weed Res 28:281–289</li>
<li>Hsu JC (1996) Multiple Comparisons: Theory and Methods. Chapman &amp; Hall, London</li>
<li>Lenth RV (2016) Least-squares means: the R package lsmeans. J Stat Softw 69(1). <a href="https://doi.org/10.18637/jss.v069.i01" class="uri">https://doi.org/10.18637/jss.v069.i01</a>.</li>
<li>Onofri A, Tei F (1994) Competitive ability and threshold levels for three broadleaf weed species in sunflower. Weed Res 34:471–479</li>
<li>Onofri A, Carbonell EA, Piepho HP, Mortimer AM, Cousens RD (2010) Current statistical issues in Weed Research. Weed Res 50(1):5–24</li>
<li>Piepho HP (2004) An algorithm for a letter-based representation of all-pairwise comparisons. J Comput Graph Stat 13(2):456–466</li>
<li>Weisberg S (2005) Applied Linear Regression, 3rd edn. Wiley, Hoboken</li>
</ol>
</div>
<div id="esercizi-2" class="section level2 hasAnchor" number="9.9">
<h2><span class="header-section-number">9.9</span> Esercizi<a href="combinazioni-linearinonlineari-dei-parametri.html#esercizi-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Considerare gli esercizi da 5 a 7 nel Capitolo 4. Per tutti questi esercizi, dopo essersi accertati se è necessaria una trasformazione per soddisfare le ipotesi di base per i modelli lineari, eseguire il test di confronto multiplo, adottando una correzione appropriata per la molteplicità.</li>
</ol>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>vedi: <a href="combinazioni-linearinonlineari-dei-parametri.html#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Chi fosse interessato può trovare informazioni sul nel blog associato, all’indirizzo \url{<a href="https://www.statforbiology.com/2024/stat_general_thedeltamethod_edit/" class="uri">https://www.statforbiology.com/2024/stat_general_thedeltamethod_edit/</a><a href="combinazioni-linearinonlineari-dei-parametri.html#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="verifica-dei-modelli.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ricomponiamo-il-puzzle.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
