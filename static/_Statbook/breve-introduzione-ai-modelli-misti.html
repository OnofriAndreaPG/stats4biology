<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capitolo 12 Breve introduzione ai modelli misti | Metodologia sperimentale per le scienze agrarie</title>
  <meta name="description" content="Capitolo 12 Breve introduzione ai modelli misti | Metodologia sperimentale per le scienze agrarie con applicazioni in R" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Capitolo 12 Breve introduzione ai modelli misti | Metodologia sperimentale per le scienze agrarie" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Capitolo 12 Breve introduzione ai modelli misti | Metodologia sperimentale per le scienze agrarie con applicazioni in R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capitolo 12 Breve introduzione ai modelli misti | Metodologia sperimentale per le scienze agrarie" />
  
  <meta name="twitter:description" content="Capitolo 12 Breve introduzione ai modelli misti | Metodologia sperimentale per le scienze agrarie con applicazioni in R" />
  

<meta name="author" content="Andrea Onofri e Dario Sacco" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelli-di-regressione-avanzati.html"/>
<link rel="next" href="appendice-a-breve-introduzione-ad-r.html"/>
<script src="book_assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="book_assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="book_assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="book_assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131792052-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-131792052-1');
  </script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Metodologia sperimentale</a></strong></li> 

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Premessa</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#obiettivi"><i class="fa fa-check"></i>Obiettivi</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organizzazione"><i class="fa fa-check"></i>Organizzazione</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-statistico"><i class="fa fa-check"></i>Software statistico</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#gli-autori"><i class="fa fa-check"></i>Gli autori</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ringraziamenti-e-scuse"><i class="fa fa-check"></i>Ringraziamenti e scuse</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acronimi"><i class="fa fa-check"></i>Acronimi</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html"><i class="fa fa-check"></i><b>1</b> Scienza e pseudo-scienza</a>
<ul>
<li class="chapter" data-level="1.1" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#scienza-dati"><i class="fa fa-check"></i><b>1.1</b> Scienza = dati</a></li>
<li class="chapter" data-level="1.2" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#dati-buoni-e-cattivi"><i class="fa fa-check"></i><b>1.2</b> Dati ‘buoni’ e ‘cattivi’</a></li>
<li class="chapter" data-level="1.3" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#dati-buoni-e-metodi-buoni"><i class="fa fa-check"></i><b>1.3</b> Dati ‘buoni’ e metodi ‘buoni’</a></li>
<li class="chapter" data-level="1.4" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#il-principio-di-falsificazione"><i class="fa fa-check"></i><b>1.4</b> Il principio di falsificazione</a></li>
<li class="chapter" data-level="1.5" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#falsificare-un-risultato"><i class="fa fa-check"></i><b>1.5</b> Falsificare un risultato</a></li>
<li class="chapter" data-level="1.6" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#elementi-fondamentali-del-disegno-sperimentale"><i class="fa fa-check"></i><b>1.6</b> Elementi fondamentali del disegno sperimentale</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#controllo-degli-errori"><i class="fa fa-check"></i><b>1.6.1</b> Controllo degli errori</a></li>
<li class="chapter" data-level="1.6.2" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#replicazione"><i class="fa fa-check"></i><b>1.6.2</b> Replicazione</a></li>
<li class="chapter" data-level="1.6.3" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#randomizzazione"><i class="fa fa-check"></i><b>1.6.3</b> Randomizzazione</a></li>
<li class="chapter" data-level="1.6.4" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#esperimenti-invalidi"><i class="fa fa-check"></i><b>1.6.4</b> Esperimenti invalidi</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#chi-valuta-se-un-esperimento-è-attendibile"><i class="fa fa-check"></i><b>1.7</b> Chi valuta se un esperimento è attendibile?</a></li>
<li class="chapter" data-level="1.8" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#conclusioni"><i class="fa fa-check"></i><b>1.8</b> Conclusioni</a></li>
<li class="chapter" data-level="1.9" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#esercizi-e-domande"><i class="fa fa-check"></i><b>1.9</b> Esercizi e domande</a></li>
<li class="chapter" data-level="1.10" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#altre-letture"><i class="fa fa-check"></i><b>1.10</b> Altre letture</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html"><i class="fa fa-check"></i><b>2</b> Progettare un esperimento</a>
<ul>
<li class="chapter" data-level="2.1" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#gli-elementi-della-ricerca"><i class="fa fa-check"></i><b>2.1</b> Gli elementi della ricerca</a></li>
<li class="chapter" data-level="2.2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#ipotesi-scientifica-rightarrow-obiettivo-dellesperimento"><i class="fa fa-check"></i><b>2.2</b> Ipotesi scientifica <span class="math inline">\(\rightarrow\)</span> obiettivo dell’esperimento</a></li>
<li class="chapter" data-level="2.3" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#identificazione-dei-fattori-sperimentali"><i class="fa fa-check"></i><b>2.3</b> Identificazione dei fattori sperimentali</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esperimenti-multi-fattoriali"><i class="fa fa-check"></i><b>2.3.1</b> Esperimenti (multi-)fattoriali</a></li>
<li class="chapter" data-level="2.3.2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#controllo-o-testimone"><i class="fa fa-check"></i><b>2.3.2</b> Controllo o testimone</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#le-unità-sperimentali"><i class="fa fa-check"></i><b>2.4</b> Le unità sperimentali</a></li>
<li class="chapter" data-level="2.5" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#allocazione-dei-trattamenti"><i class="fa fa-check"></i><b>2.5</b> Allocazione dei trattamenti</a></li>
<li class="chapter" data-level="2.6" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#le-variabili-sperimentali"><i class="fa fa-check"></i><b>2.6</b> Le variabili sperimentali</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#variabili-nominali-categoriche"><i class="fa fa-check"></i><b>2.6.1</b> Variabili nominali (categoriche)</a></li>
<li class="chapter" data-level="2.6.2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#variabili-ordinali"><i class="fa fa-check"></i><b>2.6.2</b> Variabili ordinali</a></li>
<li class="chapter" data-level="2.6.3" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#variabili-quantitative-discrete"><i class="fa fa-check"></i><b>2.6.3</b> Variabili quantitative discrete</a></li>
<li class="chapter" data-level="2.6.4" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#variabili-quantitative-continue"><i class="fa fa-check"></i><b>2.6.4</b> Variabili quantitative continue</a></li>
<li class="chapter" data-level="2.6.5" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#rilievi-visivi-e-sensoriali"><i class="fa fa-check"></i><b>2.6.5</b> Rilievi visivi e sensoriali</a></li>
<li class="chapter" data-level="2.6.6" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#variabili-di-confondimento"><i class="fa fa-check"></i><b>2.6.6</b> Variabili di confondimento</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esperimenti-di-campo"><i class="fa fa-check"></i><b>2.7</b> Esperimenti di campo</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#scegliere-il-campo"><i class="fa fa-check"></i><b>2.7.1</b> Scegliere il campo</a></li>
<li class="chapter" data-level="2.7.2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#le-unità-sperimentali-in-campo"><i class="fa fa-check"></i><b>2.7.2</b> Le unità sperimentali in campo</a></li>
<li class="chapter" data-level="2.7.3" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#numero-di-repliche"><i class="fa fa-check"></i><b>2.7.3</b> Numero di repliche</a></li>
<li class="chapter" data-level="2.7.4" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#la-mappa-di-campo"><i class="fa fa-check"></i><b>2.7.4</b> La mappa di campo</a></li>
<li class="chapter" data-level="2.7.5" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#lay-out-sperimentale"><i class="fa fa-check"></i><b>2.7.5</b> Lay-out sperimentale</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#altre-letture-1"><i class="fa fa-check"></i><b>2.8</b> Altre letture</a></li>
<li class="chapter" data-level="2.9" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domande-ed-esercizi"><i class="fa fa-check"></i><b>2.9</b> Domande ed esercizi</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-1"><i class="fa fa-check"></i><b>2.9.1</b> Domanda 1</a></li>
<li class="chapter" data-level="2.9.2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-2"><i class="fa fa-check"></i><b>2.9.2</b> Domanda 2</a></li>
<li class="chapter" data-level="2.9.3" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-3"><i class="fa fa-check"></i><b>2.9.3</b> Domanda 3</a></li>
<li class="chapter" data-level="2.9.4" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-4"><i class="fa fa-check"></i><b>2.9.4</b> Domanda 4</a></li>
<li class="chapter" data-level="2.9.5" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-5"><i class="fa fa-check"></i><b>2.9.5</b> Domanda 5</a></li>
<li class="chapter" data-level="2.9.6" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-6"><i class="fa fa-check"></i><b>2.9.6</b> Domanda 6</a></li>
<li class="chapter" data-level="2.9.7" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-7"><i class="fa fa-check"></i><b>2.9.7</b> Domanda 7</a></li>
<li class="chapter" data-level="2.9.8" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-8"><i class="fa fa-check"></i><b>2.9.8</b> Domanda 8</a></li>
<li class="chapter" data-level="2.9.9" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-9"><i class="fa fa-check"></i><b>2.9.9</b> Domanda 9</a></li>
<li class="chapter" data-level="2.9.10" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-10"><i class="fa fa-check"></i><b>2.9.10</b> Domanda 10</a></li>
<li class="chapter" data-level="2.9.11" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-12"><i class="fa fa-check"></i><b>2.9.11</b> Domanda 12</a></li>
<li class="chapter" data-level="2.9.12" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-13"><i class="fa fa-check"></i><b>2.9.12</b> Domanda 13</a></li>
<li class="chapter" data-level="2.9.13" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esercizio-1"><i class="fa fa-check"></i><b>2.9.13</b> Esercizio 1</a></li>
<li class="chapter" data-level="2.9.14" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esercizio-2"><i class="fa fa-check"></i><b>2.9.14</b> Esercizio 2</a></li>
<li class="chapter" data-level="2.9.15" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esercizio-3"><i class="fa fa-check"></i><b>2.9.15</b> Esercizio 3</a></li>
<li class="chapter" data-level="2.9.16" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esercizio-4"><i class="fa fa-check"></i><b>2.9.16</b> Esercizio 4</a></li>
<li class="chapter" data-level="2.9.17" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esercizio-5"><i class="fa fa-check"></i><b>2.9.17</b> Esercizio 5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html"><i class="fa fa-check"></i><b>3</b> Richiami di statistica descrittiva</a>
<ul>
<li class="chapter" data-level="3.1" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#descrizione-di-dati-quantitativi"><i class="fa fa-check"></i><b>3.1</b> Descrizione di dati quantitativi</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#indicatori-di-tendenza-centrale"><i class="fa fa-check"></i><b>3.1.1</b> Indicatori di tendenza centrale</a></li>
<li class="chapter" data-level="3.1.2" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#indicatori-di-dispersione"><i class="fa fa-check"></i><b>3.1.2</b> Indicatori di dispersione</a></li>
<li class="chapter" data-level="3.1.3" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#incertezza-delle-misure-derivate"><i class="fa fa-check"></i><b>3.1.3</b> Incertezza delle misure derivate</a></li>
<li class="chapter" data-level="3.1.4" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#relazioni-tra-variabili-quantitative-correlazione"><i class="fa fa-check"></i><b>3.1.4</b> Relazioni tra variabili quantitative: correlazione</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#statistiche-descrittive-con-r"><i class="fa fa-check"></i><b>3.2</b> Statistiche descrittive con R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#descrizione-dei-sottogruppi"><i class="fa fa-check"></i><b>3.2.1</b> Descrizione dei sottogruppi</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#altre-letture-2"><i class="fa fa-check"></i><b>3.3</b> Altre letture</a></li>
<li class="chapter" data-level="3.4" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#domande-ed-esercizi-1"><i class="fa fa-check"></i><b>3.4</b> Domande ed esercizi</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html"><i class="fa fa-check"></i><b>4</b> Le relazioni causa-effetto</a>
<ul>
<li class="chapter" data-level="4.1" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#modelli-matematici-e-statistici"><i class="fa fa-check"></i><b>4.1</b> Modelli matematici e statistici</a></li>
<li class="chapter" data-level="4.2" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#componenti-di-un-modello"><i class="fa fa-check"></i><b>4.2</b> Componenti di un modello</a></li>
<li class="chapter" data-level="4.3" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#fitting-di-un-modello"><i class="fa fa-check"></i><b>4.3</b> <em>Fitting</em> di un modello</a></li>
<li class="chapter" data-level="4.4" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#esempio-1-il-modello-della-media"><i class="fa fa-check"></i><b>4.4</b> Esempio 1: il ‘modello della media’</a></li>
<li class="chapter" data-level="4.5" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#esempio-2-un-predittore-quantitativo"><i class="fa fa-check"></i><b>4.5</b> Esempio 2: un predittore quantitativo</a></li>
<li class="chapter" data-level="4.6" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#esempio-3-un-predittore-nominale"><i class="fa fa-check"></i><b>4.6</b> Esempio 3: un predittore nominale</a></li>
<li class="chapter" data-level="4.7" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#lanalisi-della-varianza-anova"><i class="fa fa-check"></i><b>4.7</b> L’analisi della varianza (ANOVA)</a></li>
<li class="chapter" data-level="4.8" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#example-4-due-predittori-nominali"><i class="fa fa-check"></i><b>4.8</b> Example 4: due predittori nominali</a></li>
<li class="chapter" data-level="4.9" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#example-5-due-predittori-nominali-con-interazione"><i class="fa fa-check"></i><b>4.9</b> Example 5: due predittori nominali con interazione</a></li>
<li class="chapter" data-level="4.10" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#interazione-tra-fattori-sperimentali"><i class="fa fa-check"></i><b>4.10</b> Interazione tra fattori sperimentali</a></li>
<li class="chapter" data-level="4.11" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#example-5-segue"><i class="fa fa-check"></i><b>4.11</b> Example 5 (segue)</a></li>
<li class="chapter" data-level="4.12" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#dati-non-bilanciati"><i class="fa fa-check"></i><b>4.12</b> Dati non bilanciati</a></li>
<li class="chapter" data-level="4.13" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#esempio-6-un-crbd-con-un-valore-mancante"><i class="fa fa-check"></i><b>4.13</b> Esempio 6: un CRBD con un valore mancante</a></li>
<li class="chapter" data-level="4.14" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#conclusioni-1"><i class="fa fa-check"></i><b>4.14</b> Conclusioni</a></li>
<li class="chapter" data-level="4.15" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#altre-letture-3"><i class="fa fa-check"></i><b>4.15</b> Altre letture</a></li>
<li class="chapter" data-level="4.16" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#domande-ed-esercizi-2"><i class="fa fa-check"></i><b>4.16</b> Domande ed esercizi</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html"><i class="fa fa-check"></i><b>5</b> Modelli stocastici</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#funzioni-di-probabilitàdensità"><i class="fa fa-check"></i><b>5.1</b> Funzioni di probabilità/densità</a></li>
<li class="chapter" data-level="5.2" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#calcolare-le-probabilità"><i class="fa fa-check"></i><b>5.2</b> Calcolare le probabilità</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#esempio-5.1-calcolare-la-probabilità-in-un-esperimento-misurativo"><i class="fa fa-check"></i><b>5.2.1</b> Esempio 5.1: Calcolare la probabilità in un esperimento misurativo</a></li>
<li class="chapter" data-level="5.2.2" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#esempio-5.2-calcolo-della-probabilità-per-un-esperimento-di-degradazione"><i class="fa fa-check"></i><b>5.2.2</b> Esempio 5.2: Calcolo della probabilità per un esperimento di degradazione</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#simulazione-stocastica"><i class="fa fa-check"></i><b>5.3</b> Simulazione stocastica</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#esempio-5.3.-simulazione-di-un-esperimento-misurativo"><i class="fa fa-check"></i><b>5.3.1</b> Esempio 5.3. Simulazione di un esperimento misurativo</a></li>
<li class="chapter" data-level="5.3.2" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#esempio-5.4-simulazione-di-un-esperimento-di-fertilizzazione"><i class="fa fa-check"></i><b>5.3.2</b> Esempio 5.4: simulazione di un esperimento di fertilizzazione</a></li>
<li class="chapter" data-level="5.3.3" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#esempio-5.4-simulazione-di-una-prova-di-confronto-varietale"><i class="fa fa-check"></i><b>5.3.3</b> Esempio 5.4: Simulazione di una prova di confronto varietale</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#conclusioni-2"><i class="fa fa-check"></i><b>5.4</b> Conclusioni</a></li>
<li class="chapter" data-level="5.5" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#altre-letture-4"><i class="fa fa-check"></i><b>5.5</b> Altre letture</a></li>
<li class="chapter" data-level="5.6" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#domande-ed-esercizi-3"><i class="fa fa-check"></i><b>5.6</b> Domande ed esercizi</a></li>
<li class="chapter" data-level="5.7" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#soluzioni"><i class="fa fa-check"></i><b>5.7</b> Soluzioni</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html"><i class="fa fa-check"></i><b>6</b> Stime ed incertezza</a>
<ul>
<li class="chapter" data-level="6.1" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#ripetere-gli-esperimenti"><i class="fa fa-check"></i><b>6.1</b> Ripetere gli esperimenti</a></li>
<li class="chapter" data-level="6.2" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#la-sampling-distribution-teorica"><i class="fa fa-check"></i><b>6.2</b> La ‘sampling distribution’ teorica</a></li>
<li class="chapter" data-level="6.3" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#lintervallo-di-confidenza-frequentista"><i class="fa fa-check"></i><b>6.3</b> L’intervallo di confidenza frequentista</a></li>
<li class="chapter" data-level="6.4" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#come-otteniamo-lerrore-standard"><i class="fa fa-check"></i><b>6.4</b> Come otteniamo l’errore standard?</a></li>
<li class="chapter" data-level="6.5" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#come-otteniamo-il-moltiplicatore-k"><i class="fa fa-check"></i><b>6.5</b> Come otteniamo il moltiplicatore <span class="math inline">\(k\)</span>?</a></li>
<li class="chapter" data-level="6.6" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#gli-intervalli-di-confidenza-in-pratica"><i class="fa fa-check"></i><b>6.6</b> Gli intervalli di confidenza in pratica</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#esempio-6.1-ic-per-una-media-campionaria"><i class="fa fa-check"></i><b>6.6.1</b> Esempio 6.1: IC per una media campionaria</a></li>
<li class="chapter" data-level="6.6.2" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#example-6.2-cis-for-model-parameters"><i class="fa fa-check"></i><b>6.6.2</b> Example 6.2: CIs for model parameters</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#altri-approcci-per-il-calcolo-dei-ci"><i class="fa fa-check"></i><b>6.7</b> Altri approcci per il calcolo dei CI</a></li>
<li class="chapter" data-level="6.8" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#limitazioni-del-ci-frequentista"><i class="fa fa-check"></i><b>6.8</b> Limitazioni del CI frequentista</a></li>
<li class="chapter" data-level="6.9" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#altre-letture-5"><i class="fa fa-check"></i><b>6.9</b> Altre letture</a></li>
<li class="chapter" data-level="6.10" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#domande-ed-esercizi-4"><i class="fa fa-check"></i><b>6.10</b> Domande ed esercizi</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html"><i class="fa fa-check"></i><b>7</b> Decisioni ed incertezza</a>
<ul>
<li class="chapter" data-level="7.1" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#esempio-7.1-confronto-tra-due-genotipi"><i class="fa fa-check"></i><b>7.1</b> Esempio 7.1: Confronto tra due genotipi</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#lipotesi-nulla"><i class="fa fa-check"></i><b>7.1.1</b> L’ipotesi ‘nulla’</a></li>
<li class="chapter" data-level="7.1.2" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#il-test-di-t-wald-test"><i class="fa fa-check"></i><b>7.1.2</b> Il test di t (Wald test)</a></li>
<li class="chapter" data-level="7.1.3" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#simulazione-monte-carlo"><i class="fa fa-check"></i><b>7.1.3</b> Simulazione Monte Carlo</a></li>
<li class="chapter" data-level="7.1.4" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#una-soluzione-formale"><i class="fa fa-check"></i><b>7.1.4</b> Una soluzione formale</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#altri-test-di-t"><i class="fa fa-check"></i><b>7.2</b> Altri test di t</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#il-test-t-di-student"><i class="fa fa-check"></i><b>7.2.1</b> Il test t di Student</a></li>
<li class="chapter" data-level="7.2.2" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#il-test-di-welch"><i class="fa fa-check"></i><b>7.2.2</b> Il test di Welch</a></li>
<li class="chapter" data-level="7.2.3" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#il-test-di-t-appaiato"><i class="fa fa-check"></i><b>7.2.3</b> Il test di t appaiato</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#differenze-generalizzate-tra-parametri"><i class="fa fa-check"></i><b>7.3</b> Differenze generalizzate tra parametri</a></li>
<li class="chapter" data-level="7.4" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#il-test-f-nellanova"><i class="fa fa-check"></i><b>7.4</b> Il test F nell’ANOVA</a></li>
<li class="chapter" data-level="7.5" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#conclusioni-3"><i class="fa fa-check"></i><b>7.5</b> Conclusioni</a></li>
<li class="chapter" data-level="7.6" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#altre-letture-6"><i class="fa fa-check"></i><b>7.6</b> Altre letture</a></li>
<li class="chapter" data-level="7.7" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#esercizi"><i class="fa fa-check"></i><b>7.7</b> Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html"><i class="fa fa-check"></i><b>8</b> Verifica dei modelli</a>
<ul>
<li class="chapter" data-level="8.1" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#deviazioni-rispetto-alle-assunzioni-di-base"><i class="fa fa-check"></i><b>8.1</b> Deviazioni rispetto alle assunzioni di base</a></li>
<li class="chapter" data-level="8.2" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#scoprire-le-violazioni"><i class="fa fa-check"></i><b>8.2</b> Scoprire le violazioni</a></li>
<li class="chapter" data-level="8.3" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#analisi-grafica-dei-residui"><i class="fa fa-check"></i><b>8.3</b> Analisi grafica dei residui</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#grafico-dei-valori-osservati-aumentato-con-le-previsioni-del-modello"><i class="fa fa-check"></i><b>8.3.1</b> Grafico dei valori osservati, aumentato con le previsioni del modello</a></li>
<li class="chapter" data-level="8.3.2" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#grafico-dei-residui-contro-i-valori-attesi"><i class="fa fa-check"></i><b>8.3.2</b> Grafico dei residui contro i valori attesi</a></li>
<li class="chapter" data-level="8.3.3" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#qq-plot"><i class="fa fa-check"></i><b>8.3.3</b> QQ-plot</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#test-dipotesi"><i class="fa fa-check"></i><b>8.4</b> Test d’ipotesi</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#test-di-levene-per-lomogeneità-delle-varianze"><i class="fa fa-check"></i><b>8.4.1</b> Test di Levene per l’omogeneità delle varianze</a></li>
<li class="chapter" data-level="8.4.2" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#test-di-shapiro-wilk-per-la-normalità"><i class="fa fa-check"></i><b>8.4.2</b> Test di Shapiro-Wilk per la normalità</a></li>
<li class="chapter" data-level="8.4.3" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#altri-test"><i class="fa fa-check"></i><b>8.4.3</b> Altri test</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#esempio-8.1-analisi-dei-residui-per-il-dataset-mixture"><i class="fa fa-check"></i><b>8.5</b> Esempio 8.1: Analisi dei residui per il dataset “mixture”</a></li>
<li class="chapter" data-level="8.6" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#esempio-8.2-analisi-dei-residui-per-il-dataset-insects"><i class="fa fa-check"></i><b>8.6</b> Esempio 8.2: Analisi dei residui per il dataset ‘insects’</a></li>
<li class="chapter" data-level="8.7" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#misure-correttive"><i class="fa fa-check"></i><b>8.7</b> Misure correttive</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#correzionerimozione-degli-outliers"><i class="fa fa-check"></i><b>8.7.1</b> Correzione/Rimozione degli outliers</a></li>
<li class="chapter" data-level="8.7.2" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#correzione-del-modello"><i class="fa fa-check"></i><b>8.7.2</b> Correzione del modello</a></li>
<li class="chapter" data-level="8.7.3" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#trasformazione-del-predittore"><i class="fa fa-check"></i><b>8.7.3</b> Trasformazione del predittore</a></li>
<li class="chapter" data-level="8.7.4" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#trasformazione-della-risposta"><i class="fa fa-check"></i><b>8.7.4</b> Trasformazione della risposta</a></li>
<li class="chapter" data-level="8.7.5" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#esempio-8.1-segue"><i class="fa fa-check"></i><b>8.7.5</b> Esempio 8.1 (segue)</a></li>
<li class="chapter" data-level="8.7.6" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#esempio-8.2-segue"><i class="fa fa-check"></i><b>8.7.6</b> Esempio 8.2 (segue)</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#risultati-contraddittori"><i class="fa fa-check"></i><b>8.8</b> Risultati contraddittori</a></li>
<li class="chapter" data-level="8.9" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#altri-approcci-avanzati"><i class="fa fa-check"></i><b>8.9</b> Altri approcci ‘avanzati’</a></li>
<li class="chapter" data-level="8.10" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#altre-letture-7"><i class="fa fa-check"></i><b>8.10</b> Altre letture</a></li>
<li class="chapter" data-level="8.11" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#esercizi-1"><i class="fa fa-check"></i><b>8.11</b> Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html"><i class="fa fa-check"></i><b>9</b> Combinazioni lineari/nonlineari dei parametri</a>
<ul>
<li class="chapter" data-level="9.1" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.1-determinare-leffetto-medio-degli-erbicidi"><i class="fa fa-check"></i><b>9.1</b> Esempio 9.1: Determinare l’effetto medio degli erbicidi</a></li>
<li class="chapter" data-level="9.2" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.2-determinare-lefficiacia-erbicida-media"><i class="fa fa-check"></i><b>9.2</b> Esempio 9.2: Determinare l’efficiacia erbicida media</a></li>
<li class="chapter" data-level="9.3" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#combinazioni-di-interesse-generale"><i class="fa fa-check"></i><b>9.3</b> Combinazioni di interesse generale</a></li>
<li class="chapter" data-level="9.4" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#example-9.4-contrasti-ortogonali-e-non"><i class="fa fa-check"></i><b>9.4</b> Example 9.4: Contrasti ortogonali (e non)</a></li>
<li class="chapter" data-level="9.5" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.5-i-confronti-multipli-a-coppie"><i class="fa fa-check"></i><b>9.5</b> Esempio 9.5: I confronti multipli a coppie</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#display-a-lettere"><i class="fa fa-check"></i><b>9.5.1</b> Display a lettere</a></li>
<li class="chapter" data-level="9.5.2" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#correzione-per-la-molteplicità"><i class="fa fa-check"></i><b>9.5.2</b> Correzione per la molteplicità</a></li>
<li class="chapter" data-level="9.5.3" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#procedure-classiche-di-confronto-multiplo"><i class="fa fa-check"></i><b>9.5.3</b> Procedure ‘classiche’ di confronto multiplo</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.6-confronti-multipli-con-dati-trasformati"><i class="fa fa-check"></i><b>9.6</b> Esempio 9.6: confronti multipli con dati trasformati</a></li>
<li class="chapter" data-level="9.7" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.7-previsioni-e-previsioni-inverse"><i class="fa fa-check"></i><b>9.7</b> Esempio 9.7: Previsioni e previsioni inverse</a></li>
<li class="chapter" data-level="9.8" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#altre-letture-8"><i class="fa fa-check"></i><b>9.8</b> Altre letture</a></li>
<li class="chapter" data-level="9.9" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esercizi-2"><i class="fa fa-check"></i><b>9.9</b> Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html"><i class="fa fa-check"></i><b>10</b> Ricomponiamo il ‘puzzle’</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esempio-10.1-confronto-tra-erbicidi-in-un-esperimento-a-blocchi-randomizzati"><i class="fa fa-check"></i><b>10.1</b> Esempio 10.1: Confronto tra erbicidi in un esperimento a blocchi randomizzati</a></li>
<li class="chapter" data-level="10.2" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esempio-10.2-confronto-tra-co-adiuvanti-in-un-esperimento-a-quadrato-latino"><i class="fa fa-check"></i><b>10.2</b> Esempio 10.2: confronto tra co-adiuvanti in un esperimento a quadrato latino</a></li>
<li class="chapter" data-level="10.3" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esempio-10.3-interazione-tra-genotipo-e-concimazione-azotata"><i class="fa fa-check"></i><b>10.3</b> Esempio 10.3: interazione tra genotipo e concimazione azotata</a></li>
<li class="chapter" data-level="10.4" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esempio-10.4-confronto-tra-incroci-in-un-disegno-fattoriale-gerarchico"><i class="fa fa-check"></i><b>10.4</b> Esempio 10.4: confronto tra incroci in un disegno fattoriale gerarchico</a></li>
<li class="chapter" data-level="10.5" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esempio-10.5-un-esperimento-di-germinazione-ripetuto-due-volte"><i class="fa fa-check"></i><b>10.5</b> Esempio 10.5: un esperimento di germinazione ripetuto due volte</a></li>
<li class="chapter" data-level="10.6" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#altre-letture-9"><i class="fa fa-check"></i><b>10.6</b> Altre letture</a></li>
<li class="chapter" data-level="10.7" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esercizi-3"><i class="fa fa-check"></i><b>10.7</b> Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="modelli-di-regressione-avanzati.html"><a href="modelli-di-regressione-avanzati.html"><i class="fa fa-check"></i><b>11</b> Modelli di regressione ‘avanzati’</a></li>
<li class="chapter" data-level="12" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html"><i class="fa fa-check"></i><b>12</b> Breve introduzione ai modelli misti</a>
<ul>
<li class="chapter" data-level="12.1" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.1-un-esperimento-di-lavorazione-a-split-plot"><i class="fa fa-check"></i><b>12.1</b> Esempio 12.1: un esperimento di lavorazione a split-plot</a></li>
<li class="chapter" data-level="12.2" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.2-un-esperimento-di-recropping-a-strip-plot"><i class="fa fa-check"></i><b>12.2</b> Esempio 12.2: un esperimento di ‘recropping’ a strip-plot</a></li>
<li class="chapter" data-level="12.3" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.3-confronto-varietale-con-blocchi-random"><i class="fa fa-check"></i><b>12.3</b> Esempio 12.3: confronto varietale con blocchi ‘random’</a></li>
<li class="chapter" data-level="12.4" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.4-blocchi-randomizzati-con-sub-campionamento"><i class="fa fa-check"></i><b>12.4</b> Esempio 12.4: blocchi randomizzati con sub-campionamento</a></li>
<li class="chapter" data-level="12.5" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.5-confronto-varietale-ripetuto-in-più-anni"><i class="fa fa-check"></i><b>12.5</b> Esempio 12.5: confronto varietale ripetuto in più anni</a></li>
<li class="chapter" data-level="12.6" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.6-misure-ripetute-nelle-colture-poliennali"><i class="fa fa-check"></i><b>12.6</b> Esempio 12.6: misure ripetute nelle colture poliennali</a></li>
<li class="chapter" data-level="12.7" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#fattori-di-raggruppamento-nei-modelli-di-regressione"><i class="fa fa-check"></i><b>12.7</b> Fattori di raggruppamento nei modelli di regressione</a></li>
<li class="chapter" data-level="12.8" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#altre-letture-10"><i class="fa fa-check"></i><b>12.8</b> Altre letture</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html"><i class="fa fa-check"></i><b>13</b> Appendice A: Breve introduzione ad R</a>
<ul>
<li class="chapter" data-level="" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#cosa-è-r"><i class="fa fa-check"></i>Cosa è R?</a></li>
<li class="chapter" data-level="" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#installazione-di-r"><i class="fa fa-check"></i>Installazione di R</a></li>
<li class="chapter" data-level="13.1" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#prima-di-iniziare"><i class="fa fa-check"></i><b>13.1</b> Prima di iniziare</a></li>
<li class="chapter" data-level="13.2" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#oggetti-e-assegnazioni"><i class="fa fa-check"></i><b>13.2</b> Oggetti e assegnazioni</a></li>
<li class="chapter" data-level="13.3" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#tipi-di-oggetti"><i class="fa fa-check"></i><b>13.3</b> Tipi di oggetti</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#costanti-e-vettori"><i class="fa fa-check"></i><b>13.3.1</b> Costanti e vettori</a></li>
<li class="chapter" data-level="13.3.2" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#matrici"><i class="fa fa-check"></i><b>13.3.2</b> Matrici</a></li>
<li class="chapter" data-level="13.3.3" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#dataframe"><i class="fa fa-check"></i><b>13.3.3</b> Dataframe</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#lavorare-con-gli-oggetti"><i class="fa fa-check"></i><b>13.4</b> Lavorare con gli oggetti</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#visualizzazione"><i class="fa fa-check"></i><b>13.4.1</b> Visualizzazione</a></li>
<li class="chapter" data-level="13.4.2" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#indicizzazione"><i class="fa fa-check"></i><b>13.4.2</b> Indicizzazione</a></li>
<li class="chapter" data-level="13.4.3" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#estrazione-di-slots"><i class="fa fa-check"></i><b>13.4.3</b> Estrazione di <em>slots</em></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#espressioni-funzioni-e-argomenti"><i class="fa fa-check"></i><b>13.5</b> Espressioni, funzioni e argomenti</a></li>
<li class="chapter" data-level="13.6" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#funzioni-di-uso-comune"><i class="fa fa-check"></i><b>13.6</b> Funzioni di uso comune</a></li>
<li class="chapter" data-level="13.7" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#creazione-di-funzioni-personalizzate"><i class="fa fa-check"></i><b>13.7</b> Creazione di funzioni personalizzate</a></li>
<li class="chapter" data-level="13.8" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#uso-di-librerie-aggiuntive"><i class="fa fa-check"></i><b>13.8</b> Uso di librerie aggiuntive</a></li>
<li class="chapter" data-level="13.9" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#workspace"><i class="fa fa-check"></i><b>13.9</b> Workspace</a></li>
<li class="chapter" data-level="13.10" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#importare-dati-esterni"><i class="fa fa-check"></i><b>13.10</b> Importare dati esterni</a></li>
<li class="chapter" data-level="13.11" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#cenni-sulle-funzionalità-grafiche-in-r"><i class="fa fa-check"></i><b>13.11</b> Cenni sulle funzionalità grafiche in R</a></li>
<li class="chapter" data-level="13.12" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#altre-letture-11"><i class="fa fa-check"></i><b>13.12</b> Altre letture</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><i class="fa fa-check"></i><b>14</b> Appendice B: Statistica descrittiva per le variabili nominali</a>
<ul>
<li class="chapter" data-level="14.1" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#distribuzioni-di-frequenze-e-classamento"><i class="fa fa-check"></i><b>14.1</b> Distribuzioni di frequenze e classamento</a></li>
<li class="chapter" data-level="14.2" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#statistiche-descrittive-per-le-distribuzioni-di-frequenze"><i class="fa fa-check"></i><b>14.2</b> Statistiche descrittive per le distribuzioni di frequenze</a></li>
<li class="chapter" data-level="14.3" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#rappresentazione-grafica-delle-distribuzioni-di-frequenza"><i class="fa fa-check"></i><b>14.3</b> Rappresentazione grafica delle distribuzioni di frequenza</a></li>
<li class="chapter" data-level="14.4" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#distribuzioni-di-frequenza-bivariate-le-tabelle-di-contingenze"><i class="fa fa-check"></i><b>14.4</b> Distribuzioni di frequenza bivariate: le tabelle di contingenze</a></li>
<li class="chapter" data-level="14.5" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#connessione"><i class="fa fa-check"></i><b>14.5</b> Connessione</a></li>
<li class="chapter" data-level="14.6" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#il-chi-quadro-con-r"><i class="fa fa-check"></i><b>14.6</b> Il chi quadro con R</a></li>
<li class="chapter" data-level="14.7" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#altre-letture-12"><i class="fa fa-check"></i><b>14.7</b> Altre letture</a></li>
<li class="chapter" data-level="14.8" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#esercizi-4"><i class="fa fa-check"></i><b>14.8</b> Esercizi</a></li>
<li class="chapter" data-level="14.9" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#soluzioni-1"><i class="fa fa-check"></i><b>14.9</b> Soluzioni</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="appendice-c-intervalli-di-confidenza-per-una-proporzione.html"><a href="appendice-c-intervalli-di-confidenza-per-una-proporzione.html"><i class="fa fa-check"></i><b>15</b> Appendice C: Intervalli di confidenza per una proporzione</a>
<ul>
<li class="chapter" data-level="15.1" data-path="appendice-c-intervalli-di-confidenza-per-una-proporzione.html"><a href="appendice-c-intervalli-di-confidenza-per-una-proporzione.html#popolazioni-gaussiane-e-non"><i class="fa fa-check"></i><b>15.1</b> Popolazioni gaussiane e non</a></li>
<li class="chapter" data-level="15.2" data-path="appendice-c-intervalli-di-confidenza-per-una-proporzione.html"><a href="appendice-c-intervalli-di-confidenza-per-una-proporzione.html#cosa-fare-se-il-teorema-centrale-del-limite-non-funziona"><i class="fa fa-check"></i><b>15.2</b> Cosa fare se il teorema centrale del limite non funziona?</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="appendice-e-confronto-di-due-proporzioni.html"><a href="appendice-e-confronto-di-due-proporzioni.html"><i class="fa fa-check"></i><b>16</b> Appendice E: Confronto di due proporzioni</a>
<ul>
<li class="chapter" data-level="16.1" data-path="appendice-e-confronto-di-due-proporzioni.html"><a href="appendice-e-confronto-di-due-proporzioni.html#il-test-di-chi-quadro"><i class="fa fa-check"></i><b>16.1</b> Il test di ‘chi quadro’</a></li>
<li class="chapter" data-level="16.2" data-path="appendice-e-confronto-di-due-proporzioni.html"><a href="appendice-e-confronto-di-due-proporzioni.html#confronto-tra-due-proporzioni-con-simulazione-di-monte-carlo"><i class="fa fa-check"></i><b>16.2</b> Confronto tra due proporzioni con simulazione di Monte Carlo</a></li>
<li class="chapter" data-level="16.3" data-path="appendice-e-confronto-di-due-proporzioni.html"><a href="appendice-e-confronto-di-due-proporzioni.html#esercizi-5"><i class="fa fa-check"></i><b>16.3</b> Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="appendice-f-alcuni-problemi-collegati-con-le-deviazioni-rispetti-agli-assunti-di-base.html"><a href="appendice-f-alcuni-problemi-collegati-con-le-deviazioni-rispetti-agli-assunti-di-base.html"><i class="fa fa-check"></i><b>17</b> Appendice F: Alcuni problemi collegati con le deviazioni rispetti agli assunti di base</a></li>
<li class="divider"></li>
<li><strong><a href="https://www.statforbiology.com">Back to blog</a></strong></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Metodologia sperimentale per le scienze agrarie</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="breve-introduzione-ai-modelli-misti" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Capitolo 12</span> Breve introduzione ai modelli misti<a href="breve-introduzione-ai-modelli-misti.html#breve-introduzione-ai-modelli-misti" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In questo libro abbiamo affrontato le questioni più rilevanti in relazione all’attività di ricerca e sperimentazione, almeno quelle che dovrebbero far parte del bagaglio culturale di ogni laureato in agraria o altre discipline biologiche. La trattazione non è affatto esaustiva e quindi, se si avesse l’intenzioni intraprendere una carriera professionale nel mondo dell’analisi dei dati, non si potrebbe prescindere dalla lettura di altri testi di approfondimento, che sono stati via via segnalati. Ci sembra comunque opportuno, in questo capitolo e quello successivo, dare almeno alcune informazioni di base su altri modelli un po’ più complessi, il cui impiego è abbastanza comune nella sperimentazione di pieno campo.</p>
<p>In particolare, in questo libro abbiamo finora considerato i cosidetti <strong>modelli fissi</strong>, cioè contenenti solo <em>fattori fissi</em> oltre al residuo stocastico. I fattori fissi, identificabili per le seguenti caratteristiche:</p>
<ol style="list-style-type: decimal">
<li>i livelli sono selezionati appositamente (non campionati);</li>
<li>i livelli sono ripetibili (potremmo effettuare un nuovo esperimento con gli stessi livelli);</li>
<li>gli effetti attesi sono deterministici ed espressi come differenze (aumenti o diminuzioni) rispetto ad un valore di base.</li>
</ol>
<p>Esempi di fattore fisso sono il genotipo, le ferrtilizzazioni, le epoche di semina, ecc.</p>
<p>Oltre ai fattori fissi, i modelli in agricoltura e biologia possono richiedere l’inclusione di <strong>fattori random</strong> che presentano le seguenti caratteristiche:</p>
<ol style="list-style-type: decimal">
<li>i livelli non sono interessanti di per sé, ma sono campionati da una popolazione più ampia di possibili livelli;</li>
<li>i livelli non sono ripetibili, nel senso che se l’esperimento venisse ripetuto, è molto probabile che sarebbero scelti altri livelli, senza che l’esperimento perda il suo significato biologico;</li>
<li>gli effetti attesi sono casuali e cambiano ad ogni campionamento;</li>
<li>i livelli rappresentano unità di randomizzazione a cui vengono assegnati i livelli del trattamento, attraverso un processo di randomizzazione (ad esempio, le parcelle).</li>
</ol>
<p>Come conseguenza di quanto detto sopra, l’interesse primario per i fattori casuali non è stimare gli effetti di ciascun livello incluso nell’esperimento, ma stimare la quantità complessiva di varianza (componente di varianza) che inducono nella risposta sperimentale.</p>
<p>Ad esempio, nel caso dell’elemento casuale <span class="math inline">\(\varepsilon\)</span> che abbiamo trovato in tutti i modelli fin qui trattati, non vi è alcun interesse nel valore esatto di ciascun residuo, poiché questi valori si verificano casualmente e, ripetendo l’esperimento, si otterrebbero valori diversi. Invece, i residui sono stati determinati solo per poterne calcolare la relativa varianza, che è l’unico elemento di nostro interesse, da utilizzare per diversi scopi, come, ad esempio, al denominatore del test F. Oltre ai residui, per comprendere meglio cosa è un fattore random, possiamo considerare un esperimento di confronto tra genotipi, che viene ripetuto in diversi campi scelti a caso all’interno di un certo macroambiente. In questo caso, i ‘campi’ non sono, di per se’, interessanti, ma vengono campionati per quantificare la variabilità della resa all’interno dell’intero macroambiente.</p>
<p>Il fattore ‘campo’ nell’esempio precedente costituisce un tipico esempio di <strong>grouping factor</strong> (fattore di raggruppamento; vedi Capitolo 2); altri esempi includono i blocchi nei disegni a blocchi completi randomizzati, le righe e le colonne nei disegni a quadrato latino e le main-plots nei disegni a split-plot. Tutti questi fattori di raggruppamento creano spesso problemi perché raramente sono interessanti di per sé e quindi vengono spesso trascurati in fase di analisi dei dati. Si tratta di un grave errore, poichè l’effetto di questi fattori di raggruppamento, se trascurato, finisce per essere incluso nei residui, che risulteranno quindi non indipendenti, ma saranno invece accomunati dalla eventuale cappartenenza allo stesso gruppo e dalla conseguente condisione dello stesso effetto di gruppo.</p>
<p>Ad esempio, in un disegno a split-plot, se una <em>main-plot</em> è più fertile di un’altra, tutte le misurazioni effettuate su di essa condivideranno lo stesso effetto positivo e saranno quindi più simili tra di loro che non le misurazioni effettuate su <em>main-plots</em> diverse. Insomma, con uno schema a split-plot, i dati ottenuti sulla stessa <em>main-plot</em> non sono indipendenti, ma sono in qualche modo ‘apparentati’; più propriamente, si parla di <strong>correlazione intra-classe</strong>, un concetto simile, ma non totalmente coincidente con quello di correlazione di Pearson. Insomma, se l’effetto prodotto dalle <em>main-plots</em> o dagli altri <em>grouping factors</em> non viene incluso nel modello statistico descrittivo, esso rimane tra gli effetti non spiegati e, di conseguenza, viene incluso nei residui, che, pertanto, saranno correlati e quindi non indipendenti tra di loro.</p>
<p>Posto che i <em>grouping factors</em> debbano essere inclusi nel modello, la domanda è: dobbiamo considerare questi fattori come fissi o random? Nella maggior parte dei casi, la decisione spetta al ricercatore, che dovrebbe fornire motivazioni convincenti a sostegno della sua scelta; in altri casi, come accennato in precedenza per il fattore ‘campo’, un fattore di raggruppamento deve obbnligatoriamente essere random, ovvero quando i suoi livelli diventano unità di randomizzazione e ricevono l’allocazione dei livelli di un fattore o di una combinazione di fattori, tramite un processo di randomizzazione (Piepho et al., 2003). Si considerino i seguenti esempi:</p>
<ol style="list-style-type: decimal">
<li>in un disegno a blocchi randomizzati, i blocchi raggruppano le unità in base al loro posizionamento rispetto al ‘gradiente’ di fertilità; tuttavia, non sono unità di randomizzazione nel senso che i livelli di trattamento sono allocati alle parcelle all’interno di ciascun blocco, non ai blocchi stessi. Di conseguenza, il fattore blocco può essere considerato random o fisso, a seconda delle circostanze;</li>
<li>in un disegno a split-plot, le main-plots raggruppano le sub-plots e sono anche unità di randomizzazione perché ricevono l’llocazione dei livelli del fattore principale. Di conseguenza, il fattore main-plot deve essere necessariamente random.</li>
</ol>
<p>Il motivo per cui le main-plots e le altre unità di randomizzazione devono essere considerate fattori random è legato al loro ruolo nell’esperimento: secondo Ronald Fisher, la differenza tra le unità sperimentali trattate allo stesso modo è la misura più appropriata dell’errore sperimentale e, di conseguenza, la differenza tra, ad esempio, le main-plots trattate allo stesso modo diviene una misura dell’errore sperimentale, il che significa che l’effetto delle main-plots è, in effetti, random.</p>
<p>Considerando le premesse precedenti, ne consegue che diversi esperimenti comuni in agricoltura, come i disegni split-plot, strip-plot, misure ripetute e sottocampionamento, contengono fattori di raggruppamento e potrebbero richiedere l’inclusione di effetti random nel modello, oltre al residuo. I modelli che contengono più di un effetto random oltre agli eventuali effetti fissi sono chiamati <strong>modelli misti</strong> e, a partire dagli anni ’80, sono diventati una classe di modelli molto diffusa.</p>
<p>Fornire dettagli sui modelli misti va ben oltre lo scopo di questo libro e i lettori interessati sono invitati a consultare il libro di (Galecki e Burzicoski, 2013). Per tutti gli altri lettori, i seguenti esempi concreti dimostrano come i modelli misti possano essere applicati per analizzare i dati provenienti da esperimenti split-plot, strip-plot e altri tipi comuni nella ricerca agricola.</p>
<div id="esempio-12.1-un-esperimento-di-lavorazione-a-split-plot" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Esempio 12.1: un esperimento di lavorazione a split-plot<a href="breve-introduzione-ai-modelli-misti.html#esempio-12.1-un-esperimento-di-lavorazione-a-split-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consideriamo nuovamente l’esempio presentato nel capitolo 2, nel quale avevamo due fattori sperimentali a confronto: il diserbo, con due livelli (totale o localizzato sulla fila) e la lavorazione, con tre livelli (aratura profonda, aratura superficiale e <em>minimum tillage</em>). Questo esperimento è stato disegnato a split-plot, come indicato in Figura 2.9, ovvero con le lavorazioni allocate a random alle main-plots e il diserbo allocato a caso alle sub-plot, all’interno di ogni main-plot. I risultati di questo esperimento sono disponibili nel dataset ‘beet’, all’interno del <em>package</em> <code>statforbiology</code>.</p>
<p>Il modello ANOVA per un disegno a split-plot è simile a quello dell’ANOVA fattoriale, fatta salva la presenza di un effetto aggiuntivo, cioè quello delle parcelle principali, che costituiscono un elemento di raggruppamento delle osservazioni:</p>
<p><span class="math display">\[Y_{ijk} = \mu + \gamma_k + \alpha_i + \theta_{ik} + \beta_j + \alpha\beta_{ij} + \varepsilon_{ijk}\]</span></p>
<p>dove <span class="math inline">\(\gamma\)</span> è l’effetto del blocco <span class="math inline">\(k\)</span>, <span class="math inline">\(\alpha\)</span> è l’effetto della lavorazione <span class="math inline">\(i\)</span>, <span class="math inline">\(\beta\)</span> è l’effetto del diserbo <span class="math inline">\(j\)</span>, <span class="math inline">\(\alpha\beta\)</span> è l’effetto dell’interazione per la specifica combinazione della lavorazione <span class="math inline">\(i\)</span> e del diserbo <span class="math inline">\(j\)</span>. Abbiamo incluso anche <span class="math inline">\(\theta\)</span> che è l’effetto della main-plot; dato che ogni parcella principale è identificata univocamente dal blocco <span class="math inline">\(k\)</span> a cui appartiene e dalla lavorazione <span class="math inline">\(i\)</span> in essa eseguita, abbiamo utilizzato i pedici corrispondenti.</p>
<p>Nel precedente modello vi sono due fattori di raggruppamento, cioè il blocco e la main-plot. Mentre il blocco non costituisce un’unità di randomizzazione e quindi il suo effetto potrebbe essere considerato o fisso o casuale (ma lo considereremo fisso, come abbiamo sempre fatto finora), le main-plots costituiscono delle unità di randomizzazione e quindi gli effetti che producono debbono essere considerati random, con distribuzione normale, media pari a 0 e deviazione standard pari a <span class="math inline">\(\sigma_{\theta}\)</span>. Allo stesso modo, il residuo <span class="math inline">\(\varepsilon\)</span> è casuale, con distribuzione normale, media 0 a deviazione standard pari a <span class="math inline">\(\sigma\)</span>.</p>
<p>Stimare un modello misto in R non è molto diverso dallo stimare un modello a effetti fissi. Innanzitutto, dobbiamo creare una nuova variabile per identificare in modo univoco le main-plots, il che può essere fatto creando un nuovo fattore che combini i livelli di blocco e lavorazione, come accennato in precedenza. Successivamente, è necessario abbandonare la funzione <code>lm()</code>, che non permette di inserire effetti random, ed utilizzare un’altra funzione che abbia questa capacità. Tra quelle disponibili, in questo libro proporremo la funzione <code>lmer()</code>, che si trova all’interno del <em>package</em> <code>lme4</code> (Bates et al. 2015), da utilizzare assieme al package <code>lmerTest</code> (Kuznetsova et al. 2017), che fornisce alcune utili funzionalità aggiuntive ed, in particolare, consente di migliorare la leggibilità della tabella ANOVA.
<code>La sintassi della funzione</code>lmer()<code>è simile a quella della funzione</code>lm()<code>; l'effetto random deve essere inserito utilizzando l'operatore</code>1|<code>e posto tra parentesi, per distinguerlo meglio dagli effetti fissi (riquadro sottostante). In questo capitolo, introduciamo anche  l'uso dell'operatore "pipe" (</code>|&gt;`), che serve a scrivere codice più chiaro e riceve il valore restituito dalla funzione precedente, passandolo alla successiva come primo argomento (riquadro sottostante; vedi anche l’Appendice A).</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="breve-introduzione-ai-modelli-misti.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 12.1</span></span>
<span id="cb122-2"><a href="breve-introduzione-ai-modelli-misti.html#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A split-plot tillage experiment</span></span>
<span id="cb122-3"><a href="breve-introduzione-ai-modelli-misti.html#cb122-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4"><a href="breve-introduzione-ai-modelli-misti.html#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the packages</span></span>
<span id="cb122-5"><a href="breve-introduzione-ai-modelli-misti.html#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statforbiology)</span>
<span id="cb122-6"><a href="breve-introduzione-ai-modelli-misti.html#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb122-7"><a href="breve-introduzione-ai-modelli-misti.html#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb122-8"><a href="breve-introduzione-ai-modelli-misti.html#cb122-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-9"><a href="breve-introduzione-ai-modelli-misti.html#cb122-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading and transforming the data</span></span>
<span id="cb122-10"><a href="breve-introduzione-ai-modelli-misti.html#cb122-10" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">getAgroData</span>(<span class="st">&quot;beet&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb122-11"><a href="breve-introduzione-ai-modelli-misti.html#cb122-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(<span class="at">Tillage =</span> <span class="fu">factor</span>(Tillage),</span>
<span id="cb122-12"><a href="breve-introduzione-ai-modelli-misti.html#cb122-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">WeedControl =</span> <span class="fu">factor</span>(WeedControl),</span>
<span id="cb122-13"><a href="breve-introduzione-ai-modelli-misti.html#cb122-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">Block =</span> <span class="fu">factor</span>(Block),</span>
<span id="cb122-14"><a href="breve-introduzione-ai-modelli-misti.html#cb122-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">mainPlot =</span> <span class="fu">factor</span>(Block)<span class="sc">:</span><span class="fu">factor</span>(Tillage))</span>
<span id="cb122-15"><a href="breve-introduzione-ai-modelli-misti.html#cb122-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-16"><a href="breve-introduzione-ai-modelli-misti.html#cb122-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Mixed-Model fitting</span></span>
<span id="cb122-17"><a href="breve-introduzione-ai-modelli-misti.html#cb122-17" aria-hidden="true" tabindex="-1"></a>mod.split <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Yield <span class="sc">~</span> Block <span class="sc">+</span> Tillage <span class="sc">*</span> WeedControl <span class="sc">+</span></span>
<span id="cb122-18"><a href="breve-introduzione-ai-modelli-misti.html#cb122-18" aria-hidden="true" tabindex="-1"></a>                  (<span class="dv">1</span><span class="sc">|</span>mainPlot), <span class="at">data=</span>dataset)</span>
<span id="cb122-19"><a href="breve-introduzione-ai-modelli-misti.html#cb122-19" aria-hidden="true" tabindex="-1"></a><span class="do">## boundary (singular) fit: see help(&#39;isSingular&#39;)</span></span></code></pre></div>
<p>Per quanto riguarda le assunzioni di base, i modelli misti sono sempre e comunque modelli linear e quindi fanno le stesse assunzioni di moscedasticità e normalità dei residui. L’ispezione grafica di questi ultimi può essere condotta nel modo usuale, se non che la funzione <code>plot()</code> restituisce solo il grafico dei residui verso i valori attesi (quello corrispondente all’argomento ‘which = 1’ in <code>lm()</code>), mentre l’argomento ‘which’ non funziona. Pertanto, il QQ-plot dovrebbe essere prodotto utilizzando le funzioni generiche <code>qqnorm()</code> e <code>qqline()</code>, come mostrato nel riquadro sottostante. Questi due grafici presentano alcune lievi deviazioni rispetto agli assunti di normalità ed omoschedasticità (Fig. <a href="breve-introduzione-ai-modelli-misti.html#fig:figName133one">12.1</a>), ma il test di Shapiro-Wilk non sembra sollevare particolari preoccupazioni, per cui possiamo procedere con le operazioni di inferenza statistica.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="breve-introduzione-ai-modelli-misti.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 12.1 [continuation]</span></span>
<span id="cb123-2"><a href="breve-introduzione-ai-modelli-misti.html#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="breve-introduzione-ai-modelli-misti.html#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for the basic assumptions for the &#39;beet&#39; data</span></span>
<span id="cb123-4"><a href="breve-introduzione-ai-modelli-misti.html#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="breve-introduzione-ai-modelli-misti.html#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphical analyses (not run)</span></span>
<span id="cb123-6"><a href="breve-introduzione-ai-modelli-misti.html#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mod.split) # Analogous to &#39;which = 1&#39; for linear models</span></span>
<span id="cb123-7"><a href="breve-introduzione-ai-modelli-misti.html#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="co"># qqnorm(resid(mod.split)) # QQ-plot</span></span>
<span id="cb123-8"><a href="breve-introduzione-ai-modelli-misti.html#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="co"># qqline(resid(mod.split), lty = 2)</span></span>
<span id="cb123-9"><a href="breve-introduzione-ai-modelli-misti.html#cb123-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-10"><a href="breve-introduzione-ai-modelli-misti.html#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro-Wilk&#39;s test</span></span>
<span id="cb123-11"><a href="breve-introduzione-ai-modelli-misti.html#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.split))</span>
<span id="cb123-12"><a href="breve-introduzione-ai-modelli-misti.html#cb123-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb123-13"><a href="breve-introduzione-ai-modelli-misti.html#cb123-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  Shapiro-Wilk normality test</span></span>
<span id="cb123-14"><a href="breve-introduzione-ai-modelli-misti.html#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb123-15"><a href="breve-introduzione-ai-modelli-misti.html#cb123-15" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  residuals(mod.split)</span></span>
<span id="cb123-16"><a href="breve-introduzione-ai-modelli-misti.html#cb123-16" aria-hidden="true" tabindex="-1"></a><span class="do">## W = 0.93838, p-value = 0.1501</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figName133one"></span>
<img src="_main_files/figure-html/figName133one-1.png" alt="Analisi grafiche dei residui per l'esperimento a split-plot relativo all'esempio 12.1, ove il model fitting è stato eseguito con la funzione `lmer()`" width="90%" />
<p class="caption">
Figura 12.1: Analisi grafiche dei residui per l’esperimento a split-plot relativo all’esempio 12.1, ove il model fitting è stato eseguito con la funzione <code>lmer()</code>
</p>
</div>
<p>L’oggetto che risulta dalla stima del modello misto può essere esplorato con i metodi usuali, anche se è necessario ricordare che le stime dei parametri debbono essere ottenuto con la funzione <code>fixef()</code> al posto di <code>coef()</code>. L’ANOVA viene sempre prodotta con l’usuale funzione <code>anova()</code>, che fornisce però un output leggermente diverso dal solito. Come secondo argomento è necessario indicare il metodo prescelto per la stima dei gradi di libertà, che non è così semplice come nel caso dei modelli lineari generali. Consigliamo il metodo ‘Kenward-Roger’ che, pur fornendo comunque un’approssimazione, ha dimostrato ottima affidabilità, superiore a quella del metodo ‘Sattertwhaite’, che verrebbe utilizzato di default (Kuznetsova et al. 2017).</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="breve-introduzione-ai-modelli-misti.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 12.1 [continuation]</span></span>
<span id="cb124-2"><a href="breve-introduzione-ai-modelli-misti.html#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="breve-introduzione-ai-modelli-misti.html#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance partitioning for the ’beet’ data</span></span>
<span id="cb124-4"><a href="breve-introduzione-ai-modelli-misti.html#cb124-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-5"><a href="breve-introduzione-ai-modelli-misti.html#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod.split, <span class="at">ddf=</span><span class="st">&quot;Kenward-Roger&quot;</span>)</span>
<span id="cb124-6"><a href="breve-introduzione-ai-modelli-misti.html#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Type III Analysis of Variance Table with Kenward-Roger&#39;s method</span></span>
<span id="cb124-7"><a href="breve-introduzione-ai-modelli-misti.html#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="do">##                      Sum Sq Mean Sq NumDF DenDF F value  Pr(&gt;F)  </span></span>
<span id="cb124-8"><a href="breve-introduzione-ai-modelli-misti.html#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Block                3.6596  1.2199     3     6  0.6521 0.61016  </span></span>
<span id="cb124-9"><a href="breve-introduzione-ai-modelli-misti.html#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Tillage             23.6565 11.8282     2     6  6.3228 0.03332 *</span></span>
<span id="cb124-10"><a href="breve-introduzione-ai-modelli-misti.html#cb124-10" aria-hidden="true" tabindex="-1"></a><span class="do">## WeedControl          3.3205  3.3205     1     9  1.7750 0.21552  </span></span>
<span id="cb124-11"><a href="breve-introduzione-ai-modelli-misti.html#cb124-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Tillage:WeedControl 19.4641  9.7321     2     9  5.2023 0.03152 *</span></span>
<span id="cb124-12"><a href="breve-introduzione-ai-modelli-misti.html#cb124-12" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb124-13"><a href="breve-introduzione-ai-modelli-misti.html#cb124-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>L’interazione tra lavorazione del terreno e controllo delle erbe infestanti è significativa; pertanto, possiamo esplorare e confrontare le medie relative alle combinazioni ‘lavorazione <span class="math inline">\(\times\)</span> diserbo’, utilizzando l’usuale funzione <code>emmeans()</code>. Questa parte di lavoro viene lasciata al lettore come esercizio.</p>
</div>
<div id="esempio-12.2-un-esperimento-di-recropping-a-strip-plot" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Esempio 12.2: un esperimento di ‘recropping’ a strip-plot<a href="breve-introduzione-ai-modelli-misti.html#esempio-12.2-un-esperimento-di-recropping-a-strip-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In alcune circostanze, soprattutto nelle prove di diserbo chimico, potrebbe trovare applicazione un altro tipo di schema sperimentale, nel quale ogni blocco viene diviso in tante righe quanti sono i livelli di un fattore sperimentale e tante colonne quanti sono i livelli dell’altro. In questo modo, i livelli del primo fattore sperimentale vengono applicati ad ognuna delle righe, mentre i livelli dell’altro trattamento ad ognuna delle colonne, in ordine casuale, che cambia per ogni blocco (esperimento a <strong>strip-plot</strong>).</p>
<p>Consideriamo l’esperimento fattoriale a due vie descritto nel Capitolo 2 e finalizzato a determinare l’intervallo di risemina per un erbicida sulfonilureico. In questo esperimento, sono stati considerati due tesi di diserbo, cioè: rimsulfuron applicato alla dose raccomandata su terreno nudo e testimone non diserbato. Quaranta giorni dopo il trattamento, sono state seminate tre colture, cioè barbabietola da zucchero, colza e soia, sia sulle parcelle trattate che su quelle non trattate e, quattro settimane dopo la semina, è stato determinato il peso delle piante su un metro quadrato di ogni parcella. L’esperimento è stato disegnato a strip-plot, in quattro blocchi completi (Fig. 2.10); in ogni blocco, i trattamenti erbicidi (rimsulfuron e controllo non trattato) sono stati assegnati casualmente a ciascuna di due colonne, mentre le tre colture sono state assegnate casualmente a ciascuna di tre righe (Onofri, dati non pubblicati). Il dataset relativo ai risultati di questo esperimento è disponibile come “recropS” nel <em>package</em> <code>statforbiology</code>.</p>
<p>In questo esperimento, ci sono tre fattori di raggruppamento</p>
<ol style="list-style-type: decimal">
<li>I blocchi</li>
<li>Le righe all’interno di ciascun blocco (tre righe per blocco)</li>
<li>Le colonne all’interno di ciascun blocco (due colonne per blocco)</li>
</ol>
<p>Le righe e le colonne sono anche unità di randomizzazione, poiché hanno ricevuto i
trattamenti sperimentali attraverso un processo di randomizzazione, analogo alle main-plots nell’Esempio 12.1. Di conseguenza, entrambi gli effetti sono da considerare random.</p>
<p>Analogamente a quanto abbiamo visto per lo split-plot, le 12 righe sono univocamente definite da un livello di lavorazione e un blocco, mentre le 8 colonne sono definite da un livello di diserbo e un blocco, per cui l’effetto <span class="math inline">\(\zeta\)</span> porta i pedici <span class="math inline">\(j\)</span> e <span class="math inline">\(k\)</span>. per cui anche questo è un modello ‘misto’, con tre effetti random.</p>
<p>Iniziamo le analisi caricando il dataset e operando le necessarie trasformazioni dei dati, come abbiamo visto negli esempi precedenti.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="breve-introduzione-ai-modelli-misti.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 12.2</span></span>
<span id="cb125-2"><a href="breve-introduzione-ai-modelli-misti.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A strip-plot recropping experiment</span></span>
<span id="cb125-3"><a href="breve-introduzione-ai-modelli-misti.html#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="breve-introduzione-ai-modelli-misti.html#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading packages</span></span>
<span id="cb125-5"><a href="breve-introduzione-ai-modelli-misti.html#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statforbiology)</span>
<span id="cb125-6"><a href="breve-introduzione-ai-modelli-misti.html#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb125-7"><a href="breve-introduzione-ai-modelli-misti.html#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb125-8"><a href="breve-introduzione-ai-modelli-misti.html#cb125-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-9"><a href="breve-introduzione-ai-modelli-misti.html#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading and transforming the data</span></span>
<span id="cb125-10"><a href="breve-introduzione-ai-modelli-misti.html#cb125-10" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">getAgroData</span>(<span class="st">&quot;recropS&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb125-11"><a href="breve-introduzione-ai-modelli-misti.html#cb125-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(<span class="at">Herbicide =</span> <span class="fu">factor</span>(Herbicide),</span>
<span id="cb125-12"><a href="breve-introduzione-ai-modelli-misti.html#cb125-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">Crop =</span> <span class="fu">factor</span>(Crop),</span>
<span id="cb125-13"><a href="breve-introduzione-ai-modelli-misti.html#cb125-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">Block =</span> <span class="fu">factor</span>(Block),</span>
<span id="cb125-14"><a href="breve-introduzione-ai-modelli-misti.html#cb125-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">Rows =</span> <span class="fu">factor</span>(Crop)<span class="sc">:</span><span class="fu">factor</span>(Block),</span>
<span id="cb125-15"><a href="breve-introduzione-ai-modelli-misti.html#cb125-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">Columns =</span> <span class="fu">factor</span>(Herbicide)<span class="sc">:</span><span class="fu">factor</span>(Block))</span></code></pre></div>
<p>Un modello adatto a descrivere i risultati di questo esperimento è il seguente:</p>
<p><span class="math display">\[Y_{ijk} = \mu + \gamma_k + \alpha_i + \theta_{ik} + \beta_j + \zeta_{jk} + \alpha\beta_{ij} + \varepsilon_{ijk}\]</span></p>
<p>In questo modello, <span class="math inline">\(\mu\)</span> è l’intercetta, <span class="math inline">\(\gamma_k\)</span> sono gli effetti blocco, <span class="math inline">\(\alpha_i\)</span> sono gli effetti delle colture, <span class="math inline">\(\theta_ik\)</span> sono gli effetti ‘riga’, <span class="math inline">\(\beta_j\)</span> sono gli effetti degli erbicidi/testimone, <span class="math inline">\(\zeta_{jk}\)</span> sono gli effetti ‘colonna’, <span class="math inline">\(\alpha\beta_{ij}\)</span> sono gli effetti di interazione ‘coltura-erbicida’ e <span class="math inline">\(\varepsilon_ijk\)</span> è residuo casuale. I tre effetti random (‘riga’, ‘colonna’ e residuo) sono assunti come gaussiani, con media pari a zero e deviazioni standard rispettivamente pari a <span class="math inline">\(\sigma_{\theta}\)</span>, <span class="math inline">\(\sigma_{\zeta}\)</span> e <span class="math inline">\(\sigma\)</span>.</p>
<p>Il codice da utilizzare è analogo a quello precedentemente esposto per il disegno a split-plot e prevede l’introduzione degli effetti random ‘riga’ e ‘colonna’, che vengono inseriti tra parentesi e con l’operatore ‘1|’, come indicato nel box sottostante. L’analisi grafica dei residui può essere eseguita con la stessa tecnica illustrata per l’Esempio 12.1 e viene lasciata al lettore per esercizio.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="breve-introduzione-ai-modelli-misti.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 12.2 [continuation]</span></span>
<span id="cb126-2"><a href="breve-introduzione-ai-modelli-misti.html#cb126-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-3"><a href="breve-introduzione-ai-modelli-misti.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Model fitting</span></span>
<span id="cb126-4"><a href="breve-introduzione-ai-modelli-misti.html#cb126-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-5"><a href="breve-introduzione-ai-modelli-misti.html#cb126-5" aria-hidden="true" tabindex="-1"></a>mod.strip <span class="ot">&lt;-</span> <span class="fu">lmer</span>(CropBiomass <span class="sc">~</span> Block <span class="sc">+</span> Herbicide<span class="sc">*</span>Crop <span class="sc">+</span> </span>
<span id="cb126-6"><a href="breve-introduzione-ai-modelli-misti.html#cb126-6" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span><span class="sc">|</span>Rows) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Columns), <span class="at">data =</span> dataset)</span>
<span id="cb126-7"><a href="breve-introduzione-ai-modelli-misti.html#cb126-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-8"><a href="breve-introduzione-ai-modelli-misti.html#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance partitioning</span></span>
<span id="cb126-9"><a href="breve-introduzione-ai-modelli-misti.html#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod.strip, <span class="at">ddf =</span> <span class="st">&quot;Kenward-Roger&quot;</span>)</span>
<span id="cb126-10"><a href="breve-introduzione-ai-modelli-misti.html#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Type III Analysis of Variance Table with Kenward-Roger&#39;s method</span></span>
<span id="cb126-11"><a href="breve-introduzione-ai-modelli-misti.html#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="do">##                Sum Sq Mean Sq NumDF  DenDF F value  Pr(&gt;F)  </span></span>
<span id="cb126-12"><a href="breve-introduzione-ai-modelli-misti.html#cb126-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Block           21451  7150.3     3 4.1367  2.5076 0.19387  </span></span>
<span id="cb126-13"><a href="breve-introduzione-ai-modelli-misti.html#cb126-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Herbicide         148   147.9     1 3.0000  0.0519 0.83450  </span></span>
<span id="cb126-14"><a href="breve-introduzione-ai-modelli-misti.html#cb126-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Crop            43874 21936.9     2 6.0000  7.6932 0.02208 *</span></span>
<span id="cb126-15"><a href="breve-introduzione-ai-modelli-misti.html#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Herbicide:Crop  12549  6274.4     2 6.0000  2.2004 0.19198  </span></span>
<span id="cb126-16"><a href="breve-introduzione-ai-modelli-misti.html#cb126-16" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb126-17"><a href="breve-introduzione-ai-modelli-misti.html#cb126-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>La tabella ANOVA mostra che solo l’effetto della coltura è significativo, mentre non vi è alcuna differenza tra i trattamenti erbicidi (trattato vs. non trattato) all’interno di ciascuna coltura. Pertanto, gli effetti fitotossici possono essere considerati negligibili. Il calcolo delle medie e i confronti multipli possono essere eseguiti con la tecnica usuale, indicata nei capitoli precedenti e sono lasciati al lettore per esercizio.</p>
</div>
<div id="esempio-12.3-confronto-varietale-con-blocchi-random" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Esempio 12.3: confronto varietale con blocchi ‘random’<a href="breve-introduzione-ai-modelli-misti.html#esempio-12.3-confronto-varietale-con-blocchi-random" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Riconsideriamo l’Esempio 10.1, che descrive un esperimento di campo con otto genotipi di frumento in tre blocchi completi, eseguito sulle colline dell’Italia centrale nel 2002 (Belocchi et al. 2003). Sebbene i blocchi non rappresentino unità di randomizzazione, a volte si suggerisce di considerare il loro effetto come random, cosa che è molto conveniente per recuperare le informazioni inter-blocco, nei disegni a blocchi incompleti (Dixon 2016). In questo caso, trattandosi di un disegno a blocchi completi, considerare l’effetto del blocco come random non è conveniente, perchè non vi sono informazioni inter-blocco da recuperare. Tuttavia, ci è sembrato utile mostrare qual è il codice R da utilizzare quando si vogliono considerare i blocchi come effetti casuali.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="breve-introduzione-ai-modelli-misti.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 12.3</span></span>
<span id="cb127-2"><a href="breve-introduzione-ai-modelli-misti.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A genotype experiment with random blocks</span></span>
<span id="cb127-3"><a href="breve-introduzione-ai-modelli-misti.html#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="breve-introduzione-ai-modelli-misti.html#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the packages</span></span>
<span id="cb127-5"><a href="breve-introduzione-ai-modelli-misti.html#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statforbiology)</span>
<span id="cb127-6"><a href="breve-introduzione-ai-modelli-misti.html#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb127-7"><a href="breve-introduzione-ai-modelli-misti.html#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb127-8"><a href="breve-introduzione-ai-modelli-misti.html#cb127-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb127-9"><a href="breve-introduzione-ai-modelli-misti.html#cb127-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-10"><a href="breve-introduzione-ai-modelli-misti.html#cb127-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading and transforming the data</span></span>
<span id="cb127-11"><a href="breve-introduzione-ai-modelli-misti.html#cb127-11" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">getAgroData</span>(<span class="st">&quot;WinterWheat2002&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb127-12"><a href="breve-introduzione-ai-modelli-misti.html#cb127-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(<span class="at">Block =</span> <span class="fu">factor</span>(Block),</span>
<span id="cb127-13"><a href="breve-introduzione-ai-modelli-misti.html#cb127-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">Genotype =</span> <span class="fu">factor</span>(Genotype))</span>
<span id="cb127-14"><a href="breve-introduzione-ai-modelli-misti.html#cb127-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-15"><a href="breve-introduzione-ai-modelli-misti.html#cb127-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Model fitting (with random blocks)</span></span>
<span id="cb127-16"><a href="breve-introduzione-ai-modelli-misti.html#cb127-16" aria-hidden="true" tabindex="-1"></a>modmix <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Yield <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>Block) <span class="sc">+</span> Genotype, <span class="at">data =</span> dataset)</span>
<span id="cb127-17"><a href="breve-introduzione-ai-modelli-misti.html#cb127-17" aria-hidden="true" tabindex="-1"></a>meds <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(modmix, <span class="sc">~</span>Genotype)</span>
<span id="cb127-18"><a href="breve-introduzione-ai-modelli-misti.html#cb127-18" aria-hidden="true" tabindex="-1"></a>multcomp<span class="sc">::</span><span class="fu">cld</span>(meds, <span class="at">Letters =</span> LETTERS, <span class="at">reverse =</span> T)</span>
<span id="cb127-19"><a href="breve-introduzione-ai-modelli-misti.html#cb127-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  Genotype emmean    SE   df lower.CL upper.CL .group</span></span>
<span id="cb127-20"><a href="breve-introduzione-ai-modelli-misti.html#cb127-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  IRIDE      4.96 0.216 10.8     4.49     5.44  A    </span></span>
<span id="cb127-21"><a href="breve-introduzione-ai-modelli-misti.html#cb127-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  COLOSSEO   4.89 0.216 10.8     4.42     5.37  A    </span></span>
<span id="cb127-22"><a href="breve-introduzione-ai-modelli-misti.html#cb127-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  SOLEX      4.79 0.216 10.8     4.31     5.27  A    </span></span>
<span id="cb127-23"><a href="breve-introduzione-ai-modelli-misti.html#cb127-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  SANCARLO   4.50 0.216 10.8     4.03     4.98  A    </span></span>
<span id="cb127-24"><a href="breve-introduzione-ai-modelli-misti.html#cb127-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  GRAZIA     4.34 0.216 10.8     3.86     4.82  A    </span></span>
<span id="cb127-25"><a href="breve-introduzione-ai-modelli-misti.html#cb127-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  CRESO      4.33 0.216 10.8     3.85     4.80  A    </span></span>
<span id="cb127-26"><a href="breve-introduzione-ai-modelli-misti.html#cb127-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  DUILIO     4.24 0.216 10.8     3.76     4.72  AB   </span></span>
<span id="cb127-27"><a href="breve-introduzione-ai-modelli-misti.html#cb127-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  SIMETO     3.34 0.216 10.8     2.86     3.82   B   </span></span>
<span id="cb127-28"><a href="breve-introduzione-ai-modelli-misti.html#cb127-28" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb127-29"><a href="breve-introduzione-ai-modelli-misti.html#cb127-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Degrees-of-freedom method: kenward-roger </span></span>
<span id="cb127-30"><a href="breve-introduzione-ai-modelli-misti.html#cb127-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb127-31"><a href="breve-introduzione-ai-modelli-misti.html#cb127-31" aria-hidden="true" tabindex="-1"></a><span class="do">## P value adjustment: tukey method for comparing a family of 8 estimates </span></span>
<span id="cb127-32"><a href="breve-introduzione-ai-modelli-misti.html#cb127-32" aria-hidden="true" tabindex="-1"></a><span class="do">## significance level used: alpha = 0.05 </span></span>
<span id="cb127-33"><a href="breve-introduzione-ai-modelli-misti.html#cb127-33" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: If two or more means share the same grouping symbol,</span></span>
<span id="cb127-34"><a href="breve-introduzione-ai-modelli-misti.html#cb127-34" aria-hidden="true" tabindex="-1"></a><span class="do">##       then we cannot show them to be different.</span></span>
<span id="cb127-35"><a href="breve-introduzione-ai-modelli-misti.html#cb127-35" aria-hidden="true" tabindex="-1"></a><span class="do">##       But we also did not show them to be the same.</span></span></code></pre></div>
</div>
<div id="esempio-12.4-blocchi-randomizzati-con-sub-campionamento" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Esempio 12.4: blocchi randomizzati con sub-campionamento<a href="breve-introduzione-ai-modelli-misti.html#esempio-12.4-blocchi-randomizzati-con-sub-campionamento" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Il sub-campionamento può verificarsi ogni qual volta in cui vengano prese, in ogni parcella, due o più misure casuali, che non possono essere considerate repliche vere, poiché non hanno ricevuto il trattamento sperimentale in modo indipendente l’una dall’altra.</p>
<p>Consideriamo ad esempio i dati nel dataset ‘TKW’, disponibile nel <em>package</em> <code>statforbiology</code>. Questi dati derivano da un esperimento con 30 genotipi di frumento in tre blocchi, nel quale è stato determinato il peso di mille semi (Thousand Kernel Weight; TKW), in tre sub-campioni di granella per parcella (Ciriciofolo, dati non pubblicati).</p>
<p>Dopo aver caricato i dati, è necessario trasformare tutti i predittori in fattori nominali (‘Genotype’, ‘Block’ e ‘Plot’); è importante notare che questo dataset include anche la variabile ‘Plot’, che identifica in modo univoco tutte le parcelle e funge da variabile di raggruppamento per i tre sub-campioni di ciascuna parcella. A scopo di confronto, nel riquadro sottostante, mostriamo la stima di un modello errato, che non fa alcuna distinzione tra repliche vere e sub-repliche (pseudo-repliche) e, di conseguenza, considera l’esperimento come se avesse 9 repliche vere. La deviazione standard dei residui è 2.71, il test F per il genotipo è altamente significativo e ci sono 225 confronti a coppie significativi tra i 30 genotipi.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="breve-introduzione-ai-modelli-misti.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 12.4</span></span>
<span id="cb128-2"><a href="breve-introduzione-ai-modelli-misti.html#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A RCBD with sub-sampling</span></span>
<span id="cb128-3"><a href="breve-introduzione-ai-modelli-misti.html#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="breve-introduzione-ai-modelli-misti.html#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the packages</span></span>
<span id="cb128-5"><a href="breve-introduzione-ai-modelli-misti.html#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statforbiology)</span>
<span id="cb128-6"><a href="breve-introduzione-ai-modelli-misti.html#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb128-7"><a href="breve-introduzione-ai-modelli-misti.html#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb128-8"><a href="breve-introduzione-ai-modelli-misti.html#cb128-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb128-9"><a href="breve-introduzione-ai-modelli-misti.html#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb128-10"><a href="breve-introduzione-ai-modelli-misti.html#cb128-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb128-11"><a href="breve-introduzione-ai-modelli-misti.html#cb128-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-12"><a href="breve-introduzione-ai-modelli-misti.html#cb128-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading and transforming the data</span></span>
<span id="cb128-13"><a href="breve-introduzione-ai-modelli-misti.html#cb128-13" aria-hidden="true" tabindex="-1"></a>TKW <span class="ot">&lt;-</span> <span class="fu">getAgroData</span>(<span class="st">&quot;TKW&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb128-14"><a href="breve-introduzione-ai-modelli-misti.html#cb128-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(<span class="at">Plot =</span> <span class="fu">factor</span>(Plot),</span>
<span id="cb128-15"><a href="breve-introduzione-ai-modelli-misti.html#cb128-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">Block =</span> <span class="fu">factor</span>(Block),</span>
<span id="cb128-16"><a href="breve-introduzione-ai-modelli-misti.html#cb128-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">Genotype =</span> <span class="fu">factor</span>(Genotype))</span>
<span id="cb128-17"><a href="breve-introduzione-ai-modelli-misti.html#cb128-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(TKW)</span>
<span id="cb128-18"><a href="breve-introduzione-ai-modelli-misti.html#cb128-18" aria-hidden="true" tabindex="-1"></a><span class="do">##   Plot Block  Genotype Sample  TKW</span></span>
<span id="cb128-19"><a href="breve-introduzione-ai-modelli-misti.html#cb128-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 1    1     1 Meridiano      1 28.6</span></span>
<span id="cb128-20"><a href="breve-introduzione-ai-modelli-misti.html#cb128-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 2    2     1     Solex      1 33.3</span></span>
<span id="cb128-21"><a href="breve-introduzione-ai-modelli-misti.html#cb128-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 3    3     1  Liberdur      1 22.3</span></span>
<span id="cb128-22"><a href="breve-introduzione-ai-modelli-misti.html#cb128-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 4    4     1  Virgilio      1 28.1</span></span>
<span id="cb128-23"><a href="breve-introduzione-ai-modelli-misti.html#cb128-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 5    5     1   PR22D40      1 26.7</span></span>
<span id="cb128-24"><a href="breve-introduzione-ai-modelli-misti.html#cb128-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 6    6     1    Ciccio      1 34.2</span></span>
<span id="cb128-25"><a href="breve-introduzione-ai-modelli-misti.html#cb128-25" aria-hidden="true" tabindex="-1"></a><span class="co"># WRONG ANALYSIS!!!!</span></span>
<span id="cb128-26"><a href="breve-introduzione-ai-modelli-misti.html#cb128-26" aria-hidden="true" tabindex="-1"></a><span class="co"># no distinction is made between true replicates and sub-replicates</span></span>
<span id="cb128-27"><a href="breve-introduzione-ai-modelli-misti.html#cb128-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-28"><a href="breve-introduzione-ai-modelli-misti.html#cb128-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting a &#39;naive&#39; model</span></span>
<span id="cb128-29"><a href="breve-introduzione-ai-modelli-misti.html#cb128-29" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(TKW <span class="sc">~</span> Block <span class="sc">+</span> Genotype, <span class="at">data=</span>TKW)</span>
<span id="cb128-30"><a href="breve-introduzione-ai-modelli-misti.html#cb128-30" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod)</span>
<span id="cb128-31"><a href="breve-introduzione-ai-modelli-misti.html#cb128-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb128-32"><a href="breve-introduzione-ai-modelli-misti.html#cb128-32" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb128-33"><a href="breve-introduzione-ai-modelli-misti.html#cb128-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: TKW</span></span>
<span id="cb128-34"><a href="breve-introduzione-ai-modelli-misti.html#cb128-34" aria-hidden="true" tabindex="-1"></a><span class="do">##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb128-35"><a href="breve-introduzione-ai-modelli-misti.html#cb128-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Block       2  110.3  55.169   7.510 0.0006875 ***</span></span>
<span id="cb128-36"><a href="breve-introduzione-ai-modelli-misti.html#cb128-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype   29 7224.7 249.129  33.913 &lt; 2.2e-16 ***</span></span>
<span id="cb128-37"><a href="breve-introduzione-ai-modelli-misti.html#cb128-37" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 238 1748.4   7.346                      </span></span>
<span id="cb128-38"><a href="breve-introduzione-ai-modelli-misti.html#cb128-38" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb128-39"><a href="breve-introduzione-ai-modelli-misti.html#cb128-39" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb128-40"><a href="breve-introduzione-ai-modelli-misti.html#cb128-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual standard deviation</span></span>
<span id="cb128-41"><a href="breve-introduzione-ai-modelli-misti.html#cb128-41" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)<span class="sc">$</span>sigma</span>
<span id="cb128-42"><a href="breve-introduzione-ai-modelli-misti.html#cb128-42" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2.710373</span></span>
<span id="cb128-43"><a href="breve-introduzione-ai-modelli-misti.html#cb128-43" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2.710373</span></span>
<span id="cb128-44"><a href="breve-introduzione-ai-modelli-misti.html#cb128-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-45"><a href="breve-introduzione-ai-modelli-misti.html#cb128-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of significant pairwise comparisons between genotype means</span></span>
<span id="cb128-46"><a href="breve-introduzione-ai-modelli-misti.html#cb128-46" aria-hidden="true" tabindex="-1"></a>pairwise <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">pairs</span>(<span class="fu">emmeans</span>(mod, <span class="sc">~</span>Genotype)))</span>
<span id="cb128-47"><a href="breve-introduzione-ai-modelli-misti.html#cb128-47" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pairwise<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb128-48"><a href="breve-introduzione-ai-modelli-misti.html#cb128-48" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 225</span></span></code></pre></div>
<p>L’analisi illustrata qui sopra è semplice e allettante, ma è anche <strong>totalmente sbagliata</strong>: mettere sullo stesso piano repliche vere e pseudo-repliche trascura il fatto che le 270 osservazioni sono raggruppate per parcella e che le osservazioni nella stessa parcella sono più simili che quelle in pacelle diverse, poiché condividono la stessa ‘origine’ (mancanza di indipendenza dei residui). Inoltre, il grado di precisione è troppo elevato: i tre sottocampioni sono correlati e non forniscono tre ‘pezzi’ di informazione completi.</p>
<p>Un modello corretto per questa circostanza dovrebbe includere un termine aggiuntivo per le parcelle, che sono unità di “raggruppamento” e sono anche unità di randomizzazione:</p>
<p><span class="math display">\[Y_{ijs} = \mu + \alpha_i + \gamma_j + \delta_{ij} + \varepsilon_{ijs}\]</span></p>
<p>In questo modello, <span class="math inline">\(Y_{ijs}\)</span> è il peso di mille semi per l’i-esimo genotipo, il j-esimo blocco, la k-esima pacella e il s-esimo sub-campione, <span class="math inline">\(\alpha_i\)</span> è l’effetto dell’i-esimo genotipo, <span class="math inline">\(\gamma_j\)</span> è l’effetto del j-esimo blocco, <span class="math inline">\(\delta_{ij}\)</span> è l’effetto della parcella identificata dall’i-esimo genotipo e dal j-esimo blocco e <span class="math inline">\(\varepsilon_{ijs}\)</span> è l’effetto del s-esimo sottocampione, nella parcella identificata come precedentemente menzionato. La presenza dell’elemento <span class="math inline">\(\delta\)</span> spiega le differenze tra le parcelle, in modo da ripristinare l’indipendenza dei residui del modello.</p>
<p>Dato che la parcella anche un’unità di randomizzazione, perchè riceve i livelli del trattamento in modo randomizzato, deve essere considerata come effetto random. Di conseguenza, si tratta di un modello misto: le due componenti della varianza sono <span class="math inline">\(\sigma^2_{\delta}\)</span> e <span class="math inline">\(\sigma^2_{\varepsilon}\)</span>, e la seconda dovrebbe essere molto più piccola, in quanto non contiene importanti fonti di errore sperimentale, come la variabilità dovuta al suolo o alle pratiche colturali. Ovviamente, alla prima componente deve essere assegnato il peso appropriato quando si costruisce il termine di errore corretto per testare l’effetto del genotipo.</p>
<p>Questo modello misto può essere stimato utilizzando la funzione <code>lmer()</code> nel pacchetto <code>lme4</code> (Codice 12.8). La verifica delle assunzioni di base, effettuata come spiegato per gli esempi precedenti, non fornisce alcun sospetto di possibili deviazioni e, pertanto, è possibile visualizzare le componenti della varianza e la tabella ANOVA. Si può confermare che l’effetto del genotipo è significativo, sebbene gli errori standard delle medie siano molto più alti rispetto all’analisi errata mostrata in precedenza (1.75 contro 0.903) e il numero di confronti significativi sia sceso a 91. Per brevità, non vengono mostrati i risultati completi dei confronti a coppie.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="breve-introduzione-ai-modelli-misti.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 12.4 [continuation]</span></span>
<span id="cb129-2"><a href="breve-introduzione-ai-modelli-misti.html#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="breve-introduzione-ai-modelli-misti.html#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="co"># CORRECT ANALYSES!!!</span></span>
<span id="cb129-4"><a href="breve-introduzione-ai-modelli-misti.html#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co"># True replicates and sub-replicates are parted</span></span>
<span id="cb129-5"><a href="breve-introduzione-ai-modelli-misti.html#cb129-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-6"><a href="breve-introduzione-ai-modelli-misti.html#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="breve-introduzione-ai-modelli-misti.html#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting a mixed model with the random &#39;plot&#39; term</span></span>
<span id="cb129-8"><a href="breve-introduzione-ai-modelli-misti.html#cb129-8" aria-hidden="true" tabindex="-1"></a>mod.mix <span class="ot">&lt;-</span> <span class="fu">lmer</span>(TKW <span class="sc">~</span> Block <span class="sc">+</span> Genotype <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Plot), <span class="at">data=</span>TKW)</span>
<span id="cb129-9"><a href="breve-introduzione-ai-modelli-misti.html#cb129-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-10"><a href="breve-introduzione-ai-modelli-misti.html#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for basic assumptions (not run)</span></span>
<span id="cb129-11"><a href="breve-introduzione-ai-modelli-misti.html#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mod.mix)</span></span>
<span id="cb129-12"><a href="breve-introduzione-ai-modelli-misti.html#cb129-12" aria-hidden="true" tabindex="-1"></a><span class="co"># qqnorm(resid(mod.mix)) # QQ-plot</span></span>
<span id="cb129-13"><a href="breve-introduzione-ai-modelli-misti.html#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="co"># qqline(resid(mod.mix), lty = 2)</span></span>
<span id="cb129-14"><a href="breve-introduzione-ai-modelli-misti.html#cb129-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-15"><a href="breve-introduzione-ai-modelli-misti.html#cb129-15" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(<span class="fu">lm</span>(<span class="fu">residuals</span>(mod.mix) <span class="sc">~</span> Genotype, <span class="at">data=</span>TKW))</span>
<span id="cb129-16"><a href="breve-introduzione-ai-modelli-misti.html#cb129-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Levene&#39;s Test for Homogeneity of Variance (center = median)</span></span>
<span id="cb129-17"><a href="breve-introduzione-ai-modelli-misti.html#cb129-17" aria-hidden="true" tabindex="-1"></a><span class="do">##        Df F value Pr(&gt;F)</span></span>
<span id="cb129-18"><a href="breve-introduzione-ai-modelli-misti.html#cb129-18" aria-hidden="true" tabindex="-1"></a><span class="do">## group  29  1.0143 0.4507</span></span>
<span id="cb129-19"><a href="breve-introduzione-ai-modelli-misti.html#cb129-19" aria-hidden="true" tabindex="-1"></a><span class="do">##       240</span></span>
<span id="cb129-20"><a href="breve-introduzione-ai-modelli-misti.html#cb129-20" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod.mix))</span>
<span id="cb129-21"><a href="breve-introduzione-ai-modelli-misti.html#cb129-21" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb129-22"><a href="breve-introduzione-ai-modelli-misti.html#cb129-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  Shapiro-Wilk normality test</span></span>
<span id="cb129-23"><a href="breve-introduzione-ai-modelli-misti.html#cb129-23" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb129-24"><a href="breve-introduzione-ai-modelli-misti.html#cb129-24" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  residuals(mod.mix)</span></span>
<span id="cb129-25"><a href="breve-introduzione-ai-modelli-misti.html#cb129-25" aria-hidden="true" tabindex="-1"></a><span class="do">## W = 0.99277, p-value = 0.2141</span></span>
<span id="cb129-26"><a href="breve-introduzione-ai-modelli-misti.html#cb129-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the variance components </span></span>
<span id="cb129-27"><a href="breve-introduzione-ai-modelli-misti.html#cb129-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">VarCorr</span>(mod.mix), <span class="at">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb129-28"><a href="breve-introduzione-ai-modelli-misti.html#cb129-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  Groups   Name        Variance</span></span>
<span id="cb129-29"><a href="breve-introduzione-ai-modelli-misti.html#cb129-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  Plot     (Intercept) 8.89201 </span></span>
<span id="cb129-30"><a href="breve-introduzione-ai-modelli-misti.html#cb129-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  Residual             0.84526</span></span>
<span id="cb129-31"><a href="breve-introduzione-ai-modelli-misti.html#cb129-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance partitioning</span></span>
<span id="cb129-32"><a href="breve-introduzione-ai-modelli-misti.html#cb129-32" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod.mix, <span class="at">ddf =</span> <span class="st">&quot;Kenward-Roger&quot;</span>)</span>
<span id="cb129-33"><a href="breve-introduzione-ai-modelli-misti.html#cb129-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Type III Analysis of Variance Table with Kenward-Roger&#39;s method</span></span>
<span id="cb129-34"><a href="breve-introduzione-ai-modelli-misti.html#cb129-34" aria-hidden="true" tabindex="-1"></a><span class="do">##           Sum Sq Mean Sq NumDF DenDF F value    Pr(&gt;F)    </span></span>
<span id="cb129-35"><a href="breve-introduzione-ai-modelli-misti.html#cb129-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Block      3.389  1.6944     2    58  2.0046    0.1439    </span></span>
<span id="cb129-36"><a href="breve-introduzione-ai-modelli-misti.html#cb129-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype 221.892  7.6515    29    58  9.0522 9.944e-13 ***</span></span>
<span id="cb129-37"><a href="breve-introduzione-ai-modelli-misti.html#cb129-37" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb129-38"><a href="breve-introduzione-ai-modelli-misti.html#cb129-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb129-39"><a href="breve-introduzione-ai-modelli-misti.html#cb129-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of significant pairwise comparisons between genotype means</span></span>
<span id="cb129-40"><a href="breve-introduzione-ai-modelli-misti.html#cb129-40" aria-hidden="true" tabindex="-1"></a>pairwise <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">pairs</span>(<span class="fu">emmeans</span>(mod.mix, <span class="sc">~</span>Genotype)))</span>
<span id="cb129-41"><a href="breve-introduzione-ai-modelli-misti.html#cb129-41" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pairwise<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb129-42"><a href="breve-introduzione-ai-modelli-misti.html#cb129-42" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 91</span></span></code></pre></div>
<p>Il metodo di analisi dei dati illustrato nel riquadro sovrastante è fortemente raccomandato, sebbene, qualora il numero di sub-campioni sia lo stesso per tutte le parcelle, possiamo ottenere risultati corretti anche con un’analisi in due fasi: nella prima fase, calcoliamo le medie dei sub-campioni per ciascuna parcella e, nella seconda fase, utilizziamo queste medie per stimare un modello che include il genotipo e il blocco come fattori fissi. Il riquadro sottostante mostra che questa tecnica in due fasi produce gli stessi risultati, senza la necessità di disporre di un software avanzato per la stima di un modello misto.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="breve-introduzione-ai-modelli-misti.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 12.4 [continuation]</span></span>
<span id="cb130-2"><a href="breve-introduzione-ai-modelli-misti.html#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="breve-introduzione-ai-modelli-misti.html#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting in two-steps without a mixed model</span></span>
<span id="cb130-4"><a href="breve-introduzione-ai-modelli-misti.html#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Only correct when the number of sub-samples is the</span></span>
<span id="cb130-5"><a href="breve-introduzione-ai-modelli-misti.html#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="co"># same for all plots!</span></span>
<span id="cb130-6"><a href="breve-introduzione-ai-modelli-misti.html#cb130-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-7"><a href="breve-introduzione-ai-modelli-misti.html#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="co"># First step</span></span>
<span id="cb130-8"><a href="breve-introduzione-ai-modelli-misti.html#cb130-8" aria-hidden="true" tabindex="-1"></a>TKWm <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(TKW <span class="sc">~</span> Block <span class="sc">+</span> Genotype, <span class="at">data =</span> TKW, mean)</span>
<span id="cb130-9"><a href="breve-introduzione-ai-modelli-misti.html#cb130-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-10"><a href="breve-introduzione-ai-modelli-misti.html#cb130-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Second step</span></span>
<span id="cb130-11"><a href="breve-introduzione-ai-modelli-misti.html#cb130-11" aria-hidden="true" tabindex="-1"></a>mod2step <span class="ot">&lt;-</span> <span class="fu">lm</span>(TKW <span class="sc">~</span> Genotype <span class="sc">+</span> Block, <span class="at">data =</span> TKWm)</span>
<span id="cb130-12"><a href="breve-introduzione-ai-modelli-misti.html#cb130-12" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2step)</span>
<span id="cb130-13"><a href="breve-introduzione-ai-modelli-misti.html#cb130-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb130-14"><a href="breve-introduzione-ai-modelli-misti.html#cb130-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb130-15"><a href="breve-introduzione-ai-modelli-misti.html#cb130-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: TKW</span></span>
<span id="cb130-16"><a href="breve-introduzione-ai-modelli-misti.html#cb130-16" aria-hidden="true" tabindex="-1"></a><span class="do">##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb130-17"><a href="breve-introduzione-ai-modelli-misti.html#cb130-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype  29 2408.24  83.043  9.0522 9.943e-13 ***</span></span>
<span id="cb130-18"><a href="breve-introduzione-ai-modelli-misti.html#cb130-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Block      2   36.78  18.390  2.0046    0.1439    </span></span>
<span id="cb130-19"><a href="breve-introduzione-ai-modelli-misti.html#cb130-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 58  532.08   9.174                      </span></span>
<span id="cb130-20"><a href="breve-introduzione-ai-modelli-misti.html#cb130-20" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb130-21"><a href="breve-introduzione-ai-modelli-misti.html#cb130-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="esempio-12.5-confronto-varietale-ripetuto-in-più-anni" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> Esempio 12.5: confronto varietale ripetuto in più anni<a href="breve-introduzione-ai-modelli-misti.html#esempio-12.5-confronto-varietale-ripetuto-in-più-anni" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In questo libro, abbiamo più volte menzionato l’importanza di ripetere più volte gli esperimenti, cosa che è del tutto assodata per le prove varietali, che coinvolgono spesso ampie reti di istituti di ricerca, in molte regioni e/o paesi. In genere, le reti varietali utilizzano un nucleo di genotipi comuni e lo stesso disegno sperimentale (ad esempio, blocchi completi randomizzati con 3-4 repliche), mentr, nel corso del tempo, vengono via via inseriti i genotipi più innovativi , mentre quelli obsoleti sono progressivamente abbandonati (Annichiarico 2002).</p>
<p>Consideriamo un esperimento varietale con otto genotipi di frumento, in tre blocchi completi, ripetuto per 7 anni e finalizzato a fornire raccomandazioni varietali agli agricoltori. I risultati sono tratti da Onofri e Ciriciofolo (2007) e sono disponibili nel dataset ‘WinterWheat’, all’interno del package <code>statforbiology</code>.</p>
<p>Per questo dataset è possibile utilizzare il modello seguente:</p>
<p><span class="math display">\[y_{ijk} = \mu + \gamma_{ik} + \alpha_i + \beta_j + \alpha\beta_{ij} + \varepsilon_{ijk}\]</span></p>
<p>In questo modello, <span class="math inline">\(y\)</span> è la produzione nell’iesimo anno, j-esimo genotipo e k-esimo blocco, <span class="math inline">\(\mu\)</span> è l’intercetta, <span class="math inline">\(\gamma_{ik}\)</span> è l’effetto del k-esimo blocco nell’i-esimo anno, <span class="math inline">\(\alpha_i\)</span> è l’effetto dell’i-esimo anno, <span class="math inline">\(\beta_j\)</span> è l’effetto del j-esimo genotipo, <span class="math inline">\(\alpha\beta_{ij}\)</span> è l’effetto dell’interazione ‘genotipo x anno’ e <span class="math inline">\(\varepsilon_{ijk}\)</span> è il residuo, che assumiamo sia distribuito normalmente e omoschedastico (<span class="math inline">\(\epsilon_{ijk} \sim N(0, \sigma_{\varepsilon})\)</span>).</p>
<p>Con gli esperimenti ripetuti, di qualunque genere essi siano, è necessario prendere una decisione sulla natura dell’effetto di ripetizione, cioè l’anno (in questo caso), la località oppure, in genere, la ‘serie’. In particolare, è necessario decidere se considerare questo effetto “fisso” o “random”. Tale decisione è specifica per ogni esperimento e spetta al ricercatore, che dovrebbe fornire solide motivazioni a supporto. Come regola generale, si possono dare i seguenti suggerimenti:</p>
<ol style="list-style-type: decimal">
<li>ogni volta che l’esperimento viene ripetuto un numero limitato di volte (ad esempio 2 o 3), l’effetto “ripetizione” potrebbe essere preferibilmente considerato fisso, come abbiamo mostrato nella Sezione 10.5; infatti, una stima affidabile delle componenti della varianza richiede che il numero di livelli per il fattore random sia sufficientemente elevato (almeno 4, approssimativamente).</li>
<li>Con esperimenti di campo ripetuti in un numero relativamente elevato di anni, quest’ultimo effetto potrebbe essere ragionevolmente considerato casuale, per almeno una buona ragione: sebbene gli anni non siano campionati (non possiamo campionare gli anni, possiamo solo prenderli nelll’ordine in cui si presentano), gli effetti che producono non sono ripetibili e sono chiaramente di natura casuale.</li>
<li>Con esperimenti sul campo ripetuti in un numero relativamente elevato di località, la natura di quest’ultimo effetto è più dubbia: in alcuni casi, le località sono scelte appositamente e sono interessanti di per sè, senza rappresentare nessun macro-ambiente. In questo caso, l’effetto ‘località’ può essere ragionevolmente preso come fisso. In altri casi, le località sono campionate per rappresentare un macroambiente e, pertanto, il loro effetto è da considerare random.</li>
</ol>
<p>Quando gli ‘anni/località/ambienti’ sono considerati random, essi costituiscono una sorta di “super-repliche”, che inducono un’ulteriore fonte di variabilità (la variabilità tra prove), che si aggiunge alla consueta variabilità entro prova. Separare queste due fonti di variabilità è estremamente rilevante, ad esempio, per scopi di selezione varietale.</p>
<p>Nel dataset ‘WinterWheat’, il numero di anni è relativamente elevato e, poiché l’effetto anno è intrinsecamente di natura casuale e irripetibile, non avrebbe senso condizionare la raccomandazione varietale ad uno specifico anno; pertanto, l’effetto anno può essere preferibilmente considerato come random, con distribuzione gaussiana, media pari a 0 e deviazione standard pari a <span class="math inline">\(\sigma_E\)</span>:</p>
<p><span class="math display">\[\alpha_i \sim N(0, \sigma_E)\]</span></p>
<p>L’elemento <span class="math inline">\(\sigma^2_E\)</span> è la cosiddetta “componente di varianza” per l’effetto anno. Se l’anno è random, anche gli effetti “genotipo x anno” e “blocco entro anno” sono casuali e sono definiti come:</p>
<p><span class="math display">\[\alpha\beta_{ij} \sim N(0, \sigma_{GE})\]</span></p>
<p><span class="math display">\[\gamma_{ik} \sim N(0, \sigma_{EB})\]</span></p>
<p>Una volta caricato il dataset e aver eseguito le trasformazioni necessarie (ovvero, le variabili “Block”, “Year” e “Genotype” devono essere trasformate in fattori), è necessaria un’attenta analisi EDA, che implica un esame approfondito di ogni singolo esperimento, per assicurarsi che i dati di tutti gli anni siano validi e che le varianze dei residui dei diversi anni siano simili (vedere anche Sezione 10.5). Il riquadro sottostante non evidenzia problemi rilevanti, sebbene i risultati non siano mostrati per brevità.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="breve-introduzione-ai-modelli-misti.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 12.5</span></span>
<span id="cb131-2"><a href="breve-introduzione-ai-modelli-misti.html#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A multi-year winter wheat experiment</span></span>
<span id="cb131-3"><a href="breve-introduzione-ai-modelli-misti.html#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="breve-introduzione-ai-modelli-misti.html#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the packages</span></span>
<span id="cb131-5"><a href="breve-introduzione-ai-modelli-misti.html#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statforbiology)</span>
<span id="cb131-6"><a href="breve-introduzione-ai-modelli-misti.html#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb131-7"><a href="breve-introduzione-ai-modelli-misti.html#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb131-8"><a href="breve-introduzione-ai-modelli-misti.html#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb131-9"><a href="breve-introduzione-ai-modelli-misti.html#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb131-10"><a href="breve-introduzione-ai-modelli-misti.html#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb131-11"><a href="breve-introduzione-ai-modelli-misti.html#cb131-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb131-12"><a href="breve-introduzione-ai-modelli-misti.html#cb131-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SuppDists)</span>
<span id="cb131-13"><a href="breve-introduzione-ai-modelli-misti.html#cb131-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-14"><a href="breve-introduzione-ai-modelli-misti.html#cb131-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading and transforming the data</span></span>
<span id="cb131-15"><a href="breve-introduzione-ai-modelli-misti.html#cb131-15" aria-hidden="true" tabindex="-1"></a>WinterWheat <span class="ot">&lt;-</span> <span class="fu">getAgroData</span>(<span class="st">&quot;WinterWheat&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb131-16"><a href="breve-introduzione-ai-modelli-misti.html#cb131-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(<span class="at">Block =</span> <span class="fu">factor</span>(Block),</span>
<span id="cb131-17"><a href="breve-introduzione-ai-modelli-misti.html#cb131-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">Year =</span> <span class="fu">factor</span>(Year),</span>
<span id="cb131-18"><a href="breve-introduzione-ai-modelli-misti.html#cb131-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">Genotype =</span> <span class="fu">factor</span>(Genotype))</span>
<span id="cb131-19"><a href="breve-introduzione-ai-modelli-misti.html#cb131-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-20"><a href="breve-introduzione-ai-modelli-misti.html#cb131-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Model fitting for each year</span></span>
<span id="cb131-21"><a href="breve-introduzione-ai-modelli-misti.html#cb131-21" aria-hidden="true" tabindex="-1"></a>fits <span class="ot">&lt;-</span> <span class="fu">by</span>(WinterWheat, WinterWheat<span class="sc">$</span>Year,</span>
<span id="cb131-22"><a href="breve-introduzione-ai-modelli-misti.html#cb131-22" aria-hidden="true" tabindex="-1"></a>   <span class="cf">function</span>(group) <span class="fu">lm</span>(Yield <span class="sc">~</span> Block <span class="sc">+</span> Genotype,</span>
<span id="cb131-23"><a href="breve-introduzione-ai-modelli-misti.html#cb131-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> group))</span>
<span id="cb131-24"><a href="breve-introduzione-ai-modelli-misti.html#cb131-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-25"><a href="breve-introduzione-ai-modelli-misti.html#cb131-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Levene&#39;s test for each year: fit a reduced model with </span></span>
<span id="cb131-26"><a href="breve-introduzione-ai-modelli-misti.html#cb131-26" aria-hidden="true" tabindex="-1"></a><span class="co"># only the Genotype in each year and use the &#39;leveneTest&#39; function</span></span>
<span id="cb131-27"><a href="breve-introduzione-ai-modelli-misti.html#cb131-27" aria-hidden="true" tabindex="-1"></a>fits2 <span class="ot">&lt;-</span> <span class="fu">by</span>(WinterWheat, WinterWheat<span class="sc">$</span>Year,</span>
<span id="cb131-28"><a href="breve-introduzione-ai-modelli-misti.html#cb131-28" aria-hidden="true" tabindex="-1"></a>   <span class="cf">function</span>(group) <span class="fu">leveneTest</span>(<span class="fu">residuals</span>(<span class="fu">lm</span>(Yield <span class="sc">~</span> Block <span class="sc">+</span> Genotype,</span>
<span id="cb131-29"><a href="breve-introduzione-ai-modelli-misti.html#cb131-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> group)) <span class="sc">~</span> Genotype, <span class="at">data =</span> group ))</span>
<span id="cb131-30"><a href="breve-introduzione-ai-modelli-misti.html#cb131-30" aria-hidden="true" tabindex="-1"></a>lev.test <span class="ot">&lt;-</span> <span class="fu">unlist</span>( <span class="fu">lapply</span>(fits2, <span class="cf">function</span>(mod) mod<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">1</span>] ))</span>
<span id="cb131-31"><a href="breve-introduzione-ai-modelli-misti.html#cb131-31" aria-hidden="true" tabindex="-1"></a>lev.test</span>
<span id="cb131-32"><a href="breve-introduzione-ai-modelli-misti.html#cb131-32" aria-hidden="true" tabindex="-1"></a><span class="do">##      1996      1997      1998      1999      2000      2001      2002 </span></span>
<span id="cb131-33"><a href="breve-introduzione-ai-modelli-misti.html#cb131-33" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.9606223 0.9227674 0.8272382 0.7615624 0.9400817 0.8875930 0.7361952</span></span>
<span id="cb131-34"><a href="breve-introduzione-ai-modelli-misti.html#cb131-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro-Wilks&#39; test for each year</span></span>
<span id="cb131-35"><a href="breve-introduzione-ai-modelli-misti.html#cb131-35" aria-hidden="true" tabindex="-1"></a>norm.tests <span class="ot">&lt;-</span> <span class="fu">unlist</span>( <span class="fu">lapply</span>(fits, <span class="cf">function</span>(mod)</span>
<span id="cb131-36"><a href="breve-introduzione-ai-modelli-misti.html#cb131-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(mod))<span class="sc">$</span>p.value ))</span>
<span id="cb131-37"><a href="breve-introduzione-ai-modelli-misti.html#cb131-37" aria-hidden="true" tabindex="-1"></a>norm.tests</span>
<span id="cb131-38"><a href="breve-introduzione-ai-modelli-misti.html#cb131-38" aria-hidden="true" tabindex="-1"></a><span class="do">##       1996       1997       1998       1999       2000       2001 </span></span>
<span id="cb131-39"><a href="breve-introduzione-ai-modelli-misti.html#cb131-39" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.43238842 0.24363110 0.70103762 0.98820729 0.85707740 0.46985800 </span></span>
<span id="cb131-40"><a href="breve-introduzione-ai-modelli-misti.html#cb131-40" aria-hidden="true" tabindex="-1"></a><span class="do">##       2002 </span></span>
<span id="cb131-41"><a href="breve-introduzione-ai-modelli-misti.html#cb131-41" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.03322886</span></span>
<span id="cb131-42"><a href="breve-introduzione-ai-modelli-misti.html#cb131-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve the residual variance for each year</span></span>
<span id="cb131-43"><a href="breve-introduzione-ai-modelli-misti.html#cb131-43" aria-hidden="true" tabindex="-1"></a>mses <span class="ot">&lt;-</span> <span class="fu">unlist</span>( <span class="fu">lapply</span>(fits, <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span>) )</span>
<span id="cb131-44"><a href="breve-introduzione-ai-modelli-misti.html#cb131-44" aria-hidden="true" tabindex="-1"></a>mses</span>
<span id="cb131-45"><a href="breve-introduzione-ai-modelli-misti.html#cb131-45" aria-hidden="true" tabindex="-1"></a><span class="do">##       1996       1997       1998       1999       2000       2001 </span></span>
<span id="cb131-46"><a href="breve-introduzione-ai-modelli-misti.html#cb131-46" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.16178095 0.20184048 0.07198333 0.10116845 0.12620893 0.27505952 </span></span>
<span id="cb131-47"><a href="breve-introduzione-ai-modelli-misti.html#cb131-47" aria-hidden="true" tabindex="-1"></a><span class="do">##       2002 </span></span>
<span id="cb131-48"><a href="breve-introduzione-ai-modelli-misti.html#cb131-48" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.10358631</span></span>
<span id="cb131-49"><a href="breve-introduzione-ai-modelli-misti.html#cb131-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Hartley&#39;s Fmax test</span></span>
<span id="cb131-50"><a href="breve-introduzione-ai-modelli-misti.html#cb131-50" aria-hidden="true" tabindex="-1"></a>Fmax <span class="ot">&lt;-</span> <span class="fu">max</span>(mses)<span class="sc">/</span><span class="fu">min</span>(mses)</span>
<span id="cb131-51"><a href="breve-introduzione-ai-modelli-misti.html#cb131-51" aria-hidden="true" tabindex="-1"></a><span class="fu">pmaxFratio</span>(Fmax, <span class="dv">15</span>, <span class="dv">7</span>, <span class="at">lower.tail =</span> F)</span>
<span id="cb131-52"><a href="breve-introduzione-ai-modelli-misti.html#cb131-52" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1573404</span></span></code></pre></div>
<p>Prima di stimare un modello misto, potrebbe essere una buona idea adattare un modello fisso, per una valutazione preliminare dei residui e per confrontare i risultati con quelli del un modello misto (riquadro sottostante).</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="breve-introduzione-ai-modelli-misti.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 12.5 [continuation]</span></span>
<span id="cb132-2"><a href="breve-introduzione-ai-modelli-misti.html#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="breve-introduzione-ai-modelli-misti.html#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pooled analyses: fitting a preliminary fixed model</span></span>
<span id="cb132-4"><a href="breve-introduzione-ai-modelli-misti.html#cb132-4" aria-hidden="true" tabindex="-1"></a>modfix <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">sqrt</span>(Yield) <span class="sc">~</span> Year<span class="sc">/</span>Block <span class="sc">+</span> Genotype <span class="sc">*</span> Year,</span>
<span id="cb132-5"><a href="breve-introduzione-ai-modelli-misti.html#cb132-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> WinterWheat)</span>
<span id="cb132-6"><a href="breve-introduzione-ai-modelli-misti.html#cb132-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-7"><a href="breve-introduzione-ai-modelli-misti.html#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking the residuals (not run)</span></span>
<span id="cb132-8"><a href="breve-introduzione-ai-modelli-misti.html#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(modfix, which= 1)</span></span>
<span id="cb132-9"><a href="breve-introduzione-ai-modelli-misti.html#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(modfix, which = 2)</span></span>
<span id="cb132-10"><a href="breve-introduzione-ai-modelli-misti.html#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="co"># boxcox(modfix)</span></span>
<span id="cb132-11"><a href="breve-introduzione-ai-modelli-misti.html#cb132-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-12"><a href="breve-introduzione-ai-modelli-misti.html#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="co"># No problems with the assumptions, thus proceed to ANOVA</span></span>
<span id="cb132-13"><a href="breve-introduzione-ai-modelli-misti.html#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modfix)</span>
<span id="cb132-14"><a href="breve-introduzione-ai-modelli-misti.html#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb132-15"><a href="breve-introduzione-ai-modelli-misti.html#cb132-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb132-16"><a href="breve-introduzione-ai-modelli-misti.html#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: sqrt(Yield)</span></span>
<span id="cb132-17"><a href="breve-introduzione-ai-modelli-misti.html#cb132-17" aria-hidden="true" tabindex="-1"></a><span class="do">##               Df Sum Sq Mean Sq  F value    Pr(&gt;F)    </span></span>
<span id="cb132-18"><a href="breve-introduzione-ai-modelli-misti.html#cb132-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Year           6 6.8527 1.14212 192.5546 &lt; 2.2e-16 ***</span></span>
<span id="cb132-19"><a href="breve-introduzione-ai-modelli-misti.html#cb132-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype       7 0.4760 0.06799  11.4633 1.488e-10 ***</span></span>
<span id="cb132-20"><a href="breve-introduzione-ai-modelli-misti.html#cb132-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Year:Block    14 0.1657 0.01183   1.9949   0.02568 *  </span></span>
<span id="cb132-21"><a href="breve-introduzione-ai-modelli-misti.html#cb132-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Year:Genotype 42 1.1627 0.02768   4.6671 1.804e-10 ***</span></span>
<span id="cb132-22"><a href="breve-introduzione-ai-modelli-misti.html#cb132-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals     98 0.5813 0.00593                       </span></span>
<span id="cb132-23"><a href="breve-introduzione-ai-modelli-misti.html#cb132-23" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb132-24"><a href="breve-introduzione-ai-modelli-misti.html#cb132-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Il riquadro precedente conferma l’assenza di problemi con le assunzioni di base e la tabella ANOVA mostra che l’interazione “genotipo per anno” è significativa, il che consentirebbe solo raccomandazioni varietali specifiche per anno (e, quindi, piuttosto inutili). È chiaro che le raccomandazioni per un determinato sito dovrebbero essere formulate tenendo conto dell’intera gamma di condizioni meteorologiche che potrebbero verificarsi. In quest’ottica, possiamo stimare un modello misto con anni random tramite la funzione <code>lmer()</code>; le stime delle componenti della varianza vengono prodotte utilizzando il metodo REML (Restricted Maximum Likelyhood) (Pinheiro e Bates, 2000) e possono essere visualizzate utilizzando la funzione <code>VarCorr()</code> (riquadro sottostante).</p>
<p>Queste componenti della varianza mostrano che la variabilità complessiva della produzione è dovuta principalmente all’effetto anno (variabilità tra anni: <span class="math inline">\(\sigma^2_E = 1,07\)</span>), seguito dall’interazione genotipo-anno (<span class="math inline">\(\sigma^2_{GE} = 0,170\)</span>), dalla variabilità tra parcelle entro anno (termine di errore residuo <span class="math inline">\(\sigma^2 = 0,149\)</span>) e, infine, dalla variabilità tra blocchi entro anno (<span class="math inline">\(\sigma^2_{EB} = 0,016\)</span>). Queste componenti vengono utilizzate per costruire test F ed errori standard.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="breve-introduzione-ai-modelli-misti.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 12.5 [continuation]</span></span>
<span id="cb133-2"><a href="breve-introduzione-ai-modelli-misti.html#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="breve-introduzione-ai-modelli-misti.html#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pooled analyses: fitting a mixed model with random years</span></span>
<span id="cb133-4"><a href="breve-introduzione-ai-modelli-misti.html#cb133-4" aria-hidden="true" tabindex="-1"></a>modmix <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Yield <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>Year) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Year<span class="sc">:</span>Block) <span class="sc">+</span> Genotype <span class="sc">+</span></span>
<span id="cb133-5"><a href="breve-introduzione-ai-modelli-misti.html#cb133-5" aria-hidden="true" tabindex="-1"></a>               (<span class="dv">1</span><span class="sc">|</span>Year<span class="sc">:</span>Genotype),</span>
<span id="cb133-6"><a href="breve-introduzione-ai-modelli-misti.html#cb133-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> WinterWheat)</span>
<span id="cb133-7"><a href="breve-introduzione-ai-modelli-misti.html#cb133-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-8"><a href="breve-introduzione-ai-modelli-misti.html#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance components</span></span>
<span id="cb133-9"><a href="breve-introduzione-ai-modelli-misti.html#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( <span class="fu">VarCorr</span>(modmix), <span class="at">comp=</span><span class="fu">c</span>(<span class="st">&quot;Variance&quot;</span>, <span class="st">&quot;Std.Dev.&quot;</span>) )</span>
<span id="cb133-10"><a href="breve-introduzione-ai-modelli-misti.html#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  Groups        Name        Variance Std.Dev.</span></span>
<span id="cb133-11"><a href="breve-introduzione-ai-modelli-misti.html#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  Year:Genotype (Intercept) 0.170341 0.41272 </span></span>
<span id="cb133-12"><a href="breve-introduzione-ai-modelli-misti.html#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  Year:Block    (Intercept) 0.016418 0.12813 </span></span>
<span id="cb133-13"><a href="breve-introduzione-ai-modelli-misti.html#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  Year          (Intercept) 1.073146 1.03593 </span></span>
<span id="cb133-14"><a href="breve-introduzione-ai-modelli-misti.html#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  Residual                  0.148804 0.38575</span></span>
<span id="cb133-15"><a href="breve-introduzione-ai-modelli-misti.html#cb133-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA table</span></span>
<span id="cb133-16"><a href="breve-introduzione-ai-modelli-misti.html#cb133-16" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modmix, <span class="at">ddf =</span> <span class="st">&quot;Kenward-Roger&quot;</span>)</span>
<span id="cb133-17"><a href="breve-introduzione-ai-modelli-misti.html#cb133-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Type III Analysis of Variance Table with Kenward-Roger&#39;s method</span></span>
<span id="cb133-18"><a href="breve-introduzione-ai-modelli-misti.html#cb133-18" aria-hidden="true" tabindex="-1"></a><span class="do">##          Sum Sq Mean Sq NumDF DenDF F value  Pr(&gt;F)  </span></span>
<span id="cb133-19"><a href="breve-introduzione-ai-modelli-misti.html#cb133-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype 2.6033  0.3719     7    42  2.4993 0.03058 *</span></span>
<span id="cb133-20"><a href="breve-introduzione-ai-modelli-misti.html#cb133-20" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb133-21"><a href="breve-introduzione-ai-modelli-misti.html#cb133-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The ANOVA table shows that the F-ratio is still significant, but it is smaller than that of the fixed model fit. Indeed, at the denominator, apart from the residual error term, it is necessary to also consider the specific variability of each genotype across years (i.e., the genotype-by-year interaction).</p>
<p>Infine, vengono derivate e confrontate le medie complessive dei genotipi, ma non vengono evidenziate differenze significative tra i genotipi. Infatti, i modelli misti consentono di considerare tutte le possibili fonti di variabilità della resa (all’interno degli anni e tra gli anni), consentendo inferenze sull’intera popolazione di possibili anni (inferenza ‘broad space’).</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="breve-introduzione-ai-modelli-misti.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 12.5 [continuation]</span></span>
<span id="cb134-2"><a href="breve-introduzione-ai-modelli-misti.html#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="breve-introduzione-ai-modelli-misti.html#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple comparisons for a mixed model with random years</span></span>
<span id="cb134-4"><a href="breve-introduzione-ai-modelli-misti.html#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(<span class="fu">emmeans</span>(modmix, <span class="sc">~</span>Genotype), <span class="at">Letters =</span> letters)</span>
<span id="cb134-5"><a href="breve-introduzione-ai-modelli-misti.html#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  Genotype emmean    SE   df lower.CL upper.CL .group</span></span>
<span id="cb134-6"><a href="breve-introduzione-ai-modelli-misti.html#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  SIMETO     5.93 0.431 8.23     4.94     6.91  a    </span></span>
<span id="cb134-7"><a href="breve-introduzione-ai-modelli-misti.html#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  CRESO      5.97 0.431 8.23     4.99     6.96  a    </span></span>
<span id="cb134-8"><a href="breve-introduzione-ai-modelli-misti.html#cb134-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  GRAZIA     6.08 0.431 8.23     5.09     7.07  a    </span></span>
<span id="cb134-9"><a href="breve-introduzione-ai-modelli-misti.html#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  SANCARLO   6.22 0.431 8.23     5.23     7.21  a    </span></span>
<span id="cb134-10"><a href="breve-introduzione-ai-modelli-misti.html#cb134-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  SOLEX      6.23 0.431 8.23     5.24     7.22  a    </span></span>
<span id="cb134-11"><a href="breve-introduzione-ai-modelli-misti.html#cb134-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  COLOSSEO   6.41 0.431 8.23     5.43     7.40  a    </span></span>
<span id="cb134-12"><a href="breve-introduzione-ai-modelli-misti.html#cb134-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  DUILIO     6.59 0.431 8.23     5.60     7.58  a    </span></span>
<span id="cb134-13"><a href="breve-introduzione-ai-modelli-misti.html#cb134-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  IRIDE      6.70 0.431 8.23     5.71     7.68  a    </span></span>
<span id="cb134-14"><a href="breve-introduzione-ai-modelli-misti.html#cb134-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb134-15"><a href="breve-introduzione-ai-modelli-misti.html#cb134-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Degrees-of-freedom method: kenward-roger </span></span>
<span id="cb134-16"><a href="breve-introduzione-ai-modelli-misti.html#cb134-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb134-17"><a href="breve-introduzione-ai-modelli-misti.html#cb134-17" aria-hidden="true" tabindex="-1"></a><span class="do">## P value adjustment: tukey method for comparing a family of 8 estimates </span></span>
<span id="cb134-18"><a href="breve-introduzione-ai-modelli-misti.html#cb134-18" aria-hidden="true" tabindex="-1"></a><span class="do">## significance level used: alpha = 0.05 </span></span>
<span id="cb134-19"><a href="breve-introduzione-ai-modelli-misti.html#cb134-19" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: If two or more means share the same grouping symbol,</span></span>
<span id="cb134-20"><a href="breve-introduzione-ai-modelli-misti.html#cb134-20" aria-hidden="true" tabindex="-1"></a><span class="do">##       then we cannot show them to be different.</span></span>
<span id="cb134-21"><a href="breve-introduzione-ai-modelli-misti.html#cb134-21" aria-hidden="true" tabindex="-1"></a><span class="do">##       But we also did not show them to be the same.</span></span></code></pre></div>
</div>
<div id="esempio-12.6-misure-ripetute-nelle-colture-poliennali" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> Esempio 12.6: misure ripetute nelle colture poliennali<a href="breve-introduzione-ai-modelli-misti.html#esempio-12.6-misure-ripetute-nelle-colture-poliennali" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Con le colture poliennali, le misure vengono effettuate ripetutamente nelle stesse parcelle nel corso degli anni. Per questo motivo, sebbene il dataset assomigli molto a quello dell’esperimento precedente su frumento ripetuto in diversi anni, deve essere analizzato in modo completamente diverso.</p>
<p>In particolare, non dobbiamo trascurare che, a differenza dell’Esempio 12.5, le osservazioni non sono indipendenti, ma sono raggruppate all’interno delle stesse parcelle. La situazione appare simile a quella di un esperimento con sub-campionamento (vedi Sezione 12.4), con un’importante differenza: mentre i sub-campioni sono scelti casualmente all’interno di ciascuna parcella, con l’unico scopo di valutare la loro variabilità, le misure ripetute vengono eseguite specificamente per valutare l’andamento temporale della risposta.</p>
<p>Consideriamo un set di dati relativo alla resa di diversi genotipi di erba medica in tre anni consecutivi, prelevati dalle stesse parcelle in un singolo esperimento della durata di tre anni. Nel riquadro sottostante, il set di dati viene caricato e vengono eseguite alcune trasformazioni necessarie. Abbiamo anche creato una nuova variabile per identificare in modo univoco ogni parcella, il che è semplice, considerando che i valori di resa presi per lo stesso genotipo nello stesso blocco devono essere stati presi nella stessa parcella.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="breve-introduzione-ai-modelli-misti.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 12.6</span></span>
<span id="cb135-2"><a href="breve-introduzione-ai-modelli-misti.html#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeated measures in a perennial crop</span></span>
<span id="cb135-3"><a href="breve-introduzione-ai-modelli-misti.html#cb135-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-4"><a href="breve-introduzione-ai-modelli-misti.html#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the packages</span></span>
<span id="cb135-5"><a href="breve-introduzione-ai-modelli-misti.html#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statforbiology)</span>
<span id="cb135-6"><a href="breve-introduzione-ai-modelli-misti.html#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb135-7"><a href="breve-introduzione-ai-modelli-misti.html#cb135-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb135-8"><a href="breve-introduzione-ai-modelli-misti.html#cb135-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb135-9"><a href="breve-introduzione-ai-modelli-misti.html#cb135-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb135-10"><a href="breve-introduzione-ai-modelli-misti.html#cb135-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-11"><a href="breve-introduzione-ai-modelli-misti.html#cb135-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading and transforming the data</span></span>
<span id="cb135-12"><a href="breve-introduzione-ai-modelli-misti.html#cb135-12" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> <span class="fu">getAgroData</span>(<span class="st">&quot;alfalfa3years&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb135-13"><a href="breve-introduzione-ai-modelli-misti.html#cb135-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(<span class="at">Block =</span> <span class="fu">factor</span>(Block),</span>
<span id="cb135-14"><a href="breve-introduzione-ai-modelli-misti.html#cb135-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">Genotype =</span> <span class="fu">factor</span>(Genotype),</span>
<span id="cb135-15"><a href="breve-introduzione-ai-modelli-misti.html#cb135-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">Year =</span> <span class="fu">factor</span>(Year))</span>
<span id="cb135-16"><a href="breve-introduzione-ai-modelli-misti.html#cb135-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataset)</span>
<span id="cb135-17"><a href="breve-introduzione-ai-modelli-misti.html#cb135-17" aria-hidden="true" tabindex="-1"></a><span class="do">##   Plot Block Genotype Year    Yield</span></span>
<span id="cb135-18"><a href="breve-introduzione-ai-modelli-misti.html#cb135-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 1    1     1 4cascine 2006 6.631775</span></span>
<span id="cb135-19"><a href="breve-introduzione-ai-modelli-misti.html#cb135-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 2   25     2 4cascine 2006 6.705397</span></span>
<span id="cb135-20"><a href="breve-introduzione-ai-modelli-misti.html#cb135-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 3   60     3 4cascine 2006 6.499588</span></span>
<span id="cb135-21"><a href="breve-introduzione-ai-modelli-misti.html#cb135-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 4   63     4 4cascine 2006 7.087686</span></span>
<span id="cb135-22"><a href="breve-introduzione-ai-modelli-misti.html#cb135-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 5    7     1 casalina 2006 8.033558</span></span>
<span id="cb135-23"><a href="breve-introduzione-ai-modelli-misti.html#cb135-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 6   33     2 casalina 2006 8.265165</span></span>
<span id="cb135-24"><a href="breve-introduzione-ai-modelli-misti.html#cb135-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Reference the plots (not necessary in this instance)</span></span>
<span id="cb135-25"><a href="breve-introduzione-ai-modelli-misti.html#cb135-25" aria-hidden="true" tabindex="-1"></a><span class="co"># dataset$Plot &lt;- dataset$Block:dataset$Genotype</span></span></code></pre></div>
<p>Per i disegni a misure ripetute, i modelli possono essere costruiti utilizzando le regole di Piepho et al. (2004):</p>
<ol style="list-style-type: decimal">
<li>Considerare un singolo anno e costruire il modello per i trattamenti</li>
<li>Considerare un singolo anno e costruire il modello per i fattori di raggruppamento</li>
<li>Includere il fattore anno nel modello e combinare l’anno con tutti gli effetti nel modello dei trattamento, incrociando o annidando a seconda dei casi.</li>
<li>Considerare che il fattore “plot” nel modello dei fattori di raggruppamento fa riferimento alle unità di randomizzazione, ovvero quelle unità che hanno ricevuto i genotipi tramite un processo di randomizzazione. Assegnare quindi a questo fattore ‘plot’ un effetto casuale.</li>
<li>Escludendo i termini per le unità di randomizzazione, annidare l’anno in tutti gli altri termini del modello dei fattori di raggruppamento.</li>
<li>Combinare gli effetti casuali per le unità di randomizzazione con il fattore ripetuto, utilizzando l’operatore due punti, al fine di derivare i termini di errore corretti per gestire le strutture di correlazione.</li>
</ol>
<p>I modelli nelle diverse fasi sono i seguenti (con notazione R):</p>
<ol style="list-style-type: decimal">
<li>modello dei trattamenti: RESA ~ GENOTIPO</li>
<li>modello dei fattori di raggruppamento: RESA ~ BLOCCO + BLOCCO:PLOT</li>
<li>modello di trattamento: RESA ~ GENOTIPO * ANNO</li>
<li>modello a blocchi: RESA ~ BLOCCO + (1|BLOCCO:GRAFICO)</li>
<li>modello a blocchi: RESA ~ BLOCCO + BLOCCO:ANNO + (1|BLOCCO:GRAFICO)</li>
<li>modello a blocchi: RESA ~ BLOCCO + BLOCCO:ANNO + (1|BLOCCO:GRAFICO) + (1|BLOCCO:GRAFICO:ANNO)</li>
</ol>
<p>In questo caso, considerando che l’erba medica dura in media tre anni e segue uno specifico schema di resa in questi anni, si è deciso che gli effetti di blocco, anno e genotipo siano fissi e, quindi, il modello finale, con notazione R, è:</p>
<p>RESA ~ BLOCCO + BLOCCO:ANNO + GENOTIPO * ANNO + (1|BLOCK:PLOT) + (1|BLOCK:PLOT:YEAR)</p>
<p>dove l’ultimo termine (i residui) non deve essere inserito, poiché viene inserito di default.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="breve-introduzione-ai-modelli-misti.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 12.6 [continuation]</span></span>
<span id="cb136-2"><a href="breve-introduzione-ai-modelli-misti.html#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="breve-introduzione-ai-modelli-misti.html#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Mixed model analysis for the &#39;alfalfa3years&#39; dataset</span></span>
<span id="cb136-4"><a href="breve-introduzione-ai-modelli-misti.html#cb136-4" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Yield <span class="sc">~</span> Block <span class="sc">+</span> Block<span class="sc">:</span>Year <span class="sc">+</span> Genotype<span class="sc">*</span>Year <span class="sc">+</span></span>
<span id="cb136-5"><a href="breve-introduzione-ai-modelli-misti.html#cb136-5" aria-hidden="true" tabindex="-1"></a>            (<span class="dv">1</span><span class="sc">|</span>Block<span class="sc">:</span>Plot),</span>
<span id="cb136-6"><a href="breve-introduzione-ai-modelli-misti.html#cb136-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> dataset)</span>
<span id="cb136-7"><a href="breve-introduzione-ai-modelli-misti.html#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod, <span class="at">ddf =</span> <span class="st">&quot;Kenward-Roger&quot;</span>)</span>
<span id="cb136-8"><a href="breve-introduzione-ai-modelli-misti.html#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Type III Analysis of Variance Table with Kenward-Roger&#39;s method</span></span>
<span id="cb136-9"><a href="breve-introduzione-ai-modelli-misti.html#cb136-9" aria-hidden="true" tabindex="-1"></a><span class="do">##                Sum Sq Mean Sq NumDF DenDF   F value    Pr(&gt;F)    </span></span>
<span id="cb136-10"><a href="breve-introduzione-ai-modelli-misti.html#cb136-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Block            3.96    1.32     3    57    2.1389  0.105316    </span></span>
<span id="cb136-11"><a href="breve-introduzione-ai-modelli-misti.html#cb136-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype        54.00    2.84    19    57    4.6024  3.75e-06 ***</span></span>
<span id="cb136-12"><a href="breve-introduzione-ai-modelli-misti.html#cb136-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Year          2602.53 1301.27     2   114 2107.3223 &lt; 2.2e-16 ***</span></span>
<span id="cb136-13"><a href="breve-introduzione-ai-modelli-misti.html#cb136-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Block:Year      14.14    2.36     6   114    3.8176  0.001667 ** </span></span>
<span id="cb136-14"><a href="breve-introduzione-ai-modelli-misti.html#cb136-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Year:Genotype   31.83    0.84    38   114    1.3563  0.111546    </span></span>
<span id="cb136-15"><a href="breve-introduzione-ai-modelli-misti.html#cb136-15" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb136-16"><a href="breve-introduzione-ai-modelli-misti.html#cb136-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb136-17"><a href="breve-introduzione-ai-modelli-misti.html#cb136-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple comparisons</span></span>
<span id="cb136-18"><a href="breve-introduzione-ai-modelli-misti.html#cb136-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(<span class="fu">emmeans</span>(mod, <span class="sc">~</span>Genotype), <span class="at">Letters =</span> LETTERS, <span class="at">reverse =</span> <span class="cn">TRUE</span>)</span>
<span id="cb136-19"><a href="breve-introduzione-ai-modelli-misti.html#cb136-19" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: Results may be misleading due to involvement in interactions</span></span>
<span id="cb136-20"><a href="breve-introduzione-ai-modelli-misti.html#cb136-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  Genotype          emmean    SE df lower.CL upper.CL .group</span></span>
<span id="cb136-21"><a href="breve-introduzione-ai-modelli-misti.html#cb136-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  casalina           12.46 0.315 57    11.83     13.1  A    </span></span>
<span id="cb136-22"><a href="breve-introduzione-ai-modelli-misti.html#cb136-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  FDL0101            12.22 0.315 57    11.59     12.9  A    </span></span>
<span id="cb136-23"><a href="breve-introduzione-ai-modelli-misti.html#cb136-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  LaBellaCampagnola  12.17 0.315 57    11.54     12.8  A    </span></span>
<span id="cb136-24"><a href="breve-introduzione-ai-modelli-misti.html#cb136-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  PicenaGR           12.12 0.315 57    11.49     12.8  A    </span></span>
<span id="cb136-25"><a href="breve-introduzione-ai-modelli-misti.html#cb136-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  Selene             12.11 0.315 57    11.48     12.7  A    </span></span>
<span id="cb136-26"><a href="breve-introduzione-ai-modelli-misti.html#cb136-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  robot              12.11 0.315 57    11.48     12.7  A    </span></span>
<span id="cb136-27"><a href="breve-introduzione-ai-modelli-misti.html#cb136-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  Zenith             11.94 0.315 57    11.31     12.6  A    </span></span>
<span id="cb136-28"><a href="breve-introduzione-ai-modelli-misti.html#cb136-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  prosementi         11.79 0.315 57    11.15     12.4  A    </span></span>
<span id="cb136-29"><a href="breve-introduzione-ai-modelli-misti.html#cb136-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  marina             11.76 0.315 57    11.13     12.4  A    </span></span>
<span id="cb136-30"><a href="breve-introduzione-ai-modelli-misti.html#cb136-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  garisenda          11.76 0.315 57    11.13     12.4  A    </span></span>
<span id="cb136-31"><a href="breve-introduzione-ai-modelli-misti.html#cb136-31" aria-hidden="true" tabindex="-1"></a><span class="do">##  dimitra            11.75 0.315 57    11.12     12.4  A    </span></span>
<span id="cb136-32"><a href="breve-introduzione-ai-modelli-misti.html#cb136-32" aria-hidden="true" tabindex="-1"></a><span class="do">##  PR57Q53            11.70 0.315 57    11.07     12.3  A    </span></span>
<span id="cb136-33"><a href="breve-introduzione-ai-modelli-misti.html#cb136-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  classe             11.59 0.315 57    10.96     12.2  AB   </span></span>
<span id="cb136-34"><a href="breve-introduzione-ai-modelli-misti.html#cb136-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  4cascine           11.59 0.315 57    10.96     12.2  AB   </span></span>
<span id="cb136-35"><a href="breve-introduzione-ai-modelli-misti.html#cb136-35" aria-hidden="true" tabindex="-1"></a><span class="do">##  PR56S82            11.56 0.315 57    10.93     12.2  AB   </span></span>
<span id="cb136-36"><a href="breve-introduzione-ai-modelli-misti.html#cb136-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  LaTorre            11.36 0.315 57    10.73     12.0  ABC  </span></span>
<span id="cb136-37"><a href="breve-introduzione-ai-modelli-misti.html#cb136-37" aria-hidden="true" tabindex="-1"></a><span class="do">##  linfa              11.23 0.315 57    10.60     11.9  ABC  </span></span>
<span id="cb136-38"><a href="breve-introduzione-ai-modelli-misti.html#cb136-38" aria-hidden="true" tabindex="-1"></a><span class="do">##  Palladiana         10.89 0.315 57    10.26     11.5  ABC  </span></span>
<span id="cb136-39"><a href="breve-introduzione-ai-modelli-misti.html#cb136-39" aria-hidden="true" tabindex="-1"></a><span class="do">##  RivieraVicentina    9.98 0.315 57     9.35     10.6   BC  </span></span>
<span id="cb136-40"><a href="breve-introduzione-ai-modelli-misti.html#cb136-40" aria-hidden="true" tabindex="-1"></a><span class="do">##  costanza            9.89 0.315 57     9.26     10.5    C  </span></span>
<span id="cb136-41"><a href="breve-introduzione-ai-modelli-misti.html#cb136-41" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb136-42"><a href="breve-introduzione-ai-modelli-misti.html#cb136-42" aria-hidden="true" tabindex="-1"></a><span class="do">## Results are averaged over the levels of: Block, Year </span></span>
<span id="cb136-43"><a href="breve-introduzione-ai-modelli-misti.html#cb136-43" aria-hidden="true" tabindex="-1"></a><span class="do">## Degrees-of-freedom method: kenward-roger </span></span>
<span id="cb136-44"><a href="breve-introduzione-ai-modelli-misti.html#cb136-44" aria-hidden="true" tabindex="-1"></a><span class="do">## Confidence level used: 0.95 </span></span>
<span id="cb136-45"><a href="breve-introduzione-ai-modelli-misti.html#cb136-45" aria-hidden="true" tabindex="-1"></a><span class="do">## P value adjustment: tukey method for comparing a family of 20 estimates </span></span>
<span id="cb136-46"><a href="breve-introduzione-ai-modelli-misti.html#cb136-46" aria-hidden="true" tabindex="-1"></a><span class="do">## significance level used: alpha = 0.05 </span></span>
<span id="cb136-47"><a href="breve-introduzione-ai-modelli-misti.html#cb136-47" aria-hidden="true" tabindex="-1"></a><span class="do">## </span><span class="al">NOTE</span><span class="do">: If two or more means share the same grouping symbol,</span></span>
<span id="cb136-48"><a href="breve-introduzione-ai-modelli-misti.html#cb136-48" aria-hidden="true" tabindex="-1"></a><span class="do">##       then we cannot show them to be different.</span></span>
<span id="cb136-49"><a href="breve-introduzione-ai-modelli-misti.html#cb136-49" aria-hidden="true" tabindex="-1"></a><span class="do">##       But we also did not show them to be the same.</span></span></code></pre></div>
<p>Si dimostra che l’interazione “genotipo x anno” non è significativa, quindi è possibile derivare e confrontare le medie complessive dei genotipi negli anni. Il gruppo dei migliori, in media sui tre anni, contiene tutti i genotipi tranne Riviera Vicentina e Costanza.</p>
<p>Prima di concludere, è necessario ribadire l’idea che se questo set di dati venisse analizzato come nell’Esempio 12.5, tutte le inferenze e i test di ipotesi sarebbero invalidi perché l’assunto di base di indipendenza dei residui verrebbe violato, come accade quando i fattori di raggruppamento non sono inclusi nel modello.</p>
<p>Un’altra avvertenza è che l’analisi del modello misto proposta in precedenza nel riquadro precedente considera il disegno come uno “split-plot nel tempo”, il che non è necessariamente corretto. Infatti, tale analisi presuppone che la correlazione entro parcella rimanga la stessa per tutte le coppie di osservazioni, indipendentemente dalla loro distanza temporale. In effetti, sarebbe ragionevole aspettarsi che la correlazione sia maggiore per misure molto vicine nel tempo e diminuisca per misure prese a distanze temporali elevate. Pertanto, soprattutto quando il numero di anni è elevato, potrebbero essere necessarie ulteriori analisi per valutare se l’adozione di strutture di correlazione seriale sia giustificata (Piepho et al., 2004). Tuttavia, questo aspetto esula dallo scopo di questo libro introduttivo; informazioni utili sono reperibili in Littel et al. (2006).</p>
<p>Infine, vale la pena notare che si possono trovare disegni in cui le misurazioni non vengono ripetute nel tempo ma piuttosto nello spazio, ad esempio in posizioni diverse (vedi Capitolo 2) o a profondità variabili. Sebbene il termine “split-plot nel tempo” possa non essere appropriato per queste situazioni, il set di dati risultante può comunque essere analizzato utilizzando gli stessi metodi mostrati in questo esempio.</p>
</div>
<div id="fattori-di-raggruppamento-nei-modelli-di-regressione" class="section level2 hasAnchor" number="12.7">
<h2><span class="header-section-number">12.7</span> Fattori di raggruppamento nei modelli di regressione<a href="breve-introduzione-ai-modelli-misti.html#fattori-di-raggruppamento-nei-modelli-di-regressione" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Si prevedeva (Capitolo 11) che i fattori di raggruppamento dovessero sempre essere adeguatamente referenziati nel modello, il che vale anche per i modelli di regressione. Per questi ultimi modelli, in particolare per i modelli non lineari, è spesso preferibile considerare l’effetto del fattore di raggruppamento come casuale, supponendo che tutti i parametri del modello (o parte di essi) cambino casualmente da un gruppo all’altro. Di conseguenza, ad esempio, per i modelli di regressione lineare semplici, è possibile definire modelli con intercetta casuale o modelli con pendenza casuale o modelli con intercetta e pendenza casuali.</p>
<p>Questo è un aspetto spesso trascurato e, pertanto, è sembrato opportuno menzionarlo qui, sebbene sia troppo avanzato per un libro introduttivo. I lettori interessati possono consultare per ulteriori informazioni. Inoltre, diversi post sono dedicati a questo aspetto nel blog allegato a questo libro.</p>
<hr />
</div>
<div id="altre-letture-10" class="section level2 hasAnchor" number="12.8">
<h2><span class="header-section-number">12.8</span> Altre letture<a href="breve-introduzione-ai-modelli-misti.html#altre-letture-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Annichiarico P (2002) Genotype x Environment Interactions - Challenges and Opportunities for Plant Breeding and Cultivar Recommendations, Plant Production and Protection Paper, vol 1. FAO, MET</li>
<li>Bates D, Mächler M, Bolker B, Walker S (2015) Fitting linear mixed-effects models using lme4. J Stat Softw 67(1):1–48. <a href="https://doi.org/10.18637/jss.v067.i01" class="uri">https://doi.org/10.18637/jss.v067.i01</a></li>
<li>Belocchi A, Fornara M, Ciriciofolo E, Biancolatte E, Del Puglia S, Olimpieri G, Vecchiarelli V, Gosparini E, Piccioni C, Desiderio E (2003) Grano duro: Risultati 2002-03 della Rete Nazionale. Lazio e Umbria. L’Informatore Agrario 19(Suppl. 1):41–44</li>
<li>Dixon P (2016) Should blocks be fixed or random? In: Conference on Applied Statistics in Agri- culture. <a href="https://doi.org/10.4148/2475-7772.1474" class="uri">https://doi.org/10.4148/2475-7772.1474</a>. <a href="https://newprairiepress.org/agstatconference/" class="uri">https://newprairiepress.org/agstatconference/</a> 2016/proceedings/4</li>
<li>Gałecki A, Burzykowski T (2013) Linear Mixed-Effects Models Using R: A Step-by-Step Approach. Springer, Berlin</li>
<li>Gerhard D, Ritz C (2018) medrc: Mixed effect dose-response curves. <a href="https://github.com/doseResponse/medrc" class="uri">https://github.com/doseResponse/medrc</a>, r package version 1.1-0, commit bc36df514ad68d6e3f29ec4c740a563605231819</li>
<li>Kuznetsova A, Brockhoff PB, Christensen RHB (2017) lmerTest package: Tests in linear mixed effects models. J Stat Softw 82(13):1–26. <a href="https://doi.org/10.18637/jss.v082.i13" class="uri">https://doi.org/10.18637/jss.v082.i13</a></li>
<li>Ligabue M, Onofri A, Ruozzi F (2009) Le migliori varietà di erba medica da seme. Agricoltura 84:82–84</li>
<li>Littell RC, Milliken GA, Stroup WW, Wolfinger RD, Schabanberger O (2006) SAS for Mixed Models, 2nd edn. Books. SAS Publishing, Cary</li>
<li>Onofri A, Ciriciofolo E (2007) Using R to perform the AMMI analysis on agriculture variety trials. R News 7:14–19. <a href="http://www.r-project.org" class="uri">http://www.r-project.org</a></li>
<li>Piepho HP, Büchse A, Emrich K (2003) A Hitchhiker’s Guide to mixed models for randomized experiments. J Agron Crop Sci 189(5):310–322. <a href="https://doi.org/10.1046/j.1439-037X.2003" class="uri">https://doi.org/10.1046/j.1439-037X.2003</a>. 00049.x</li>
<li>Piepho HP, Büchse A, Richter C (2004) A mixed modelling approach for randomized experiments with repeated measures. J Agron Crop Sci 190(4):230–247. <a href="http://dx.doi.org/10.1111/j.1439-" class="uri">http://dx.doi.org/10.1111/j.1439-</a> 037X.2004.00097.x</li>
<li>Pinheiro JC, Bates DM (2000) Mixed-Effects Models in S and S-Plus. Springer-Verlag Inc. edn. Springer, New York</li>
<li>Stagnari F, Onofri A, Jemison J, Monotti M (2007) Improved multivariate analyses to discriminate the behaviour of faba bean varieties. Agron Sustain Develop 27(4):387–397</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelli-di-regressione-avanzati.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendice-a-breve-introduzione-ad-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
