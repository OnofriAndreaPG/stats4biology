<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capitolo 4 Le relazioni causa-effetto | Metodologia sperimentale per le scienze agrarie</title>
  <meta name="description" content="Capitolo 4 Le relazioni causa-effetto | Metodologia sperimentale per le scienze agrarie con applicazioni in R" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Capitolo 4 Le relazioni causa-effetto | Metodologia sperimentale per le scienze agrarie" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Capitolo 4 Le relazioni causa-effetto | Metodologia sperimentale per le scienze agrarie con applicazioni in R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capitolo 4 Le relazioni causa-effetto | Metodologia sperimentale per le scienze agrarie" />
  
  <meta name="twitter:description" content="Capitolo 4 Le relazioni causa-effetto | Metodologia sperimentale per le scienze agrarie con applicazioni in R" />
  

<meta name="author" content="Andrea Onofri e Dario Sacco" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="richiami-di-statistica-descrittiva.html"/>
<link rel="next" href="modelli-stocastici.html"/>
<script src="book_assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="book_assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="book_assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="book_assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131792052-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-131792052-1');
  </script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Metodologia sperimentale</a></strong></li> 

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Premessa</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#obiettivi"><i class="fa fa-check"></i>Obiettivi</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organizzazione"><i class="fa fa-check"></i>Organizzazione</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-statistico"><i class="fa fa-check"></i>Software statistico</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#gli-autori"><i class="fa fa-check"></i>Gli autori</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ringraziamenti-e-scuse"><i class="fa fa-check"></i>Ringraziamenti e scuse</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acronimi"><i class="fa fa-check"></i>Acronimi</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html"><i class="fa fa-check"></i><b>1</b> Scienza e pseudo-scienza</a>
<ul>
<li class="chapter" data-level="1.1" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#scienza-dati"><i class="fa fa-check"></i><b>1.1</b> Scienza = dati</a></li>
<li class="chapter" data-level="1.2" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#dati-buoni-e-cattivi"><i class="fa fa-check"></i><b>1.2</b> Dati ‘buoni’ e ‘cattivi’</a></li>
<li class="chapter" data-level="1.3" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#dati-buoni-e-metodi-buoni"><i class="fa fa-check"></i><b>1.3</b> Dati ‘buoni’ e metodi ‘buoni’</a></li>
<li class="chapter" data-level="1.4" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#il-principio-di-falsificazione"><i class="fa fa-check"></i><b>1.4</b> Il principio di falsificazione</a></li>
<li class="chapter" data-level="1.5" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#falsificare-un-risultato"><i class="fa fa-check"></i><b>1.5</b> Falsificare un risultato</a></li>
<li class="chapter" data-level="1.6" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#elementi-fondamentali-del-disegno-sperimentale"><i class="fa fa-check"></i><b>1.6</b> Elementi fondamentali del disegno sperimentale</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#controllo-degli-errori"><i class="fa fa-check"></i><b>1.6.1</b> Controllo degli errori</a></li>
<li class="chapter" data-level="1.6.2" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#replicazione"><i class="fa fa-check"></i><b>1.6.2</b> Replicazione</a></li>
<li class="chapter" data-level="1.6.3" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#randomizzazione"><i class="fa fa-check"></i><b>1.6.3</b> Randomizzazione</a></li>
<li class="chapter" data-level="1.6.4" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#esperimenti-invalidi"><i class="fa fa-check"></i><b>1.6.4</b> Esperimenti invalidi</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#chi-valuta-se-un-esperimento-è-attendibile"><i class="fa fa-check"></i><b>1.7</b> Chi valuta se un esperimento è attendibile?</a></li>
<li class="chapter" data-level="1.8" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#conclusioni"><i class="fa fa-check"></i><b>1.8</b> Conclusioni</a></li>
<li class="chapter" data-level="1.9" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#esercizi-e-domande"><i class="fa fa-check"></i><b>1.9</b> Esercizi e domande</a></li>
<li class="chapter" data-level="1.10" data-path="scienza-e-pseudo-scienza.html"><a href="scienza-e-pseudo-scienza.html#altre-letture"><i class="fa fa-check"></i><b>1.10</b> Altre letture</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html"><i class="fa fa-check"></i><b>2</b> Progettare un esperimento</a>
<ul>
<li class="chapter" data-level="2.1" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#gli-elementi-della-ricerca"><i class="fa fa-check"></i><b>2.1</b> Gli elementi della ricerca</a></li>
<li class="chapter" data-level="2.2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#ipotesi-scientifica-rightarrow-obiettivo-dellesperimento"><i class="fa fa-check"></i><b>2.2</b> Ipotesi scientifica <span class="math inline">\(\rightarrow\)</span> obiettivo dell’esperimento</a></li>
<li class="chapter" data-level="2.3" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#identificazione-dei-fattori-sperimentali"><i class="fa fa-check"></i><b>2.3</b> Identificazione dei fattori sperimentali</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esperimenti-multi-fattoriali"><i class="fa fa-check"></i><b>2.3.1</b> Esperimenti (multi-)fattoriali</a></li>
<li class="chapter" data-level="2.3.2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#controllo-o-testimone"><i class="fa fa-check"></i><b>2.3.2</b> Controllo o testimone</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#le-unità-sperimentali"><i class="fa fa-check"></i><b>2.4</b> Le unità sperimentali</a></li>
<li class="chapter" data-level="2.5" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#allocazione-dei-trattamenti"><i class="fa fa-check"></i><b>2.5</b> Allocazione dei trattamenti</a></li>
<li class="chapter" data-level="2.6" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#le-variabili-sperimentali"><i class="fa fa-check"></i><b>2.6</b> Le variabili sperimentali</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#variabili-nominali-categoriche"><i class="fa fa-check"></i><b>2.6.1</b> Variabili nominali (categoriche)</a></li>
<li class="chapter" data-level="2.6.2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#variabili-ordinali"><i class="fa fa-check"></i><b>2.6.2</b> Variabili ordinali</a></li>
<li class="chapter" data-level="2.6.3" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#variabili-quantitative-discrete"><i class="fa fa-check"></i><b>2.6.3</b> Variabili quantitative discrete</a></li>
<li class="chapter" data-level="2.6.4" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#variabili-quantitative-continue"><i class="fa fa-check"></i><b>2.6.4</b> Variabili quantitative continue</a></li>
<li class="chapter" data-level="2.6.5" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#rilievi-visivi-e-sensoriali"><i class="fa fa-check"></i><b>2.6.5</b> Rilievi visivi e sensoriali</a></li>
<li class="chapter" data-level="2.6.6" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#variabili-di-confondimento"><i class="fa fa-check"></i><b>2.6.6</b> Variabili di confondimento</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esperimenti-di-campo"><i class="fa fa-check"></i><b>2.7</b> Esperimenti di campo</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#scegliere-il-campo"><i class="fa fa-check"></i><b>2.7.1</b> Scegliere il campo</a></li>
<li class="chapter" data-level="2.7.2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#le-unità-sperimentali-in-campo"><i class="fa fa-check"></i><b>2.7.2</b> Le unità sperimentali in campo</a></li>
<li class="chapter" data-level="2.7.3" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#numero-di-repliche"><i class="fa fa-check"></i><b>2.7.3</b> Numero di repliche</a></li>
<li class="chapter" data-level="2.7.4" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#la-mappa-di-campo"><i class="fa fa-check"></i><b>2.7.4</b> La mappa di campo</a></li>
<li class="chapter" data-level="2.7.5" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#lay-out-sperimentale"><i class="fa fa-check"></i><b>2.7.5</b> Lay-out sperimentale</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#altre-letture-1"><i class="fa fa-check"></i><b>2.8</b> Altre letture</a></li>
<li class="chapter" data-level="2.9" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domande-ed-esercizi"><i class="fa fa-check"></i><b>2.9</b> Domande ed esercizi</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-1"><i class="fa fa-check"></i><b>2.9.1</b> Domanda 1</a></li>
<li class="chapter" data-level="2.9.2" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-2"><i class="fa fa-check"></i><b>2.9.2</b> Domanda 2</a></li>
<li class="chapter" data-level="2.9.3" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-3"><i class="fa fa-check"></i><b>2.9.3</b> Domanda 3</a></li>
<li class="chapter" data-level="2.9.4" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-4"><i class="fa fa-check"></i><b>2.9.4</b> Domanda 4</a></li>
<li class="chapter" data-level="2.9.5" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-5"><i class="fa fa-check"></i><b>2.9.5</b> Domanda 5</a></li>
<li class="chapter" data-level="2.9.6" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-6"><i class="fa fa-check"></i><b>2.9.6</b> Domanda 6</a></li>
<li class="chapter" data-level="2.9.7" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-7"><i class="fa fa-check"></i><b>2.9.7</b> Domanda 7</a></li>
<li class="chapter" data-level="2.9.8" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-8"><i class="fa fa-check"></i><b>2.9.8</b> Domanda 8</a></li>
<li class="chapter" data-level="2.9.9" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-9"><i class="fa fa-check"></i><b>2.9.9</b> Domanda 9</a></li>
<li class="chapter" data-level="2.9.10" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-10"><i class="fa fa-check"></i><b>2.9.10</b> Domanda 10</a></li>
<li class="chapter" data-level="2.9.11" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-12"><i class="fa fa-check"></i><b>2.9.11</b> Domanda 12</a></li>
<li class="chapter" data-level="2.9.12" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#domanda-13"><i class="fa fa-check"></i><b>2.9.12</b> Domanda 13</a></li>
<li class="chapter" data-level="2.9.13" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esercizio-1"><i class="fa fa-check"></i><b>2.9.13</b> Esercizio 1</a></li>
<li class="chapter" data-level="2.9.14" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esercizio-2"><i class="fa fa-check"></i><b>2.9.14</b> Esercizio 2</a></li>
<li class="chapter" data-level="2.9.15" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esercizio-3"><i class="fa fa-check"></i><b>2.9.15</b> Esercizio 3</a></li>
<li class="chapter" data-level="2.9.16" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esercizio-4"><i class="fa fa-check"></i><b>2.9.16</b> Esercizio 4</a></li>
<li class="chapter" data-level="2.9.17" data-path="progettare-un-esperimento.html"><a href="progettare-un-esperimento.html#esercizio-5"><i class="fa fa-check"></i><b>2.9.17</b> Esercizio 5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html"><i class="fa fa-check"></i><b>3</b> Richiami di statistica descrittiva</a>
<ul>
<li class="chapter" data-level="3.1" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#descrizione-di-dati-quantitativi"><i class="fa fa-check"></i><b>3.1</b> Descrizione di dati quantitativi</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#indicatori-di-tendenza-centrale"><i class="fa fa-check"></i><b>3.1.1</b> Indicatori di tendenza centrale</a></li>
<li class="chapter" data-level="3.1.2" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#indicatori-di-dispersione"><i class="fa fa-check"></i><b>3.1.2</b> Indicatori di dispersione</a></li>
<li class="chapter" data-level="3.1.3" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#incertezza-delle-misure-derivate"><i class="fa fa-check"></i><b>3.1.3</b> Incertezza delle misure derivate</a></li>
<li class="chapter" data-level="3.1.4" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#relazioni-tra-variabili-quantitative-correlazione"><i class="fa fa-check"></i><b>3.1.4</b> Relazioni tra variabili quantitative: correlazione</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#statistiche-descrittive-con-r"><i class="fa fa-check"></i><b>3.2</b> Statistiche descrittive con R</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#descrizione-dei-sottogruppi"><i class="fa fa-check"></i><b>3.2.1</b> Descrizione dei sottogruppi</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#altre-letture-2"><i class="fa fa-check"></i><b>3.3</b> Altre letture</a></li>
<li class="chapter" data-level="3.4" data-path="richiami-di-statistica-descrittiva.html"><a href="richiami-di-statistica-descrittiva.html#domande-ed-esercizi-1"><i class="fa fa-check"></i><b>3.4</b> Domande ed esercizi</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html"><i class="fa fa-check"></i><b>4</b> Le relazioni causa-effetto</a>
<ul>
<li class="chapter" data-level="4.1" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#modelli-matematici-e-statistici"><i class="fa fa-check"></i><b>4.1</b> Modelli matematici e statistici</a></li>
<li class="chapter" data-level="4.2" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#componenti-di-un-modello"><i class="fa fa-check"></i><b>4.2</b> Componenti di un modello</a></li>
<li class="chapter" data-level="4.3" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#fitting-di-un-modello"><i class="fa fa-check"></i><b>4.3</b> <em>Fitting</em> di un modello</a></li>
<li class="chapter" data-level="4.4" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#esempio-1-il-modello-della-media"><i class="fa fa-check"></i><b>4.4</b> Esempio 1: il ‘modello della media’</a></li>
<li class="chapter" data-level="4.5" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#esempio-2-un-predittore-quantitativo"><i class="fa fa-check"></i><b>4.5</b> Esempio 2: un predittore quantitativo</a></li>
<li class="chapter" data-level="4.6" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#esempio-3-un-predittore-nominale"><i class="fa fa-check"></i><b>4.6</b> Esempio 3: un predittore nominale</a></li>
<li class="chapter" data-level="4.7" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#lanalisi-della-varianza-anova"><i class="fa fa-check"></i><b>4.7</b> L’analisi della varianza (ANOVA)</a></li>
<li class="chapter" data-level="4.8" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#example-4-due-predittori-nominali"><i class="fa fa-check"></i><b>4.8</b> Example 4: due predittori nominali</a></li>
<li class="chapter" data-level="4.9" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#example-5-due-predittori-nominali-con-interazione"><i class="fa fa-check"></i><b>4.9</b> Example 5: due predittori nominali con interazione</a></li>
<li class="chapter" data-level="4.10" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#interazione-tra-fattori-sperimentali"><i class="fa fa-check"></i><b>4.10</b> Interazione tra fattori sperimentali</a></li>
<li class="chapter" data-level="4.11" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#example-5-segue"><i class="fa fa-check"></i><b>4.11</b> Example 5 (segue)</a></li>
<li class="chapter" data-level="4.12" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#dati-non-bilanciati"><i class="fa fa-check"></i><b>4.12</b> Dati non bilanciati</a></li>
<li class="chapter" data-level="4.13" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#esempio-6-un-crbd-con-un-valore-mancante"><i class="fa fa-check"></i><b>4.13</b> Esempio 6: un CRBD con un valore mancante</a></li>
<li class="chapter" data-level="4.14" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#conclusioni-1"><i class="fa fa-check"></i><b>4.14</b> Conclusioni</a></li>
<li class="chapter" data-level="4.15" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#altre-letture-3"><i class="fa fa-check"></i><b>4.15</b> Altre letture</a></li>
<li class="chapter" data-level="4.16" data-path="le-relazioni-causa-effetto.html"><a href="le-relazioni-causa-effetto.html#domande-ed-esercizi-2"><i class="fa fa-check"></i><b>4.16</b> Domande ed esercizi</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html"><i class="fa fa-check"></i><b>5</b> Modelli stocastici</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#funzioni-di-probabilitàdensità"><i class="fa fa-check"></i><b>5.1</b> Funzioni di probabilità/densità</a></li>
<li class="chapter" data-level="5.2" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#calcolare-le-probabilità"><i class="fa fa-check"></i><b>5.2</b> Calcolare le probabilità</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#esempio-5.1-calcolare-la-probabilità-in-un-esperimento-misurativo"><i class="fa fa-check"></i><b>5.2.1</b> Esempio 5.1: Calcolare la probabilità in un esperimento misurativo</a></li>
<li class="chapter" data-level="5.2.2" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#esempio-5.2-calcolo-della-probabilità-per-un-esperimento-di-degradazione"><i class="fa fa-check"></i><b>5.2.2</b> Esempio 5.2: Calcolo della probabilità per un esperimento di degradazione</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#simulazione-stocastica"><i class="fa fa-check"></i><b>5.3</b> Simulazione stocastica</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#esempio-5.3.-simulazione-di-un-esperimento-misurativo"><i class="fa fa-check"></i><b>5.3.1</b> Esempio 5.3. Simulazione di un esperimento misurativo</a></li>
<li class="chapter" data-level="5.3.2" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#esempio-5.4-simulazione-di-un-esperimento-di-fertilizzazione"><i class="fa fa-check"></i><b>5.3.2</b> Esempio 5.4: simulazione di un esperimento di fertilizzazione</a></li>
<li class="chapter" data-level="5.3.3" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#esempio-5.4-simulazione-di-una-prova-di-confronto-varietale"><i class="fa fa-check"></i><b>5.3.3</b> Esempio 5.4: Simulazione di una prova di confronto varietale</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#conclusioni-2"><i class="fa fa-check"></i><b>5.4</b> Conclusioni</a></li>
<li class="chapter" data-level="5.5" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#altre-letture-4"><i class="fa fa-check"></i><b>5.5</b> Altre letture</a></li>
<li class="chapter" data-level="5.6" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#domande-ed-esercizi-3"><i class="fa fa-check"></i><b>5.6</b> Domande ed esercizi</a></li>
<li class="chapter" data-level="5.7" data-path="modelli-stocastici.html"><a href="modelli-stocastici.html#soluzioni"><i class="fa fa-check"></i><b>5.7</b> Soluzioni</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html"><i class="fa fa-check"></i><b>6</b> Stime ed incertezza</a>
<ul>
<li class="chapter" data-level="6.1" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#ripetere-gli-esperimenti"><i class="fa fa-check"></i><b>6.1</b> Ripetere gli esperimenti</a></li>
<li class="chapter" data-level="6.2" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#la-sampling-distribution-teorica"><i class="fa fa-check"></i><b>6.2</b> La ‘sampling distribution’ teorica</a></li>
<li class="chapter" data-level="6.3" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#lintervallo-di-confidenza-frequentista"><i class="fa fa-check"></i><b>6.3</b> L’intervallo di confidenza frequentista</a></li>
<li class="chapter" data-level="6.4" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#come-otteniamo-lerrore-standard"><i class="fa fa-check"></i><b>6.4</b> Come otteniamo l’errore standard?</a></li>
<li class="chapter" data-level="6.5" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#come-otteniamo-il-moltiplicatore-k"><i class="fa fa-check"></i><b>6.5</b> Come otteniamo il moltiplicatore <span class="math inline">\(k\)</span>?</a></li>
<li class="chapter" data-level="6.6" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#gli-intervalli-di-confidenza-in-pratica"><i class="fa fa-check"></i><b>6.6</b> Gli intervalli di confidenza in pratica</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#esempio-6.1-ic-per-una-media-campionaria"><i class="fa fa-check"></i><b>6.6.1</b> Esempio 6.1: IC per una media campionaria</a></li>
<li class="chapter" data-level="6.6.2" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#example-6.2-cis-for-model-parameters"><i class="fa fa-check"></i><b>6.6.2</b> Example 6.2: CIs for model parameters</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#altri-approcci-per-il-calcolo-dei-ci"><i class="fa fa-check"></i><b>6.7</b> Altri approcci per il calcolo dei CI</a></li>
<li class="chapter" data-level="6.8" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#limitazioni-del-ci-frequentista"><i class="fa fa-check"></i><b>6.8</b> Limitazioni del CI frequentista</a></li>
<li class="chapter" data-level="6.9" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#altre-letture-5"><i class="fa fa-check"></i><b>6.9</b> Altre letture</a></li>
<li class="chapter" data-level="6.10" data-path="stime-ed-incertezza.html"><a href="stime-ed-incertezza.html#domande-ed-esercizi-4"><i class="fa fa-check"></i><b>6.10</b> Domande ed esercizi</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html"><i class="fa fa-check"></i><b>7</b> Decisioni ed incertezza</a>
<ul>
<li class="chapter" data-level="7.1" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#esempio-7.1-confronto-tra-due-genotipi"><i class="fa fa-check"></i><b>7.1</b> Esempio 7.1: Confronto tra due genotipi</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#lipotesi-nulla"><i class="fa fa-check"></i><b>7.1.1</b> L’ipotesi ‘nulla’</a></li>
<li class="chapter" data-level="7.1.2" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#il-test-di-t-wald-test"><i class="fa fa-check"></i><b>7.1.2</b> Il test di t (Wald test)</a></li>
<li class="chapter" data-level="7.1.3" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#simulazione-monte-carlo"><i class="fa fa-check"></i><b>7.1.3</b> Simulazione Monte Carlo</a></li>
<li class="chapter" data-level="7.1.4" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#una-soluzione-formale"><i class="fa fa-check"></i><b>7.1.4</b> Una soluzione formale</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#altri-test-di-t"><i class="fa fa-check"></i><b>7.2</b> Altri test di t</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#il-test-t-di-student"><i class="fa fa-check"></i><b>7.2.1</b> Il test t di Student</a></li>
<li class="chapter" data-level="7.2.2" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#il-test-di-welch"><i class="fa fa-check"></i><b>7.2.2</b> Il test di Welch</a></li>
<li class="chapter" data-level="7.2.3" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#il-test-di-t-appaiato"><i class="fa fa-check"></i><b>7.2.3</b> Il test di t appaiato</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#differenze-generalizzate-tra-parametri"><i class="fa fa-check"></i><b>7.3</b> Differenze generalizzate tra parametri</a></li>
<li class="chapter" data-level="7.4" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#il-test-f-nellanova"><i class="fa fa-check"></i><b>7.4</b> Il test F nell’ANOVA</a></li>
<li class="chapter" data-level="7.5" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#conclusioni-3"><i class="fa fa-check"></i><b>7.5</b> Conclusioni</a></li>
<li class="chapter" data-level="7.6" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#altre-letture-6"><i class="fa fa-check"></i><b>7.6</b> Altre letture</a></li>
<li class="chapter" data-level="7.7" data-path="decisioni-ed-incertezza.html"><a href="decisioni-ed-incertezza.html#esercizi"><i class="fa fa-check"></i><b>7.7</b> Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html"><i class="fa fa-check"></i><b>8</b> Verifica dei modelli</a>
<ul>
<li class="chapter" data-level="8.1" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#deviazioni-rispetto-alle-assunzioni-di-base"><i class="fa fa-check"></i><b>8.1</b> Deviazioni rispetto alle assunzioni di base</a></li>
<li class="chapter" data-level="8.2" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#scoprire-le-violazioni"><i class="fa fa-check"></i><b>8.2</b> Scoprire le violazioni</a></li>
<li class="chapter" data-level="8.3" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#analisi-grafica-dei-residui"><i class="fa fa-check"></i><b>8.3</b> Analisi grafica dei residui</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#grafico-dei-valori-osservati-aumentato-con-le-previsioni-del-modello"><i class="fa fa-check"></i><b>8.3.1</b> Grafico dei valori osservati, aumentato con le previsioni del modello</a></li>
<li class="chapter" data-level="8.3.2" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#grafico-dei-residui-contro-i-valori-attesi"><i class="fa fa-check"></i><b>8.3.2</b> Grafico dei residui contro i valori attesi</a></li>
<li class="chapter" data-level="8.3.3" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#qq-plot"><i class="fa fa-check"></i><b>8.3.3</b> QQ-plot</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#test-dipotesi"><i class="fa fa-check"></i><b>8.4</b> Test d’ipotesi</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#test-di-levene-per-lomogeneità-delle-varianze"><i class="fa fa-check"></i><b>8.4.1</b> Test di Levene per l’omogeneità delle varianze</a></li>
<li class="chapter" data-level="8.4.2" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#test-di-shapiro-wilk-per-la-normalità"><i class="fa fa-check"></i><b>8.4.2</b> Test di Shapiro-Wilk per la normalità</a></li>
<li class="chapter" data-level="8.4.3" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#altri-test"><i class="fa fa-check"></i><b>8.4.3</b> Altri test</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#esempio-8.1-analisi-dei-residui-per-il-dataset-mixture"><i class="fa fa-check"></i><b>8.5</b> Esempio 8.1: Analisi dei residui per il dataset “mixture”</a></li>
<li class="chapter" data-level="8.6" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#esempio-8.2-analisi-dei-residui-per-il-dataset-insects"><i class="fa fa-check"></i><b>8.6</b> Esempio 8.2: Analisi dei residui per il dataset ‘insects’</a></li>
<li class="chapter" data-level="8.7" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#misure-correttive"><i class="fa fa-check"></i><b>8.7</b> Misure correttive</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#correzionerimozione-degli-outliers"><i class="fa fa-check"></i><b>8.7.1</b> Correzione/Rimozione degli outliers</a></li>
<li class="chapter" data-level="8.7.2" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#correzione-del-modello"><i class="fa fa-check"></i><b>8.7.2</b> Correzione del modello</a></li>
<li class="chapter" data-level="8.7.3" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#trasformazione-del-predittore"><i class="fa fa-check"></i><b>8.7.3</b> Trasformazione del predittore</a></li>
<li class="chapter" data-level="8.7.4" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#trasformazione-della-risposta"><i class="fa fa-check"></i><b>8.7.4</b> Trasformazione della risposta</a></li>
<li class="chapter" data-level="8.7.5" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#esempio-8.1-segue"><i class="fa fa-check"></i><b>8.7.5</b> Esempio 8.1 (segue)</a></li>
<li class="chapter" data-level="8.7.6" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#esempio-8.2-segue"><i class="fa fa-check"></i><b>8.7.6</b> Esempio 8.2 (segue)</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#risultati-contraddittori"><i class="fa fa-check"></i><b>8.8</b> Risultati contraddittori</a></li>
<li class="chapter" data-level="8.9" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#altri-approcci-avanzati"><i class="fa fa-check"></i><b>8.9</b> Altri approcci ‘avanzati’</a></li>
<li class="chapter" data-level="8.10" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#altre-letture-7"><i class="fa fa-check"></i><b>8.10</b> Altre letture</a></li>
<li class="chapter" data-level="8.11" data-path="verifica-dei-modelli.html"><a href="verifica-dei-modelli.html#esercizi-1"><i class="fa fa-check"></i><b>8.11</b> Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html"><i class="fa fa-check"></i><b>9</b> Combinazioni lineari/nonlineari dei parametri</a>
<ul>
<li class="chapter" data-level="9.1" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.1-determinare-leffetto-medio-degli-erbicidi"><i class="fa fa-check"></i><b>9.1</b> Esempio 9.1: Determinare l’effetto medio degli erbicidi</a></li>
<li class="chapter" data-level="9.2" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.2-determinare-lefficiacia-erbicida-media"><i class="fa fa-check"></i><b>9.2</b> Esempio 9.2: Determinare l’efficiacia erbicida media</a></li>
<li class="chapter" data-level="9.3" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#combinazioni-di-interesse-generale"><i class="fa fa-check"></i><b>9.3</b> Combinazioni di interesse generale</a></li>
<li class="chapter" data-level="9.4" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#example-9.4-contrasti-ortogonali-e-non"><i class="fa fa-check"></i><b>9.4</b> Example 9.4: Contrasti ortogonali (e non)</a></li>
<li class="chapter" data-level="9.5" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.5-i-confronti-multipli-a-coppie"><i class="fa fa-check"></i><b>9.5</b> Esempio 9.5: I confronti multipli a coppie</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#display-a-lettere"><i class="fa fa-check"></i><b>9.5.1</b> Display a lettere</a></li>
<li class="chapter" data-level="9.5.2" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#correzione-per-la-molteplicità"><i class="fa fa-check"></i><b>9.5.2</b> Correzione per la molteplicità</a></li>
<li class="chapter" data-level="9.5.3" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#procedure-classiche-di-confronto-multiplo"><i class="fa fa-check"></i><b>9.5.3</b> Procedure ‘classiche’ di confronto multiplo</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.6-confronti-multipli-con-dati-trasformati"><i class="fa fa-check"></i><b>9.6</b> Esempio 9.6: confronti multipli con dati trasformati</a></li>
<li class="chapter" data-level="9.7" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esempio-9.7-previsioni-e-previsioni-inverse"><i class="fa fa-check"></i><b>9.7</b> Esempio 9.7: Previsioni e previsioni inverse</a></li>
<li class="chapter" data-level="9.8" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#altre-letture-8"><i class="fa fa-check"></i><b>9.8</b> Altre letture</a></li>
<li class="chapter" data-level="9.9" data-path="combinazioni-linearinonlineari-dei-parametri.html"><a href="combinazioni-linearinonlineari-dei-parametri.html#esercizi-2"><i class="fa fa-check"></i><b>9.9</b> Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html"><i class="fa fa-check"></i><b>10</b> Ricomponiamo il ‘puzzle’</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esempio-10.1-confronto-tra-erbicidi-in-un-esperimento-a-blocchi-randomizzati"><i class="fa fa-check"></i><b>10.1</b> Esempio 10.1: Confronto tra erbicidi in un esperimento a blocchi randomizzati</a></li>
<li class="chapter" data-level="10.2" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esempio-10.2-confronto-tra-co-adiuvanti-in-un-esperimento-a-quadrato-latino"><i class="fa fa-check"></i><b>10.2</b> Esempio 10.2: confronto tra co-adiuvanti in un esperimento a quadrato latino</a></li>
<li class="chapter" data-level="10.3" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esempio-10.3-interazione-tra-genotipo-e-concimazione-azotata"><i class="fa fa-check"></i><b>10.3</b> Esempio 10.3: interazione tra genotipo e concimazione azotata</a></li>
<li class="chapter" data-level="10.4" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esempio-10.4-confronto-tra-incroci-in-un-disegno-fattoriale-gerarchico"><i class="fa fa-check"></i><b>10.4</b> Esempio 10.4: confronto tra incroci in un disegno fattoriale gerarchico</a></li>
<li class="chapter" data-level="10.5" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esempio-10.5-un-esperimento-di-germinazione-ripetuto-due-volte"><i class="fa fa-check"></i><b>10.5</b> Esempio 10.5: un esperimento di germinazione ripetuto due volte</a></li>
<li class="chapter" data-level="10.6" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#altre-letture-9"><i class="fa fa-check"></i><b>10.6</b> Altre letture</a></li>
<li class="chapter" data-level="10.7" data-path="ricomponiamo-il-puzzle.html"><a href="ricomponiamo-il-puzzle.html#esercizi-3"><i class="fa fa-check"></i><b>10.7</b> Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="modelli-di-regressione-avanzati.html"><a href="modelli-di-regressione-avanzati.html"><i class="fa fa-check"></i><b>11</b> Modelli di regressione ‘avanzati’</a></li>
<li class="chapter" data-level="12" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html"><i class="fa fa-check"></i><b>12</b> Breve introduzione ai modelli misti</a>
<ul>
<li class="chapter" data-level="12.1" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.1-un-esperimento-di-lavorazione-a-split-plot"><i class="fa fa-check"></i><b>12.1</b> Esempio 12.1: un esperimento di lavorazione a split-plot</a></li>
<li class="chapter" data-level="12.2" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.2-un-esperimento-di-recropping-a-strip-plot"><i class="fa fa-check"></i><b>12.2</b> Esempio 12.2: un esperimento di ‘recropping’ a strip-plot</a></li>
<li class="chapter" data-level="12.3" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.3-confronto-varietale-con-blocchi-random"><i class="fa fa-check"></i><b>12.3</b> Esempio 12.3: confronto varietale con blocchi ‘random’</a></li>
<li class="chapter" data-level="12.4" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.4-blocchi-randomizzati-con-sub-campionamento"><i class="fa fa-check"></i><b>12.4</b> Esempio 12.4: blocchi randomizzati con sub-campionamento</a></li>
<li class="chapter" data-level="12.5" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.5-confronto-varietale-ripetuto-in-più-anni"><i class="fa fa-check"></i><b>12.5</b> Esempio 12.5: confronto varietale ripetuto in più anni</a></li>
<li class="chapter" data-level="12.6" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#esempio-12.6-misure-ripetute-nelle-colture-poliennali"><i class="fa fa-check"></i><b>12.6</b> Esempio 12.6: misure ripetute nelle colture poliennali</a></li>
<li class="chapter" data-level="12.7" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#fattori-di-raggruppamento-nei-modelli-di-regressione"><i class="fa fa-check"></i><b>12.7</b> Fattori di raggruppamento nei modelli di regressione</a></li>
<li class="chapter" data-level="12.8" data-path="breve-introduzione-ai-modelli-misti.html"><a href="breve-introduzione-ai-modelli-misti.html#altre-letture-10"><i class="fa fa-check"></i><b>12.8</b> Altre letture</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html"><i class="fa fa-check"></i><b>13</b> Appendice A: Breve introduzione ad R</a>
<ul>
<li class="chapter" data-level="" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#cosa-è-r"><i class="fa fa-check"></i>Cosa è R?</a></li>
<li class="chapter" data-level="" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#installazione-di-r"><i class="fa fa-check"></i>Installazione di R</a></li>
<li class="chapter" data-level="13.1" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#prima-di-iniziare"><i class="fa fa-check"></i><b>13.1</b> Prima di iniziare</a></li>
<li class="chapter" data-level="13.2" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#oggetti-e-assegnazioni"><i class="fa fa-check"></i><b>13.2</b> Oggetti e assegnazioni</a></li>
<li class="chapter" data-level="13.3" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#tipi-di-oggetti"><i class="fa fa-check"></i><b>13.3</b> Tipi di oggetti</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#costanti-e-vettori"><i class="fa fa-check"></i><b>13.3.1</b> Costanti e vettori</a></li>
<li class="chapter" data-level="13.3.2" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#matrici"><i class="fa fa-check"></i><b>13.3.2</b> Matrici</a></li>
<li class="chapter" data-level="13.3.3" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#dataframe"><i class="fa fa-check"></i><b>13.3.3</b> Dataframe</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#lavorare-con-gli-oggetti"><i class="fa fa-check"></i><b>13.4</b> Lavorare con gli oggetti</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#visualizzazione"><i class="fa fa-check"></i><b>13.4.1</b> Visualizzazione</a></li>
<li class="chapter" data-level="13.4.2" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#indicizzazione"><i class="fa fa-check"></i><b>13.4.2</b> Indicizzazione</a></li>
<li class="chapter" data-level="13.4.3" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#estrazione-di-slots"><i class="fa fa-check"></i><b>13.4.3</b> Estrazione di <em>slots</em></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#espressioni-funzioni-e-argomenti"><i class="fa fa-check"></i><b>13.5</b> Espressioni, funzioni e argomenti</a></li>
<li class="chapter" data-level="13.6" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#funzioni-di-uso-comune"><i class="fa fa-check"></i><b>13.6</b> Funzioni di uso comune</a></li>
<li class="chapter" data-level="13.7" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#creazione-di-funzioni-personalizzate"><i class="fa fa-check"></i><b>13.7</b> Creazione di funzioni personalizzate</a></li>
<li class="chapter" data-level="13.8" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#uso-di-librerie-aggiuntive"><i class="fa fa-check"></i><b>13.8</b> Uso di librerie aggiuntive</a></li>
<li class="chapter" data-level="13.9" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#workspace"><i class="fa fa-check"></i><b>13.9</b> Workspace</a></li>
<li class="chapter" data-level="13.10" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#importare-dati-esterni"><i class="fa fa-check"></i><b>13.10</b> Importare dati esterni</a></li>
<li class="chapter" data-level="13.11" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#cenni-sulle-funzionalità-grafiche-in-r"><i class="fa fa-check"></i><b>13.11</b> Cenni sulle funzionalità grafiche in R</a></li>
<li class="chapter" data-level="13.12" data-path="appendice-a-breve-introduzione-ad-r.html"><a href="appendice-a-breve-introduzione-ad-r.html#altre-letture-11"><i class="fa fa-check"></i><b>13.12</b> Altre letture</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><i class="fa fa-check"></i><b>14</b> Appendice B: Statistica descrittiva per le variabili nominali</a>
<ul>
<li class="chapter" data-level="14.1" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#distribuzioni-di-frequenze-e-classamento"><i class="fa fa-check"></i><b>14.1</b> Distribuzioni di frequenze e classamento</a></li>
<li class="chapter" data-level="14.2" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#statistiche-descrittive-per-le-distribuzioni-di-frequenze"><i class="fa fa-check"></i><b>14.2</b> Statistiche descrittive per le distribuzioni di frequenze</a></li>
<li class="chapter" data-level="14.3" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#rappresentazione-grafica-delle-distribuzioni-di-frequenza"><i class="fa fa-check"></i><b>14.3</b> Rappresentazione grafica delle distribuzioni di frequenza</a></li>
<li class="chapter" data-level="14.4" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#distribuzioni-di-frequenza-bivariate-le-tabelle-di-contingenze"><i class="fa fa-check"></i><b>14.4</b> Distribuzioni di frequenza bivariate: le tabelle di contingenze</a></li>
<li class="chapter" data-level="14.5" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#connessione"><i class="fa fa-check"></i><b>14.5</b> Connessione</a></li>
<li class="chapter" data-level="14.6" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#il-chi-quadro-con-r"><i class="fa fa-check"></i><b>14.6</b> Il chi quadro con R</a></li>
<li class="chapter" data-level="14.7" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#altre-letture-12"><i class="fa fa-check"></i><b>14.7</b> Altre letture</a></li>
<li class="chapter" data-level="14.8" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#esercizi-4"><i class="fa fa-check"></i><b>14.8</b> Esercizi</a></li>
<li class="chapter" data-level="14.9" data-path="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html"><a href="appendice-b-statistica-descrittiva-per-le-variabili-nominali.html#soluzioni-1"><i class="fa fa-check"></i><b>14.9</b> Soluzioni</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="appendice-c-intervalli-di-confidenza-per-una-proporzione.html"><a href="appendice-c-intervalli-di-confidenza-per-una-proporzione.html"><i class="fa fa-check"></i><b>15</b> Appendice C: Intervalli di confidenza per una proporzione</a>
<ul>
<li class="chapter" data-level="15.1" data-path="appendice-c-intervalli-di-confidenza-per-una-proporzione.html"><a href="appendice-c-intervalli-di-confidenza-per-una-proporzione.html#popolazioni-gaussiane-e-non"><i class="fa fa-check"></i><b>15.1</b> Popolazioni gaussiane e non</a></li>
<li class="chapter" data-level="15.2" data-path="appendice-c-intervalli-di-confidenza-per-una-proporzione.html"><a href="appendice-c-intervalli-di-confidenza-per-una-proporzione.html#cosa-fare-se-il-teorema-centrale-del-limite-non-funziona"><i class="fa fa-check"></i><b>15.2</b> Cosa fare se il teorema centrale del limite non funziona?</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="appendice-e-confronto-di-due-proporzioni.html"><a href="appendice-e-confronto-di-due-proporzioni.html"><i class="fa fa-check"></i><b>16</b> Appendice E: Confronto di due proporzioni</a>
<ul>
<li class="chapter" data-level="16.1" data-path="appendice-e-confronto-di-due-proporzioni.html"><a href="appendice-e-confronto-di-due-proporzioni.html#il-test-di-chi-quadro"><i class="fa fa-check"></i><b>16.1</b> Il test di ‘chi quadro’</a></li>
<li class="chapter" data-level="16.2" data-path="appendice-e-confronto-di-due-proporzioni.html"><a href="appendice-e-confronto-di-due-proporzioni.html#confronto-tra-due-proporzioni-con-simulazione-di-monte-carlo"><i class="fa fa-check"></i><b>16.2</b> Confronto tra due proporzioni con simulazione di Monte Carlo</a></li>
<li class="chapter" data-level="16.3" data-path="appendice-e-confronto-di-due-proporzioni.html"><a href="appendice-e-confronto-di-due-proporzioni.html#esercizi-5"><i class="fa fa-check"></i><b>16.3</b> Esercizi</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="appendice-f-alcuni-problemi-collegati-con-le-deviazioni-rispetti-agli-assunti-di-base.html"><a href="appendice-f-alcuni-problemi-collegati-con-le-deviazioni-rispetti-agli-assunti-di-base.html"><i class="fa fa-check"></i><b>17</b> Appendice F: Alcuni problemi collegati con le deviazioni rispetti agli assunti di base</a></li>
<li class="divider"></li>
<li><strong><a href="https://www.statforbiology.com">Back to blog</a></strong></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Metodologia sperimentale per le scienze agrarie</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="le-relazioni-causa-effetto" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Capitolo 4</span> Le relazioni causa-effetto<a href="le-relazioni-causa-effetto.html#le-relazioni-causa-effetto" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Nel capitolo precedente abbiamo visto come possiamo utilizzare semplici statistiche per descrivere alcuni tratti dei nostri dati sperimentali, come la tendenza centrale e la dispersione e, se abbiamo due o più variabili, abbiamo visto come possiamo descrivere la loro variabilità congiunta. Nel lavoro di ricerca, la relazione tra variabili più importante è la cosiddetta <strong>causalità</strong>, che si verifica ogni volta che una variabile (solitamente denominata “predittore”) provoca un cambiamento in un’altra variabile (solitamente denominata “risposta”); ad esempio, una variazione del genotipo può causare un cambiamento nella resa del frumento, oppure una variazione nella tecnica di lavorazione può causare un cambiamento nel tempo di emergenza del mais. Questo effetto diretto del predittore sulla risposta (e non viceversa) è ciò che rende la causalità diversa, ad esempio, dalla correlazione, che implica solo variazione congiunta, senza una chiara distinzione tra predittore e risposta, cioè tra la causa e l’effetto.</p>
<p>Gli esperimenti controllati, replicati e randomizzati sono particolarmente adatti a stabilire relazioni causa-effetto; infatti, la probabilità di effetti confondenti è ridotta al minimo, così che le discrepanze tra le unità osservate sottoposte a trattamenti diversi possono essere ragionevolmente attribuite all’effetto di tali trattamenti sperimentali e non ad altre cause sistematiche, ma ignote.</p>
<div id="modelli-matematici-e-statistici" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Modelli matematici e statistici<a href="le-relazioni-causa-effetto.html#modelli-matematici-e-statistici" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Per descrivere le relazioni causali, possiamo utilizzare i <strong>modelli statistici</strong>, cioè delle equazioni in cui le osservazioni sperimentali sono prodotte come risultato dell’effetto di uno o più predittori.</p>
<p>In effetti, questo approccio alla scienza è fondato sull’eredità galileiana, che ci porta ad immaginare che il funzionamento della natura sia descrivibile utilizzando il linguaggio universale della matematica. In effetti era proprio questa l’ambizione più grande degli scienziati all’inizio dell’ottocento: conoscendo lo stato iniziale di un sistema, doveva essere possibile prevederne con precisione l’evoluzione futura. Laplace diceva: <em>“Possiamo considerare lo stato attuale dell’universo come l’effetto del suo passato e la causa del suo futuro. Un intelletto che ad un determinato istante dovesse conoscere tutte le forze che mettono in moto la natura, e tutte le posizioni di tutti gli oggetti di cui la natura è composta, se questo intelletto fosse inoltre sufficientemente ampio da sottoporre questi dati ad analisi, esso racchiuderebbe in un’unica formula i movimenti dei corpi più grandi dell’universo e quelli degli atomi più piccoli; per un tale intelletto nulla sarebbe incerto ed il futuro proprio come il passato sarebbe evidente davanti ai suoi occhi”</em>. In realtà si è ben presto scoperto che si trattava di un’ambizione irrealistica, non tanto e non solo per la comparsa della meccanica quantistica un secolo dopo, ma anche per l’aumento di importanza degli studi in ambito psichiatrico e medico/biologico. Questi studi, infatti, venivano (e vengono) eseguiti su organismi viventi molto complessi, che, se sottoposti allo stesso stimolo, davano (e danno) risposte altamente variabili e, spesso, anche difficilmente misurabili e controllabili.</p>
<p>Queste difficoltà fecero prevalere, tra i biologi, la convinzione che la natura funzionasse in base a meccanismi deterministici ben definiti, anche se difficilmente osservabili nella pratica sperimentale, a causa dei numerosi elementi d’incertezza che si manifestavano nel corso delle osservazioni sperimentali. Insomma, la natura è perfetta, ma l’osservazione è fallace, perché influenzata dalla presenza di una forte componente stocastica ed imprevedibile, che va sotto il nome generico di errore sperimentale. Di questo abbiamo già parlato nei capitoli precedenti. Abbiamo anche visto che Ronald Fisher, nel suo famoso testo “Il disegno degli esperimenti” ha posto le basi per una corretta metodica sperimentale, finalizzata a minimizzare l’impatto della componente stocastica e, soprattutto, ad impedire che essa si confondesse con gli effetti degli stimoli sperimentali in studio.</p>
<p>Minimizzare, tuttavia, non significa eliminare ed è evidente che, pur con tutti gli sforzi possibili, è impossibile evitare che i risultati sperimentali siano influenzati, sempre e comunque, da una certa quota di variabilità stocastica. Si vengono quindi a creare due contrapposte situazioni:</p>
<ol style="list-style-type: decimal">
<li>la verità ‘vera’, immanente, che ‘agisce’ in base a meccanismi deterministici causa-effetto ben definiti.</li>
<li>La ‘verità’ sperimentale, che si produce a partire dalla verità ‘vera’, per effetto dell’azione di elementi perturbativi casuali, che non ci permettono di osservare la verità ‘vera’.</li>
</ol>
<p>Di conseguenza, la descrizione di qualunque risultato sperimentale non può essere realistica se non utilizzando un modello in grado di considerare contemporaneamente sia i nessi causa-effetto, che le altre forze ignote e, almeno apparentemente, di natura stocastica. I modelli matematici che incorporano anche effetti di natura casuale sono detti modelli statistici.</p>
</div>
<div id="componenti-di-un-modello" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Componenti di un modello<a href="le-relazioni-causa-effetto.html#componenti-di-un-modello" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In semplice linguaggio algebrico, possiamo scrivere un modello causa-effetto utilizzando un’a funzione’equazione generale come la seguente:</p>
<p><span class="math display">\[ Y_E = f(X, \theta)\]</span></p>
<p>dove <span class="math inline">\(Y_E\)</span> è l’effetto atteso dello stimolo <span class="math inline">\(X\)</span>, secondo la funzione <span class="math inline">\(f\)</span>, basata su una collezioni di parametri <span class="math inline">\(\theta\)</span></p>
<p>Le componenti di questo modello sono la risposta attesa (<span class="math inline">\(Y_E\)</span>) che è l’oggetto del nostro studio e può assumere le forme più disparate: spesso è numerica, ma a volte rappresenta una qualità. In questo libro consideremo solo la situazione in cui <span class="math inline">\(Y_E\)</span> è rappresentato da una sola variabile (analisi univariata), ma esistono casi in cui viene osservata ed analizzata la risposta di soggetti in relazione a molte variabili (analisi multivariata).</p>
<p>Lo stimolo sperimentale (<span class="math inline">\(X\)</span>) è costituito da una o più variabili continue, discrete o categoriche (predittori), che rappresentano i trattamenti sperimentali. Insieme ad <span class="math inline">\(Y_E\)</span>, <span class="math inline">\(X\)</span> è l’elemento noto di un esperimento, in quanto viene definito <em>a priori</em> in fase di progettazione.</p>
<p>La ‘funzione’ di risposta (<span class="math inline">\(f\)</span>) è un’equazione, lineare o non-lineare, scelta in base a considerazioni di carattere biologico, o con un approccio puramente empirico, osservando l’andamento della curva di risposta.</p>
<p>I parametri di una funzione (<span class="math inline">\(\theta\)</span>) sono un insieme di valori numerici che permettono di definire l’equazione di risposta.</p>
<p>Il predittore può essere rappresentato da una dose; ad esempio un aumento della dose di una sostanza erbicida provoca una diminuzione della crescita delle erbe infestanti. In questo caso usiamo il termine modello dose-risposta, che è forse uno dei modelli più famosi e risale a Paracelso (1493-1541), che coniò la sua famosa massima “<em>Cosa c’è che non sia veleno? Tutte le cose sono veleno e nulla è senza veleno. Soltanto la dose determina che una cosa non è un veleno</em>”.</p>
<p>Il modello sovrastante, in accordo con la logica galileiana, postula che un fenomeno naturale segua una legge ben definita. Tuttavia, la realtà è più complessa delle nostre aspettative e, a causa di errori sperimentali e altri effetti di natura puramente casuale, non osserviamo mai il risultato atteso <span class="math inline">\(Y_E\)</span>, ma osserviamo un valore diverso <span class="math inline">\(Y_O \neq Y_E\)</span>. Dobbiamo quindi ampliare il modello aggiungendo la componente stocastica <span class="math inline">\(\varepsilon\)</span>:</p>
<p><span class="math display">\[ Y_O = f(X, \theta) + \varepsilon\]</span></p>
<p>cioè il cosiddetto ‘residuo’, la discrepanza tra ciò che prevede il modello e ciò che effettivamente osserviamo:</p>
<p><span class="math display">\[\varepsilon = Y_O - Y_E \]</span></p>
<p>In un esperimento con <span class="math inline">\(n\)</span> unità sperimentali, abbiamo <span class="math inline">\(n\)</span> residui, con media pari a 0 e deviazione standard pari a <span class="math inline">\(\sigma\)</span> (Root Mean Squared Error, ovvero l’RMSE o <span class="math inline">\(\sigma\)</span>). In parole povere, <strong>i residui misurano quanto “cattivo” è il modello: più alti sono i residui, peggiore è la capacità del modello di descrivere una certa relazione causa-effetto</strong>.</p>
</div>
<div id="fitting-di-un-modello" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> <em>Fitting</em> di un modello<a href="le-relazioni-causa-effetto.html#fitting-di-un-modello" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nella ricerca, possiamo utilizzare i modelli per capire se due o più variabili sperimentali sono in una relazione causa-effetto tra di loro. Il nostro lavoro consisterà nel:</p>
<ol style="list-style-type: decimal">
<li>definire un modello un modello statistico potenzialmente capace di descrivere adeguatamente le relazioni causa-effetto in studio. In altre parole si potrebbe dire che lo sforzo è quello di tradurre un’ipotesi scientifica in un modello statistico, per verificare se il modello è supportato dai dati, così come l’ipotesi scientifica di cui esso è la ‘traduzione’. Questo modello sarà posto nella sua forma generale e sarà basato su una serie di parametri dal valore ignoto (<span class="math inline">\(\theta\)</span> e <span class="math inline">\(\sigma\)</span>).</li>
<li>Eseguire l’esperimento e raccogliere i dati;</li>
<li>utilizzare il set di dati per assegnare valori precisi a tutti i parametri ignoti (<strong>fitting del modello</strong> o, in alcune applicazioni, <strong>calibrazione del modello</strong>);</li>
<li>valutare se il modello parametrizzato fornisca una descrizione accurata dei dati sperimentali (<strong>valutazione del modello</strong>);</li>
<li>se necessario, selezionare il modello migliore tra tutti quelli quelli possibili (<strong>confronto dei modelli</strong>).</li>
</ol>
<p>Il fitting del modello viene solitamente eseguito dall’algoritmo dei “minimi quadrati”, che consiste nel selezionare i valori dei parametri che minimizzano la somma dei residui al quadrato:</p>
<p><span class="math display">\[RSS = \sum_{i = 1}^n{\left( Y_{O_i} - Y_{E_i} \right)^2}\]</span></p>
<p>In generale, la minimizzazione dei quadrati dei residui non viene eseguita mediante calcoli manuali, in quanto è molto più semplice avvalersi delle funzioni di adattamento più adatte in R. In particolare, per i modelli lineari utilizzeremo la funzione <code>lm()</code>, secondo la seguente sintassi:</p>
<pre><code>mod &lt;- lm(Y ~ X dati = set di dati)</code></pre>
<p>Il primo argomento è l’equazione che vogliamo adattare: sul lato sinistro dobbiamo specificare il nome della variabile di risposta, la ‘tilde’ (~) significa ‘è una funzione di’ e sostituisce il segno ‘=’, mentre, sul lato destro, dobbiamo specificare il nome del/i predittore/i. Come secondo argomento, se necessario, forniamo il nome del dataset in cui sono archiviate le variabili. Non dobbiamo specificare l’intercetta e il termine stocastico <span class="math inline">\(\varepsilon\)</span>, che sono inclusi per impostazione predefinita. C’è inoltre da tenere presente che, prima dell’analisi, ogni volta che vogliamo utilizzare una variabile numerica come fattore, dovremmo eseguire esplicitamente questa trasformazione utilizzando la funzionottenere risultati sbagliati (come vedremo nei capitoli seguenti).</p>
<p>Un modello causa-effetto completamente specificato può fornire una buona descrizione dei dati sperimentali, <strong>postulando l’esistenza di un meccanismo causa-effetto che produce i risultati sperimentali</strong>. Con la dovuta prudenza, questo modello può essere utilizzato per fare previsioni; ad esempio, il modello precedente suggerisce che una fertilizzazione con azoto di 150 kg/ha dovrebbe, prevedibilmente, dare come risultato un livello di resa <span class="math inline">\(Y_E = 65\)</span> quintali per ettaro.</p>
</div>
<div id="esempio-1-il-modello-della-media" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Esempio 1: il ‘modello della media’<a href="le-relazioni-causa-effetto.html#esempio-1-il-modello-della-media" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Abbiamo condotto un esperimento misurativo, in cui abbiamo raccolto tre campioni di acqua da un pozzo, per misurare la concentrazione di una sostanza xenobiotica. I risultati sono 116, 119, 125 mg/L e vogliamo calcolare la media e la deviazione standard dei tre campioni.</p>
<p>Questo problema è piuttosto semplice e potrebbe essere meglio risolto utilizzando semplici statistiche descrittive (vedi Capitolo 3); tuttavia, è interessante vedere come lo stesso problema può essere risolto con un’operazione di ‘model fitting’: non abbiamo alcun predittore e, pertanto, possiamo supporre che le osservazioni siano generate in base al modello della media, che abbiamo mostrato in precedenza (<span class="math inline">\(Y_i = \mu + \varepsilon_i\)</span>).</p>
<p>Assegnare un valore a tutti i parametri sconosciuti è banale, utilizzando i semplici calcoli mostrati nel Capitolo 3 (vale a dire, <span class="math inline">\(\mu = 120\)</span> e <span class="math inline">\(\sigma = 4.58\)</span>). Tuttavia, possiamo ottenere gli stessi risultati utilizzando l’approccio di minimizzazione dei minimi quadrati, come mostrato nel riquadro seguente. Si noti che utilizziamo ‘1’ come lato destro dell’equazione del modello, poiché non abbiamo alcun predittore.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="le-relazioni-causa-effetto.html#cb12-1" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">116</span>, <span class="dv">119</span>, <span class="dv">125</span>)</span>
<span id="cb12-2"><a href="le-relazioni-causa-effetto.html#cb12-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> <span class="dv">1</span>)</span></code></pre></div>
<p>La stima di <span class="math inline">\(\mu\)</span> può essere ottenuta con la seguente funzione R:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="le-relazioni-causa-effetto.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod)</span>
<span id="cb13-2"><a href="le-relazioni-causa-effetto.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) </span></span>
<span id="cb13-3"><a href="le-relazioni-causa-effetto.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="do">##         120</span></span></code></pre></div>
<p>Per quanto riguarda la componente stocastica, possiamo ottenere i residui, la loro devianza e la loro deviazione standard con le seguenti funzioni R:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="le-relazioni-causa-effetto.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residui</span></span>
<span id="cb14-2"><a href="le-relazioni-causa-effetto.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(mod)</span>
<span id="cb14-3"><a href="le-relazioni-causa-effetto.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  1  2  3 </span></span>
<span id="cb14-4"><a href="le-relazioni-causa-effetto.html#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="do">## -4 -1  5</span></span>
<span id="cb14-5"><a href="le-relazioni-causa-effetto.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb14-6"><a href="le-relazioni-causa-effetto.html#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Devianza dei residui</span></span>
<span id="cb14-7"><a href="le-relazioni-causa-effetto.html#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(mod)</span>
<span id="cb14-8"><a href="le-relazioni-causa-effetto.html#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 42</span></span>
<span id="cb14-9"><a href="le-relazioni-causa-effetto.html#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb14-10"><a href="le-relazioni-causa-effetto.html#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Deviazione standard dei residui</span></span>
<span id="cb14-11"><a href="le-relazioni-causa-effetto.html#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)<span class="sc">$</span>sigma</span>
<span id="cb14-12"><a href="le-relazioni-causa-effetto.html#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 4.582576</span></span></code></pre></div>
<p>Il modello della media descrive una situazione in cui non abbiamo predittori e, pertanto, non vi sono nessi causa-effetto; di conseguwnza, è il peggior modello possibile, il punto di riferimento rispetto al quale valutare ogni altro modello alternativo. Per queste sue caratteristiche, il modello della media è spesso definito come <strong>modello nullo</strong>.</p>
</div>
<div id="esempio-2-un-predittore-quantitativo" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Esempio 2: un predittore quantitativo<a href="le-relazioni-causa-effetto.html#esempio-2-un-predittore-quantitativo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>L’algoritmo dei minimi quadrati è facile da comprendere se consideriamo un’indagine in cui la resa del mais (in q/ha) è stata determinata, come conseguenza della copertura delle erbacce, all’inizio del ciclo colturale. In una situazione del genere, potremmo aspettarci una relazione causa-effetto, in cui la copertura delle erbacce è il predittore e la resa è la risposta, secondo la funzione lineare (linea retta) <span class="math inline">\(Y_i = b_0 + b_1 \, Xx_i + \varepsilon_i\)</span>, che è solitamente nota come <strong>modello di regressione semplice</strong>.</p>
<p>I due parametri <span class="math inline">\(b_0\)</span> e <span class="math inline">\(b_1\)</span> rappresentano, rispettivamente, l’intercetta (livello di resa senza erbacce) e la pendenza (variazione della resa per un aumento di 1 unità nella copertura delle erbacce). Per stimare questi due valori, possiamo usare la funzione ‘lm()’ (riquadro codice 4.2), che produce i risultati mostrati nella Figura <a href="le-relazioni-causa-effetto.html#fig:figName41a">4.1</a>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="le-relazioni-causa-effetto.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Code box 4.2</span></span>
<span id="cb15-2"><a href="le-relazioni-causa-effetto.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting a simple linear regression model</span></span>
<span id="cb15-3"><a href="le-relazioni-causa-effetto.html#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="le-relazioni-causa-effetto.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Entering the data</span></span>
<span id="cb15-5"><a href="le-relazioni-causa-effetto.html#cb15-5" aria-hidden="true" tabindex="-1"></a>yield <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">29.8</span>, <span class="fl">88.9</span>, <span class="fl">47.0</span>, <span class="fl">96.6</span>, <span class="fl">83.0</span>, <span class="fl">95.3</span>, <span class="fl">91.5</span>, <span class="fl">97.9</span>, </span>
<span id="cb15-6"><a href="le-relazioni-causa-effetto.html#cb15-6" aria-hidden="true" tabindex="-1"></a>           <span class="fl">89.2</span>, <span class="fl">88.3</span>, <span class="fl">96.9</span>, <span class="fl">93.9</span>, <span class="fl">84.6</span>, <span class="fl">51.9</span>, <span class="fl">21.8</span>, <span class="fl">35.7</span>)</span>
<span id="cb15-7"><a href="le-relazioni-causa-effetto.html#cb15-7" aria-hidden="true" tabindex="-1"></a>weedCover <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">105.35</span>, <span class="fl">27.5</span>, <span class="fl">68.8</span>, <span class="fl">23.8</span>, <span class="fl">12.7</span>, <span class="fl">42.7</span>, <span class="fl">31.5</span>, </span>
<span id="cb15-8"><a href="le-relazioni-causa-effetto.html#cb15-8" aria-hidden="true" tabindex="-1"></a>               <span class="fl">37.8</span>, <span class="fl">18.9</span>, <span class="fl">35.8</span>, <span class="fl">44.5</span>, <span class="fl">11.4</span>, <span class="fl">31.6</span>, <span class="fl">87.9</span>, </span>
<span id="cb15-9"><a href="le-relazioni-causa-effetto.html#cb15-9" aria-hidden="true" tabindex="-1"></a>               <span class="fl">133.9</span>, <span class="fl">136.525</span>)</span>
<span id="cb15-10"><a href="le-relazioni-causa-effetto.html#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="le-relazioni-causa-effetto.html#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting the model</span></span>
<span id="cb15-12"><a href="le-relazioni-causa-effetto.html#cb15-12" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> weedCover)</span>
<span id="cb15-13"><a href="le-relazioni-causa-effetto.html#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="le-relazioni-causa-effetto.html#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspecting the estimates</span></span>
<span id="cb15-15"><a href="le-relazioni-causa-effetto.html#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod)</span>
<span id="cb15-16"><a href="le-relazioni-causa-effetto.html#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)   weedCover </span></span>
<span id="cb15-17"><a href="le-relazioni-causa-effetto.html#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 106.5979798  -0.6033652</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:figName41a"></span>
<img src="_main_files/figure-html/figName41a-1.png" alt="Example 2: the least square estimate is represented by the straight line that passes as close as possible to the observed points." width="85%" />
<p class="caption">
Figura 4.1: Example 2: the least square estimate is represented by the straight line that passes as close as possible to the observed points.
</p>
</div>
</div>
<div id="esempio-3-un-predittore-nominale" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Esempio 3: un predittore nominale<a href="le-relazioni-causa-effetto.html#esempio-3-un-predittore-nominale" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Immaginiamo un esperimento sul campo per confrontare la resa di quattro genotipi di avena (denominati A, B, C e D), con un disegno completamente randomizzato con tre repliche. I risultati (in tonnellate per ettaro) sono mostrati nella Tabella <a href="le-relazioni-causa-effetto.html#tab:tabName4b1">4.1</a>.</p>
<table>
<caption><span id="tab:tabName4b1">Tabella 4.1: </span>Esempio di una dataset proveniente da una prova varietale a randomizzazione completa con quattro genotipi di avena (A, B, C and D) e tre repliche.</caption>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">4.5</td>
<td align="right">4.3</td>
<td align="right">4.8</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="right">3.9</td>
<td align="right">3.6</td>
<td align="right">4.0</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="right">3.9</td>
<td align="right">4.2</td>
<td align="right">4.3</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="right">4.6</td>
<td align="right">4.7</td>
<td align="right">5.0</td>
</tr>
</tbody>
</table>
<p>In questo esperimento, abbiamo una risposta quantitativa (la resa) e un fattore nominale (il genotipo) e la relazione causa-effetto tra queste due variabili può essere descritta con il modello seguente:</p>
<p><span class="math display">\[Y_i = \mu + \alpha_j + \varepsilon_i\]</span></p>
<p>Questo modello postula che ogni osservazione <span class="math inline">\(Y_i\)</span> derivi dal valore <span class="math inline">\(\mu\)</span> (la cosiddetta intercetta) più le quantità <span class="math inline">\(\alpha_j\)</span>, che dipendono dal genotipo <span class="math inline">\(j\)</span>, più gli effetti stocastici <span class="math inline">\(\varepsilon_i\)</span>, che sono specifici per ogni osservazione ed hanno media 0 e una deviazione standard pari a <span class="math inline">\(\sigma\)</span>.</p>
<p>Per comprendere il significato biologico di <span class="math inline">\(\mu\)</span> ed <span class="math inline">\(\alpha\)</span> dobbiamo entrare un po’ di più nei dettagli matematici. Consideriamo la prima osservazione <span class="math inline">\(Y_1 = 4.5\)</span>; dobbiamo stimare tre valori (<span class="math inline">\(\mu\)</span>, <span class="math inline">\(\alpha_1\)</span> e <span class="math inline">\(\varepsilon_1\)</span>) che, sommati, restituiscano questa osservazione. Chiaramente il problema è indeterminato, in quanto esistono infinite triplette di valori, che, sommate, restituiscono 4.5; pertanto è necessario imporre dei vincoli su alcuni parametri del modello (<strong>parametrizzazioni del modello</strong>). Un vincolo molto comune è <span class="math inline">\(\alpha_1 = 0\)</span> (<strong>vincolo sul trattamento</strong>):</p>
<p><span class="math display">\[\left\{ {\begin{array}{l}
\mu_1 = \mu + \alpha_1 = \mu + 0\\
\mu_2 = \mu + \alpha_2 \\
\mu_3 = \mu + \alpha_3 \\
\mu_4 = \mu + \alpha_4
\end{array}} \right.\]</span></p>
<p>Con tale vincolo, <span class="math inline">\(\mu\)</span> è la media del primo genotipo (in R: <strong>primo in ordine alfabetico</strong>), mentre <span class="math inline">\(\alpha_2\)</span>, <span class="math inline">\(\alpha_3\)</span> e <span class="math inline">\(\alpha_4\)</span> sono, rispettivamente, le differenze tra le medie del secondo, terzo e quarto genotipo,
rispetto al primo. In generale, con questa parametrizzazione, i parametri del modello sono medie o differenze tra medie.</p>
<p>Un altro possibile vincolo è <span class="math inline">\(\sum{\alpha_j} = 0\)</span> (vincolo sulla somma). Se prendiamo l’equazione precedente e sommiamo tutti i membri otteniamo:</p>
<p><span class="math display">\[\mu_1 + \mu_2 + \mu_3 + \mu_4 = 4 \mu + \sum{\alpha_j}\]</span></p>
<p>Imponendo il vincolo di somma a zero otteniamo:</p>
<p><span class="math display">\[\mu_1 + \mu_2 + \mu_3 + \mu_4 = 4 \mu\]</span></p>
<p>e quindi a:</p>
<p><span class="math display">\[\mu = \frac{\mu_1 + \mu_2 + \mu_3 + \mu_4}{4}\]</span></p>
<p>Con questa parametrizzazione <span class="math inline">\(\mu\)</span> è la media generale dei dati, mentre i valori <span class="math inline">\(\alpha_j\)</span> rappresentano le differenze tra le medie dei trattamenti e la media generale (<strong>effetti dei trattamenti</strong>): valori <span class="math inline">\(\alpha\)</span> positivi ed elevati identificano i genotipi superiori alla media, mentre valori <span class="math inline">\(\alpha\)</span> elevati, ma negativi identificano i genotipi inferiori alla media. In generale, con questa parametrizzazione, i parametri del modello rappresentano medie ed effetti.</p>
<p>Un terzo possibile vincolo si ottiene rimuovendo l’intercetta (ovvero, imponendo che <span class="math inline">\(\mu = 0\)</span>). In questo caso, i valori di <span class="math inline">\(\alpha_j\)</span> saranno le medie dei genotipi ed il modello riduce a:</p>
<p><span class="math display">\[Y_i = \mu_j + \varepsilon_i\]</span></p>
<p>La selezione dei vincoli spetta all’utente, a seconda degli obiettivi dell’esperimento. <strong>In R, il vincolo del trattamento è utilizzato di default</strong>, sebbene gli altri vincoli possano essere facilmente ottenuti, utilizzando la codifica appropriata.</p>
<p>La stima dei parametri del modello potrebbe essere facilmente eseguita a mano, ma noi utilizziamo la funzione ‘lm()’ in R.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="le-relazioni-causa-effetto.html#cb16-1" aria-hidden="true" tabindex="-1"></a>Yield <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">4.3</span>, <span class="fl">4.8</span>,</span>
<span id="cb16-2"><a href="le-relazioni-causa-effetto.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fl">3.9</span>, <span class="fl">3.6</span>, <span class="fl">4.0</span>,</span>
<span id="cb16-3"><a href="le-relazioni-causa-effetto.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fl">3.9</span>, <span class="fl">4.2</span>, <span class="fl">4.3</span>,</span>
<span id="cb16-4"><a href="le-relazioni-causa-effetto.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fl">4.6</span>, <span class="fl">4.7</span>, <span class="fl">5.0</span>)</span>
<span id="cb16-5"><a href="le-relazioni-causa-effetto.html#cb16-5" aria-hidden="true" tabindex="-1"></a>Genotype <span class="ot">&lt;-</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">each =</span> <span class="dv">3</span>)</span>
<span id="cb16-6"><a href="le-relazioni-causa-effetto.html#cb16-6" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Genotype)</span></code></pre></div>
<p>I parametri stimati, i residui, la deviazione residua e la deviazione standard possono essere ottenuti con la solita codifica:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="le-relazioni-causa-effetto.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stima dei parametri</span></span>
<span id="cb17-2"><a href="le-relazioni-causa-effetto.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod)</span>
<span id="cb17-3"><a href="le-relazioni-causa-effetto.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)   GenotypeB   GenotypeC   GenotypeD </span></span>
<span id="cb17-4"><a href="le-relazioni-causa-effetto.html#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   4.5333333  -0.7000000  -0.4000000   0.2333333</span></span>
<span id="cb17-5"><a href="le-relazioni-causa-effetto.html#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-6"><a href="le-relazioni-causa-effetto.html#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Residui</span></span>
<span id="cb17-7"><a href="le-relazioni-causa-effetto.html#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(mod)</span>
<span id="cb17-8"><a href="le-relazioni-causa-effetto.html#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="do">##           1           2           3           4           5 </span></span>
<span id="cb17-9"><a href="le-relazioni-causa-effetto.html#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.03333333 -0.23333333  0.26666667  0.06666667 -0.23333333 </span></span>
<span id="cb17-10"><a href="le-relazioni-causa-effetto.html#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="do">##           6           7           8           9          10 </span></span>
<span id="cb17-11"><a href="le-relazioni-causa-effetto.html#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  0.16666667 -0.23333333  0.06666667  0.16666667 -0.16666667 </span></span>
<span id="cb17-12"><a href="le-relazioni-causa-effetto.html#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="do">##          11          12 </span></span>
<span id="cb17-13"><a href="le-relazioni-causa-effetto.html#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.06666667  0.23333333</span></span>
<span id="cb17-14"><a href="le-relazioni-causa-effetto.html#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-15"><a href="le-relazioni-causa-effetto.html#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Devianza dei residui</span></span>
<span id="cb17-16"><a href="le-relazioni-causa-effetto.html#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(mod)</span>
<span id="cb17-17"><a href="le-relazioni-causa-effetto.html#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.3866667</span></span>
<span id="cb17-18"><a href="le-relazioni-causa-effetto.html#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-19"><a href="le-relazioni-causa-effetto.html#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Deviazione standard del residui (RMSE)</span></span>
<span id="cb17-20"><a href="le-relazioni-causa-effetto.html#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)<span class="sc">$</span>sigma</span>
<span id="cb17-21"><a href="le-relazioni-causa-effetto.html#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.2198484</span></span></code></pre></div>
<p>Ora che il modello è completamente specificato, abbiamo tutti gli ingredienti per descrivere le 12 osservazioni, sommando <span class="math inline">\(\mu + \alpha_j + \varepsilon_i\)</span>; ad esempio, per la prima osservazione, appartenente al primo genotipo, abbiamo:</p>
<p><span class="math display">\[y_1 = 4.5 = 4.533 + 0 - 0.033\]</span>
mentre, per la quarta osservazione, appartenente al 2° genotipo, abbiamo:</p>
<p><span class="math display">\[y_4 = 3.9 = 4.533 - 0.7 + 0.067\]</span></p>
<p>Per completezza, potrebbe essere utile mostrare che, in R, possiamo modificare la parametrizzazione, impostando l’argomento ‘contrasts’ e passando un elenco di fattori associati alla parametrizzazione richiesta. Ad esempio, se utilizziamo <code>Treat = "contr.sum"</code>, otteniamo il vincolo sulla somma; di conseguenza, l’effetto dell’ultimo genotipo non è mostrato, perché è vincolato ad eseere l’opposto della somma degli altri tre effetti.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="le-relazioni-causa-effetto.html#cb18-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Genotype,</span>
<span id="cb18-2"><a href="le-relazioni-causa-effetto.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">Genotype =</span> <span class="st">&quot;contr.sum&quot;</span>))</span>
<span id="cb18-3"><a href="le-relazioni-causa-effetto.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod2)</span>
<span id="cb18-4"><a href="le-relazioni-causa-effetto.html#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)   Genotype1   Genotype2   Genotype3 </span></span>
<span id="cb18-5"><a href="le-relazioni-causa-effetto.html#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   4.3166667   0.2166667  -0.4833333  -0.1833333</span></span></code></pre></div>
<p>Un’altra possibile parametrizzazione consiste nel rimuovere l’intercetta, che è possibile utilizzando <code>-1</code> sul lato destro dell’espressione, come mostrato di seguito.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="le-relazioni-causa-effetto.html#cb19-1" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Genotype <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb19-2"><a href="le-relazioni-causa-effetto.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod3)</span>
<span id="cb19-3"><a href="le-relazioni-causa-effetto.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="do">## GenotypeA GenotypeB GenotypeC GenotypeD </span></span>
<span id="cb19-4"><a href="le-relazioni-causa-effetto.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  4.533333  3.833333  4.133333  4.766667</span></span></code></pre></div>
<p>Esistono diversi altri metodi per modificare la parametrizzazione, sia globalmente (per l’intera sessione R) sia a livello di fattore; ulteriori informazioni sono disponibili in letteratura.</p>
</div>
<div id="lanalisi-della-varianza-anova" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> L’analisi della varianza (ANOVA)<a href="le-relazioni-causa-effetto.html#lanalisi-della-varianza-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In questo secondo esempio abbiamo descritto una relazione causa-effetto, tramite un modello contenente un predittore. L’RMSE (<span class="math inline">\(\sigma\)</span>) è uguale a 0.220, ma questa non è una buona metrica per capire se la relazione causa-effetto è rilevante o meno. Una possibilità è quella di dividere l’RMSE per la media dei valori osservati, per ottenere il coefficiente di variabilità (RRMSE: Relative Root Mean Squared Error), che è 0.051 (o 5.1%), il che indica che l’errore residuo è piuttosto piccolo, rispetto al valore medio atteso.</p>
<p>Un altro indicatore per descrivere la bontà della relazione causa-effetto definita dal modello è il cosiddetto <strong>coefficiente di determinazione (R<sup>2</sup>)</strong>, ottenuto sottraendo da 1 il rapporto tra la devianza dei residui e la devianza totale delle osservazioni (che poi sarebbe la devianza dei residui del modello nullo). Nel nostro caso, il modello nullo è ottenuto trascurando l’effetto del genotipo e la devianza dei residui è quella indicata nel box sottostante:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="le-relazioni-causa-effetto.html#cb20-1" aria-hidden="true" tabindex="-1"></a>modnull <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb20-2"><a href="le-relazioni-causa-effetto.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(modnull)</span>
<span id="cb20-3"><a href="le-relazioni-causa-effetto.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.936667</span></span></code></pre></div>
<p>Il coefficiente di determinazione è quindi:</p>
<p><span class="math display">\[R^2 = 1 - \frac{SS_{res}}{SS_{tot}} = 1 - \frac{0.3866667}{1.936667} = 0.800\]</span></p>
<p>cosa che può essere verificata utilizzando il codice R:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="le-relazioni-causa-effetto.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb21-2"><a href="le-relazioni-causa-effetto.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.8003442</span></span></code></pre></div>
<p>Il coefficiente di determinazione varia da 0 ad 1, più è alto il valore tanto migliore è la bontà del modello.</p>
<p>Oltre a queste statistiche (RMSE, RRMSE e R<sup>2</sup>), vi è una tecnica famosissima per valutare l’entità dell’evidenza in favore dell’esistenza di una relazione causa effetto ben definita; questa tecnica si chiama <strong>Analisi della Varianza (ANOVA)</strong> ed è stata originariamente ideata da Ronald Fisher durante gli anni ’30 del XX secolo; oggi è ancora molto utilizzata, seppure in una forma leggermente diversa da quella originale.</p>
<p>Il principio di fondo è che, considerando un modello che contenga almeno un predittore, è sempre possibile associare allo stesso dataset un secondo modello ‘nullo’ (modello della media), ottenuto dal precedente per rimozione del predittore. Ad esempio, con riferimento all’esempio 2, abbiamo già visto che il modello ANOVA è:</p>
<pre><code>Yield ~ Genotype</code></pre>
<p>mentre il modello nullo è:</p>
<pre><code>Yield ~ 1</code></pre>
<p>Rimuovere l’effetto del genotipo dal modello npn può che indurre un incremento dei residui, dato che non si tiene più in considerazione il fatto che parte della differenza tra le osservazioni è dovuto al fatto che esse appartengono a genotipi di versi. Infatti, il codice sovrastante e sottostante mostrano che la devianza dei residui (RSS: Residual Sum of Squares) è pari a:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="le-relazioni-causa-effetto.html#cb24-1" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">residuals</span>(mod)</span>
<span id="cb24-2"><a href="le-relazioni-causa-effetto.html#cb24-2" aria-hidden="true" tabindex="-1"></a>RSS <span class="ot">&lt;-</span> <span class="fu">sum</span>(epsilon<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb24-3"><a href="le-relazioni-causa-effetto.html#cb24-3" aria-hidden="true" tabindex="-1"></a>RSS</span>
<span id="cb24-4"><a href="le-relazioni-causa-effetto.html#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.3866667</span></span></code></pre></div>
<p>mentre la devianza dei residui del modello nullo (pari alla devianza totale delle osservazioni), è pari a:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="le-relazioni-causa-effetto.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual deviance null model</span></span>
<span id="cb25-2"><a href="le-relazioni-causa-effetto.html#cb25-2" aria-hidden="true" tabindex="-1"></a>RSS.null <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(modnull)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb25-3"><a href="le-relazioni-causa-effetto.html#cb25-3" aria-hidden="true" tabindex="-1"></a>RSS.null</span>
<span id="cb25-4"><a href="le-relazioni-causa-effetto.html#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.936667</span></span></code></pre></div>
<p>Insomma, rimuovendo l’effetto del genotipo, il modello è ‘peggiorato’, con un incremento dei residui quantificabile come differenza:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="le-relazioni-causa-effetto.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contribution of genotype effect</span></span>
<span id="cb26-2"><a href="le-relazioni-causa-effetto.html#cb26-2" aria-hidden="true" tabindex="-1"></a>SS_g <span class="ot">&lt;-</span> RSS.null <span class="sc">-</span> RSS</span>
<span id="cb26-3"><a href="le-relazioni-causa-effetto.html#cb26-3" aria-hidden="true" tabindex="-1"></a>SS_g</span>
<span id="cb26-4"><a href="le-relazioni-causa-effetto.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.55</span></span></code></pre></div>
<p>È evidente che più è grande questa differenza, più è grande l’effetto del genotipo. In altre parole, abbiamo appena scomposto la devianza totale delle osservazioni (<span class="math inline">\(SS_{tot} = 1.937\)</span>) in due quote, una dovuta all’effetto causale del trattamento sperimentale (<span class="math inline">\(SS_g = 1.55\)</span>) e l’altra dovuta a tutti gli altri effetti ignoti di natura casuale (errore sperimentale: <span class="math inline">\(RSS = 0.387\)</span>). Questa seconda quota costituisce una specie di ‘rumore di fondo’, contro il quale si può valutare il ‘segnale’, cioè l’intensità dell’effetto del trattamento sperimentale.</p>
<p>Come abbiamo visto nel Capitolo 3, non possiamo confrontare direttamente <span class="math inline">\(SS_g\)</span> e <span class="math inline">\(RSS\)</span>, poiché queste due devianze hanno un diverso numero di gradi di libertà (DF); il numero di DF per il trattamento è uguale al numero dei suoi livelli meno uno (<span class="math inline">\(DF_g\)</span> = 3), mentre il numero di gradi di libertà per la devianza residua <span class="math inline">\(RSS\)</span> è <span class="math inline">\(p \times (k -1)\)</span>, dove <span class="math inline">\(p\)</span> è il numero di trattamenti e <span class="math inline">\(k\)</span> è il numero di repliche, supponendo che questo sia costante tra i trattamenti. Di conseguenza, <span class="math inline">\(DF_{RSS} = 4 \times (3 - 1) = 8\)</span>. Possiamo quindi calcolare le relative varianze (Qudrati Medi: MS) come segue:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="le-relazioni-causa-effetto.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianza del genotipo</span></span>
<span id="cb27-2"><a href="le-relazioni-causa-effetto.html#cb27-2" aria-hidden="true" tabindex="-1"></a>MS_g <span class="ot">&lt;-</span> SS_g<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb27-3"><a href="le-relazioni-causa-effetto.html#cb27-3" aria-hidden="true" tabindex="-1"></a>MS_g</span>
<span id="cb27-4"><a href="le-relazioni-causa-effetto.html#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.5166667</span></span>
<span id="cb27-5"><a href="le-relazioni-causa-effetto.html#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb27-6"><a href="le-relazioni-causa-effetto.html#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianza del residuo</span></span>
<span id="cb27-7"><a href="le-relazioni-causa-effetto.html#cb27-7" aria-hidden="true" tabindex="-1"></a>RMS <span class="ot">&lt;-</span> RSS<span class="sc">/</span><span class="dv">8</span></span>
<span id="cb27-8"><a href="le-relazioni-causa-effetto.html#cb27-8" aria-hidden="true" tabindex="-1"></a>RMS</span>
<span id="cb27-9"><a href="le-relazioni-causa-effetto.html#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.04833333</span></span></code></pre></div>
<p>Queste due varianze (trattamento e residuo) possono essere confrontate direttamente, utilizzando il cosiddetto rapporto F:</p>
<p><span class="math display">\[F = \frac{MS_g}{RMS} = \frac{0.517}{0.048} = 10.69\]</span></p>
<p>Il nome ‘rapporto F’ deriva da Fisher, che lo inventò. Mostra che la variabilità imposta dal trattamento sperimentale è più di 10 volte superiore alla variabilità dovuta al rumore di fondo (errore sperimentale), il che supporta l’idea che l’effetto causale del genotipo sulla resa sia molto rilevante. In termini generali, più alto è il rapporto F, più forte è il nesso causa-effetto. Possiamo riassumere questi risultati nella cosiddetta tabella ANOVA, che si ottiene facilmente utilizzando il metodo ‘anova()’ con R.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="le-relazioni-causa-effetto.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod)</span>
<span id="cb28-2"><a href="le-relazioni-causa-effetto.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb28-3"><a href="le-relazioni-causa-effetto.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-4"><a href="le-relazioni-causa-effetto.html#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: Yield</span></span>
<span id="cb28-5"><a href="le-relazioni-causa-effetto.html#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="do">##           Df  Sum Sq Mean Sq F value   Pr(&gt;F)   </span></span>
<span id="cb28-6"><a href="le-relazioni-causa-effetto.html#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype   3 1.55000 0.51667   10.69 0.003584 **</span></span>
<span id="cb28-7"><a href="le-relazioni-causa-effetto.html#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals  8 0.38667 0.04833                    </span></span>
<span id="cb28-8"><a href="le-relazioni-causa-effetto.html#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb28-9"><a href="le-relazioni-causa-effetto.html#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Rispetto a quanto esposto in precedenza, la tabella ottenuta con R contiene solo un valore che non abbiamo ancora spiegato, il cosidetto P-level, che si trova all’estrema destra (P = 0.003584). Si tratta di un indicatore inferenziale che sarà illustrato nei Capitoli seguenti anche se è opportuno dare ora indicazioni per la sua interpretazione. In dettaglio, più il P-level è basso, più è forte l’evidenza scientifica contro l’ipotesi ‘nulla’ che il trattamento sperimentale (in questo caso il genotipo) non abbia avuto alcun effetto sulla variabile risposta (produzione della coltura). Ancora più in dettaglio, se il P-level è inferiore a 0.05 ed è accompagnato da uno o più asterischi, la conclusione è che l’effetto del trattamento è <em>statisticamente significativo</em>.</p>
</div>
<div id="example-4-due-predittori-nominali" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Example 4: due predittori nominali<a href="le-relazioni-causa-effetto.html#example-4-due-predittori-nominali" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consideriamo lo stesso esperimento dell’esempio precedente ed immaginiamo che sia stato disegnato a blocchi randomizzati (la prima osservazione di ogni genotipo è stata presa nel primo blocco, la seconda nel secondo blocco e così via). In questo caso, il nesso causa-effetto e, di consegeunza, il modello interpretativo sono diversi, perché la resa dipende da due fattori sperimentali, ovvero il genotipo e il blocco. L’equazione è:</p>
<p><span class="math display">\[ Y_{ij} = \mu + \gamma_i + \alpha_j + \varepsilon_{ij}\]</span></p>
<p>dove <span class="math inline">\(Y_{ij}\)</span> è la resa parcellare nell’ <span class="math inline">\(i\)</span><sup>esimo</sup> blocco e per il <span class="math inline">\(j\)</span><sup>esimo</sup> genotipo, <span class="math inline">\(\mu\)</span> è l’intercetta, <span class="math inline">\(\gamma_i\)</span> è l’effetto del <span class="math inline">\(i\)</span><sup>esimo</sup> blocco, <span class="math inline">\(\alpha_j\)</span> è l’effetto del <span class="math inline">\(j\)</span><sup>esimo</sup> genotipo e <span class="math inline">\(\varepsilon\)</span> è l’errore residuo di ogni parcella, con deviazione standard pari a <span class="math inline">\(\sigma\)</span>. Come abbiamo fatto per il modello ANOVA ad una via, dobbiamo porre dei vincoli sui valori <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\gamma\)</span>, in modo che i parametri del modello siano stimabili; in particolare, imporremo che <span class="math inline">\(\alpha_1 = \gamma_1 = 0\)</span>, in modo che <span class="math inline">\(\mu\)</span> è la produzione nel primo blocco e col primo genotipo (in R, convenzionalmente il primo in ordine alfabetico). Abbiamo quindi 3 parametri da stimare per l’effetto del genotipo e 2 parametri da stimare per l’effetto del blocco, oltre a <span class="math inline">\(\sigma\)</span>.</p>
<p>La stima dei parametri del modello può essere eseguita con R, aggiungendo l’effetto blocco all’equazione del modello:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="le-relazioni-causa-effetto.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I dati sono stati inseriti in un box precedente, </span></span>
<span id="cb29-2"><a href="le-relazioni-causa-effetto.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># qui creiamo il vettore che identifica il blocco</span></span>
<span id="cb29-3"><a href="le-relazioni-causa-effetto.html#cb29-3" aria-hidden="true" tabindex="-1"></a>Block <span class="ot">&lt;-</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">times =</span> <span class="dv">4</span>)</span>
<span id="cb29-4"><a href="le-relazioni-causa-effetto.html#cb29-4" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Genotype <span class="sc">+</span> Block)</span></code></pre></div>
<p>Le stime dei parametri sono:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="le-relazioni-causa-effetto.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alpha e beta</span></span>
<span id="cb30-2"><a href="le-relazioni-causa-effetto.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod)</span>
<span id="cb30-3"><a href="le-relazioni-causa-effetto.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)   GenotypeB   GenotypeC   GenotypeD      BlockB </span></span>
<span id="cb30-4"><a href="le-relazioni-causa-effetto.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   4.4416667  -0.7000000  -0.4000000   0.2333333  -0.0250000 </span></span>
<span id="cb30-5"><a href="le-relazioni-causa-effetto.html#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="do">##      BlockC </span></span>
<span id="cb30-6"><a href="le-relazioni-causa-effetto.html#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   0.3000000</span></span>
<span id="cb30-7"><a href="le-relazioni-causa-effetto.html#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb30-8"><a href="le-relazioni-causa-effetto.html#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Sigma</span></span>
<span id="cb30-9"><a href="le-relazioni-causa-effetto.html#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)<span class="sc">$</span>sigma</span>
<span id="cb30-10"><a href="le-relazioni-causa-effetto.html#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1443376</span></span></code></pre></div>
<p>I residui e la loro devianza sono:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="le-relazioni-causa-effetto.html#cb31-1" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">residuals</span>(mod)</span>
<span id="cb31-2"><a href="le-relazioni-causa-effetto.html#cb31-2" aria-hidden="true" tabindex="-1"></a>RSS <span class="ot">&lt;-</span> <span class="fu">sum</span>(epsilon<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb31-3"><a href="le-relazioni-causa-effetto.html#cb31-3" aria-hidden="true" tabindex="-1"></a>RSS</span>
<span id="cb31-4"><a href="le-relazioni-causa-effetto.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.125</span></span></code></pre></div>
<p>Come previsto, i residui di questo modello sono più piccoli e quindi hanno una devianza minore di quelli del modello precedente, senza l’effetto del blocco. La rimozione dell’effetto del blocco fa si che la devianza del residuo aumenti da 0.125 a 0.38667 (vedi sopra), con una differenza pari a 0.262, che misura appunto l’effetto del blocco 8devianza del blocco: SS<sub>b</sub>). Anche in questo caso, se consideriamo un modello ridotto, contenente solo il blocco, ma non il genotipo (quindi rimuoviamo dal modello l’effetto del genotipo), possiamo misurare la devianza del fattore sperimentale rimosso, che, coerentemente con quanto visto in precedenza, ammonta a 1.55.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="le-relazioni-causa-effetto.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rimozione dei blocchi</span></span>
<span id="cb32-2"><a href="le-relazioni-causa-effetto.html#cb32-2" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Genotype) <span class="co"># Stesso modello di prima</span></span>
<span id="cb32-3"><a href="le-relazioni-causa-effetto.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(mod2)</span>
<span id="cb32-4"><a href="le-relazioni-causa-effetto.html#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.3866667</span></span>
<span id="cb32-5"><a href="le-relazioni-causa-effetto.html#cb32-5" aria-hidden="true" tabindex="-1"></a>SS_b <span class="ot">&lt;-</span> <span class="fu">deviance</span>(mod2) <span class="sc">-</span> RSS</span>
<span id="cb32-6"><a href="le-relazioni-causa-effetto.html#cb32-6" aria-hidden="true" tabindex="-1"></a>SS_b</span>
<span id="cb32-7"><a href="le-relazioni-causa-effetto.html#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.2616667</span></span>
<span id="cb32-8"><a href="le-relazioni-causa-effetto.html#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Rimozione dei genotipi</span></span>
<span id="cb32-9"><a href="le-relazioni-causa-effetto.html#cb32-9" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Block)</span>
<span id="cb32-10"><a href="le-relazioni-causa-effetto.html#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(mod3)</span>
<span id="cb32-11"><a href="le-relazioni-causa-effetto.html#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.675</span></span>
<span id="cb32-12"><a href="le-relazioni-causa-effetto.html#cb32-12" aria-hidden="true" tabindex="-1"></a>SS_g <span class="ot">&lt;-</span> <span class="fu">deviance</span>(mod3) <span class="sc">-</span> RSS</span>
<span id="cb32-13"><a href="le-relazioni-causa-effetto.html#cb32-13" aria-hidden="true" tabindex="-1"></a>SS_g</span>
<span id="cb32-14"><a href="le-relazioni-causa-effetto.html#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.55</span></span></code></pre></div>
<p>Il numero di gradi di libertà è, rispettivamente, 11 per la devianza totale (<span class="math inline">\(SS_{tot} = n - 1 = 12 - 1 = 11\)</span>), 3 per i genotipi (numero dei genotipi meno 1) e 2 per i blocchi (numero dei blocchi meno 1); per sottrazione, arriviamo a 6 DF per la devianza del residuo. A questo punto possiamo calcolare le varianze dei blocchi, dei genotipi e del residuo, che anche in questo caso è attribuibile a tutte le sorgenti di variabilità casuali non controllate (errore sperimentale o rumore di fondo). In questo caso possiamo calcolare due rapporti F, uno per l’effetto del blocco e uno per l’effetto del genotipo; per comodità, possiamo saltare tutti i calcoli manuali e arrivare direttamente alla tabella ANOVA finale usando il metodo ‘anova()’ in R.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="le-relazioni-causa-effetto.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod)</span>
<span id="cb33-2"><a href="le-relazioni-causa-effetto.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb33-3"><a href="le-relazioni-causa-effetto.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-4"><a href="le-relazioni-causa-effetto.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: Yield</span></span>
<span id="cb33-5"><a href="le-relazioni-causa-effetto.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="do">##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb33-6"><a href="le-relazioni-causa-effetto.html#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype   3 1.55000 0.51667   24.80 0.0008833 ***</span></span>
<span id="cb33-7"><a href="le-relazioni-causa-effetto.html#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Block      2 0.26167 0.13083    6.28 0.0337847 *  </span></span>
<span id="cb33-8"><a href="le-relazioni-causa-effetto.html#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals  6 0.12500 0.02083                      </span></span>
<span id="cb33-9"><a href="le-relazioni-causa-effetto.html#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb33-10"><a href="le-relazioni-causa-effetto.html#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>I rapporti F suggeriscono che l’effetto causale del genotipo è elevato e significativo (presenza di asterischi), mentre l’effetto blocco è significativo, ma il valore F è più basso e P è più alto di quello del genotipo, il che porta a pensare che l’effetto prodotto dal blocco sia meno rilevante.</p>
</div>
<div id="example-5-due-predittori-nominali-con-interazione" class="section level2 hasAnchor" number="4.9">
<h2><span class="header-section-number">4.9</span> Example 5: due predittori nominali con interazione<a href="le-relazioni-causa-effetto.html#example-5-due-predittori-nominali-con-interazione" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Immaginiamo che l’esperimento presentato nell’Esempio 1 sia stato ripetuto in un’altra località, utilizzando sempre un disegno completamente randomizzato. I dati osservati sono riportati nella Tabella <a href="le-relazioni-causa-effetto.html#tab:tabName4b4">4.2</a>.</p>
<table>
<caption><span id="tab:tabName4b4">Tabella 4.2: </span>Risultati di un esperimento di campo a randomizzazione completa per il confronto di quattro genotipi di avena (A, B, C and D), ripetuto in due località.</caption>
<thead>
<tr class="header">
<th align="left">Genotype</th>
<th align="left">Location</th>
<th align="right">Yield</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="left">LOC1</td>
<td align="right">4.5</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="left">LOC1</td>
<td align="right">4.3</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="left">LOC1</td>
<td align="right">4.8</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left">LOC1</td>
<td align="right">3.9</td>
</tr>
<tr class="odd">
<td align="left">B</td>
<td align="left">LOC1</td>
<td align="right">3.6</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left">LOC1</td>
<td align="right">4.0</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="left">LOC1</td>
<td align="right">3.9</td>
</tr>
<tr class="even">
<td align="left">C</td>
<td align="left">LOC1</td>
<td align="right">4.2</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="left">LOC1</td>
<td align="right">4.3</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="left">LOC1</td>
<td align="right">4.6</td>
</tr>
<tr class="odd">
<td align="left">D</td>
<td align="left">LOC1</td>
<td align="right">4.7</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="left">LOC1</td>
<td align="right">5.0</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="left">LOC2</td>
<td align="right">5.4</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="left">LOC2</td>
<td align="right">5.5</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="left">LOC2</td>
<td align="right">4.1</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left">LOC2</td>
<td align="right">5.8</td>
</tr>
<tr class="odd">
<td align="left">B</td>
<td align="left">LOC2</td>
<td align="right">7.1</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left">LOC2</td>
<td align="right">5.8</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="left">LOC2</td>
<td align="right">4.2</td>
</tr>
<tr class="even">
<td align="left">C</td>
<td align="left">LOC2</td>
<td align="right">4.5</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="left">LOC2</td>
<td align="right">4.8</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="left">LOC2</td>
<td align="right">5.0</td>
</tr>
<tr class="odd">
<td align="left">D</td>
<td align="left">LOC2</td>
<td align="right">6.2</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="left">LOC2</td>
<td align="right">5.6</td>
</tr>
</tbody>
</table>
<p>In questo esperimento abbiamo due fattori incrociati, ma, a differenza dell’esempio precedente, abbiamo tre repliche per ciascuna delle otto combinazioni tra i livelli di genotipo e località. In questo modo, oltre agli effetti di genotipo e località, possiamo anche valutare la cosiddetta <strong>interazione</strong> tra i due fattori sperimentali, che è un’informazione molto importante.</p>
</div>
<div id="interazione-tra-fattori-sperimentali" class="section level2 hasAnchor" number="4.10">
<h2><span class="header-section-number">4.10</span> Interazione tra fattori sperimentali<a href="le-relazioni-causa-effetto.html#interazione-tra-fattori-sperimentali" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Per comprendere meglio il concetto di interazione, osserviamo la Figura <a href="le-relazioni-causa-effetto.html#fig:figName4b5">4.2</a>, dove sono mostrate le medie di quattro trattamenti, ottenuti dalla combinazione fattoriale di un trattamento A con due livelli (A1 e A2) e di un trattamento B con altrettanti livelli (B1 e B2). Nel grafico, ogni combinazione è rappresentata da un simbolo.</p>
<p>Concentriamoci un attimo sul grafico di sinistra e consideriamo la prima combinazione in ordine alfabetico (A1B1): per questa, la media è pari a 10. Se passiamo da A1 ad A2, fermo restando B1, l’incremento è + 4. Se invece passiamo da B1 a B2, fermo restando A1, l’incremento è + 5. Si deduce che, se gli effetti fossero puramente additivi, la media di A2B2 dovrebbe essere pari a 10 + 4 + 5 = 19, in quanto vengono modificati entrambi i livelli, da A1 ad A2 e da B1 a B2. Vediamo che l’osservazione conferma questa aspettativa di additività degli effetti e di mancanza di interazione.</p>
<p>Al contrario, nel grafico centrale vediamo che il risultato osservato di A2B2 non può essere ottenuto per semplice somma di effetti, perché, a fronte di un risultato atteso pari a 19 otteniamo invece 16. Evidentemente, vi è qualcosa in questa combinazione che altera l’effetto congiunto di A e B. Questo qualcosa può essere quantificato con il valore -3, così che la media A2B2 è pari a 10 + 4 + 5 - 3 = 16. Il valore -3 rappresenta la mancanza di additività o interazione; in questo caso si tratta di <strong>interazione semplice</strong>, in quanto la graduatoria dei trattamenti non cambia: A2 è sempre meglio di A1 e B2 è sempre meglio di B1, anche se gli effetti non sono quelli previsti.</p>
<p>Nel grafico di sinistra la situazione è analoga, ma più estrema: l’effetto dell’interazione è -10 e comporta un’inversione della graduatoria, per cui parliamo di <strong>interazione cross-over</strong>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figName4b5"></span>
<img src="_main_files/figure-html/figName4b5-1.png" alt="Esempi di interazione tra fattori sperimentali" width="90%" />
<p class="caption">
Figura 4.2: Esempi di interazione tra fattori sperimentali
</p>
</div>
<p>Perchè siamo così interessati all’interazione e, in particolare, all’interazione cross-over? Esaminiamo più da vicino i valori nel grafico a destra in Figura <a href="le-relazioni-causa-effetto.html#fig:figName4b5">4.2</a>, riportandoli nella tabella <a href="le-relazioni-causa-effetto.html#tab:tabName4b6">4.3</a>, insieme alle medie dei quattro livelli A1, A2, B1 e B2. Le medie delle combinazioni sono dette <strong>medie di cella</strong>, mentre le medie dei livelli principali sono dette <strong>medie marginali</strong>, perché si trovano al margine della tabella.</p>
<table>
<caption><span id="tab:tabName4b6">Tabella 4.3: </span>Interazione cross-over tra fattori sperimentali</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">B1</th>
<th align="right">B2</th>
<th align="right">Media</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A1</td>
<td align="right">10.0</td>
<td align="right">15.0</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td align="left">A2</td>
<td align="right">14.0</td>
<td align="right">9.0</td>
<td align="right">12.0</td>
</tr>
<tr class="odd">
<td align="left">Media</td>
<td align="right">12.5</td>
<td align="right">11.5</td>
<td align="right">12.0</td>
</tr>
</tbody>
</table>
<p>Se guardassimo solo le medie marginali, avremmo l’impressione sbagliata che il fattore A, da solo, non ha alcun effetto (le medie A1 e A2 sono uguali) e che il fattore B ha solo un piccolissimo effetto. La realtà è invece che entrambi i fattori hanno un grande effetto, ma la presenza dell’interazione lo nasconde completamente, impedendoci di raggiungere conclusioni attendibili guardando ai due fattori, uno separatamente dall’altro.</p>
</div>
<div id="example-5-segue" class="section level2 hasAnchor" number="4.11">
<h2><span class="header-section-number">4.11</span> Example 5 (segue)<a href="le-relazioni-causa-effetto.html#example-5-segue" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tornando al nostro esempio, è chiaro che le produzioni osservate sono determinate dall’effetto di:</p>
<ol style="list-style-type: decimal">
<li>genotipo</li>
<li>località</li>
<li>interazione ‘genotipo <span class="math inline">\(\times\)</span> località’</li>
</ol>
<p>Il modello lineare può essere così definito:</p>
<p><span class="math display">\[Y_{ij} = \mu + \alpha_i + \beta_j + \alpha\beta_{ij} + \varepsilon_{ij}\]</span></p>
<p>dove <span class="math inline">\(\mu\)</span> è l’intercetta (produzione del primo genotipo nella prima località, sotto il vincolo che <span class="math inline">\(\alpha_1 = \beta_1 = 0\)</span>), <span class="math inline">\(\alpha_i\)</span> è la differenza tra il genotipo <span class="math inline">\(i\)</span><sup>esimo</sup> ed il primo in ordine alfabetico, <span class="math inline">\(\beta_j\)</span> è la differenza tra la località <span class="math inline">\(j\)</span><sup>esima</sup> e la prima in ordine alfabetico e <span class="math inline">\(\alpha\beta_{ij}\)</span> è l’interazione tra il genotipo <span class="math inline">\(i\)</span><sup>esimo</sup> e la località <span class="math inline">\(j\)</span><sup>esima</sup> (sotto i vincoli che <span class="math inline">\(\alpha\beta_{1.} = \alpha\beta_{.1} = 0\)</span>). I residui sono quantificati dai valori <span class="math inline">\(\varepsilon_{ij}\)</span>, con media uguale a 0 e deviazione standard uguale a <span class="math inline">\(\sigma\)</span>.</p>
<p>Per stimare i parametri del modello, possiamo utiliozzare R, considerando che il termine di interazione viene codificato con l’operatore ‘:’, ad esempio:</p>
<pre><code>Y ~ A + B + A:B</code></pre>
<p>che può essere abbreviato come:</p>
<pre><code>Y ~ A * B</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="le-relazioni-causa-effetto.html#cb36-1" aria-hidden="true" tabindex="-1"></a>Yield <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">4.3</span>, <span class="fl">4.8</span>,</span>
<span id="cb36-2"><a href="le-relazioni-causa-effetto.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fl">3.9</span>, <span class="fl">3.6</span>, <span class="fl">4.0</span>,</span>
<span id="cb36-3"><a href="le-relazioni-causa-effetto.html#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fl">3.9</span>, <span class="fl">4.2</span>, <span class="fl">4.3</span>,</span>
<span id="cb36-4"><a href="le-relazioni-causa-effetto.html#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fl">4.6</span>, <span class="fl">4.7</span>, <span class="fl">5.0</span>,</span>
<span id="cb36-5"><a href="le-relazioni-causa-effetto.html#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fl">5.4</span>, <span class="fl">5.5</span>, <span class="fl">4.1</span>,</span>
<span id="cb36-6"><a href="le-relazioni-causa-effetto.html#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fl">5.8</span>, <span class="fl">7.1</span>, <span class="fl">5.8</span>,</span>
<span id="cb36-7"><a href="le-relazioni-causa-effetto.html#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fl">4.2</span>, <span class="fl">4.5</span>, <span class="fl">4.8</span>,</span>
<span id="cb36-8"><a href="le-relazioni-causa-effetto.html#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fl">5.0</span>, <span class="fl">6.2</span>, <span class="fl">5.6</span>)</span>
<span id="cb36-9"><a href="le-relazioni-causa-effetto.html#cb36-9" aria-hidden="true" tabindex="-1"></a>Genotype <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">each =</span> <span class="dv">3</span>), <span class="dv">2</span>)</span>
<span id="cb36-10"><a href="le-relazioni-causa-effetto.html#cb36-10" aria-hidden="true" tabindex="-1"></a>Location <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;LOC1&quot;</span>, <span class="st">&quot;LOC2&quot;</span>), <span class="at">each =</span> <span class="dv">12</span>)</span>
<span id="cb36-11"><a href="le-relazioni-causa-effetto.html#cb36-11" aria-hidden="true" tabindex="-1"></a>dfr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Genotype, Location, Yield)</span>
<span id="cb36-12"><a href="le-relazioni-causa-effetto.html#cb36-12" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Genotype <span class="sc">*</span> Location, <span class="at">data =</span> dfr)</span>
<span id="cb36-13"><a href="le-relazioni-causa-effetto.html#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="le-relazioni-causa-effetto.html#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Stima dei parametri</span></span>
<span id="cb36-15"><a href="le-relazioni-causa-effetto.html#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod)</span>
<span id="cb36-16"><a href="le-relazioni-causa-effetto.html#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="do">##            (Intercept)              GenotypeB              GenotypeC </span></span>
<span id="cb36-17"><a href="le-relazioni-causa-effetto.html#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="do">##              4.5333333             -0.7000000             -0.4000000 </span></span>
<span id="cb36-18"><a href="le-relazioni-causa-effetto.html#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="do">##              GenotypeD           LocationLOC2 GenotypeB:LocationLOC2 </span></span>
<span id="cb36-19"><a href="le-relazioni-causa-effetto.html#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="do">##              0.2333333              0.4666667              1.9333333 </span></span>
<span id="cb36-20"><a href="le-relazioni-causa-effetto.html#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="do">## GenotypeC:LocationLOC2 GenotypeD:LocationLOC2 </span></span>
<span id="cb36-21"><a href="le-relazioni-causa-effetto.html#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="do">##             -0.1000000              0.3666667</span></span>
<span id="cb36-22"><a href="le-relazioni-causa-effetto.html#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb36-23"><a href="le-relazioni-causa-effetto.html#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Sigma</span></span>
<span id="cb36-24"><a href="le-relazioni-causa-effetto.html#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)<span class="sc">$</span>sigma</span>
<span id="cb36-25"><a href="le-relazioni-causa-effetto.html#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.4765326</span></span></code></pre></div>
<p>L’analisi della varianza viene eseguita rimuovendo dal modello i tre termini uno alla volta, ma rispettando un criterio di marginalità, che tenga conto del fatto che l’interazione viene dopo che sono stati inseriti gli effetti principali che la costituiscono e, quindi, dovrebbe essere omessa per prima e non dovrebbe essere lasciata nel modello, quando uno degli effetti principali coinvolti viene rimosso. Lo schema è illustrato nel box seguente.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="le-relazioni-causa-effetto.html#cb37-1" aria-hidden="true" tabindex="-1"></a>RSS <span class="ot">&lt;-</span> <span class="fu">deviance</span>(mod)</span>
<span id="cb37-2"><a href="le-relazioni-causa-effetto.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb37-3"><a href="le-relazioni-causa-effetto.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rimozione dell&#39;interazione</span></span>
<span id="cb37-4"><a href="le-relazioni-causa-effetto.html#cb37-4" aria-hidden="true" tabindex="-1"></a>modred <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Genotype <span class="sc">+</span> Location, <span class="at">data =</span> dfr)</span>
<span id="cb37-5"><a href="le-relazioni-causa-effetto.html#cb37-5" aria-hidden="true" tabindex="-1"></a>SSint <span class="ot">&lt;-</span> <span class="fu">deviance</span>(modred) <span class="sc">-</span> RSS</span>
<span id="cb37-6"><a href="le-relazioni-causa-effetto.html#cb37-6" aria-hidden="true" tabindex="-1"></a>SSint</span>
<span id="cb37-7"><a href="le-relazioni-causa-effetto.html#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 4.008333</span></span>
<span id="cb37-8"><a href="le-relazioni-causa-effetto.html#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb37-9"><a href="le-relazioni-causa-effetto.html#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># rimozione del genotipo E dell&#39;interazione</span></span>
<span id="cb37-10"><a href="le-relazioni-causa-effetto.html#cb37-10" aria-hidden="true" tabindex="-1"></a>modred <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Location, <span class="at">data =</span> dfr)</span>
<span id="cb37-11"><a href="le-relazioni-causa-effetto.html#cb37-11" aria-hidden="true" tabindex="-1"></a>SSloc <span class="ot">&lt;-</span> <span class="fu">deviance</span>(modred) <span class="sc">-</span> RSS <span class="sc">-</span> SSint</span>
<span id="cb37-12"><a href="le-relazioni-causa-effetto.html#cb37-12" aria-hidden="true" tabindex="-1"></a>SSloc</span>
<span id="cb37-13"><a href="le-relazioni-causa-effetto.html#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2.601667</span></span>
<span id="cb37-14"><a href="le-relazioni-causa-effetto.html#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb37-15"><a href="le-relazioni-causa-effetto.html#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="co"># rimozione della località E dell&#39;interazione</span></span>
<span id="cb37-16"><a href="le-relazioni-causa-effetto.html#cb37-16" aria-hidden="true" tabindex="-1"></a>modred <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Genotype, <span class="at">data =</span> dfr)</span>
<span id="cb37-17"><a href="le-relazioni-causa-effetto.html#cb37-17" aria-hidden="true" tabindex="-1"></a>SSgen <span class="ot">&lt;-</span> <span class="fu">deviance</span>(modred) <span class="sc">-</span> RSS <span class="sc">-</span> SSint</span>
<span id="cb37-18"><a href="le-relazioni-causa-effetto.html#cb37-18" aria-hidden="true" tabindex="-1"></a>SSgen</span>
<span id="cb37-19"><a href="le-relazioni-causa-effetto.html#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 6.201667</span></span></code></pre></div>
<p>Anche in questo esempio, abbiamo suddiviso la variabilità totale dei dati in quattro termini, tre dei quali sono correlati all’effetto causale, mentre il quarto è correlato a tutti gli altri effetti casuali. In pratica, i calcoli manuali non sono necessari, perchè possiamo utilizzare la funzione ‘anova()’ in R. Nella tabella sottostante, l’unico elemento di cui non abbiamo parlato finora è il numero di gradi di libertà per l’interazione, che è <strong>uguale al prodotto del numero di DF per gli effetti principali</strong>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="le-relazioni-causa-effetto.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod)</span>
<span id="cb38-2"><a href="le-relazioni-causa-effetto.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb38-3"><a href="le-relazioni-causa-effetto.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb38-4"><a href="le-relazioni-causa-effetto.html#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: Yield</span></span>
<span id="cb38-5"><a href="le-relazioni-causa-effetto.html#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="do">##                   Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span id="cb38-6"><a href="le-relazioni-causa-effetto.html#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype           3 2.6017  0.8672  3.8190   0.03077 *  </span></span>
<span id="cb38-7"><a href="le-relazioni-causa-effetto.html#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Location           1 6.2017  6.2017 27.3101 8.322e-05 ***</span></span>
<span id="cb38-8"><a href="le-relazioni-causa-effetto.html#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype:Location  3 4.0083  1.3361  5.8838   0.00662 ** </span></span>
<span id="cb38-9"><a href="le-relazioni-causa-effetto.html#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals         16 3.6333  0.2271                      </span></span>
<span id="cb38-10"><a href="le-relazioni-causa-effetto.html#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb38-11"><a href="le-relazioni-causa-effetto.html#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Vediamo che tutti gli effetti in gioco (genotipo, località ed interazione) sono significativi ed hanno quindi un nesso causa-effetto rilevante sulla produzione della coltura. La presnza di un’interaione significativa mostra che, probabilmente, la valutazione dei genotipi performanti non è comune alle due località anche se questa affermazione richiede analisi successive che vedremo in seguito.</p>
</div>
<div id="dati-non-bilanciati" class="section level2 hasAnchor" number="4.12">
<h2><span class="header-section-number">4.12</span> Dati non bilanciati<a href="le-relazioni-causa-effetto.html#dati-non-bilanciati" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Prima di concludere questo capitolo, è necessario sottolineare che esistono diversi metodi per calcolare la somma dei quadrati per gli effetti del modello e che non portano necessariamente agli stessi risultati, in particolare quando i dati sono non bilanciati, ovvero quando c’è un numero diverso di repliche per ogni gruppo di trattamento. Il metodo da noi proposto si basa su:</p>
<ol style="list-style-type: decimal">
<li>adattamento del modello completo ai dati osservati</li>
<li>rimozione dell’effetto in studio e adattamento del modello ridotto</li>
<li>sottrazione della somma residua dei quadrati del modello completo dalla somma residua dei quadrati del modello ridotto.</li>
</ol>
<p>Questo approccio produce la cosiddetta <em>somma marginale dei quadrati</em> e non è lo stesso dell’approccio utilizzato nella funzione ‘anova()’ in base R, che produce la cosiddetta <em>somma sequenziale dei quadrati</em>. Questi due metodi danno gli stessi risultati con dati bilanciati, sebbene, con dati non bilanciati, raccomandiamo la <em>somma marginale dei quadrati</em>, che può essere ottenuta utilizzando la funzione ‘Anova()’ (si noti la lettera maiuscola all’inizio) nel pacchetto ‘car’, come mostrato nel seguente esempio.</p>
</div>
<div id="esempio-6-un-crbd-con-un-valore-mancante" class="section level2 hasAnchor" number="4.13">
<h2><span class="header-section-number">4.13</span> Esempio 6: un CRBD con un valore mancante<a href="le-relazioni-causa-effetto.html#esempio-6-un-crbd-con-un-valore-mancante" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Se consideriamo i dati nel precedente Esempio 3 e se immaginiamo che il genotipo A manchi dal terzo blocco (vedere il valore ‘NA’ nel riquadro Codice 4.14, che significa Non disponibile), il metodo ‘anova()’ in base R porta a diverse tabelle ANOVA, a seconda dell’ordine con cui i due effetti (genotipo e blocco) vengono inseriti nel modello (vedere riquadro Codice 4.14). Poiché non abbiamo una logica per decidere quale effetto debba essere inserito per primo, le conclusioni che otteniamo con la funzione ‘anova()’ sono puramente arbitrarie, il che non è accettabile nella scienza.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="le-relazioni-causa-effetto.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Codice box 4.14</span></span>
<span id="cb39-2"><a href="le-relazioni-causa-effetto.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Dati non bilanciati</span></span>
<span id="cb39-3"><a href="le-relazioni-causa-effetto.html#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="le-relazioni-causa-effetto.html#cb39-4" aria-hidden="true" tabindex="-1"></a>Yield <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.5</span>, <span class="fl">4.3</span>, <span class="cn">NA</span>,</span>
<span id="cb39-5"><a href="le-relazioni-causa-effetto.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fl">3.9</span>, <span class="fl">3.6</span>, <span class="fl">4.0</span>,</span>
<span id="cb39-6"><a href="le-relazioni-causa-effetto.html#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fl">3.9</span>, <span class="fl">4.2</span>, <span class="fl">4.3</span>,</span>
<span id="cb39-7"><a href="le-relazioni-causa-effetto.html#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="fl">4.6</span>, <span class="fl">4.7</span>, <span class="fl">5.0</span>)</span>
<span id="cb39-8"><a href="le-relazioni-causa-effetto.html#cb39-8" aria-hidden="true" tabindex="-1"></a>Genotype <span class="ot">&lt;-</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">each =</span> <span class="dv">3</span>)</span>
<span id="cb39-9"><a href="le-relazioni-causa-effetto.html#cb39-9" aria-hidden="true" tabindex="-1"></a>Block <span class="ot">&lt;-</span> <span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">times =</span> <span class="dv">4</span>)</span>
<span id="cb39-10"><a href="le-relazioni-causa-effetto.html#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="le-relazioni-causa-effetto.html#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Adattamento di un modello</span></span>
<span id="cb39-12"><a href="le-relazioni-causa-effetto.html#cb39-12" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Genotype <span class="sc">+</span> Block)</span>
<span id="cb39-13"><a href="le-relazioni-causa-effetto.html#cb39-13" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Block <span class="sc">+</span> Genotype)</span>
<span id="cb39-14"><a href="le-relazioni-causa-effetto.html#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="le-relazioni-causa-effetto.html#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Partizionamento della varianza</span></span>
<span id="cb39-16"><a href="le-relazioni-causa-effetto.html#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod1)</span>
<span id="cb39-17"><a href="le-relazioni-causa-effetto.html#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb39-18"><a href="le-relazioni-causa-effetto.html#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-19"><a href="le-relazioni-causa-effetto.html#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: Yield</span></span>
<span id="cb39-20"><a href="le-relazioni-causa-effetto.html#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="do">##           Df  Sum Sq Mean Sq F value   Pr(&gt;F)   </span></span>
<span id="cb39-21"><a href="le-relazioni-causa-effetto.html#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype   3 1.40182 0.46727 19.7671 0.003338 **</span></span>
<span id="cb39-22"><a href="le-relazioni-causa-effetto.html#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Block      2 0.16181 0.08090  3.4224 0.115770   </span></span>
<span id="cb39-23"><a href="le-relazioni-causa-effetto.html#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals  5 0.11819 0.02364                    </span></span>
<span id="cb39-24"><a href="le-relazioni-causa-effetto.html#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb39-25"><a href="le-relazioni-causa-effetto.html#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb39-26"><a href="le-relazioni-causa-effetto.html#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2)</span>
<span id="cb39-27"><a href="le-relazioni-causa-effetto.html#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb39-28"><a href="le-relazioni-causa-effetto.html#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb39-29"><a href="le-relazioni-causa-effetto.html#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: Yield</span></span>
<span id="cb39-30"><a href="le-relazioni-causa-effetto.html#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="do">##           Df  Sum Sq Mean Sq F value   Pr(&gt;F)   </span></span>
<span id="cb39-31"><a href="le-relazioni-causa-effetto.html#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Block      2 0.10765 0.05383   2.277 0.198135   </span></span>
<span id="cb39-32"><a href="le-relazioni-causa-effetto.html#cb39-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype   3 1.45597 0.48532  20.531 0.003061 **</span></span>
<span id="cb39-33"><a href="le-relazioni-causa-effetto.html#cb39-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals  5 0.11819 0.02364                    </span></span>
<span id="cb39-34"><a href="le-relazioni-causa-effetto.html#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb39-35"><a href="le-relazioni-causa-effetto.html#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>L’approccio proposto in precedenza, basato sulla rimozione dei due predittori, uno alla volta, porta alla somma dei quadrati mostrata nel Codice box 4.15 e possiamo notare che questa somma di quadrati (per gli effetti genotipo e blocco) sono gli stessi, indipendentemente dall’ordine con cui i due effetti sono stati inclusi nel modello completo. Queste somme marginali di quadrati possono essere riprodotte utilizzando la funzione ‘Anova()’ nel pacchetto ‘car’ e impostando l’argomento ‘type = 2’. Ulteriori informazioni sui tipi di somma di quadrati possono essere trovate in Lansrud (2003).</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="le-relazioni-causa-effetto.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Casella di codice 4.15</span></span>
<span id="cb40-2"><a href="le-relazioni-causa-effetto.html#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="le-relazioni-causa-effetto.html#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Rimozione dei predittori uno alla volta (modello 1)</span></span>
<span id="cb40-4"><a href="le-relazioni-causa-effetto.html#cb40-4" aria-hidden="true" tabindex="-1"></a>RSS <span class="ot">&lt;-</span> <span class="fu">deviance</span>(mod1)</span>
<span id="cb40-5"><a href="le-relazioni-causa-effetto.html#cb40-5" aria-hidden="true" tabindex="-1"></a>mod1.red <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Block) <span class="co"># Rimozione del genotipo</span></span>
<span id="cb40-6"><a href="le-relazioni-causa-effetto.html#cb40-6" aria-hidden="true" tabindex="-1"></a>SS_g <span class="ot">&lt;-</span> <span class="fu">deviance</span>(mod1.red) <span class="sc">-</span> RSS</span>
<span id="cb40-7"><a href="le-relazioni-causa-effetto.html#cb40-7" aria-hidden="true" tabindex="-1"></a>SS_g</span>
<span id="cb40-8"><a href="le-relazioni-causa-effetto.html#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.455972</span></span>
<span id="cb40-9"><a href="le-relazioni-causa-effetto.html#cb40-9" aria-hidden="true" tabindex="-1"></a>mod1.red2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Genotype) <span class="co"># Rimozione del blocco</span></span>
<span id="cb40-10"><a href="le-relazioni-causa-effetto.html#cb40-10" aria-hidden="true" tabindex="-1"></a>SS_b <span class="ot">&lt;-</span> <span class="fu">deviance</span>(mod1.red2) <span class="sc">-</span> RSS</span>
<span id="cb40-11"><a href="le-relazioni-causa-effetto.html#cb40-11" aria-hidden="true" tabindex="-1"></a>SS_b</span>
<span id="cb40-12"><a href="le-relazioni-causa-effetto.html#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1618056</span></span>
<span id="cb40-13"><a href="le-relazioni-causa-effetto.html#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Rimozione dei predittori uno alla volta (modello 2)</span></span>
<span id="cb40-14"><a href="le-relazioni-causa-effetto.html#cb40-14" aria-hidden="true" tabindex="-1"></a>RSS <span class="ot">&lt;-</span> <span class="fu">deviance</span>(mod2)</span>
<span id="cb40-15"><a href="le-relazioni-causa-effetto.html#cb40-15" aria-hidden="true" tabindex="-1"></a>mod2.red <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Block) <span class="co"># Rimozione del genotipo</span></span>
<span id="cb40-16"><a href="le-relazioni-causa-effetto.html#cb40-16" aria-hidden="true" tabindex="-1"></a>SS_g <span class="ot">&lt;-</span> <span class="fu">deviance</span>(mod2.red) <span class="sc">-</span> RSS</span>
<span id="cb40-17"><a href="le-relazioni-causa-effetto.html#cb40-17" aria-hidden="true" tabindex="-1"></a>SS_g</span>
<span id="cb40-18"><a href="le-relazioni-causa-effetto.html#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.455972</span></span>
<span id="cb40-19"><a href="le-relazioni-causa-effetto.html#cb40-19" aria-hidden="true" tabindex="-1"></a>mod2.red2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yield <span class="sc">~</span> Genotype) <span class="co"># Rimozione del blocco</span></span>
<span id="cb40-20"><a href="le-relazioni-causa-effetto.html#cb40-20" aria-hidden="true" tabindex="-1"></a>SS_b <span class="ot">&lt;-</span> <span class="fu">deviance</span>(mod2.red2) <span class="sc">-</span> RSS</span>
<span id="cb40-21"><a href="le-relazioni-causa-effetto.html#cb40-21" aria-hidden="true" tabindex="-1"></a>SS_b</span>
<span id="cb40-22"><a href="le-relazioni-causa-effetto.html#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1618056</span></span>
<span id="cb40-23"><a href="le-relazioni-causa-effetto.html#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizzo del metodo Anova() nel pacchetto &#39;car&#39;</span></span>
<span id="cb40-24"><a href="le-relazioni-causa-effetto.html#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb40-25"><a href="le-relazioni-causa-effetto.html#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(mod1, <span class="at">type =</span> <span class="dv">2</span>)</span>
<span id="cb40-26"><a href="le-relazioni-causa-effetto.html#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Anova Table (Type II tests)</span></span>
<span id="cb40-27"><a href="le-relazioni-causa-effetto.html#cb40-27" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb40-28"><a href="le-relazioni-causa-effetto.html#cb40-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: Yield</span></span>
<span id="cb40-29"><a href="le-relazioni-causa-effetto.html#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="do">##            Sum Sq Df F value   Pr(&gt;F)   </span></span>
<span id="cb40-30"><a href="le-relazioni-causa-effetto.html#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype  1.45597  3 20.5307 0.003061 **</span></span>
<span id="cb40-31"><a href="le-relazioni-causa-effetto.html#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Block     0.16181  2  3.4224 0.115770   </span></span>
<span id="cb40-32"><a href="le-relazioni-causa-effetto.html#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 0.11819  5                    </span></span>
<span id="cb40-33"><a href="le-relazioni-causa-effetto.html#cb40-33" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb40-34"><a href="le-relazioni-causa-effetto.html#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb40-35"><a href="le-relazioni-causa-effetto.html#cb40-35" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(mod2, <span class="at">type =</span> <span class="dv">2</span>)</span>
<span id="cb40-36"><a href="le-relazioni-causa-effetto.html#cb40-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Anova Table (Type II tests)</span></span>
<span id="cb40-37"><a href="le-relazioni-causa-effetto.html#cb40-37" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb40-38"><a href="le-relazioni-causa-effetto.html#cb40-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: Yield</span></span>
<span id="cb40-39"><a href="le-relazioni-causa-effetto.html#cb40-39" aria-hidden="true" tabindex="-1"></a><span class="do">##            Sum Sq Df F value   Pr(&gt;F)   </span></span>
<span id="cb40-40"><a href="le-relazioni-causa-effetto.html#cb40-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Block     0.16181  2  3.4224 0.115770   </span></span>
<span id="cb40-41"><a href="le-relazioni-causa-effetto.html#cb40-41" aria-hidden="true" tabindex="-1"></a><span class="do">## Genotype  1.45597  3 20.5307 0.003061 **</span></span>
<span id="cb40-42"><a href="le-relazioni-causa-effetto.html#cb40-42" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 0.11819  5                    </span></span>
<span id="cb40-43"><a href="le-relazioni-causa-effetto.html#cb40-43" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb40-44"><a href="le-relazioni-causa-effetto.html#cb40-44" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
</div>
<div id="conclusioni-1" class="section level2 hasAnchor" number="4.14">
<h2><span class="header-section-number">4.14</span> Conclusioni<a href="le-relazioni-causa-effetto.html#conclusioni-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In questo capitolo abbiamo presentato un metodo per valutare se un certo set di dati ottenuto da un esperimento controllato può ragionevolmente supportare l’esistenza di relazioni causa-effetto tra le variabili in esame.</p>
<p>Questo metodo consiste in:</p>
<ol style="list-style-type: decimal">
<li>adattamento di un modello causa-effetto ragionevole nei dati osservati;</li>
<li>utilizzo del metodo di partizionamento della varianza (ANOVA) per ottenere i quadrati medi (varianze) per tutti gli effetti causali in esame e il quadrato medio per tutti gli altri effetti di natura casuale (quadrato medio residuo);</li>
<li>confronto dei quadrati medi per gli effetti causali con il quadrato medio per gli effetti casuali, utilizzando i rapporti F. Più alto è il rapporto F, più forte è la relazione causa-effetto.</li>
</ol>
<p>Per il metodo di partizionamento della varianza con R, sono disponibili due funzioni, ‘anova()’ in base R e ‘Anova()’ nel pacchetto ‘car’. Queste due funzioni forniscono gli stessi risultati con dati bilanciati, ma la seconda è altamente consigliata quando i dati non sono bilanciati.</p>
<hr />
</div>
<div id="altre-letture-3" class="section level2 hasAnchor" number="4.15">
<h2><span class="header-section-number">4.15</span> Altre letture<a href="le-relazioni-causa-effetto.html#altre-letture-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Faraway, J.J., 2002. Practical regression and Anova using R. In: <a href="http://cran.r-project.org/doc/contrib/Faraway-PRA.pdf" class="uri">http://cran.r-project.org/doc/contrib/Faraway-PRA.pdf</a>.</li>
<li>Kuehl, R. O., 2000. Design of experiments: statistical principles of research design and analysis. Duxbury Press</li>
</ol>
</div>
<div id="domande-ed-esercizi-2" class="section level2 hasAnchor" number="4.16">
<h2><span class="header-section-number">4.16</span> Domande ed esercizi<a href="le-relazioni-causa-effetto.html#domande-ed-esercizi-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Qual è la differenza tra variazione congiunta e causalità?</li>
<li>In valore, cosa intendiamo quando diciamo “effetto del trattamento”?</li>
<li>Descrivi in poche frasi cos’è l’ANOVA e perché viene utilizzata.</li>
<li>Qual è la definizione di “interazione tra due fattori sperimentali”? Spiega brevemente.</li>
<li>Considera il file Excel “rimsulfuron.csv” da <a href="https://www.casaonofri.it/_datasets/rimsulfuron.csv">https://www.casaonofri.it/_datasets/rimsulfuron.csv</a> (puoi scaricarlo o leggerlo direttamente dal repository web). Questo è un set di dati relativo a un esperimento sul campo per confrontare 14 erbicidi e due controlli non trattati, con 4 repliche per trattamento. L’esperimento è stato progettato in blocchi randomizzati. Esegui l’ANOVA con R e valuta la rilevanza dell’effetto erbicida.</li>
<li>Hai eseguito un esperimento con un layout completamente randomizzato con due repliche, per confrontare due genotipi di mais (G1 e G2) con due diverse strategie di fertilizzazione (F1 e F2). Calcola i quadrati medi e i rapporti F per il genotipo, gli effetti della fertilizzazione e per la loro interazione. Gli effetti causali sono rilevanti? Il set di dati è mostrato di seguito.</li>
</ol>
<table>
<thead>
<tr class="header">
<th align="left">Genotype</th>
<th align="left">Fertiliser</th>
<th align="right">Yield</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">G1</td>
<td align="left">F1</td>
<td align="right">11.292934</td>
</tr>
<tr class="even">
<td align="left">G1</td>
<td align="left">F1</td>
<td align="right">12.777429</td>
</tr>
<tr class="odd">
<td align="left">G1</td>
<td align="left">F2</td>
<td align="right">12.584441</td>
</tr>
<tr class="even">
<td align="left">G1</td>
<td align="left">F2</td>
<td align="right">9.154302</td>
</tr>
<tr class="odd">
<td align="left">G2</td>
<td align="left">F1</td>
<td align="right">14.929125</td>
</tr>
<tr class="even">
<td align="left">G2</td>
<td align="left">F1</td>
<td align="right">15.006056</td>
</tr>
<tr class="odd">
<td align="left">G2</td>
<td align="left">F2</td>
<td align="right">12.925260</td>
</tr>
<tr class="even">
<td align="left">G2</td>
<td align="left">F2</td>
<td align="right">12.953368</td>
</tr>
</tbody>
</table>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="richiami-di-statistica-descrittiva.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelli-stocastici.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
